var JSceneKit=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}([function(e,t,n){"use strict";var r=n(2),o=new Map,i=["superclass","isSubclassOf","className"],a=["isInstanceOf","className"];o.registerClass=function(e,t){if(!t.startsWith("_")){if(e._className=t,void 0===e.superclass&&void 0!==e.prototype){for(var n=0;n<i.length;n++){var u=i[n],s=Object.getOwnPropertyDescriptor(r.a,u);Object.defineProperty(e,u,s)}for(var l=0;l<a.length;l++){var c=a[l],f=Object.getOwnPropertyDescriptor(r.a.prototype,c);Object.defineProperty(e.prototype,c,f)}}o.set(t,e)}},t.a=o},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(8);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.z=r}var t,n,i;return t=e,i=[{key:"_initWithData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new e;return r?(o.x=t.readFloatBE(n+0),o.y=t.readFloatBE(n+4),o.z=t.readFloatBE(n+8)):(o.x=t.readFloatLE(n+0),o.y=t.readFloatLE(n+4),o.z=t.readFloatLE(n+8)),o}}],(n=[{key:"_copy",value:function(){return new e(this.x,this.y,this.z)}},{key:"_copyFrom",value:function(e){this.x=e.x,this.y=e.y,this.z=e.z}},{key:"zero",value:function(){return new e}},{key:"add",value:function(t){var n=new e;return n.x=this.x+t.x,n.y=this.y+t.y,n.z=this.z+t.z,n}},{key:"sub",value:function(t){var n=new e;return n.x=this.x-t.x,n.y=this.y-t.y,n.z=this.z-t.z,n}},{key:"mul",value:function(t){var n=new e;return n.x=this.x*t,n.y=this.y*t,n.z=this.z*t,n}},{key:"mulv",value:function(t){var n=new e;return n.x=this.x*t.x,n.y=this.y*t.y,n.z=this.z*t.z,n}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"cross",value:function(t){var n=new e;return n.x=this.y*t.z-this.z*t.y,n.y=this.z*t.x-this.x*t.z,n.z=this.x*t.y-this.y*t.x,n}},{key:"lerp",value:function(t,n){var r=new e;return r.x=this.x+n*(t.x-this.x),r.y=this.y+n*(t.y-this.y),r.z=this.z+n*(t.z-this.z),r}},{key:"normalize",value:function(){var t=this.length(),n=new e;if(0===t)return n;var r=1/t;return n.x=this.x*r,n.y=this.y*r,n.z=this.z*r,n}},{key:"length2",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"transform",value:function(t){var n=new e,r=this.x*t.m14+this.y*t.m24+this.z*t.m34+t.m44;if(0===r)return n;var o=1/r;return n.x=(this.x*t.m11+this.y*t.m21+this.z*t.m31+t.m41)*o,n.y=(this.x*t.m12+this.y*t.m22+this.z*t.m32+t.m42)*o,n.z=(this.x*t.m13+this.y*t.m23+this.z*t.m33+t.m43)*o,n}},{key:"rotate",value:function(t){var n=new e;return n.x=this.x*t.m11+this.y*t.m21+this.z*t.m31,n.y=this.x*t.m12+this.y*t.m22+this.z*t.m32,n.z=this.x*t.m13+this.y*t.m23+this.z*t.m33,n}},{key:"rotateWithQuaternion",value:function(e){return this.rotate(e.rotMatrix())}},{key:"eulerAnglesToRotation",value:function(){var e=new r.a,t=.5*this.x,n=.5*this.y,o=.5*this.z,i=Math.cos(t),a=Math.sin(t),u=Math.cos(n),s=Math.sin(n),l=Math.cos(o),c=Math.sin(o),f=(new r.a,a*u*l-i*s*c),h=i*s*l+a*u*c,y=i*u*c-a*s*l,p=f*f+h*h+y*y;if(0===p)e.x=0,e.y=0,e.z=0,e.w=0;else{var m=1/Math.sqrt(p);e.x=f*m,e.y=h*m,e.z=y*m,e.w=2*Math.acos(i*u*l+a*s*c)}return e}},{key:"eulerAnglesToQuat",value:function(){return this.eulerAnglesToRotation().rotationToQuat()}},{key:"floatArray",value:function(){return[this.x,this.y,this.z]}},{key:"float32Array",value:function(){return new Float32Array([this.x,this.y,this.z])}},{key:"_createBtVector3",value:function(){}}])&&o(t.prototype,n),i&&o(t,i),e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return a});var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var a=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._autoContentAccessingProxy=null,this._classForArchiver=null,this._classForCoder=null,this._classForKeyedArchiver=null,this._attributeKeys=null,this._classDescription=null,this._toManyRelationshipKeys=null,this._toOneRelationshipKeys=null,this.scriptingProperties=null,this._classCode=0,this.observationInfo=null,this.accessibilityActivationPoint=null,this.accessibilityCustomActions=null,this.accessibilityCustomRotors=null,this.accessibilityElements=null,this.accessibilityElementsHidden=!1,this.accessibilityFrame=null,this.accessibilityHeaderElements=null,this.accessibilityHint=null,this.accessibilityLabel=null,this.accessibilityLanguage=null,this.accessibilityNavigationStyle=null,this.accessibilityPath=null,this.accessibilityTraits=null,this.accessibilityValue=null,this.accessibilityViewIsModal=!1,this.isAccessibilityElement=!1,this.shouldGroupAccessibilityChildren=!1,this._hashValue=0,this._accessibilityFocusedUIElement=null,this._accessibilityNotifiesWhenDestroyed=!1,this._exposedBindings=null,this._objectForWebScript=null,this._objectSpecifier=null,this._webFrame=null,this._webPlugInContainerSelectionColor=null,this._isSelectable=!1,this._destroyed=!1}return i(t,null,[{key:"initialize",value:function(){}},{key:"load",value:function(){}},{key:"_propTypes",get:function(){return{}}}]),i(t,[{key:"copy",value:function(){return new this.constructor}},{key:"mutableCopy",value:function(){return null}},{key:"isInstanceOf",value:function(e){return this.constructor.isSubclassOf(e)}},{key:"methodFor",value:function(e){return null}},{key:"performWithAfterDelay",value:function(e,t,n){}},{key:"performWithAfterDelayInModes",value:function(e,t,n,r){}},{key:"performSelectorOnMainThreadWithWaitUntilDone",value:function(e,t,n){}},{key:"performSelectorOnMainThreadWithWaitUntilDoneModes",value:function(e,t,n,r){}},{key:"performOnWithWaitUntilDone",value:function(e,t,n,r){}},{key:"performOnWithWaitUntilDoneModes",value:function(e,t,n,r,o){}},{key:"performSelectorInBackgroundWith",value:function(e,t){}},{key:"forwardingTargetFor",value:function(e){return null}},{key:"doesNotRecognizeSelector",value:function(e){}},{key:"awakeAfterUsing",value:function(e){return null}},{key:"replacementObjectFor",value:function(e){return null}},{key:"inverseForRelationshipKey",value:function(e){return null}},{key:"copyScriptingValueForKeyWithProperties",value:function(e,t,n){return null}},{key:"newScriptingObjectOfForValueForKeyWithContentsValue",value:function(e,t,n,r){return null}},{key:"scriptingValueFor",value:function(e){return null}},{key:"finalize",value:function(){}},{key:"addObserverForKeyPath",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&arguments[3]}},{key:"attemptRecoveryFromErrorOptionIndex",value:function(e,t){return!1}},{key:"dictionaryWithValuesForKeys",value:function(e){return null}},{key:"didChangeValuesAtForKey",value:function(e,t,n){}},{key:"didChangeValueForKey",value:function(e){}},{key:"didChangeValueForKeyWithSetMutationUsing",value:function(e,t,n){}},{key:"fileManagerShouldProceedAfterError",value:function(e,t){return!1}},{key:"fileManagerWillProcessPath",value:function(e,t){}},{key:"mutableArrayValueForKey",value:function(e){return null}},{key:"mutableArrayValueForKeyPath",value:function(e){return null}},{key:"mutableOrderedSetValueForKey",value:function(e){return null}},{key:"mutableOrderedSetValueForKeyPath",value:function(e){return null}},{key:"mutableSetValueForKey",value:function(e){return null}},{key:"mutableSetValueForKeyPath",value:function(e){return null}},{key:"observeValueForKeyPathOf",value:function(e,t,n,r){}},{key:"removeObserverForKeyPath",value:function(e,t){}},{key:"setNilValueForKey",value:function(e){}},{key:"setValueForKey",value:function(e,t){void 0===this[t]?this.setValueForUndefinedKey(e,t):this[t]=e}},{key:"setValueForKeyPath",value:function(e,t){if("string"!=typeof t)throw new Error("setValueForKeyPath: keyPath should be string");var n=t.split("."),r=n.shift();if(0!==n.length){var o=this.valueForKey(r);null!==o?o.setValueForKeyPath(e,n.join(".")):console.error("setValueForKeyPath: key ".concat(r," is null."))}else this.setValueForKey(e,r)}},{key:"setValueForUndefinedKey",value:function(e,t){throw new Error("setValueForKey: undefined key: ".concat(t))}},{key:"setValuesForKeys",value:function(e){}},{key:"validateValueForKey",value:function(e,t){}},{key:"validateValueForKeyPath",value:function(e,t){}},{key:"valueForKey",value:function(e){if("string"!=typeof e)throw new Error("error: valueForKey(key): key should be string");return void 0===this[e]?this.valueForUndefinedKey(e):this[e]}},{key:"valueForKeyPath",value:function(e){if("string"!=typeof e)throw new Error("valueForKeyPath(keyPath): keyPath should be string");var t=e.split("."),n=t.shift(),r=this.valueForKey(n);return 0===t.length?r:null===r?null:r.valueForKeyPath(t.join("."))}},{key:"valueForUndefinedKey",value:function(e){}},{key:"willChangeValuesAtForKey",value:function(e,t,n){}},{key:"willChangeValueForKey",value:function(e){}},{key:"willChangeValueForKeyWithSetMutationUsing",value:function(e,t,n){}},{key:"acceptsPreviewPanelControl",value:function(e){return!1}},{key:"accessibilityActionDescription",value:function(e){return null}},{key:"accessibilityActionNames",value:function(){return null}},{key:"accessibilityArrayAttributeCount",value:function(e){return 0}},{key:"accessibilityArrayAttributeValues",value:function(e,t,n){return null}},{key:"accessibilityAttributeNames",value:function(){return null}},{key:"accessibilityAttributeValue",value:function(e){return null}},{key:"accessibilityAttributeValueForParameter",value:function(e,t){return null}},{key:"accessibilityHitTest",value:function(e){return null}},{key:"accessibilityIndexOfChild",value:function(e){return 0}},{key:"accessibilityIsAttributeSettable",value:function(e){return!1}},{key:"accessibilityIsIgnored",value:function(){return!1}},{key:"accessibilityParameterizedAttributeNames",value:function(){return null}},{key:"accessibilityPerformAction",value:function(e){}},{key:"accessibilitySetOverrideValueForAttribute",value:function(e,t){return!1}},{key:"accessibilitySetValueForAttribute",value:function(e,t){}},{key:"actionProperty",value:function(){return null}},{key:"applicationDelegateHandlesKey",value:function(e,t){return!1}},{key:"authorizationViewCreatedAuthorization",value:function(e){}},{key:"authorizationViewDidAuthorize",value:function(e){}},{key:"authorizationViewDidDeauthorize",value:function(e){}},{key:"authorizationViewDidHide",value:function(e){}},{key:"authorizationViewReleasedAuthorization",value:function(e){}},{key:"authorizationViewShouldDeauthorize",value:function(e){return 0}},{key:"awakeFromNib",value:function(){}},{key:"beginPreviewPanelControl",value:function(e){}},{key:"bindToWithKeyPath",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"candidates",value:function(e){return null}},{key:"certificatePanelShowHelp",value:function(e){return 0}},{key:"changeColor",value:function(e){}},{key:"changeFont",value:function(e){}},{key:"chooseIdentityPanelShowHelp",value:function(e){return 0}},{key:"classForAnnotationClass",value:function(e){return null}},{key:"classForPage",value:function(){return null}},{key:"coerceValueForKey",value:function(e,t){return null}},{key:"commitComposition",value:function(e){}},{key:"commitEditing",value:function(){return!1}},{key:"commitEditingAndReturnError",value:function(){}},{key:"commitEditingWithDelegateDidCommit",value:function(e,t,n){}},{key:"composedString",value:function(e){return null}},{key:"compositionParameterViewDidChangeParameterWithKey",value:function(e,t){}},{key:"compositionParameterViewShouldDisplayParameterWithKeyAttributes",value:function(e,t){arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;return!1}},{key:"compositionPickerViewDidSelect",value:function(e,t){}},{key:"compositionPickerViewDidStartAnimating",value:function(e){}},{key:"compositionPickerViewWillStopAnimating",value:function(e){}},{key:"controlTextDidBeginEditing",value:function(e){}},{key:"controlTextDidChange",value:function(e){}},{key:"controlTextDidEndEditing",value:function(e){}},{key:"didCommandByClient",value:function(e,t){return!1}},{key:"didMatchString",value:function(e){}},{key:"discardEditing",value:function(){}},{key:"documentDidBeginDocumentFind",value:function(e){}},{key:"documentDidBeginPageFind",value:function(e){}},{key:"documentDidEndDocumentFind",value:function(e){}},{key:"documentDidEndPageFind",value:function(e){}},{key:"documentDidFindMatch",value:function(e){}},{key:"documentDidUnlock",value:function(e){}},{key:"doesContain",value:function(e){return!1}},{key:"endPreviewPanelControl",value:function(e){}},{key:"exceptionHandlerShouldHandleMask",value:function(e,t,n){return!1}},{key:"exceptionHandlerShouldLogExceptionMask",value:function(e,t,n){return!1}},{key:"fileTransferServicesAbortCompleteError",value:function(e,t){}},{key:"fileTransferServicesConnectionCompleteError",value:function(e,t){}},{key:"fileTransferServicesCopyRemoteFileCompleteError",value:function(e,t){}},{key:"fileTransferServicesCopyRemoteFileProgressTransferProgress",value:function(e,t){}},{key:"fileTransferServicesCreateFolderCompleteErrorFolder",value:function(e,t,n){}},{key:"fileTransferServicesDisconnectionCompleteError",value:function(e,t){}},{key:"fileTransferServicesFilePreparationCompleteError",value:function(e,t){}},{key:"fileTransferServicesPathChangeCompleteErrorFinalPath",value:function(e,t,n){}},{key:"fileTransferServicesRemoveItemCompleteErrorRemovedItem",value:function(e,t,n){}},{key:"fileTransferServicesRetrieveFolderListingCompleteErrorListing",value:function(e,t,n){}},{key:"fileTransferServicesSendFileCompleteError",value:function(e,t){}},{key:"fileTransferServicesSendFileProgressTransferProgress",value:function(e,t){}},{key:"finalizeForWebScript",value:function(){}},{key:"fontManagerWillIncludeFont",value:function(e,t){return!1}},{key:"handleClient",value:function(e,t){return!1}},{key:"imageBrowserBackgroundWasRightClickedWith",value:function(e,t){}},{key:"imageBrowserCellWasDoubleClickedAt",value:function(e,t){}},{key:"imageBrowserCellWasRightClickedAtWith",value:function(e,t,n){}},{key:"imageBrowserGroupAt",value:function(e,t){return null}},{key:"imageBrowserItemAt",value:function(e,t){return null}},{key:"imageBrowserMoveItemsAtTo",value:function(e,t,n){return!1}},{key:"imageBrowserRemoveItemsAt",value:function(e,t){}},{key:"imageBrowserWriteItemsAtTo",value:function(e,t,n){return 0}},{key:"imageBrowserSelectionDidChange",value:function(e){}},{key:"imageRepresentation",value:function(){return null}},{key:"imageRepresentationType",value:function(){return null}},{key:"imageSubtitle",value:function(){return null}},{key:"imageTitle",value:function(){return null}},{key:"imageUID",value:function(){return null}},{key:"imageVersion",value:function(){return 0}},{key:"indicesOfObjectsByEvaluatingObjectSpecifier",value:function(e){return null}},{key:"infoForBinding",value:function(e){return null}},{key:"inputTextClient",value:function(e,t){return!1}},{key:"inputTextKeyModifiersClient",value:function(e,t,n,r){return!1}},{key:"insertValueAtInPropertyWithKey",value:function(e,t,n){}},{key:"insertValueInPropertyWithKey",value:function(e,t){}},{key:"invokeDefaultMethodWithArguments",value:function(e){return null}},{key:"invokeUndefinedMethodFromWebScriptWithArguments",value:function(e,t){return null}},{key:"isCaseInsensitiveLike",value:function(e){return!1}},{key:"isEqualTo",value:function(e){return!1}},{key:"isGreaterThan",value:function(e){return!1}},{key:"isGreaterThanOrEqualTo",value:function(e){return!1}},{key:"isLessThan",value:function(e){return!1}},{key:"isLessThanOrEqualTo",value:function(e){return!1}},{key:"isLike",value:function(e){return!1}},{key:"isNotEqualTo",value:function(e){return!1}},{key:"layerShouldInheritContentsScaleFrom",value:function(e,t,n){return!1}},{key:"namesOfPromisedFilesDroppedAtDestination",value:function(e){return null}},{key:"numberOfGroupsInImageBrowser",value:function(e){return 0}},{key:"numberOfItemsInImageBrowser",value:function(e){return 0}},{key:"objectDidBeginEditing",value:function(e){}},{key:"objectDidEndEditing",value:function(e){}},{key:"optionDescriptionsForBinding",value:function(e){return null}},{key:"originalString",value:function(e){return null}},{key:"pasteboardProvideDataForType",value:function(e,t){}},{key:"pasteboardChangedOwner",value:function(e){}},{key:"performActionFor",value:function(e,t){}},{key:"prepareForInterfaceBuilder",value:function(){}},{key:"provideImageDataBytesPerRowOriginSizeUserInfo",value:function(e,t,n,r,o,i,a){}},{key:"quartzFilterManagerDidAdd",value:function(e,t){}},{key:"quartzFilterManagerDidModifyFilter",value:function(e,t){}},{key:"quartzFilterManagerDidRemove",value:function(e,t){}},{key:"quartzFilterManagerDidSelect",value:function(e,t){}},{key:"readLinkQualityForDeviceComplete",value:function(e,t,n,r){}},{key:"readRSSIForDeviceComplete",value:function(e,t,n,r){}},{key:"removeValueAtFromPropertyWithKey",value:function(e,t){}},{key:"replaceValueAtInPropertyWithKeyWithValue",value:function(e,t,n){}},{key:"saveOptionsShouldShowUTType",value:function(e,t){return!1}},{key:"scriptingBeginsWith",value:function(e){return!1}},{key:"scriptingContains",value:function(e){return!1}},{key:"scriptingEndsWith",value:function(e){return!1}},{key:"scriptingIsEqualTo",value:function(e){return!1}},{key:"scriptingIsGreaterThan",value:function(e){return!1}},{key:"scriptingIsGreaterThanOrEqualTo",value:function(e){return!1}},{key:"scriptingIsLessThan",value:function(e){return!1}},{key:"scriptingIsLessThanOrEqualTo",value:function(e){return!1}},{key:"shouldEnableActionFor",value:function(e,t){return!1}},{key:"textStorageDidProcessEditing",value:function(e){}},{key:"textStorageWillProcessEditing",value:function(e){}},{key:"titleFor",value:function(e,t){return null}},{key:"unbind",value:function(e){}},{key:"validModesForFontPanel",value:function(e){return 0}},{key:"validateMenuItem",value:function(e){return!1}},{key:"validateToolbarItem",value:function(e){return!1}},{key:"valueAtInPropertyWithKey",value:function(e,t){return null}},{key:"valueClassForBinding",value:function(e){return null}},{key:"valueWithNameInPropertyWithKey",value:function(e,t){return null}},{key:"valueWithUniqueIDInPropertyWithKey",value:function(e,t){return null}},{key:"viewStringForToolTipUserData",value:function(e,t,n,r){return""}},{key:"webPlugInContainerLoadInFrame",value:function(e,t){}},{key:"webPlugInContainerShowStatus",value:function(e){}},{key:"webPlugInDestroy",value:function(){}},{key:"webPlugInInitialize",value:function(){}},{key:"webPlugInMainResourceDidFailWithError",value:function(e){}},{key:"webPlugInMainResourceDidFinishLoading",value:function(){}},{key:"webPlugInMainResourceDidReceive",value:function(e){}},{key:"webPlugInSetIsSelected",value:function(e){}},{key:"webPlugInStart",value:function(){}},{key:"webPlugInStop",value:function(){}},{key:"workflowControllerDidError",value:function(e,t){}},{key:"workflowControllerDidRun",value:function(e,t){}},{key:"workflowControllerWillRun",value:function(e,t){}},{key:"workflowControllerDidStop",value:function(e){}},{key:"workflowControllerWillStop",value:function(e){}},{key:"accessibilityActivate",value:function(){return!1}},{key:"accessibilityAssistiveTechnologyFocusedIdentifiers",value:function(){return null}},{key:"accessibilityDecrement",value:function(){}},{key:"accessibilityElementAt",value:function(e){return null}},{key:"accessibilityElementCount",value:function(){return 0}},{key:"accessibilityElementDidBecomeFocused",value:function(){}},{key:"accessibilityElementDidLoseFocus",value:function(){}},{key:"accessibilityElementIsFocused",value:function(){return!1}},{key:"accessibilityIncrement",value:function(){}},{key:"accessibilityPerformEscape",value:function(){return!1}},{key:"accessibilityPerformMagicTap",value:function(){return!1}},{key:"accessibilityScroll",value:function(e){return!1}},{key:"indexOfAccessibilityElement",value:function(e){return 0}},{key:"_destroy",value:function(){if(this._destroyed)throw new Error("_destroy() called twice");this._destroyed=!0,this._execDestroy()}},{key:"_execDestroy",value:function(){}},{key:"autoContentAccessingProxy",get:function(){return this._autoContentAccessingProxy}},{key:"classForArchiver",get:function(){return this._classForArchiver}},{key:"classForCoder",get:function(){return this._classForCoder}},{key:"classForKeyedArchiver",get:function(){return this._classForKeyedArchiver}},{key:"attributeKeys",get:function(){return this._attributeKeys}},{key:"classDescription",get:function(){return this._classDescription}},{key:"toManyRelationshipKeys",get:function(){return this._toManyRelationshipKeys}},{key:"toOneRelationshipKeys",get:function(){return this._toOneRelationshipKeys}},{key:"classCode",get:function(){return this._classCode}},{key:"className",get:function(){return this.constructor._className}},{key:"hashValue",get:function(){return this._hashValue}},{key:"accessibilityFocusedUIElement",get:function(){return this._accessibilityFocusedUIElement}},{key:"accessibilityNotifiesWhenDestroyed",get:function(){return this._accessibilityNotifiesWhenDestroyed}},{key:"exposedBindings",get:function(){return this._exposedBindings}},{key:"objectForWebScript",get:function(){return this._objectForWebScript}},{key:"objectSpecifier",get:function(){return this._objectSpecifier}},{key:"webFrame",get:function(){return this._webFrame}},{key:"webPlugInContainerSelectionColor",get:function(){return this._webPlugInContainerSelectionColor}},{key:"isSelectable",get:function(){return this._isSelectable}}],[{key:"superclass",value:function(){var e=Object.getPrototypeOf(this);return e===Object.getPrototypeOf(Object)?null:e}},{key:"isSubclassOf",value:function(e){if(this.className===e.className)return!0;var t=this.superclass();return null!==t&&(t.className===e.className||!!t.isSubclassOf(e))}},{key:"instancesRespondTo",value:function(e){return"function"==typeof this.prototype[e]}},{key:"conformsTo",value:function(e){return!1}},{key:"instanceMethodFor",value:function(e){return null}},{key:"description",value:function(){return this.className}},{key:"cancelPreviousPerformRequestsWithTarget",value:function(e){}},{key:"cancelPreviousPerformRequestsWithTargetSelectorObject",value:function(e,t,n){}},{key:"resolveClassMethod",value:function(e){return!1}},{key:"resolveInstanceMethod",value:function(e){return!1}},{key:"classFallbacksForKeyedArchiver",value:function(){return null}},{key:"classForKeyedUnarchiver",value:function(){return null}},{key:"setVersion",value:function(e){}},{key:"version",value:function(){return 0}},{key:"automaticallyNotifiesObserversForKey",value:function(e){return!1}},{key:"debugDescription",value:function(){return""}},{key:"hash",value:function(){return 0}},{key:"keyPathsForValuesAffectingValueForKey",value:function(e){return null}},{key:"defaultPlaceholderForMarkerWithBinding",value:function(e,t){return null}},{key:"exposeBinding",value:function(e){}},{key:"isKeyExcludedFromWebScript",value:function(e){return!1}},{key:"isSelectorExcludedFromWebScript",value:function(e){return!1}},{key:"setDefaultPlaceholderForMarkerWithBinding",value:function(e,t,n){}},{key:"webScriptNameForKey",value:function(e){return null}},{key:"webScriptNameFor",value:function(e){return null}},{key:"initWithCoder",value:function(e){for(var t={},n=Object.keys(e._refObj),r=0;r<n.length;r++){var o=n[r];if("$"!==o.charAt(0))if(void 0===this._propTypes[o]){if(!this._propTypes.$unknownKey||null===this._propTypes.$unknownKey(o))throw console.error("".concat(this.className,": property ").concat(o," not registered")),new Error("".concat(this.className,": property ").concat(o," not registered"));t[o]=this._propTypes.$unknownKey(o)}else t[o]=this._propTypes[o]}var i=this._loadProperties(e,t),a=i.names,u=i.values,s=null;return s="function"==typeof this._propTypes.$constructor?this._propTypes.$constructor(a,u,e):new this,this._setProperties(s,a,u,e),s}},{key:"_loadProperties",value:function(t,n){for(var o={},i={},a=Object.keys(n),u=0;u<a.length;u++){var s=a[u];if(t.containsValueForKey(s)){var l=n[s],c="",f=s;"string"==typeof l?c=l:Array.isArray(l)&&(c=l[0],l.length>=2&&(f=l[1]));var h=null;switch(c){case"boolean":h=t.decodeBoolForKey(s);break;case"bytes":h=t.decodeBytesForKeyReturnedLength(s,null);break;case"double":h=t.decodeDoubleForKey(s);break;case"float":h=t.decodeFloatForKey(s);break;case"integer":h=t.decodeCIntForKey(s);break;case"int32":h=t.decodeInt32ForKey(s);break;case"int64":h=t.decodeInt64ForKey(s);break;case"point":h=t.decodePointForKey(s);break;case"rect":h=t.decodeRectForKey(s);break;case"size":h=t.decodeSizeForKey(s);break;case"plist":h=t.decodePropertyListForKey(s);break;case"string":if("string"!=typeof(h=t.decodeObjectForKey(s)))throw new Error("".concat(s,": value is not String type"));break;default:var y=r.a.get(c);if(void 0===y)throw new Error("unknown class name: ".concat(c));if(t._refObj[s]instanceof e){if(!((h=t.decodeObjectOfTypeForKey(y,s))instanceof y))throw new Error("".concat(s,": value is not an instance of ").concat(c))}else if("$null"===(h=t.decodeObjectForKey(s)))h=null;else if(h instanceof Promise);else if(!(h instanceof y)){if(["NSObject","NSData","NSMutableData","NSArray","NSMutableArray","NSDictionary","NSMutableDictionary","NSColor","NSURL"].indexOf(y.className)<0)throw new Error("".concat(s,": value is not an instance of ").concat(c))}}i[s]=h,o[s]=f}else console.log("!coder.containsValueForKey ".concat(s))}return{names:o,values:i}}},{key:"_setProperties",value:function(e,t,n,r){for(var o=Object.keys(n),i=0;i<o.length;i++){var a=o[i];this._setProperty(e,t[a],n[a],a,r)}}},{key:"_setProperty",value:function(e,t,n,r,o){var i=this;n instanceof Promise?n.then(function(n){i._setProperty(e,t,n,r,o)}):"function"==typeof t?t(e,n,r,o):null!==t&&(e[t]=n)}},{key:"className",get:function(){return this.prototype.constructor._className}},{key:"accessInstanceVariablesDirectly",get:function(){return!0}},{key:"supportsSecureCoding",get:function(){return!0}}]),t}()}).call(this,n(16).Buffer)},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return d});var r=n(2),o=n(1),i=n(8),a=n(12),u=n(6),s=n(4);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m={boneIndices:"kGeometrySourceSemanticBoneIndices",boneWeights:"kGeometrySourceSemanticBoneWeights",color:"kGeometrySourceSemanticColor",edgeCrease:"kGeometrySourceSemanticEdgeCrease",normal:"kGeometrySourceSemanticNormal",tangent:"kGeometrySourceSemanticTangent",texcoord:"kGeometrySourceSemanticTexcoord",vertex:"kGeometrySourceSemanticVertex",vertexCrease:"kGeometrySourceSemanticVertexCrease"},d=function(t){function n(t,r,o,i,a,u,s,l){var h;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(h=c(this,f(n).call(this)))._data=t,h._semantic=r,h._vectorCount=o,h._usesFloatComponents=i,h._componentsPerVector=a,h._bytesPerComponent=u,h._dataOffset=s,h._dataStride=l,t instanceof e){var y=null;if(i)switch(u){case 4:y=function(e){return t.readFloatLE(e)};break;case 8:y=function(e){return t.readDoubleLE(e)};break;case 1:y=function(e){return t.readIntLE(e,1)/255};break;default:throw new Error("unknown float data size: ".concat(u))}else y=function(e){return t.readIntLE(e,u)};for(var p=[],m=t.length/u,d=0,_=0;_<m;_++)p.push(y(d)),d+=u;h._data=p}return h._buffer=null,h}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,r["a"]),y(n,null,[{key:"_propTypes",get:function(){return{$constructor:function(e,t){return new n(t.data,t.semantic,t.vectorCount,t.floatComponents,t.componentsPerVector,t.bytesPerComponent,t.dataOffset,t.dataStride)},data:["NSMutableData",null],semantic:["string",null],vectorCount:["integer",null],floatComponents:["boolean",null],componentsPerVector:["integer",null],bytesPerComponent:["integer",null],dataOffset:["integer",null],dataStride:["integer",null],mkSemantic:["boolean",null]}}}]),y(n,[{key:"_createBuffer",value:function(e){var t=e;return this._buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._buffer),t.bufferData(t.ARRAY_BUFFER,this._glData,t.STATIC_DRAW),this._buffer}},{key:"_hasTypedArrayData",value:function(){if(this._usesFloatComponents){if(4===this._bytesPerComponent)return this._data instanceof Float32Array;if(8===this._bytesPerComponent)return this._data instanceof Float64Array}else{if(1===this._bytesPerComponent)return this._data instanceof Uint8Array;if(2===this._bytesPerComponent)return this._data instanceof Uint16Array;if(4===this._bytesPerComponent)return this._data instanceof Uint32Array}return!1}},{key:"_vectorAt",value:function(e){if(e<0||e>=this.vectorCount)throw new Error("index out of range: ".concat(e," (0 - ").concat(this.vectorCount-1,")"));for(var t=e*(this._dataStride/this._bytesPerComponent)+this._dataOffset/this._bytesPerComponent,n=[],r=0;r<this._componentsPerVector;r++)n.push(this._data[t+r]);return n}},{key:"_scnVectorAt",value:function(e){var t=this._vectorAt(e);return 2===t.length?new u.a(t[0],t[1]):3===t.length?new o.a(t[0],t[1],t[2]):4===t.length?new i.a(t[0],t[1],t[2],t[3]):t}},{key:"_setVectorAt",value:function(e,t){if(t<0||t>=this.vectorCount)throw new Error("index out of range: ".concat(t," (0 - ").concat(this.vectorCount-1,")"));var n=e;if(Object(s.a)(e,o.a)?n=[e.x,e.y,e.z]:Object(s.a)(e,i.a)&&(n=[e.x,e.y,e.z,e.w]),n.length!==this._componentsPerVector)throw new Error("vector size inconsistent: ".concat(n.length," != ").concat(this._componentsPerVector));for(var r=t*(this._dataStride/this._bytesPerComponent)+this._dataOffset/this._bytesPerComponent,a=0;a<this._componentsPerVector;a++)this._data[r+a]=n[a]}},{key:"_createBoundingBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e||Object(a.a)(0,0,0),n=new o.a(1/0,1/0,1/0),r=new o.a(-1/0,-1/0,-1/0);if(3!==this._componentsPerVector)throw new Error("componentsPerVector !== 3");for(var i=this._dataStride/this._bytesPerComponent,u=this._dataOffset/this._bytesPerComponent,s=this._vectorCount,l=0;l<s;l++){var c=new o.a(this._data[u+0],this._data[u+1],this._data[u+2]).transform(t);c.x<n.x&&(n.x=c.x),c.x>r.x&&(r.x=c.x),c.y<n.y&&(n.y=c.y),c.y>r.y&&(r.y=c.y),c.z<n.z&&(n.z=c.z),c.z>r.z&&(r.z=c.z),u+=i}return{min:n,max:r}}},{key:"fill",value:function(e){for(var t=this._dataOffset/this._bytesPerComponent,n=this._dataStride/this._bytesPerComponent,r=0;r<this._vectorCount;r++){for(var o=0;o<this._componentsPerVector;o++)this._data[t+o]=e;t+=n}}},{key:"copy",value:function(){return new n(this._data.slice(0),this._semantic,this._vectorCount,this._usesFloatComponents,this._componentsPerVector,this._bytesPerComponent,this._dataOffset,this._dataStride)}},{key:"data",get:function(){return this._data.slice(0)}},{key:"semantic",get:function(){return this._semantic}},{key:"vectorCount",get:function(){return this._vectorCount}},{key:"usesFloatComponents",get:function(){return this._usesFloatComponents}},{key:"componentsPerVector",get:function(){return this._componentsPerVector}},{key:"bytesPerComponent",get:function(){return this._bytesPerComponent}},{key:"dataOffset",get:function(){return this._dataOffset}},{key:"dataStride",get:function(){return this._dataStride}}],[{key:"geometrySourceWithDataSemanticVectorCountFloatComponentsComponentsPerVectorBytesPerComponentDataOffsetDataStride",value:function(e,t,r,o,i,a,u,s){return new n(e,t,r,o,i,a,u,s)}},{key:"geometrySourceWithVerticesCount",value:function(e,t){for(var r=[],o=0;o<t;o++)r.push(e[o].x,e[o].y,e[o].z);return new n(r,n.Semantic.vertex,t,!0,3,4,0,12)}},{key:"geometrySourceWithTextureCoordinatesCount",value:function(e,t){for(var r=[],o=0;o<t;o++)r.push(e[o].x,e[o].y);return new n(r,n.Semantic.texcoord,t,!0,2,4,0,8)}},{key:"geometrySourceWithNormalsCount",value:function(e,t){for(var r=[],o=0;o<t;o++)r.push(e[o].x,e[o].y,e[o].z);return new n(r,n.Semantic.normal,t,!0,3,4,0,12)}},{key:"initBufferDataOffsetDataStride",value:function(e,t,n,r,o,i){}},{key:"Semantic",get:function(){return m}}]),n}()}).call(this,n(16).Buffer)},function(e,t,n){"use strict";t.a=function(e,t){return e&&e.isInstanceOf&&e.isInstanceOf(t)}},function(e,t,n){"use strict";t.a={triangles:0,triangleStrip:1,line:2,point:3,polygon:4}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return o});var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n}var t,n,o;return t=e,o=[{key:"pointWithDictionaryRepresentation",value:function(t){return new e(t.get("x"),t.get("y"))}},{key:"zero",get:function(){return new e(0,0)}}],(n=[{key:"applying",value:function(e){return null}},{key:"equalTo",value:function(e){return Math.abs(this.x-e.x)<1e-5&&Math.abs(this.y-e.y)<1e-5}},{key:"copy",value:function(){return new e(this.x,this.y)}},{key:"zero",value:function(){return new e(0,0)}},{key:"add",value:function(t){var n=new e;return n.x=this.x+t.x,n.y=this.y+t.y,n}},{key:"sub",value:function(t){var n=new e;return n.x=this.x-t.x,n.y=this.y-t.y,n}},{key:"mul",value:function(t){var n=new e;return n.x=this.x*t,n.y=this.y*t,n}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"lerp",value:function(t,n){var r=new e;return r.x=this.x+n*(t.x-this.x),r.y=this.y+n*(t.y-this.y),r}},{key:"normalize",value:function(){var t=this.length(),n=new e;if(0===t)return n;var r=1/t;return n.x=this.x*r,n.y=this.y*r,n}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"floatArray",value:function(){return[this.x,this.y]}},{key:"float32Array",value:function(){return new Float32Array([this.x,this.y])}},{key:"dictionaryRepresentation",get:function(){var e=new Map;return e.set("x",this.x),e.set("y",this.y),e}},{key:"debugDescription",get:function(){return"{x: ".concat(this.x,", y: ").concat(this.y,"}")}},{key:"customMirror",get:function(){return null}},{key:"customPlaygroundQuickLook",get:function(){return null}}])&&r(t.prototype,n),o&&r(t,o),e}()},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",function(){return i});var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n}return o(e,null,[{key:"_initWithData",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];throw new Error("not implemented")}}]),o(e,[{key:"applying",value:function(e){return null}},{key:"equalTo",value:function(e){return Math.abs(this.width-e.width)<1e-5&&Math.abs(this.height-e.height)<1e-5}},{key:"zero",value:function(){return new e(0,0)}},{key:"add",value:function(t){return new e(this.width+t.width,this.height+t.height)}},{key:"sub",value:function(t){return new e(this.width-t.width,this.height-t.height)}},{key:"lerp",value:function(t,n){return new e(this.width+n*(t.width-this.width),this.height+n*(t.height-this.height))}},{key:"copy",value:function(){return new e(this.width,this.height)}},{key:"dictionaryRepresentation",get:function(){var e=new Map;return e.set("width",this.width),e.set("height",this.height),e}},{key:"debugDescription",get:function(){return"{width: ".concat(this.width,", height: ").concat(this.height,"}")}},{key:"customMirror",get:function(){return null}},{key:"customPlaygroundQuickLook",get:function(){return null}}],[{key:"sizeWithDictionaryRepresentation",value:function(t){return new e(t.get("width"),t.get("height"))}},{key:"zero",get:function(){return new e(0,0)}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(9),o=n(1);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.z=r,this.w=o}var t,n,a;return t=e,a=[{key:"_initWithData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new e;return r?(o.x=t.readFloatBE(n+0),o.y=t.readFloatBE(n+4),o.z=t.readFloatBE(n+8),o.w=t.readFloatBE(n+12)):(o.x=t.readFloatLE(n+0),o.y=t.readFloatLE(n+4),o.z=t.readFloatLE(n+8),o.w=t.readFloatLE(n+12)),o}}],(n=[{key:"_copy",value:function(){return new e(this.x,this.y,this.z,this.w)}},{key:"_copyFrom",value:function(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.z}},{key:"zero",value:function(){return new e}},{key:"add",value:function(t){var n=new e;return n.x=this.x+t.x,n.y=this.y+t.y,n.z=this.z+t.z,n.w=this.w+t.w,n}},{key:"sub",value:function(t){var n=new e;return n.x=this.x-t.x,n.y=this.y-t.y,n.z=this.z-t.z,n.w=this.w-t.w,n}},{key:"mul",value:function(t){var n=new e;return n.x=this.x*t,n.y=this.y*t,n.z=this.z*t,n.w=this.w*t,n}},{key:"mulv",value:function(t){var n=new e;return n.x=this.x*t.x,n.y=this.y*t.y,n.z=this.z*t.z,n.z=this.w*t.w,n}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"cross",value:function(t){var n=new e;return n.x=this.w*t.x+this.x*t.w+this.y*t.z-this.z*t.y,n.y=this.w*t.y-this.x*t.z+this.y*t.w+this.z*t.x,n.z=this.w*t.z+this.x*t.y-this.y*t.x+this.z*t.w,n.w=this.w*t.w-this.x*t.x-this.y*t.y-this.z*t.z,n}},{key:"lerp",value:function(t,n){var r=new e;return r.x=this.x+n*(t.x-this.x),r.y=this.y+n*(t.y-this.y),r.z=this.z+n*(t.z-this.z),r.w=this.w+n*(t.w-this.w),r}},{key:"slerp",value:function(t,n){var r=new e;return this.dot(t)<0?(r.x=this.x-(this.x+t.x)*n,r.y=this.y-(this.y+t.y)*n,r.z=this.z-(this.z+t.z)*n,r.w=this.w-(this.w+t.w)*n):(r.x=this.x+(t.x-this.x)*n,r.y=this.y+(t.y-this.y)*n,r.z=this.z+(t.z-this.z)*n,r.w=this.w+(t.w-this.w)*n),r.normalize()}},{key:"normalize",value:function(){var t=new e,n=1/this.length();return t.x=this.x*n,t.y=this.y*n,t.z=this.z*n,t.w=this.w*n,t}},{key:"length2",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"transform",value:function(t){var n=new e;return n.x=this.x*t.m11+this.y*t.m21+this.z*t.m31+this.w*t.m41,n.y=this.x*t.m12+this.y*t.m22+this.z*t.m32+this.w*t.m42,n.z=this.x*t.m13+this.y*t.m23+this.z*t.m33+this.w*t.m43,n.w=this.x*t.m14+this.y*t.m24+this.z*t.m34+this.w*t.m44,n}},{key:"ln",value:function(){var t=new e,n=this.normalize(),r=Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z);if(0===r)return t.x=0,t.y=0,t.z=0,t.w=0,t;var o=Math.atan2(r,n.w)/r;return t.x=o*n.x,t.y=o*n.y,t.z=o*n.z,t.w=0,t}},{key:"exp",value:function(){var t=new e,n=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(n>0){var r=Math.sin(n);t.x=r*this.x/n,t.y=r*this.y/n,t.z=r*this.z/n,t.w=Math.cos(n)}else t.x=0,t.y=0,t.z=0,t.w=1;return t}},{key:"rotMatrix",value:function(){var e=new r.a,t=this.x*this.x*2,n=this.y*this.y*2,o=this.z*this.z*2,i=this.x*this.y*2,a=this.y*this.z*2,u=this.z*this.x*2,s=this.x*this.w*2,l=this.y*this.w*2,c=this.z*this.w*2;return e.m11=1-n-o,e.m12=i+c,e.m13=u-l,e.m14=0,e.m21=i-c,e.m22=1-o-t,e.m23=a+s,e.m24=0,e.m31=u+l,e.m32=a-s,e.m33=1-t-n,e.m34=0,e.m41=0,e.m42=0,e.m43=0,e.m44=1,e}},{key:"rotationToQuat",value:function(){var t=new e;if(0===this.x&&0===this.y&&0===this.z)t.x=0,t.y=0,t.z=0,t.w=1;else{var n=1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),r=Math.cos(.5*this.w),o=Math.sin(.5*this.w)*n;t.x=this.x*o,t.y=this.y*o,t.z=this.z*o,t.w=r}return t}},{key:"quatToRotation",value:function(){var t=new e;if(0===this.x&&0===this.y&&0===this.z)t.x=0,t.y=0,t.z=0,Math.abs(this.w)>1?t.w=0:t.w=2*Math.acos(this.w);else{var n=this.normalize(),r=1/Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z);t.x=n.x*r,t.y=n.y*r,t.z=n.z*r;var o=Math.acos(n.w);isNaN(o)?t.w=0:t.w=2*o}return t}},{key:"rotationToEulerAngles",value:function(){var e=new o.a,t=Math.sin(this.w),n=Math.cos(this.w),r=1-n,i=this.x*this.x+this.y*this.y+this.z*this.z;if(0===i)return e;var a=1/Math.sqrt(i),u=this.x*a,s=this.y*a,l=this.z*a,c=s*t-u*l*r;if(c>.999999)e.x=0,e.y=.5*-Math.PI,e.z=-2*Math.atan2(l*Math.sin(.5*this.w),Math.cos(.5*this.w));else if(c<-.999999)e.x=0,e.y=.5*Math.PI,e.z=2*Math.atan2(l*Math.sin(.5*this.w),Math.cos(.5*this.w));else{var f=u*t+s*l*r,h=n+l*l*r,y=l*t+u*s*r,p=n+u*u*r;e.x=Math.atan2(f,h),e.y=Math.asin(c),e.z=Math.atan2(y,p)}return e}},{key:"quatToEulerAngles",value:function(){return this.quatToRotation().rotationToEulerAngles()}},{key:"floatArray",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"float32Array",value:function(){return new Float32Array([this.x,this.y,this.z,this.w])}},{key:"_createBtVector4",value:function(){}},{key:"_createBtQuaternion",value:function(){}},{key:"angle",get:function(){return this.quatToRotation().w}}])&&i(t.prototype,n),a&&i(t,a),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(1),o=n(8),i=n(4);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.m11=0,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=0,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=0,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=0,Object(i.a)(t,e)?(this.m11=t.m11,this.m12=t.m12,this.m13=t.m13,this.m14=t.m14,this.m21=t.m21,this.m22=t.m22,this.m23=t.m23,this.m24=t.m24,this.m31=t.m31,this.m32=t.m32,this.m33=t.m33,this.m34=t.m34,this.m41=t.m41,this.m42=t.m42,this.m43=t.m43,this.m44=t.m44):arguments.length>=16?(this.m11=arguments[0],this.m12=arguments[1],this.m13=arguments[2],this.m14=arguments[3],this.m21=arguments[4],this.m22=arguments[5],this.m23=arguments[6],this.m24=arguments[7],this.m31=arguments[8],this.m32=arguments[9],this.m33=arguments[10],this.m34=arguments[11],this.m41=arguments[12],this.m42=arguments[13],this.m43=arguments[14],this.m44=arguments[15]):null!==t&&(this.m11=t[0][0],this.m12=t[0][1],this.m13=t[0][2],this.m14=t[0][3],this.m21=t[1][0],this.m22=t[1][1],this.m23=t[1][2],this.m24=t[1][3],this.m31=t[2][0],this.m32=t[2][1],this.m33=t[2][2],this.m34=t[2][3],this.m41=t[3][0],this.m42=t[3][1],this.m43=t[3][2],this.m44=t[3][3])}var t,n,u;return t=e,u=[{key:"_initWithData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new e;return r?(o.m11=t.readFloatBE(n+0),o.m12=t.readFloatBE(n+4),o.m13=t.readFloatBE(n+8),o.m14=t.readFloatBE(n+12),o.m21=t.readFloatBE(n+16),o.m22=t.readFloatBE(n+20),o.m23=t.readFloatBE(n+24),o.m24=t.readFloatBE(n+28),o.m31=t.readFloatBE(n+32),o.m32=t.readFloatBE(n+36),o.m33=t.readFloatBE(n+40),o.m34=t.readFloatBE(n+44),o.m41=t.readFloatBE(n+48),o.m42=t.readFloatBE(n+52),o.m43=t.readFloatBE(n+56),o.m44=t.readFloatBE(n+60)):(o.m11=t.readFloatLE(n+0),o.m12=t.readFloatLE(n+4),o.m13=t.readFloatLE(n+8),o.m14=t.readFloatLE(n+12),o.m21=t.readFloatLE(n+16),o.m22=t.readFloatLE(n+20),o.m23=t.readFloatLE(n+24),o.m24=t.readFloatLE(n+28),o.m31=t.readFloatLE(n+32),o.m32=t.readFloatLE(n+36),o.m33=t.readFloatLE(n+40),o.m34=t.readFloatLE(n+44),o.m41=t.readFloatLE(n+48),o.m42=t.readFloatLE(n+52),o.m43=t.readFloatLE(n+56),o.m44=t.readFloatLE(n+60)),o}},{key:"matrixWithScale",value:function(t,n,o){var a=t,u=n,s=o;if(Object(i.a)(t,r.a)){var l=t;a=l.x,u=l.y,s=l.z}var c=e._identity();return c.m11=a,c.m22=u,c.m33=s,c}},{key:"matrixWithRotation",value:function(t,n,a,u){if(Object(i.a)(t,o.a)){var s=t;t=s.x,n=s.y,a=s.z,u=s.w}var l=Math.cos(u),c=Math.sin(u),f=new r.a(t,n,a).normalize(),h=e._identity(),y=f.x,p=f.y,m=f.z;return h.m11=y*y*(1-l)+l,h.m12=p*y*(1-l)+m*c,h.m13=m*y*(1-l)-p*c,h.m14=0,h.m21=y*p*(1-l)-m*c,h.m22=p*p*(1-l)+l,h.m23=m*p*(1-l)+y*c,h.m24=0,h.m31=y*m*(1-l)+p*c,h.m32=p*m*(1-l)-y*c,h.m33=m*m*(1-l)+l,h.m34=0,h.m41=0,h.m42=0,h.m43=0,h.m44=1,h}},{key:"matrixWithOrientation",value:function(t){return e.matrixWithRotation(t.quatToRotation())}},{key:"matrixWithTranslation",value:function(t,n,o){var a=t,u=n,s=o;if(Object(i.a)(t,r.a)){var l=t;a=l.x,u=l.y,s=l.z}var c=e._identity();return c.m41=a,c.m42=u,c.m43=s,c}},{key:"_identity",value:function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}}],(n=[{key:"_copy",value:function(){return new e(this)}},{key:"add",value:function(t){var n=new e;return n.m11=this.m11+t.m11,n.m12=this.m12+t.m12,n.m13=this.m13+t.m13,n.m14=this.m14+t.m14,n.m21=this.m21+t.m21,n.m22=this.m22+t.m22,n.m23=this.m23+t.m23,n.m24=this.m24+t.m24,n.m31=this.m31+t.m31,n.m32=this.m32+t.m32,n.m33=this.m33+t.m33,n.m34=this.m34+t.m34,n.m41=this.m41+t.m41,n.m42=this.m42+t.m42,n.m43=this.m43+t.m43,n.m44=this.m44+t.m44,n}},{key:"mul",value:function(t){var n=new e;return n.m11=this.m11*t,n.m12=this.mj2*t,n.m13=this.m13*t,n.m14=this.m14*t,n.m21=this.m21*t,n.m22=this.m22*t,n.m23=this.m23*t,n.m24=this.m24*t,n.m31=this.m31*t,n.m32=this.m32*t,n.m33=this.m33*t,n.m34=this.m34*t,n.m41=this.m41*t,n.m42=this.m42*t,n.m43=this.m43*t,n.m44=this.m44*t,n}},{key:"mult",value:function(t){var n=new e;return n.m11=this.m11*t.m11+this.m12*t.m21+this.m13*t.m31+this.m14*t.m41,n.m12=this.m11*t.m12+this.m12*t.m22+this.m13*t.m32+this.m14*t.m42,n.m13=this.m11*t.m13+this.m12*t.m23+this.m13*t.m33+this.m14*t.m43,n.m14=this.m11*t.m14+this.m12*t.m24+this.m13*t.m34+this.m14*t.m44,n.m21=this.m21*t.m11+this.m22*t.m21+this.m23*t.m31+this.m24*t.m41,n.m22=this.m21*t.m12+this.m22*t.m22+this.m23*t.m32+this.m24*t.m42,n.m23=this.m21*t.m13+this.m22*t.m23+this.m23*t.m33+this.m24*t.m43,n.m24=this.m21*t.m14+this.m22*t.m24+this.m23*t.m34+this.m24*t.m44,n.m31=this.m31*t.m11+this.m32*t.m21+this.m33*t.m31+this.m34*t.m41,n.m32=this.m31*t.m12+this.m32*t.m22+this.m33*t.m32+this.m34*t.m42,n.m33=this.m31*t.m13+this.m32*t.m23+this.m33*t.m33+this.m34*t.m43,n.m34=this.m31*t.m14+this.m32*t.m24+this.m33*t.m34+this.m34*t.m44,n.m41=this.m41*t.m11+this.m42*t.m21+this.m43*t.m31+this.m44*t.m41,n.m42=this.m41*t.m12+this.m42*t.m22+this.m43*t.m32+this.m44*t.m42,n.m43=this.m41*t.m13+this.m42*t.m23+this.m43*t.m33+this.m44*t.m43,n.m44=this.m41*t.m14+this.m42*t.m24+this.m43*t.m34+this.m44*t.m44,n}},{key:"lerp",value:function(t,n){var r=new e;return r.m11=this.m11+n*(this.m11-t.m11),r.m12=this.m12+n*(this.m12-t.m12),r.m13=this.m13+n*(this.m13-t.m13),r.m14=this.m14+n*(this.m14-t.m14),r.m21=this.m21+n*(this.m21-t.m21),r.m22=this.m22+n*(this.m22-t.m22),r.m23=this.m23+n*(this.m23-t.m23),r.m24=this.m24+n*(this.m24-t.m24),r.m31=this.m31+n*(this.m31-t.m31),r.m32=this.m32+n*(this.m32-t.m32),r.m33=this.m33+n*(this.m33-t.m33),r.m34=this.m34+n*(this.m34-t.m34),r.m41=this.m41+n*(this.m41-t.m41),r.m42=this.m42+n*(this.m42-t.m42),r.m43=this.m43+n*(this.m43-t.m43),r.m44=this.m44+n*(this.m44-t.m44),r}},{key:"quaternion",value:function(){var e=new o.a;return e.x=this.m32-this.m23,e.y=this.m13-this.m31,e.z=this.m21-this.m12,e.w=Math.acos(.5*(this.m11+this.m22+this.m33-1)),e}},{key:"invert",value:function(){var t=e._identity(),n=new e(this),r=0,o=Math.abs(n.m11),i=Math.abs(n.m21),a=Math.abs(n.m31),u=Math.abs(n.m41),s=o>i?o:i;return s<a&&(s=a),s<u?(r=1/n.m41,o=n.m11,i=n.m12,a=n.m13,u=n.m14,n.m12=n.m42*r,n.m13=n.m43*r,n.m14=n.m44*r,n.m41=o,n.m42=i,n.m43=a,n.m44=u,t.m11=0,t.m14=r,t.m41=1,t.m44=0):s===o?(r=1/n.m11,n.m12*=r,n.m13*=r,n.m14*=r,t.m11=r):s===i?(r=1/n.m21,o=n.m11,i=n.m12,a=n.m13,u=n.m14,n.m12=n.m22*r,n.m13=n.m23*r,n.m14=n.m24*r,n.m21=o,n.m22=i,n.m23=a,n.m24=u,t.m11=0,t.m12=r,t.m21=1,t.m22=0):(r=1/n.m31,o=n.m11,i=n.m12,a=n.m13,u=n.m14,n.m12=n.m32*r,n.m13=n.m33*r,n.m14=n.m34*r,n.m31=o,n.m32=i,n.m33=a,n.m34=u,t.m11=0,t.m13=r,t.m31=1,t.m33=0),r=n.m21,n.m22-=n.m12*r,n.m23-=n.m13*r,n.m24-=n.m14*r,t.m21-=t.m11*r,t.m22-=t.m12*r,t.m23-=t.m13*r,t.m24-=t.m14*r,r=n.m31,n.m32-=n.m12*r,n.m33-=n.m13*r,n.m34-=n.m14*r,t.m31-=t.m11*r,t.m32-=t.m12*r,t.m33-=t.m13*r,t.m34-=t.m14*r,r=n.m41,n.m42-=n.m12*r,n.m43-=n.m13*r,n.m44-=n.m14*r,t.m41-=t.m11*r,t.m42-=t.m12*r,t.m43-=t.m13*r,t.m44-=t.m14*r,(s=(i=Math.abs(n.m22))>(a=Math.abs(n.m32))?i:a)<(u=Math.abs(n.m42))?(r=1/n.m42,i=n.m22,a=n.m23,u=n.m24,n.m23=n.m43*r,n.m24=n.m44*r,n.m42=i,n.m43=a,n.m44=u,o=t.m21,i=t.m22,a=t.m23,u=t.m24,t.m21=t.m41*r,t.m22=t.m42*r,t.m23=t.m43*r,t.m24=t.m44*r,t.m41=o,t.m42=i,t.m43=a,t.m44=u):i>a?(r=1/n.m22,n.m23*=r,n.m24*=r,t.m21*=r,t.m22*=r,t.m23*=r,t.m24*=r):(r=1/n.m32,i=n.m22,a=n.m23,u=n.m24,n.m23=n.m33*r,n.m24=n.m34*r,n.m32=i,n.m33=a,n.m34=u,o=t.m21,i=t.m22,a=t.m23,u=t.m24,t.m21=t.m31*r,t.m22=t.m32*r,t.m23=t.m33*r,t.m24=t.m34*r,t.m31=o,t.m32=i,t.m33=a,t.m34=u),r=n.m12,n.m13-=n.m23*r,n.m14-=n.m24*r,t.m11-=t.m21*r,t.m12-=t.m22*r,t.m13-=t.m23*r,t.m14-=t.m24*r,r=n.m32,n.m33-=n.m23*r,n.m34-=n.m24*r,t.m31-=t.m21*r,t.m32-=t.m22*r,t.m33-=t.m23*r,t.m34-=t.m24*r,r=n.m42,n.m43-=n.m23*r,n.m44-=n.m24*r,t.m41-=t.m21*r,t.m42-=t.m22*r,t.m43-=t.m23*r,t.m44-=t.m24*r,Math.abs(n.m33)>Math.abs(n.m43)?(r=1/n.m33,n.m34*=r,t.m31*=r,t.m32*=r,t.m33*=r,t.m34*=r):(r=1/n.m43,a=n.m33,u=n.m34,n.m34=n.m44*r,n.m43=a,n.m44=u,o=t.m31,i=t.m32,a=t.m33,u=t.m34,t.m31=t.m41*r,t.m32=t.m42*r,t.m33=t.m43*r,t.m34=t.m44*r,t.m41=o,t.m42=i,t.m43=a,t.m44=u),r=n.m13,n.m14-=n.m34*r,t.m11-=t.m31*r,t.m12-=t.m32*r,t.m13-=t.m33*r,t.m14-=t.m34*r,r=n.m23,n.m24-=n.m34*r,t.m21-=t.m31*r,t.m22-=t.m32*r,t.m23-=t.m33*r,t.m24-=t.m34*r,r=n.m43,n.m44-=n.m34*r,t.m41-=t.m31*r,t.m42-=t.m32*r,t.m43-=t.m33*r,t.m44-=t.m34*r,r=1/n.m44,t.m41*=r,t.m42*=r,t.m43*=r,t.m44*=r,r=n.m14,t.m11-=t.m41*r,t.m12-=t.m42*r,t.m13-=t.m43*r,t.m14-=t.m44*r,r=n.m24,t.m21-=t.m41*r,t.m22-=t.m42*r,t.m23-=t.m43*r,t.m24-=t.m44*r,r=n.m34,t.m31-=t.m41*r,t.m32-=t.m42*r,t.m33-=t.m43*r,t.m34-=t.m44*r,t}},{key:"transpose",value:function(){var t=new e;return t.m11=this.m11,t.m12=this.m21,t.m13=this.m31,t.m14=this.m41,t.m21=this.m12,t.m22=this.m22,t.m23=this.m32,t.m24=this.m42,t.m31=this.m13,t.m32=this.m23,t.m33=this.m33,t.m34=this.m43,t.m41=this.m14,t.m42=this.m24,t.m43=this.m34,t.m44=this.m44,t}},{key:"scale",value:function(t,n,r){var o=e.matrixWithScale(t,n,r);return this.mult(o)}},{key:"rotation",value:function(t,n,r,a){if(Object(i.a)(t,o.a)){var u=t;t=u.x,n=u.y,r=u.z,a=u.w}var s=e.matrixWithRotation(t,n,r,a);return this.mult(s)}},{key:"translation",value:function(t,n,r){var o=e.matrixWithTranslation(t,n,r);return this.mult(o)}},{key:"equalTo",value:function(t){return!!Object(i.a)(t,e)&&(Math.abs(this.m11-t.m11)<1e-7&&Math.abs(this.m12-t.m12)<1e-7&&Math.abs(this.m13-t.m13)<1e-7&&Math.abs(this.m14-t.m14)<1e-7&&Math.abs(this.m21-t.m21)<1e-7&&Math.abs(this.m22-t.m22)<1e-7&&Math.abs(this.m23-t.m23)<1e-7&&Math.abs(this.m24-t.m24)<1e-7&&Math.abs(this.m31-t.m31)<1e-7&&Math.abs(this.m32-t.m32)<1e-7&&Math.abs(this.m33-t.m33)<1e-7&&Math.abs(this.m34-t.m34)<1e-7&&Math.abs(this.m41-t.m41)<1e-7&&Math.abs(this.m42-t.m42)<1e-7&&Math.abs(this.m43-t.m43)<1e-7&&Math.abs(this.m44-t.m44)<1e-7)}},{key:"isIdentity",value:function(){return this.equalTo(e._identity())}},{key:"getScale",value:function(){var e=(this.m11*this.m22*this.m33+this.m12*this.m23*this.m31+this.m13*this.m21*this.m32-this.m11*this.m23*this.m32-this.m12*this.m21*this.m33-this.m13*this.m22*this.m31>0?1:-1)/this.m44,t=new r.a(this.m11,this.m12,this.m13),n=new r.a(this.m21,this.m22,this.m23),o=new r.a(this.m31,this.m32,this.m33);return new r.a(t.length()*e,n.length()*e,o.length()*e)}},{key:"getTranslation",value:function(){return new r.a(this.m41/this.m44,this.m42/this.m44,this.m43/this.m44)}},{key:"getRotation",value:function(){var e=[],t=this.getScale().mul(this.m44),n=new o.a,i=new r.a(this.m11,this.m12,this.m13).mul(1/t.x),a=new r.a(this.m21,this.m22,this.m23).mul(1/t.y),u=new r.a(this.m31,this.m32,this.m33).mul(1/t.z);e[0]=i.x-a.y-u.z+1,e[1]=-i.x+a.y-u.z+1,e[2]=-i.x-a.y+u.z+1,e[3]=i.x+a.y+u.z+1;for(var s=0,l=1;l<4;l++)e[l]>e[s]&&(s=l);if(e[s]<0)throw new Error("something is wrong...");var c=.5*Math.sqrt(e[s]),f=.25/c;switch(s){case 0:n.x=c,n.y=(i.y+a.x)*f,n.z=(u.x+i.z)*f,n.w=(a.z-u.y)*f;break;case 1:n.x=(i.y+a.x)*f,n.y=c,n.z=(a.z+u.y)*f,n.w=(u.x-i.z)*f;break;case 2:n.x=(u.x+i.z)*f,n.y=(a.z+u.y)*f,n.z=c,n.w=(i.y-a.x)*f;break;case 3:n.x=(a.z-u.y)*f,n.y=(u.x-i.z)*f,n.z=(i.y-a.x)*f,n.w=c}if(0===n.x&&0===n.y&&0===n.z)n.w=0;else{var h=Math.acos(n.w);isNaN(h)?n.w=0:n.w=2*h}return n}},{key:"getOrientation",value:function(){return this.getRotation().rotationToQuat()}},{key:"floatArray",value:function(){return[this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.m41,this.m42,this.m43,this.m44]}},{key:"float32Array",value:function(){return new Float32Array([this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.m41,this.m42,this.m43,this.m44])}},{key:"floatArray3x4f",value:function(){return[this.m11,this.m21,this.m31,this.m41,this.m12,this.m22,this.m32,this.m42,this.m13,this.m23,this.m33,this.m43]}},{key:"float32Array3x4f",value:function(){return new Float32Array([this.m11,this.m21,this.m31,this.m41,this.m12,this.m22,this.m32,this.m42,this.m13,this.m23,this.m33,this.m43])}}])&&a(t.prototype,n),u&&a(t,u),e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return f});var r=n(2),o=n(5);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(t){function n(t,r){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(i=a(this,u(n).call(this)))._data=t,t instanceof e){for(var c=[],f=t.length/l,h=0,y=0;y<f;y++)c.push(t.readUIntLE(h,l)),h+=l;i._data=c}if(i._primitiveType=r,null!==s)i._primitiveCount=s;else switch(r){case o.a.triangles:i._primitiveCount=i._data.length/3;break;case o.a.triangleStrip:i._primitiveCount=i._data.length-2;break;case o.a.line:i._primitiveCount=i._data.length/2;break;case o.a.point:i._primitiveCount=i._data.length;break;case o.a.polygon:i._primitiveCount=i._data.length/2;break;default:throw new Error("unknown primitive type: "+r)}if(i._bytesPerIndex=l,i._glData=null,1===l)i._glData=new Uint8Array(i._data);else if(2===l)i._glData=new Uint16Array(i._data);else{if(4!==l)throw new Error("unknown data size: ".concat(l));i._glData=new Uint32Array(i._data)}return i.maximumPointScreenSpaceRadius=0,i.minimumPointScreenSpaceRadius=0,i.pointSize=0,i.primitiveRange=null,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,r["a"]),l(n,null,[{key:"_propTypes",get:function(){return{$constructor:function(e,t){var r=new n(t.elementData,t.primitiveType,t.primitiveCount,t.bytesPerIndex);return void 0!==t.maximumPointScreenSpaceRadius&&(r.maximumPointScreenSpaceRadius=t.maximumPointScreenSpaceRadius),void 0!==t.minimumPointScreenSpaceRadius&&(r.minimumPointScreenSpaceRadius=t.minimumPointScreenSpaceRadius),void 0!==t.ptSize&&(r.pointSize=t.ptSize),r},primitiveType:["integer",null],primitiveCount:["integer",null],elementData:["NSMutableData",null],bytesPerIndex:["integer",null],primitiveRangeLocation:["integer",null],primitiveRangeLength:["integer",null],ptSize:["float",null],indicesChannelCount:["integer",null],interleavedIndicesChannels:["integer",null],minimumPointScreenSpaceRadius:["float",null],maximumPointScreenSpaceRadius:["float",null]}}}]),l(n,[{key:"initMdlSubmesh",value:function(e){}},{key:"_createBuffer",value:function(e){var t=e;return this._buffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._glData,t.STATIC_DRAW),this._buffer}},{key:"copy",value:function(){return new n(this._data.slice(0),this._primitiveType,this._primitiveCount,this._bytesPerIndex)}},{key:"_indexAt",value:function(e){if(e<0||e>=this.primitiveCount)throw new Error("index out of range: ".concat(e," (0 - ").concat(this.primitiveCount-1,")"));this._primitiveCount;if(this._primitiveType===o.a.triangles){var t=3*e;return[this._data[t+0],this._data[t+1],this._data[t+2]]}if(this._primitiveType===o.a.triangleStrip)return[this._data[e+0],this._data[e+1],this._data[e+2]];if(this._primitiveType===o.a.line){var n=2*e;return[this._data[n+0],this._data[n+1]]}if(this._primitiveType===o.a.point)return[this._data[e]];if(this._primitiveType===o.a.polygon)return[this._data[0],this._data[e+1],this._data[e+2]];throw new Error("unknown primitive type: ".concat(this._primitiveType))}},{key:"primitiveType",get:function(){return this._primitiveType}},{key:"primitiveCount",get:function(){return this._primitiveCount}},{key:"data",get:function(){return this._data}},{key:"bytesPerIndex",get:function(){return this._bytesPerIndex}}]),n}()}).call(this,n(16).Buffer)},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(6),o=n(7);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.origin=t.copy(),this.size=n.copy()}var t,n,a;return t=e,a=[{key:"rectWithXYWidthHeight",value:function(t,n,i,a){return new e(new r.a(t,n),new o.a(i,a))}},{key:"zero",get:function(){return new e(new r.a(0,0),new o.a(0,0))}}],(n=[{key:"applying",value:function(e){return null}},{key:"insetBy",value:function(t,n){var i=this.minX+t,a=this.minY+n,u=this.size.width-2*t,s=this.size.height-2*n;return new e(new r.a(i,a),new o.a(u,s))}},{key:"offsetBy",value:function(t,n){return new e(new r.a(this.origin.x+t,this.origin.y+n),this.size)}},{key:"union",value:function(t){if(this.isNull&&t.isNull)return new e(new r.a(0,0),null);if(this.isNull)return t.copy();if(t.isNull)return this.copy();var n=this.minX<t.minX?this.minX:t.minX,i=this.maxX>t.maxX?this.maxX:t.maxX,a=this.minY<t.minY?this.minY:t.minY,u=i-n,s=(this.maxY>t.maxY?this.maxY:t.maxY)-a;return new e(new r.a(n,a),new o.a(u,s))}},{key:"intersection",value:function(t){if(this.isNull||t.isNull)return new e(new r.a(0,0),null);var n=this.minX>t.minX?this.minX:t.minX,i=this.maxX<t.maxX?this.maxX:t.maxX,a=this.minY>t.minY?this.minY:t.minY,u=i-n,s=(this.maxY<t.maxY?this.maxY:t.maxY)-a;return u<0||s<0?new e(new r.a(0,0),null):new e(new r.a(n,a),new o.a(u,s))}},{key:"dividedFrom",value:function(e,t){return null}},{key:"intersects",value:function(e){this.intersection(e);return this.width>0&&this.height>0}},{key:"contains",value:function(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}},{key:"initDictionaryRepresentation",value:function(e){this.origin=e.get("origin"),this.size=e.get("size")}},{key:"equalTo",value:function(e){return null!==this.origin&&null!==e.origin&&(null!==this.size&&null!==e.size&&(this.origin.equalTo(e.origin)&&this.size.equalTo(e.size)))}},{key:"zero",value:function(){return new e(new r.a(0,0),new e(0,0))}},{key:"add",value:function(t){return new e(this.origin.add(t.origin),this.size.add(t.size))}},{key:"sub",value:function(t){return new e(this.origin.sub(t.origin),this.size.sub(t.size))}},{key:"lerp",value:function(t,n){return new e(this.origin.lerp(t.origin,n),this.size.lerp(t.size,n))}},{key:"copy",value:function(){return new e(this.origin,this.size)}},{key:"height",get:function(){return this.isNull?0:Math.abs(this.size.height)}},{key:"width",get:function(){return this.isNull?0:Math.abs(this.size.width)}},{key:"minX",get:function(){return this.size.width<0?this.origin.x+this.size.width:this.origin.x}},{key:"midX",get:function(){return this.origin.x+.5*this.size.width}},{key:"maxX",get:function(){return this.size.width>0?this.origin.x+this.size.width:this.origin.x}},{key:"minY",get:function(){return this.size.height<0?this.origin.y+this.size.height:this.origin.y}},{key:"midY",get:function(){return this.origin.y+.5*this.size.height}},{key:"maxY",get:function(){return this.size.height>0?this.origin.y+this.size.height:this.origin.y}},{key:"standardized",get:function(){var t=this.copy();return this.isNull?e.zero:(this.width<0&&(t.origin.x=this.origin.x+this.width,t.size.width=-this.width),this.height<0&&(t.origin.y=this.origin.y+this.height,t.size.height=-this.height),t)}},{key:"integral",get:function(){return null}},{key:"isEmpty",get:function(){return this.isNull||0===this.size.height||0===this.size.width}},{key:"isInfinite",get:function(){return this.size.width===1/0&&this.size.height===1/0}},{key:"isNull",get:function(){return null===this.size}},{key:"dictionaryRepresentation",get:function(){var e=new Map;return e.set("origin",this.origin),e.set("size",this.size),e}},{key:"debugDescription",get:function(){if(null===this.size)return"{null}";var e=this.origin?this.origin.debugDescription():"{null}",t=this.size?this.size.debugDescription():"{null}";return"{origin:".concat(e,", size:").concat(t,"}")}},{key:"customMirror",get:function(){return null}},{key:"customPlaygroundQuickLook",get:function(){return null}}])&&i(t.prototype,n),a&&i(t,a),e}()},function(e,t,n){"use strict";var r=n(9);t.a=function(e,t,n){return new r.a(1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1)}},function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"h",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return l}),n.d(t,"e",function(){return c});var r=function(e){return e.replace(/%(8[1-9A-F]|[9E][0-9A-F]|F[0-9A-C])(%[4-689A-F][0-9A-F]|%7[0-9A-E]|[@-~])|%([0-7][0-9A-F]|A[1-9A-F]|[B-D][0-9A-F])/gi,function(e){var t=parseInt(e.substring(1,3),16),n=e.length;return 3==n?String.fromCharCode(t<160?t:t+65216):f.charAt(188*(t<160?t-129:t-193)+(4==n?e.charCodeAt(3)-64:(t=parseInt(e.substring(4),16))<127?t-64:t-65))})},o=function(e){return e.replace(/(%A[1-9A-F]|%[B-E][0-9A-F]|%F[0-9A-E]){2}|%8E%(A[1-9A-F]|[B-D][0-9A-F])|%[0-7][0-9A-F]/gi,function(e){var t=parseInt(e.substring(1),16);return t<161?String.fromCharCode(t<128?t:parseInt(e.substring(4),16)+65216):h.charAt(94*(t-161)+parseInt(e.substring(4),16)-161)})},i=function(e){var t,n,r=0,o="",i=String.fromCharCode,a=("%28B"+e.replace(/%49/g,"I").replace(/%1B%24%4[02]|%1B%24@/gi,"%1B%24B")).split(/%1B/i),u=function(e){return i(parseInt(e.substring(1),16))},s=function(e){return i((3==e.length?parseInt(e.substring(1),16):e.charCodeAt(0))+65344)},l=function(e){var t=e.length;return h.charAt(4<t?94*(parseInt(e.substring(1),16)-33)+parseInt(e.substring(4),16)-33:2<t?(37==(t=e.charCodeAt(0))?94*(parseInt(e.substring(1,3),16)-33)+e.charCodeAt(3):94*(t-33)+parseInt(e.substring(2),16))-33:94*(e.charCodeAt(0)-33)+e.charCodeAt(1)-33)},c=new RegExp,f=new RegExp,y=new RegExp;for(c.compile("%[0-7][0-9A-F]","ig"),f.compile("(%2[1-9A-F]|%[3-5][0-9A-F])|[!-_]","ig"),y.compile("(%2[1-9A-F]|%[3-6][0-9A-F]|%7[0-9A-E]){2}|(%2[1-9A-F]|%[3-6][0-9A-F]|%7[0-9A-E])[!-~]|[!-~](%2[1-9A-F]|%[3-6][0-9A-F]|%7[0-9A-E])|[!-~]{2}","ig");t=a[r++];)o+="%24B"==(n=t.substring(0,4))?t.substring(4).replace(y,l):"%28I"==n?t.substring(4).replace(f,s):t.replace(c,u).substring(2);return o},a=function(e){var t,n=0,r="",o=("%28B"+e.replace(/%1B%24%4[02]|%1B%24@/gi,"%1B%24B")).split(/%1B/i),i=function(e){var t=parseInt(e.substring(1),16);return String.fromCharCode(t<128?t:t+65216)},a=function(e){var t=e.length;return h.charAt(4<t?94*(parseInt(e.substring(1),16)-33)+parseInt(e.substring(4),16)-33:2<t?(37==(t=e.charCodeAt(0))?94*(parseInt(e.substring(1,3),16)-33)+e.charCodeAt(3):94*(t-33)+parseInt(e.substring(2),16))-33:94*(e.charCodeAt(0)-33)+e.charCodeAt(1)-33)},u=new RegExp,s=new RegExp;for(u.compile("%([0-7][0-9A-F]|A[1-9A-F]|[B-D][0-9A-F])","ig"),s.compile("(%2[1-9A-F]|%[3-6][0-9A-F]|%7[0-9A-E]){2}|(%2[1-9A-F]|%[3-6][0-9A-F]|%7[0-9A-E])[!-~]|[!-~](%2[1-9A-F]|%[3-6][0-9A-F]|%7[0-9A-E])|[!-~]{2}","ig");t=o[n++];)r+="%24B"==t.substring(0,4)?t.substring(4).replace(s,a):t.replace(u,i).substring(2);return r},u=function(e){return e.replace(/%u[0-9A-F]{4}|%[0-9A-F]{2}/gi,function(e){return String.fromCharCode("0x"+e.substring(e.length/3))})},s=function(e){for(var t=0,n={};t<64;)n["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)]=t++;return e.replace(RegExp("[+][+/-9A-Za-z]*-?","g"),function(e){if("+-"==e)return"+";for(var t,r=n[e.charAt(1)],o=1,i="";0<=r;)(t=7&o)<6?t=t<3?r<<10|n[e.charAt(++o)]<<4|(r=n[e.charAt(++o)])>>2:(3&r)<<14|n[e.charAt(++o)]<<8|n[e.charAt(++o)]<<2|(r=n[e.charAt(++o)])>>4:(t=(15&r)<<12|n[e.charAt(++o)]<<6|n[e.charAt(++o)],r=n[e.charAt(++o)]),t&&(i+=String.fromCharCode(t));return i})},l=function(e){return e.replace(/%(E(0%[AB]|[1-CEF]%[89AB]|D%[89])[0-9A-F]|C[2-9A-F]|D[0-9A-F])%[89AB][0-9A-F]|%[0-7][0-9A-F]/gi,function(e){var t=parseInt(e.substring(1),16);return String.fromCharCode(t<128?t:t<224?(31&t)<<6|63&parseInt(e.substring(4),16):((15&t)<<6|63&parseInt(e.substring(4),16))<<6|63&parseInt(e.substring(7),16))})},c=function(e){var t=String.fromCharCode,n=t(92,120,48,48,45,92,120,70,70);return e.replace(/^%FF%FE/i,"").replace(RegExp("%[0-9A-F]{2}%[0-9A-F]{2}|%[0-9A-F]{2}["+n+"]|["+n+"]%[0-9A-F]{2}|["+n+"]{2}","ig"),function(e){var n=e.length;return t(4<n?"0x"+e.substring(4,6)+e.substring(1,3):2<n?37==(n=e.charCodeAt(0))?parseInt(e.substring(1,3),16)|e.charCodeAt(3)<<8:n|parseInt(e.substring(2),16)<<8:e.charCodeAt(0)|e.charCodeAt(1)<<8)})},f=Function('var a="zKV33~jZ4zN=~ji36XazM93y!{~k2y!o~k0ZlW6zN?3Wz3W?{EKzK[33[`y|;-~j^YOTz$!~kNy|L1$353~jV3zKk3~k-4P4zK_2+~jY4y!xYHR~jlz$_~jk4z$e3X5He<0y!wy|X3[:~l|VU[F3VZ056Hy!nz/m1XD61+1XY1E1=1y|bzKiz!H034zKj~mEz#c5ZA3-3X$1~mBz$$3~lyz#,4YN5~mEz#{ZKZ3V%7Y}!J3X-YEX_J(3~mAz =V;kE0/y|F3y!}~m>z/U~mI~j_2+~mA~jp2;~m@~k32;~m>V}2u~mEX#2x~mBy+x2242(~mBy,;2242(~may->2&XkG2;~mIy-_2&NXd2;~mGz,{4<6:.:B*B:XC4>6:.>B*BBXSA+A:X]E&E<~r#z+625z s2+zN=`HXI@YMXIAXZYUM8X4K/:Q!Z&33 3YWX[~mB`{zKt4z (zV/z 3zRw2%Wd39]S11z$PAXH5Xb;ZQWU1ZgWP%3~o@{Dgl#gd}T){Uo{y5_d{e@}C(} WU9|cB{w}bzvV|)[} H|zT}d||0~{]Q|(l{|x{iv{dw}(5}[Z|kuZ }cq{{y|ij}.I{idbof%cu^d}Rj^y|-M{ESYGYfYsZslS`?ZdYO__gLYRZ&fvb4oKfhSf^d<Yeasc1f&a=hnYG{QY{D`Bsa|u,}Dl|_Q{C%xK|Aq}C>|c#ryW=}eY{L+`)][YF_Ub^h4}[X|?r|u_ex}TL@YR]j{SrXgo*|Gv|rK}B#mu{R1}hs|dP{C7|^Qt3|@P{YVV |8&}#D}ef{e/{Rl|>Hni}R1{Z#{D[}CQlQ||E}[s{SG_+i8eplY[=[|ec[$YXn#`hcm}YR|{Ci(_[ql|?8p3]-}^t{wy}4la&pc|3e{Rp{LqiJ],] `kc(]@chYnrM`O^,ZLYhZB]ywyfGY~aex!_Qww{a!|)*lHrM{N+n&YYj~Z b c#e_[hZSon|rOt`}hBXa^i{lh|<0||r{KJ{kni)|x,|0auY{D!^Sce{w;|@S|cA}Xn{C1h${E]Z-XgZ*XPbp]^_qbH^e[`YM|a||+=]!Lc}]vdBc=j-YSZD]YmyYLYKZ9Z>Xcczc2{Yh}9Fc#Z.l{}(D{G{{mRhC|L3b#|xK[Bepj#ut`H[,{E9Yr}1b{[e]{ZFk7[ZYbZ0XL]}Ye[(`d}c!|*y`Dg=b;gR]Hm=hJho}R-[n}9;{N![7k_{UbmN]rf#pTe[x8}!Qcs_rs[m`|>N}^V})7{^r|/E}),}HH{OYe2{Skx)e<_.cj.cjoMhc^d}0uYZd!^J_@g,[[[?{i@][|3S}Yl3|!1|eZ|5IYw|1D}e7|Cv{OHbnx-`wvb[6[4} =g+k:{C:}ed{S]|2M]-}WZ|/q{LF|dYu^}Gs^c{Z=}h>|/i|{W]:|ip{N:|zt|S<{DH[p_tvD{N<[8Axo{X4a.^o^X>Yfa59`#ZBYgY~_t^9`jZHZn`>G[oajZ;X,i)Z.^~YJe ZiZF^{][[#Zt^|]Fjx]&_5dddW]P0C[-]}]d|y {C_jUql] |OpaA[Z{lp|rz}:Mu#]_Yf6{Ep?f5`$[6^D][^u[$[6^.Z8]]ePc2U/=]K^_+^M{q*|9tYuZ,s(dS{i=|bNbB{uG}0jZOa:[-]dYtu3]:]<{DJ_SZIqr_`l=Yt`gkTnXb3d@kiq0a`Z{|!B|}e}Ww{Sp,^Z|0>_Z}36|]A|-t}lt{R6pi|v8hPu#{C>YOZHYmg/Z4nicK[}hF_Bg|YRZ7c|crkzYZY}_iXcZ.|)U|L5{R~qi^Uga@Y[xb}&qdbd6h5|Btw[}c<{Ds53[Y7]?Z<|e0{L[ZK]mXKZ#Z2^tavf0`PE[OSOaP`4gi`qjdYMgys/?[nc,}EEb,eL]g[n{E_b/vcvgb.{kcwi`~v%|0:|iK{Jh_vf5lb}KL|(oi=LrzhhY_^@`zgf[~g)[J_0fk_V{T)}I_{D&_/d9W/|MU[)f$xW}?$xr4<{Lb{y4}&u{XJ|cm{Iu{jQ}CMkD{CX|7A}G~{kt)nB|d5|<-}WJ}@||d@|Iy}Ts|iL|/^|no|0;}L6{Pm]7}$zf:|r2}?C_k{R(}-w|`G{Gy[g]bVje=_0|PT{^Y^yjtT[[[l!Ye_`ZN]@[n_)j3nEgMa]YtYpZy].d-Y_cjb~Y~[nc~sCi3|zg}B0}do{O^{|$`_|D{}U&|0+{J3|8*]iayx{a{xJ_9|,c{Ee]QXlYb]$[%YMc*]w[aafe]aVYi[fZEii[xq2YQZHg]Y~h#|Y:thre^@^|_F^CbTbG_1^qf7{L-`VFx Zr|@EZ;gkZ@slgko`[e}T:{Cu^pddZ_`yav^Ea+[#ZBbSbO`elQfLui}.F|txYcbQ`XehcGe~fc^RlV{D_0ZAej[l&jShxG[ipB_=u:eU}3e8[=j|{D(}dO{Do[BYUZ0/]AYE]ALYhZcYlYP/^-^{Yt_1_-;YT`P4BZG=IOZ&]H[e]YYd[9^F[1YdZxZ?Z{Z<]Ba2[5Yb[0Z4l?]d_;_)a?YGEYiYv`_XmZs4ZjY^Zb]6gqGaX^9Y}dXZr[g|]Y}K aFZp^k^F]M`^{O1Ys]ZCgCv4|E>}8eb7}l`{L5[Z_faQ|c2}Fj}hw^#|Ng|B||w2|Sh{v+[G}aB|MY}A{|8o}X~{E8paZ:]i^Njq]new)`-Z>haounWhN}c#{DfZ|fK]KqGZ=:u|fqoqcv}2ssm}.r{]{nIfV{JW)[K|,Z{Uxc|]l_KdCb%]cfobya3`p}G^|LZiSC]U|(X|kBlVg[kNo({O:g:|-N|qT}9?{MBiL}Sq{`P|3a|u.{Uaq:{_o|^S}jX{Fob0`;|#y_@[V[K|cw[<_ }KU|0F}d3|et{Q7{LuZttsmf^kYZ`Af`}$x}U`|Ww}d]| >}K,r&|XI|*e{C/a-bmr1fId4[;b>tQ_:]hk{b-pMge]gfpo.|(w[jgV{EC1Z,YhaY^q,_G[c_g[J0YX]`[h^hYK^_Yib,` {i6vf@YM^hdOKZZn(jgZ>bzSDc^Z%[[o9[2=/YHZ(_/Gu_`*|8z{DUZxYt^vuvZjhi^lc&gUd4|<UiA`z]$b/Z?l}YI^jaHxe|;F}l${sQ}5g}hA|e4}?o{ih}Uz{C)jPe4]H^J[Eg[|AMZMlc}:,{iz}#*|gc{Iq|/:|zK{l&}#u|myd{{M&v~nV};L|(g|I]ogddb0xsd7^V})$uQ{HzazsgxtsO^l}F>ZB]r|{7{j@cU^{{CbiYoHlng]f+nQ[bkTn/}<-d9q {KXadZYo+n|l[|lc}V2{[a{S4Zam~Za^`{HH{xx_SvF|ak=c^[v^7_rYT`ld@]:_ub%[$[m](Shu}G2{E.ZU_L_R{tz`vj(f?^}hswz}GdZ}{S:h`aD|?W|`dgG|if{a8|J1{N,}-Ao3{H#{mfsP|[ bzn+}_Q{MT{u4kHcj_q`eZj[8o0jy{p7}C|[}l){MuYY{|Ff!Ykn3{rT|m,^R|,R}$~Ykgx{P!]>iXh6[l[/}Jgcg{JYZ.^qYfYIZl[gZ#Xj[Pc7YyZD^+Yt;4;`e8YyZVbQ7YzZxXja.7SYl[s]2^/Ha$[6ZGYrb%XiYdf2]H]kZkZ*ZQ[ZYS^HZXcCc%Z|[(bVZ]]:OJQ_DZCg<[,]%Zaa [g{C00HY[c%[ChyZ,Z_`PbXa+eh`^&jPi0a[ggvhlekL]w{Yp^v}[e{~;k%a&k^|nR_z_Qng}[E}*Wq:{k^{FJZpXRhmh3^p>de^=_7`|ZbaAZtdhZ?n4ZL]u`9ZNc3g%[6b=e.ZVfC[ZZ^^^hD{E(9c(kyZ=bb|Sq{k`|vmr>izlH[u|e`}49}Y%}FT{[z{Rk}Bz{TCc/lMiAqkf(m$hDc;qooi[}^o:c^|Qm}a_{mrZ(pA`,}<2sY| adf_%|}`}Y5U;}/4|D>|$X{jw{C<|F.hK|*A{MRZ8Zsm?imZm_?brYWZrYx`yVZc3a@f?aK^ojEd {bN}/3ZH]/$YZhm^&j 9|(S|b]mF}UI{q&aM]LcrZ5^.|[j`T_V_Gak}9J[ ZCZD|^h{N9{~&[6Zd{}B}2O|cv]K}3s}Uy|l,fihW{EG`j_QOp~Z$F^zexS`dcISfhZBXP|.vn|_HYQ|)9|cr]<`&Z6]m_(ZhPcSg>`Z]5`~1`0Xcb4k1{O!bz|CN_T{LR|a/gFcD|j<{Z._[f)mPc:1`WtIaT1cgYkZOaVZOYFrEe[}T$}Ch}mk{K-^@]fH{Hdi`c*Z&|Kt{if[C{Q;{xYB`dYIX:ZB[}]*[{{p9|4GYRh2ao{DS|V+[zd$`F[ZXKadb*A] Ys]Maif~a/Z2bmclb8{Jro_rz|x9cHojbZ{GzZx_)]:{wAayeDlx}<=`g{H1{l#}9i|)=|lP{Qq}.({La|!Y{i2EZfp=c*}Cc{EDvVB|;g}2t{W4av^Bn=]ri,|y?|3+}T*ckZ*{Ffr5e%|sB{lx^0]eZb]9[SgAjS_D|uHZx]dive[c.YPkcq/}db{EQh&hQ|eg}G!ljil|BO]X{Qr_GkGl~YiYWu=c3eb}29v3|D|}4i||.{Mv})V{SP1{FX}CZW6{cm|vO{pS|e#}A~|1i}81|Mw}es|5[}3w{C`h9aL]o{}p[G`>i%a1Z@`Ln2bD[$_h`}ZOjhdTrH{[j_:k~kv[Sdu]CtL}41{I |[[{]Zp$]XjxjHt_eThoa#h>sSt8|gK|TVi[Y{t=}Bs|b7Zpr%{gt|Yo{CS[/{iteva|cf^hgn}($_c^wmb^Wm+|55jrbF|{9^ q6{C&c+ZKdJkq_xOYqZYSYXYl`8]-cxZAq/b%b*_Vsa[/Ybjac/OaGZ4fza|a)gY{P?| I|Y |,pi1n7}9bm9ad|=d{aV|2@[(}B`d&|Uz}B}{`q|/H|!JkM{FU|CB|.{}Az}#P|lk}K{|2rk7{^8^?`/|k>|Ka{Sq}Gz}io{DxZh[yK_#}9<{TRdgc]`~Z>JYmYJ]|`!ZKZ]gUcx|^E[rZCd`f9oQ[NcD_$ZlZ;Zr}mX|=!|$6ZPZYtIo%fj}CpcN|B,{VDw~gb}@hZg`Q{LcmA[(bo`<|@$|o1|Ss}9Z_}tC|G`{F/|9nd}i=}V-{L8aaeST]daRbujh^xlpq8|}zs4bj[S`J|]?G{P#{rD{]I`OlH{Hm]VYuSYUbRc*6[j`8]pZ[bt_/^Jc*[<Z?YE|Xb|?_Z^Vcas]h{t9|Uwd)_(=0^6Zb{Nc} E[qZAeX[a]P^|_J>e8`W^j_Y}R{{Jp__]Ee#e:iWb9q_wKbujrbR}CY`,{mJ}gz{Q^{t~N|? gSga`V_||:#mi}3t|/I`X{N*|ct|2g{km}gi|{={jC}F;|E}{ZZjYf*frmu}8Tdroi{T[|+~}HG{cJ}DM{Lp{Ctd&}$hi3|FZ| m}Kr|38}^c|m_|Tr{Qv|36}?Up>|;S{DV{k_as}BK{P}}9p|t`jR{sAm4{D=b4pWa[}Xi{EjwEkI}3S|E?u=X0{jf} S|NM|JC{qo^3cm]-|JUx/{Cj{s>{Crt[UXuv|D~|j|d{YXZR}Aq}0r}(_{pJfi_z}0b|-vi)Z mFe,{f4|q`b{}^Z{HM{rbeHZ|^x_o|XM|L%|uFXm}@C_{{Hhp%a7|0p[Xp+^K}9U{bP}: tT}B|}+$|b2|[^|~h{FAby[`{}xgygrt~h1[li`c4vz|,7p~b(|mviN}^pg[{N/|g3|^0c,gE|f%|7N{q[|tc|TKA{LU}I@|AZp(}G-sz{F |qZ{}F|f-}RGn6{Z]_5})B}UJ{FFb2]4ZI@v=k,]t_Dg5Bj]Z-]L]vrpdvdGlk|gF}G]|IW}Y0[G| /bo|Te^,_B}#n^^{QHYI[?hxg{[`]D^IYRYTb&kJ[cri[g_9]Ud~^_]<p@_e_XdNm-^/|5)|h_{J;{kacVopf!q;asqd}n)|.m|bf{QW|U)}b+{tL|w``N|to{t ZO|T]jF}CB|0Q{e5Zw|k |We}5:{HO{tPwf_uajjBfX}-V_C_{{r~gg|Ude;s+}KNXH}! `K}eW{Upwbk%ogaW}9EYN}YY|&v|SL{C3[5s.]Y]I]u{M6{pYZ`^,`ZbCYR[1mNg>rsk0Ym[jrE]RYiZTr*YJ{Ge|%-lf|y(`=[t}E6{k!|3)}Zk} ][G{E~cF{u3U.rJ|a9p#o#ZE|?|{sYc#vv{E=|LC}cu{N8`/`3`9rt[4|He{cq|iSYxY`}V |(Q|t4{C?]k_Vlvk)BZ^r<{CL}#h}R+[<|i=}X|{KAo]|W<`K{NW|Zx}#;|fe{IMr<|K~tJ_x}AyLZ?{GvbLnRgN}X&{H7|x~}Jm{]-| GpNu0}.ok>|c4{PYisrDZ|fwh9|hfo@{H~XSbO]Odv]%`N]b1Y]]|eIZ}_-ZA]aj,>eFn+j[aQ_+]h[J_m_g]%_wf.`%k1e#Z?{CvYu_B^|gk`Xfh^M3`afGZ-Z|[m{L}|k3cp[it ^>YUi~d>{T*}YJ{Q5{Jxa$hg|%4`}|LAgvb }G}{P=|<;Ux{_skR{cV|-*|s-{Mp|XP|$G|_J}c6cM{_=_D|*9^$ec{V;|4S{qO|w_|.7}d0|/D}e}|0G{Dq]Kdp{}dfDi>}B%{Gd|nl}lf{C-{y}|ANZr}#={T~|-(}c&{pI|ft{lsVP}){|@u}!W|bcmB{d?|iW|:dxj{PSkO|Hl]Li:}VYk@|2={fnWt{M3`cZ6|)}|Xj}BYa?vo{e4|L7|B7{L7|1W|lvYO}W8nJ|$Vih|{T{d*_1|:-n2dblk``fT{Ky|-%}m!|Xy|-a{Pz}[l{kFjz|iH}9N{WE{x,|jz}R {P|{D)c=nX|Kq|si}Ge{sh|[X{RF{t`|jsr*fYf,rK|/9}$}}Nf{y!1|<Std}4Wez{W${Fd_/^O[ooqaw_z[L`Nbv[;l7V[ii3_PeM}.h^viqYjZ*j1}+3{bt{DR[;UG}3Og,rS{JO{qw{d<_zbAh<R[1_r`iZTbv^^a}c{iEgQZ<exZFg.^Rb+`Uj{a+{z<[~r!]`[[|rZYR|?F|qppp]L|-d|}K}YZUM|=Y|ktm*}F]{D;g{uI|7kg^}%?Z%ca{N[_<q4xC]i|PqZC]n}.bDrnh0Wq{tr|OMn6tM|!6|T`{O`|>!]ji+]_bTeU}Tq|ds}n|{Gm{z,f)}&s{DPYJ`%{CGd5v4tvb*hUh~bf]z`jajiFqAii]bfy^U{Or|m+{I)cS|.9k:e3`^|xN}@Dnlis`B|Qo{`W|>||kA}Y}{ERYuYx`%[exd`]|OyiHtb}HofUYbFo![5|+]gD{NIZR|Go}.T{rh^4]S|C9_}xO^i`vfQ}C)bK{TL}cQ|79iu}9a];sj{P.o!f[Y]pM``Jda^Wc9ZarteBZClxtM{LW}l9|a.mU}KX}4@{I+f1}37|8u}9c|v${xGlz}jP{Dd1}e:}31}%3X$|22i<v+r@~mf{sN{C67G97855F4YL5}8f{DT|xy{sO{DXB334@55J1)4.G9A#JDYtXTYM4, YQD9;XbXm9SX]IB^4UN=Xn<5(;(F3YW@XkH-X_VM[DYM:5XP!T&Y`6|,^{IS-*D.H>:LXjYQ0I3XhAF:9:(==.F*3F1189K/7163D,:@|e2{LS36D4hq{Lw/84443@4.933:0307::6D7}&l{Mx657;89;,K5678H&93D(H<&<>0B90X^I;}Ag1{P%3A+>><975}[S{PZE453?4|T2{Q+5187;>447:81{C=hL6{Me^:=7ii{R=.=F<81;48?|h8}Uh{SE|,VxL{ST,7?9Y_5Xk3A#:$%YSYdXeKXOD8+TXh7(@>(YdXYHXl9J6X_5IXaL0N?3YK7Xh!1?XgYz9YEXhXaYPXhC3X`-YLY_XfVf[EGXZ5L8BXL9YHX]SYTXjLXdJ: YcXbQXg1PX]Yx4|Jr{Ys4.8YU+XIY`0N,<H%-H;:0@,74/:8546I=9177154870UC]d<C3HXl7ALYzXFXWP<<?E!88E5@03YYXJ?YJ@6YxX-YdXhYG|9o{`iXjY_>YVXe>AYFX[/(I@0841?):-B=14337:8=|14{c&93788|di{cW-0>0<097/A;N{FqYpugAFT%X/Yo3Yn,#=XlCYHYNX[Xk3YN:YRT4?)-YH%A5XlYF3C1=NWyY}>:74-C673<69545v {iT85YED=64=.F4..9878/D4378?48B3:7:7/1VX[f4{D,{l<5E75{dAbRB-8-@+;DBF/$ZfW8S<4YhXA.(5@*11YV8./S95C/0R-A4AXQYI7?68167B95HA1*<M3?1/@;/=54XbYP36}lc{qzSS38:19?,/39193574/66878Yw1X-87E6=;964X`T734:>86>1/=0;(I-1::7ALYGXhF+Xk[@W%TYbX7)KXdYEXi,H-XhYMRXfYK?XgXj.9HX_SX]YL1XmYJ>Y}WwIXiI-3-GXcYyXUYJ$X`Vs[7;XnYEZ;XF! 3;%8;PXX(N3Y[)Xi1YE&/ :;74YQ6X`33C;-(>Xm0(TYF/!YGXg8 9L5P01YPXO-5%C|qd{{/K/E6,=0144:361:955;6443@?B7*7:F89&F35YaX-CYf,XiFYRXE_e{}sF 0*7XRYPYfXa5YXXY8Xf8Y~XmA[9VjYj*#YMXIYOXk,HHX40YxYMXU8OXe;YFXLYuPXP?EB[QV0CXfY{:9XV[FWE0D6X^YVP*$4%OXiYQ(|xp|%c3{}V`1>Y`XH00:8/M6XhQ1:;3414|TE|&o@1*=81G8<3}6<|(f6>>>5-5:8;093B^3U*+*^*UT30XgYU&7*O1953)5@E78--F7YF*B&0:%P68W9Zn5974J9::3}Vk|-,C)=)1AJ4+<3YGXfY[XQXmT1M-XcYTYZXCYZXEYXXMYN,17>XIG*SaS|/eYJXbI?XdNZ+WRYP<F:R PXf;0Xg`$|1GX9YdXjLYxWX!ZIXGYaXNYm6X9YMX?9EXmZ&XZ#XQ>YeXRXfAY[4 ;0X!Zz0XdN$XhYL XIY^XGNXUYS/1YFXhYk.TXn4DXjB{jg|4DEX]:XcZMW=A.+QYL<LKXc[vV$+&PX*Z3XMYIXUQ:ZvW< YSXFZ,XBYeXMM)?Xa XiZ4/EXcP3%}&-|6~:1(-+YT$@XIYRBC<}&,|7aJ6}bp|8)K1|Xg|8C}[T|8Q.89;-964I38361<=/;883651467<7:>?1:.}le|:Z=39;1Y^)?:J=?XfLXbXi=Q0YVYOXaXiLXmJXO5?.SFXiCYW}-;|=u&D-X`N0X^,YzYRXO(QX_YW9`I|>hZ:N&X)DQXP@YH#XmNXi$YWX^=!G6YbYdX>XjY|XlX^XdYkX>YnXUXPYF)FXT[EVTMYmYJXmYSXmNXi#GXmT3X8HOX[ZiXN]IU2>8YdX1YbX<YfWuZ8XSXcZU%0;1XnXkZ_WTG,XZYX5YSX Yp 05G?XcYW(IXg6K/XlYP4XnI @XnO1W4Zp-9C@%QDYX+OYeX9>--YSXkD.YR%Q/Yo YUX].Xi<HYEZ2WdCE6YMXa7F)=,D>-@9/8@5=?7164;35387?N<618=6>7D+C50<6B03J0{Hj|N9$D,9I-,.KB3}m |NzE0::/81YqXjMXl7YG; [.W=Z0X4XQY]:MXiR,XgM?9$9>:?E;YE77VS[Y564760391?14941:0=:8B:;/1DXjFA-564=0B3XlH1+D85:0Q!B#:-6&N/:9<-R3/7Xn<*3J4.H:+334B.=>30H.;3833/76464665755:/83H6633:=;.>5645}&E|Y)?1/YG-,93&N3AE@5 <L1-G/8A0D858/30>8<549=@B8] V0[uVQYlXeD(P#ID&7T&7;Xi0;7T-$YE)E=1:E1GR):--0YI7=E<}n9|aT6783A>D7&4YG7=391W;Zx<5+>F#J39}o/|cc;6=A050EQXg8A1-}D-|d^5548083563695D?-.YOXd37I$@LYLWeYlX<Yd+YR A$;3-4YQ-9XmA0!9/XLY_YT(=5XdDI>YJ5XP1ZAW{9>X_6R(XhYO65&J%DA)C-!B:97#A9;@?F;&;(9=11/=657/H,<8}bz|j^5446>.L+&Y^8Xb6?(CYOXb*YF(8X`FYR(XPYVXmPQ%&DD(XmZXW??YOXZXfCYJ79,O)XnYF7K0!QXmXi4IYFRXS,6<%-:YO(+:-3Q!1E1:W,Zo}Am|n~;3580534*?3Zc4=9334361693:30C<6/717:<1/;>59&:4}6!|rS36=1?75<8}[B|s809983579I.A.>84758=108564741H*9E{L{|u%YQ<%6XfH.YUXe4YL@,>N}Tv|ve*G0X)Z;/)3@A74(4P&A1X:YVH97;,754*A66:1 D739E3553545558E4?-?K17/770843XAYf838A7K%N!YW4.$T19Z`WJ*0XdYJXTYOXNZ 1XaN1A+I&Xi.Xk3Z3GB&5%WhZ1+5#Y[X<4YMXhQYoQXVXbYQ8XSYUX4YXBXWDMG0WxZA[8V+Z8X;D],Va$%YeX?FXfX[XeYf<X:Z[WsYz8X_Y]%XmQ(!7BXIZFX]&YE3F$(1XgYgYE& +[+W!<YMYFXc;+PXCYI9YrWxGXY9DY[!GXiI7::)OC;*$.>N*HA@{C|}&k=:<TB83X`3YL+G4XiK]i}(fYK<=5$.FYE%4*5*H*6XkCYL=*6Xi6!Yi1KXR4YHXbC8Xj,B9ZbWx/XbYON#5B}Ue}+QKXnF1&YV5XmYQ0!*3IXBYb71?1B75XmF;0B976;H/RXU:YZX;BG-NXj;XjI>A#D3B636N;,*%<D:0;YRXY973H5)-4FXOYf0:0;/7759774;7;:/855:543L43<?6=E,.A4:C=L)%4YV!1(YE/4YF+ F3%;S;&JC:%/?YEXJ4GXf/YS-EXEYW,9;E}X$}547EXiK=51-?71C%?57;5>463553Zg90;6447?<>4:9.7538XgN{|!}9K/E&3-:D+YE1)YE/3;37/:05}n<}:UX8Yj4Yt864@JYK..G=.(A Q3%6K>3(P3#AYE$-6H/456*C=.XHY[#S.<780191;057C)=6HXj?955B:K1 E>-B/9,;5.!L?:0>/.@//:;7833YZ56<4:YE=/:7Z_WGC%3I6>XkC*&NA16X=Yz2$X:Y^&J48<99k8}CyB-61<18K946YO4{|N}E)YIB9K0L>4=46<1K0+R;6-=1883:478;4,S+3YJX`GJXh.Yp+Xm6MXcYpX(>7Yo,/:X=Z;Xi0YTYHXjYmXiXj;*;I-8S6N#XgY}.3XfYGO3C/$XjL$*NYX,1 6;YH&<XkK9C#I74.>}Hd`A748X[T450[n75<4439:18A107>|ET}Rf<1;14876/Yb983E<5.YNXd4149>,S=/4E/<306443G/06}0&}UkYSXFYF=44=-5095=88;63844,9E6644{PL}WA8:>)7+>763>>0/B3A545CCnT}Xm|dv}Xq1L/YNXk/H8;;.R63351YY747@15YE4J8;46;.38.>4A369.=-83,;Ye3?:3@YE.4-+N353;/;@(X[YYD>@/05-I*@.:551741Yf5>6A443<3535;.58/86=D4753442$635D1>0359NQ @73:3:>><Xn?;43C14 ?Y|X611YG1&<+,4<*,YLXl<1/AIXjF*N89A4Z576K1XbJ5YF.ZOWN.YGXO/YQ01:4G38Xl1;KI0YFXB=R<7;D/,/4>;$I,YGXm94@O35Yz66695385.>:6A#5}W7n^4336:4157597434433<3|XA}m`>=D>:4A.337370?-6Q96{`E|4A}C`|Qs{Mk|J+~r>|o,wHv>Vw}!c{H!|Gb|*Ca5}J||,U{t+{CN[!M65YXOY_*B,Y[Z9XaX[QYJYLXPYuZ%XcZ8LY[SYPYKZM<LMYG9OYqSQYM~[e{UJXmQYyZM_)>YjN1~[f3{aXFY|Yk:48YdH^NZ0|T){jVFYTZNFY^YTYN~[h{nPYMYn3I]`EYUYsYIZEYJ7Yw)YnXPQYH+Z.ZAZY]^Z1Y`YSZFZyGYHXLYG 8Yd#4~[i|+)YH9D?Y^F~Y7|-eYxZ^WHYdYfZQ~[j|3>~[k|3oYmYqY^XYYO=Z*4[]Z/OYLXhZ1YLZIXgYIHYEYK,<Y`YEXIGZI[3YOYcB4SZ!YHZ*&Y{Xi3~[l|JSY`Zz?Z,~[m|O=Yi>??XnYWXmYS617YVYIHZ(Z4[~L4/=~[n|Yu{P)|];YOHHZ}~[o33|a>~[r|aE]DH~[s|e$Zz~[t|kZFY~XhYXZB[`Y}~[u|{SZ&OYkYQYuZ2Zf8D~[v}% ~[w3},Q[X]+YGYeYPIS~[y}4aZ!YN^!6PZ*~[z}?E~[{3}CnZ=~[}}EdDZz/9A3(3S<,YR8.D=*XgYPYcXN3Z5 4)~[~}JW=$Yu.XX~] }KDX`PXdZ4XfYpTJLY[F5]X~[2Yp}U+DZJ::<446[m@~]#3}]1~]%}^LZwZQ5Z`/OT<Yh^ -~]&}jx[ ~m<z!%2+~ly4VY-~o>}p62yz!%2+Xf2+~ly4VY-zQ`z (=] 2z~o2",C={" ":0,"!":1},c=34,i=2,p,s="",u=String.fromCharCode,t=u(12539);while(++c<127)C[u(c)]=c^39&&c^92?i++:0;i=0;while(0<=(c=C[a.charAt(i++)]))if(16==c)if((c=C[a.charAt(i++)])<87){if(86==c)c=1879;while(c--)s+=u(++p)}else s+=s.substr(8272,360);else if(c<86)s+=u(p+=c<51?c-16:(c-55)*92+C[a.charAt(i++)]);else if((c=((c-86)*92+C[a.charAt(i++)])*92+C[a.charAt(i++)])<49152)s+=u(p=c<40960?c:c|57344);else{c&=511;while(c--)s+=t;p=12539}return s')(),h=f.substring(0,8836)},function(e,t,n){"use strict";t.a=File},function(e,t,n){"use strict";t.a=FileReader},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(27),o=n(28),i=n(29);function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=s.prototype:(null===e&&(e=new s(t)),e.length=t),e}function s(e,t,n){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);s.TYPED_ARRAY_SUPPORT?(e=t).__proto__=s.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!s.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),o=(e=u(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(s.isBuffer(t)){var n=0|y(t.length);return 0===(e=u(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?u(e,0):h(e,t);if("Buffer"===t.type&&i(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(c(t),e=u(e,t<0?0:0|y(t)),!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|y(t.length);e=u(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function y(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(s.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function d(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:_(e,t,n,r,o);if("number"==typeof t)return t&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,r,o){var i,a=1,u=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,u/=2,s/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var c=-1;for(i=n;i<u;i++)if(l(e,i)===l(t,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===s)return c*a}else-1!==c&&(i-=i-c),c=-1}else for(n+s>u&&(n=u-s),i=n;i>=0;i--){for(var f=!0,h=0;h<s;h++)if(l(e,i+h)!==l(t,h)){f=!1;break}if(f)return i}return-1}function g(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[n+a]=u}return a}function v(e,t,n,r){return z(U(t,e.length-n),e,n,r)}function b(e,t,n,r){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return b(e,t,n,r)}function w(e,t,n,r){return z(V(t),e,n,r)}function T(e,t,n,r){return z(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,u,s,l=e[o],c=null,f=l>239?4:l>223?3:l>191?2:1;if(o+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(i=e[o+1]))&&(s=(31&l)<<6|63&i)>127&&(c=s);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(s=(15&l)<<12|(63&i)<<6|63&a)>2047&&(s<55296||s>57343)&&(c=s);break;case 4:i=e[o+1],a=e[o+2],u=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&u)&&(s=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&u)>65535&&s<1114112&&(c=s)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),o+=f}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=s,t.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},t.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),s.poolSize=8192,s._augment=function(e){return e.__proto__=s.prototype,e},s.from=function(e,t,n){return l(null,e,t,n)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?u(e,t):void 0!==n?"string"==typeof r?u(e,t).fill(n,r):u(e,t).fill(n):u(e,t)}(null,e,t,n)},s.allocUnsafe=function(e){return f(null,e)},s.allocUnsafeSlow=function(e){return f(null,e)},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=s.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},s.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},s.prototype.compare=function(e,t,n,r,o){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(i,a),l=this.slice(r,o),c=e.slice(t,n),f=0;f<u;++f)if(l[f]!==c[f]){i=l[f],a=c[f];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return d(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return d(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return S(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function x(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=L(e[i]);return o}function A(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,o,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function F(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function I(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,i){return i||I(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,i){return i||I(e,0,n,8),o.write(e,t,n,r,52,8),n+8}s.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),s.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=s.prototype;else{var o=t-e;n=new s(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},s.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},s.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},s.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),o.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),o.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),o.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),o.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=0,a=1,u=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=n-1,a=1,u=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},s.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!s.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=s.isBuffer(e)?e:U(new s(e,r).toString()),u=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%u]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function L(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function V(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(26))},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return g});var r=n(18),o=(n(20),n(14)),i=n(15),a=n(22),u=n(0);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}var m=new Map,d=Symbol("loading"),_=function(){function e(t,n){h(this,e),this._unarchiver=t,this._value=n}return p(e,[{key:"value",get:function(){return this._value}},{key:"obj",get:function(){return this._unarchiver._parsedObj.$objects[this._value]}}]),e}(),g=function(t){function n(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;return h(this,n),(e=l(this,c(n).call(this)))._requiresSecureCoding=!1,e.delegate=null,e._decodingFailurePolicy=null,e._reader=null,e._offsetSize=0,e._objCount=0,e._offsetArray=[],e._parsedObj={},e._dataObj=[],e._resolveFunctions=[],e._filePath=null,e._refObj=null,e._decodingFinished=!1,e._options=r,e._promises=[],null!==t&&(e._reader=new a.a(t,!0,"utf8"),e._checkHeader(),e._parsedObj=e._parseBPlist()),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,r["a"]),p(n,[{key:"copy",value:function(){var e=new n;return e._requiresSecureCoding=this._requiresSecureCoding,e.delegate=this.delegate,e._decodingFailurePolicy=this._decodingFailurePolicy,e._reader=this._reader,e._offsetSize=this._offsetSize,e._objCount=this._objCount,e._offsetArray=this._offsetArray,e._parsedObj=this._parsedObj,e._dataObj=this._dataObj,e._resolveFunctions=this._resolveFunctions,e._filePath=this._filePath,e._refObj=this._refObj,e._decodingFinished=this._decodingFinished,e}},{key:"_checkHeader",value:function(){this._reader.seek(0);var e=this._reader.readString(8);if("bplist00"!==e)throw new Error("unsupported file format: ".concat(e))}},{key:"_parseBPlist",value:function(){var e=this._reader;e.seek(-26);e.length;var t=e.readUnsignedByte();this._offsetSize=e.readUnsignedByte(),this._objCount=e.readUnsignedLongLong();var n=e.readUnsignedLongLong(),r=e.readUnsignedLongLong();this._offsetArray=[];var o=r;e.seek(o);for(var i=this._objCount,a=0;a<i;a++){var u=e.readInteger(t);this._offsetArray.push(u)}return this._parseObjAtIndex(n)}},{key:"_parseObjAtIndex",value:function(e){return this._parseObj(this._offsetArray[e])}},{key:"_parseObj",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._reader;null!==t&&r.seek(t);var o=r.readUnsignedByte(),i=240&o,a=15&o;if(0===i){if(0===a)return null;if(8===a)return!1;if(9===a)return!0}else{if(16===i){var u=Math.pow(2,a);return r.readInteger(u,n)}if(32===i){var s=Math.pow(2,a);if(4===s)return r.readFloat();if(8===s)return r.readDouble();throw new Error("unsupported float size: ".concat(s))}if(48===i);else{if(64===i){var l=this._getDataSize(a);return r.readData(l)}if(80===i){var c=this._getDataSize(a);return r.readString(c,"ascii")}if(96===i){var f=this._getDataSize(a);return r.readString(f,"utf16be")}if(128===i){var h=r.readInteger(a+1,!1);return new _(this,h)}if(160===i){for(var y=this._getDataSize(a),p=[],m=0;m<y;m++)p.push(r.readInteger(this._offsetSize,!1));return p.map(function(t){return e._parseObjAtIndex(t)})}if(192===i){for(var d=this._getDataSize(a),g=[],v=0;v<d;v++)g.push(r.readInteger(this._offsetSize,!1));var b=g.map(function(t){return e._parseObjAtIndex(t)});return new Set(b)}if(208===i){for(var S=this._getDataSize(a),w=[],T=[],k=0;k<S;k++)w.push(r.readInteger(this._offsetSize,!1));for(var O=0;O<S;O++)T.push(r.readInteger(this._offsetSize,!1));for(var C={},x=0;x<S;x++){var E=this._parseObjAtIndex(w[x]),P=this._parseObjAtIndex(T[x]);C[E]=P}return C}}}throw new Error("unknown data type: ".concat(o))}},{key:"_getDataSize",value:function(e){var t=0;if(15!==e)t=e;else if("number"!=typeof(t=this._parseObj(null,!1)))throw new Error("data size must be int type");return t}},{key:"_parseClassAt",value:function(e){var t=this,n=this._parsedObj.$objects[e];if(this._dataObj[e]===d)return new Promise(function(n,r){void 0===t._resolveFunctions[e]&&(t._resolveFunctions[e]=[]),t._resolveFunctions[e].push(n)});if(void 0!==this._dataObj[e])return this._dataObj[e];this._dataObj[e]=d;var r=this._parseClass(n);return this._dataObj[e]=r,Array.isArray(this._resolveFunctions[e])&&(this._resolveFunctions[e].forEach(function(e){e(r)}),delete this._resolveFunctions[e]),r}},{key:"_parseClass",value:function(e){var t=e.$class.obj.$classname,r=n.classForClassName(t);if(r){var o=this.copy();return o._refObj=e,r.initWithCoder(o)}return null}},{key:"_parseStruct",value:function(e,t){if("function"!=typeof t._initWithData)throw new Error("".concat(t.prototype.constructor.name," class doesn't have _initWithData function"));return t._initWithData(e)}},{key:"containsValueForKey",value:function(e){return void 0!==this._refObj[e]}},{key:"decodeBoolForKey",value:function(e){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));var t=this._getValueForKey(e);return Boolean(t)}},{key:"decodeBytesForKeyReturnedLength",value:function(e,t){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));return this._getValueForKey(e)}},{key:"decodeDoubleForKey",value:function(e){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));return this._getValueForKey(e)}},{key:"decodeFloatForKey",value:function(e){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));return this._getValueForKey(e)}},{key:"decodeCIntForKey",value:function(e){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));return this._getValueForKey(e)}},{key:"decodeInt32ForKey",value:function(e){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));return this._getValueForKey(e)}},{key:"decodeInt64ForKey",value:function(e){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));return this._getValueForKey(e)}},{key:"decodeObjectForKey",value:function(e,t){if(this._decodingFinished)throw new Error("can't decode '".concat(e,"' after finishDecoding() is called"));var n=this._refObj[e];if("string"==typeof n)return n;if(n instanceof _){var r=n.obj;return void 0!==r.$class?this._parseClassAt(n.value,t):r}throw new Error("unknown data type for key ".concat(e,": ").concat(n))}},{key:"decodePropertyListForKey",value:function(t,r){if(this._decodingFinished)throw new Error("can't decode '".concat(t,"' after finishDecoding() is called"));var o=this.decodeObjectForKey(t,r);if(!(o instanceof e))throw new Error("propertylist of key ".concat(t," is not Buffer data"));return n.unarchiveObjectWithData(o,this._filePath,r)}},{key:"decodeObjectOfTypeForKey",value:function(t,n){if(this._decodingFinished)throw new Error("can't decode '".concat(n,"' after finishDecoding() is called"));var r=this._refObj[n];if(!(r instanceof e))throw new Error("value is not Buffer data for key: ".concat(n));return this._parseStruct(r,t)}},{key:"finishDecoding",value:function(){this._decodingFinished=!0}},{key:"_getValueForKey",value:function(e){var t=this._refObj[e];return t instanceof _?t.obj:t}},{key:"_fileName",get:function(){return null===this._filePath?null:this._filePath.split("/").pop()}},{key:"_directoryPath",get:function(){if(null===this._filePath)return null;var e=this._filePath.split("/");e.pop();return e.join("/")+"/"}}],[{key:"unarchiveObjectWithData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new n(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map);r._filePath=t;var o=r._parsedObj.$top.root.value;return r._parseClassAt(o)}},{key:"_getBufferOfFile",value:function(e,t){return new Promise(function(t,n){var r=new o.a([],e),a=new i.a;a.onload=function(){var e=a.result;t(e)},a.onerror=function(){n(a.error)},a.readAsBinaryString(r)})}},{key:"unarchiveObjectWithFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;return n._getBufferOfFile(e,t).then(function(r){return n.unarchiveObjectWithData(r,e,t)})}},{key:"setClassForClassName",value:function(e,t){m.set(t,e)}},{key:"classForClassName",value:function(e){var t=m.get(e);return t||u.a.get(e)}},{key:"unarchiveTopLevelObjectWithData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;return n.unarchiveObjectWithData(e,t,r)}}]),n}()}).call(this,n(16).Buffer)},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(2);n(6),n(11),n(7),n(21);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l={raiseException:Symbol("raiseException"),setErrorAndReturn:Symbol("setErrorAndReturn")},c=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=a(this,u(t).call(this)))._allowsKeyedCoding=!1,e._requiresSecureCoding=!1,e._allowedClasses=null,e._systemVersion=0,e._decodingFailurePolicy=null,e._error=null,e}var n,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,r["a"]),n=t,c=[{key:"DecodingFailurePolicy",get:function(){return l}}],(o=[{key:"containsValueForKey",value:function(e){return!1}},{key:"encodeArrayOfObjCTypeAt",value:function(e,t,n){}},{key:"encodeForKey",value:function(e,t){}},{key:"encodeBycopyObject",value:function(e){}},{key:"encodeByrefObject",value:function(e){}},{key:"encodeBytes",value:function(e,t){}},{key:"encodeBytesLengthForKey",value:function(e,t,n){}},{key:"encodeConditionalObject",value:function(e){}},{key:"encodeConditionalObjectForKey",value:function(e,t){}},{key:"encode",value:function(e){}},{key:"encodeCIntForKey",value:function(e,t){}},{key:"encodePropertyList",value:function(e){}},{key:"encodeRootObject",value:function(e){}},{key:"encodeValueOfObjCTypeAt",value:function(e,t){}},{key:"decodeArrayOfObjCTypeAt",value:function(e,t,n){}},{key:"decodeBoolForKey",value:function(e){return!1}},{key:"decodeBytesForKeyReturnedLength",value:function(e,t){return null}},{key:"decodeBytesWithReturnedLength",value:function(e){return null}},{key:"decodeData",value:function(){return null}},{key:"decodeDoubleForKey",value:function(e){return 0}},{key:"decodeFloatForKey",value:function(e){return 0}},{key:"decodeCIntForKey",value:function(e){return 0}},{key:"decodeIntegerForKey",value:function(e){return 0}},{key:"decodeInt32ForKey",value:function(e){return 0}},{key:"decodeInt64ForKey",value:function(e){return null}},{key:"decodeObject",value:function(){return null}},{key:"decodeObjectForKey",value:function(e){return null}},{key:"decodePoint",value:function(){return null}},{key:"decodePointForKey",value:function(e){return null}},{key:"decodePropertyList",value:function(){return null}},{key:"decodeRect",value:function(){return null}},{key:"decodeRectForKey",value:function(e){return null}},{key:"decodeSize",value:function(){return null}},{key:"decodeSizeForKey",value:function(e){return null}},{key:"decodeValueOfObjCTypeAt",value:function(e,t){}},{key:"decodePropertyListForKey",value:function(e){return null}},{key:"decodeCGPointForKey",value:function(e){return null}},{key:"decodeCGRectForKey",value:function(e){return null}},{key:"decodeCGSizeForKey",value:function(e){return null}},{key:"decodeCGAffineTransformForKey",value:function(e){return null}},{key:"decodeUIEdgeInsetsForKey",value:function(e){return null}},{key:"decodeUIOffsetForKey",value:function(e){return null}},{key:"decodeCGVectorForKey",value:function(e){return null}},{key:"decodeTimeForKey",value:function(e){return null}},{key:"decodeTimeRangeForKey",value:function(e){return null}},{key:"decodeTimeMappingForKey",value:function(e){return null}},{key:"versionForClassName",value:function(e){return 0}},{key:"decodeObjectOfClassForKey",value:function(e,t){return null}},{key:"decodeTopLevelObject",value:function(){}},{key:"decodeTopLevelObjectForKey",value:function(e){}},{key:"decodeTopLevelObjectOfForKey",value:function(e,t){}},{key:"failWithError",value:function(e){}},{key:"allowsKeyedCoding",get:function(){return this._allowsKeyedCoding}},{key:"requiresSecureCoding",get:function(){return this._requiresSecureCoding}},{key:"allowedClasses",get:function(){return this._allowedClasses}},{key:"systemVersion",get:function(){return this._systemVersion}},{key:"decodingFailurePolicy",get:function(){return this._decodingFailurePolicy}},{key:"error",get:function(){return this._error}}])&&i(n.prototype,o),c&&i(n,c),t}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return l});var r=n(13);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=new RegExp(/^(-|\+)?\d+;?/),a=new RegExp(/^(-|\+)?(\d)*\.(\d)*;?/),u=new RegExp(/^\w+/),s=new RegExp(/^.*\n/),l=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._pos=0,this._partialText="",this._partialOffset=0,this._partialStep=200,this._partialMinLength=100,this._eof=!0,this.buffer=null,this.buffer=n instanceof e?n:e.from(n),this.encoding=r,this._addPartialText()}var n,l,c;return n=t,(l=[{key:"skip",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._moveIndex(e),t||this._check()}},{key:"readString",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=this._partialText.substring(0,e);this._moveIndex(t.length)}},{key:"readInteger",value:function(e,t){var n=this._getString(i);return parseInt(n[0],10)}},{key:"readUnsignedByte",value:function(){return this.readInteger(1,!1)}},{key:"readUnsignedShort",value:function(){return this.readInteger(2,!1)}},{key:"readUnsignedInt",value:function(){return this.readInteger(4,!1)}},{key:"readInt",value:function(){return this.readInteger(4,!0)}},{key:"readFloat",value:function(){var e=this._getString(a);return parseFloat(e[0])}},{key:"readDouble",value:function(){return this.readFloat()}},{key:"readData",value:function(e){var t=this._pos;return this._pos+=e,this.buffer.slice(t,this._pos)}},{key:"readWord",value:function(){var e=this._getString(u);return null!==e?e[0]:null}},{key:"readLine",value:function(){var e=this._getString(s);return null!==e?e[0]:null}},{key:"readPattern",value:function(e){return this._getString(e)}},{key:"_check",value:function(){}},{key:"_escapeLE",value:function(e,t){for(var n=e.length,r="",o=0;o<n;o++){var i=e.charCodeAt(o);if(0===i)break;r+=i<16?"%0"+i.toString(16):"%"+i.toString(16)}return r}},{key:"_escapeBE",value:function(e,t){for(var n=e.length,r="",o=0;o<n;o++){var i=e.charCodeAt(o);if(0===i)break;var a="";a=i<16?"%0"+i.toString(16):"%"+i.toString(16),o++;var u=e.charCodeAt(o);if(0===u)break;r+=a+(u<16?"%0"+u.toString(16):"%"+u.toString(16))}return r}},{key:"_convert",value:function(e,t){var n="";if(n="utf16be"===t?this._escapeBE(e):this._escapeLE(e),"sjis"===t)return Object(r.d)(n);if("euc-jp"===t)return Object(r.a)(n);if("jis-7"===t)return Object(r.b)(n);if("jis-8"===t)return Object(r.c)(n);if("unicode"===t)return Object(r.h)(n);if("utf7"===t)return Object(r.f)(n);if("utf-8"===t)return Object(r.g)(n);if("utf-16"===t)return Object(r.e)(n);if("utf16be"===t)return Object(r.e)(n);throw new Error("unsupported encoding: ".concat(t))}},{key:"getAvailableDataLength",value:function(){return this.buffer.length-this._pos}},{key:"_moveIndex",value:function(e){this._partialText=this._partialText.substring(e),this._partialText.length<this._partialMinLength&&this._addPartialText()}},{key:"_skipSpace",value:function(){for(var e=0,t=this._partialText.charCodeAt(e);32===t||9<=t&&t<=13;)e++,t=this._partialText.charCodeAt(e),e>=this._partialText.length&&this._addPartialText();e>0&&this._moveIndex(e)}},{key:"_addPartialText",value:function(){if(!(this._partialOffset>=this.buffer.length)){var t=this._partialOffset+this._partialStep;if(t>this.buffer.length&&(t=this.buffer.length),e.isEncoding(this.encoding))this._partialText+=this.buffer.toString(this.encoding,this._partialOffset,t);else{var n=this.buffer.toString("binary",this._partialOffset,t);this._partialText+=this._convert(n,this.encoding)}this._partialOffset=t}}},{key:"_getString",value:function(e){this._skipSpace();var t=this._partialText.match(e);return null===t?null:(this._moveIndex(t[0].length),t)}}])&&o(n.prototype,l),c&&o(n,c),t}()}).call(this,n(16).Buffer)},function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(2);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,u(t).apply(this,arguments))}var n,o,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,r["a"]),n=t,l=[{key:"initWithCoder",value:function(e){var t=e.decodeBytesForKeyReturnedLength("NS.data",null);if(void 0!==t)return t;var n=e.decodeBytesForKeyReturnedLength("NS.bytes",null);return void 0!==n?n:null}}],(o=null)&&i(n.prototype,o),l&&i(n,l),t}()},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return o});var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dx=t,this._dy=n}var t,n,o;return t=e,(n=[{key:"zero",get:function(){return new e}}])&&r(t.prototype,n),o&&r(t,o),e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return i});var r=n(13);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._pos=0,this._eof=!0,this.buffer=null,this.buffer=n instanceof e?n:"string"==typeof n?e.from(n,"binary"):e.from(n),this.bigEndian=r,this.encoding=o}var n,i,a;return n=t,(i=[{key:"skip",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._pos+=e,t||this._check()}},{key:"seek",value:function(e){this._pos=e<0?this.buffer.length+e:e,this._pos<0?this._pos=0:this._pos>this.buffer.length&&(this._pos=this.buffer.length)}},{key:"readString",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._pos;this._pos+=t;var o=n||this.encoding||"sjis";if(e.isEncoding(o))return this.buffer.toString(o,r,this._pos);var i=this.buffer.toString("binary",r,this._pos);return this._convert(i,o)}},{key:"readInteger",value:function(e,t){var n=this._pos;return this._pos+=e,this.bigEndian?t?this.buffer.readIntBE(n,e):this.buffer.readUIntBE(n,e):t?this.buffer.readIntLE(n,e):this.buffer.readUIntLE(n,e)}},{key:"readUnsignedByte",value:function(){return this.readInteger(1,!1)}},{key:"readUnsignedShort",value:function(){return this.readInteger(2,!1)}},{key:"readUnsignedInt",value:function(){return this.readInteger(4,!1)}},{key:"readUnsignedLongLong",value:function(){return this.readInteger(8,!1)}},{key:"readByte",value:function(){return this.readInteger(1,!0)}},{key:"readShort",value:function(){return this.readInteger(2,!0)}},{key:"readInt",value:function(){return this.readInteger(4,!0)}},{key:"readLongLong",value:function(){return this.readInteger(8,!0)}},{key:"readFloat",value:function(){var e=this._pos;return this._pos+=4,this.bigEndian?this.buffer.readFloatBE(e):this.buffer.readFloatLE(e)}},{key:"readDouble",value:function(){var e=this._pos;return this._pos+=8,this.bigEndian?this.buffer.readDoubleBE(e):this.buffer.readDoubleLE(e)}},{key:"readData",value:function(e){var t=this._pos;return this._pos+=e,this.buffer.slice(t,this._pos)}},{key:"_check",value:function(){if(this._pos>=this.buffer.length)throw new Error("_BinaryReader: buffer out of range (".concat(this._pos," >= ").concat(this.buffer.length,")"))}},{key:"_escapeLE",value:function(e,t){for(var n=e.length,r="",o=0;o<n;o++){var i=e.charCodeAt(o);if(0===i)break;r+=i<16?"%0"+i.toString(16):"%"+i.toString(16)}return r}},{key:"_escapeBE",value:function(e,t){for(var n=e.length,r="",o=0;o<n;o++){var i=e.charCodeAt(o);if(0===i)break;var a="";a=i<16?"%0"+i.toString(16):"%"+i.toString(16),o++;var u=e.charCodeAt(o);if(0===u)break;r+=a+(u<16?"%0"+u.toString(16):"%"+u.toString(16))}return r}},{key:"_convert",value:function(e,t){var n="";if(n="utf16be"===t?this._escapeBE(e):this._escapeLE(e),"sjis"===t)return Object(r.d)(n);if("euc-jp"===t)return Object(r.a)(n);if("jis-7"===t)return Object(r.b)(n);if("jis-8"===t)return Object(r.c)(n);if("unicode"===t)return Object(r.h)(n);if("utf7"===t)return Object(r.f)(n);if("utf-8"===t)return Object(r.g)(n);if("utf-16"===t)return Object(r.e)(n);if("utf16be"===t)return Object(r.e)(n);throw new Error("unsupported encoding: ".concat(t))}},{key:"getAvailableDataLength",value:function(){return this.buffer.length-this._pos}},{key:"length",get:function(){return this.buffer.length}}])&&o(n.prototype,i),a&&o(n,a),t}()}).call(this,n(16).Buffer)},function(e,t,n){"use strict";var o=function(e,t){this.bigEndian=e,this.allowExceptions=t};t.a=o;var i=o.prototype;i.encodeFloat=function(e,t,n){var o,i,a,u,s,l=Math.pow(2,n-1)-1,c=1-l,f=l,h=c-t,y=isNaN(g=parseFloat(e))||g==-1/0||g==1/0?g:0,p=0,m=2*l+1+t+3,d=new Array(m),_=(g=0!==y?0:g)<0,g=Math.abs(g),v=Math.floor(g),b=g-v;for(o=m;o;d[--o]=0);for(o=l+2;v&&o;d[--o]=v%2,v=Math.floor(v/2));for(o=l+1;b>0&&o;(d[++o]=((b*=2)>=1)-0)&&--b);for(o=-1;++o<m&&!d[o];);if(d[(i=t-1+(o=(p=l+1-o)>=c&&p<=f?o+1:l+1-(p=c-1)))+1]){if(!(a=d[i]))for(u=i+2;!a&&u<m;a=d[u++]);for(u=i+1;a&&--u>=0;(d[u]=!d[u]-0)&&(a=0));}for(o=o-2<0?-1:o-3;++o<m&&!d[o];);for((p=l+1-o)>=c&&p<=f?++o:p<c&&(p!=l+1-m&&p<h&&this.warn("encodeFloat::float underflow"),o=l+1-(p=c-1)),(v||0!==y)&&(this.warn(v?"encodeFloat::float overflow":"encodeFloat::"+y),p=f+1,o=l+2,y==-1/0?_=1:isNaN(y)&&(d[o]=1)),g=Math.abs(p+l),u=n+1,s="";--u;s=g%2+s,g=g>>=1);for(g=0,u=0,o=(s=(_?"1":"0")+s+d.slice(o,o+t).join("")).length,r=[];o;g+=(1<<u)*s.charAt(--o),7==u&&(r[r.length]=String.fromCharCode(g),g=0),u=(u+1)%8);return r[r.length]=g?String.fromCharCode(g):"",(this.bigEndian?r.reverse():r).join("")},i.encodeInt=function(e,t,n){var r=Math.pow(2,t),o=[];for((e>=r||e<-(r>>1))&&this.warn("encodeInt::overflow")&&(e=0),e<0&&(e+=r);e;o[o.length]=String.fromCharCode(e%256),e=Math.floor(e/256));for(t=-(-t>>3)-o.length;t--;o[o.length]="\0");return(this.bigEndian?o.reverse():o).join("")},i.decodeFloat=function(e,t,n){var r,o,i,a=((a=new this.Buffer(this.bigEndian,e)).checkBuffer(t+n+1),a),u=Math.pow(2,n-1)-1,s=a.readBits(t+n,1),l=a.readBits(t,n),c=0,f=2,h=a.buffer.length+(-t>>3)-1;do{for(r=a.buffer[++h],i=1<<(o=t%8||8);i>>=1;r&i&&(c+=1/f),f*=2);}while(t-=o);return l==1+(u<<1)?c?NaN:s?-1/0:1/0:(1+-2*s)*(l||c?l?Math.pow(2,l-u)*(1+c):Math.pow(2,1-u)*c:0)},i.decodeInt=function(e,t,n){var r=new this.Buffer(this.bigEndian,e).readBits(0,t),o=Math.pow(2,t);return n&&r>=o/2?r-o:r};var a=(i.Buffer=function(e,t){this.bigEndian=e||0,this.buffer=[],this.setBuffer(t)}).prototype;a.readBits=function(e,t){function n(e,t){for(++t;--t;e=1073741824==(1073741824&(e%=2147483648))?2*e:2*(e-1073741824)+2147483647+1);return e}if(e<0||t<=0)return 0;this.checkBuffer(e+t);for(var r,o=e%8,i=this.buffer.length-(e>>3)-1,a=this.buffer.length+(-(e+t)>>3),u=i-a,s=(this.buffer[i]>>o&(1<<(u?8-o:t))-1)+(u&&(r=(e+t)%8)?(this.buffer[a++]&(1<<r)-1)<<(u--<<3)-o:0);u;s+=n(this.buffer[a++],(u--<<3)-o));return s},a.setBuffer=function(e){if(e){for(var t,n=t=e.length,r=this.buffer=new Array(t);n;r[t-n]=e.charCodeAt(--n));this.bigEndian&&r.reverse()}},a.hasNeededBits=function(e){return this.buffer.length>=-(-e>>3)},a.checkBuffer=function(e){if(!this.hasNeededBits(e))throw new Error("checkBuffer::missing bytes")},i.warn=function(e){if(this.allowExceptions)throw new Error(e);return 1},i.toSmall=function(e){return this.decodeInt(e,8,!0)},i.fromSmall=function(e){return this.encodeInt(e,8,!0)},i.toByte=function(e){return this.decodeInt(e,8,!1)},i.fromByte=function(e){return this.encodeInt(e,8,!1)},i.toShort=function(e){return this.decodeInt(e,16,!0)},i.fromShort=function(e){return this.encodeInt(e,16,!0)},i.toWord=function(e){return this.decodeInt(e,16,!1)},i.fromWord=function(e){return this.encodeInt(e,16,!1)},i.toInt=function(e){return this.decodeInt(e,32,!0)},i.fromInt=function(e){return this.encodeInt(e,32,!0)},i.toDWord=function(e){return this.decodeInt(e,32,!1)},i.fromDWord=function(e){return this.encodeInt(e,32,!1)},i.toFloat=function(e){return this.decodeFloat(e,23,8)},i.fromFloat=function(e){return this.encodeFloat(e,23,8)},i.toDouble=function(e){return this.decodeFloat(e,52,11)},i.fromDouble=function(e){return this.encodeFloat(e,52,11)}},function(e,t,n){"use strict";(function(e){var r=n(23),o=n(13);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=["ascii","utf8","utf16le","utf16be","ucs2","base64","latin1","binary","hex"],u=null;if(void 0!==e)u=e;else{var s=new r.a(!0,!0),l=new r.a(!1,!0);u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data=null}var t,n,r;return t=e,r=[{key:"from",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=new e;if(Array.isArray(t)){var i=new ArrayBuffer(t);o._data=new DataView(i.buffer,n,r)}else t instanceof ArrayBuffer?o._data=new DataView(t,n,r):t.buffer instanceof ArrayBuffer&&(o._data=new DataView(t.buffer,n,r));if(null===o._data)throw new Error("Buffer.from: unsupported data type: ".concat(t));return o}},{key:"isEncoding",value:function(e){return a.indexOf(e)>=0}}],(n=[{key:"readIntBE",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(t){case 1:return this.readInt8(e,n);case 2:return this.readInt16BE(e,n);case 4:return this.readInt32BE(e,n)}var r=this.slice(e,e+t)._data;return s.decodeInt(r,8*t,!0)}},{key:"readIntLE",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(t){case 1:return this.readInt8(e,n);case 2:return this.readInt16LE(e,n);case 4:return this.readInt32LE(e,n)}var r=this.slice(e,e+t)._data;return l.decodeInt(r,8*t,!0)}},{key:"readInt8",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getInt8(e)}},{key:"readInt16BE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getInt16(e,!1)}},{key:"readInt16LE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getInt16(e,!0)}},{key:"readInt32BE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getInt32(e,!1)}},{key:"readInt32LE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getInt32(e,!0)}},{key:"readUIntBE",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(t){case 1:return this.readUInt8(e,n);case 2:return this.readUInt16BE(e,n);case 4:return this.readUInt32BE(e,n)}var r=this.slice(e,e+t)._data;return s.decodeInt(r,8*t,!1)}},{key:"readUIntLE",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(t){case 1:return this.readUInt8(e,n);case 2:return this.readUInt16LE(e,n);case 4:return this.readUInt32LE(e,n)}var r=this.slice(e,e+t)._data;return l.decodeInt(r,8*t,!1)}},{key:"readUInt8",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getUint8(e)}},{key:"readUInt16BE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getUint16(e,!1)}},{key:"readUInt16LE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getUint16(e,!0)}},{key:"readUInt32BE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getUint32(e,!1)}},{key:"readUInt32LE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getUint32(e,!0)}},{key:"readFloatBE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getFloat32(e,!1)}},{key:"readFloatLE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getFloat32(e,!0)}},{key:"readDoubleBE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getFloat64(e,!1)}},{key:"readDoubleLE",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._data.getFloat64(e,!0)}},{key:"slice",value:function(t,n){return new e(this._data.buffer.slice(t,n))}},{key:"toString",value:function(t,n,r){if(!e.isEncoding(t))throw new Error("unsupported encoding: ".concat(t));var i=new Uint8Array(this._data.buffer);if("binary"===t)return String.fromCharCode.apply("",i);if("ascii"===t||"latin1"===t){var a=i.indexOf(0),u=i.slice(0,a);return String.fromCharCode.apply("",u)}if("hex"===t)return this._hex(i,!1);if("base64"===t){var s=String.fromCharCode.apply("",i);if("function"==typeof atob)return atob(s);throw new Error("needs atob() function to convert to base64")}var l="";if(l="utf16be"===t?this._hexBE(i,!0):this._hex(i,!0),"utf8"===t)return Object(o.g)(l);if("utf16le"===t||"utf16be"===t||"ucs2"===t)return Object(o.e)(l);throw new Error("unsupported encoding: ".concat(t))}},{key:"_hexBE",value:function(e,t){for(var n=e.length,r=[],o=0;o<n;o+=2){var i=e[o+1].toString(16);e[o+1]<16?r[o]="0"+i:r[o]=i;var a=e[o].toString(16);e[o]<16?r[o+1]="0"+a:r[o+1]=a}var u="";return t&&(u="%"),r.join(u)}},{key:"_hex",value:function(e,t){var n="";return t&&(n="%"),e.map(function(e){return e<16?"0"+e.toString(16):e.toString(16)}).join(n)}},{key:"length",get:function(){return this._data.byteLength}}])&&i(t.prototype,n),r&&i(t,r),e}()}t.a=u}).call(this,n(16).Buffer)},function(e,t){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";(function(t){var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o={noImage:0,colorMapped:1,RGB:2,blackAndWhite:3,runlengthColorMapped:9,runlengthRGB:10,compressedBlackAndWhite:11,compressedColorMapped:32,compressed4PassQTColorMapped:33},i=function(){function e(n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._buffer=n instanceof t?n:"string"==typeof n?t.from(n,"binary"):n?t.from(n):null,this._idLength=0,this._colorMapType=0,this._imageType=0,this._colorMapOrigin=0,this._colorMapLength=0,this._colorMapDepth=0,this._imageXOrigin=0,this._imageYOrigin=0,this._imageWidth=0,this._imageHeight=0,this._imageDepth=0,this._alphaDepth=0,this._leftToRight=!0,this._topToBottom=!1,this._interleave=!1,this._hasAlpha=!1,this._imageID=null,this._canvas=null,this._context=null,this._imageData=null,this._image=null,this._src=null,this.onload=null,this.onerror=null,this._resolveFunc=null,this._rejectFunc=null,this._didLoad=new Promise(function(e,t){r._resolveFunc=e,r._rejectFunc=t}),n&&this._parseData()}return n(e,[{key:"_loadURL",value:function(e){var n=this;this._src=e,this._requestBinaryFile(e).then(function(e){n._buffer=t.from(e),n._parseData()}).catch(function(e){n._reject(e)})}},{key:"_requestBinaryFile",value:function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="arraybuffer",r.onload=function(e){r.response?t(r.response):n(r)},r.onerror=function(e){n(e)},r.send(null)})}},{key:"_parseData",value:function(){this._readHeader(),this._readImageID(),this._initImage();var e=this._getImageData();switch(this._imageType){case o.noImage:break;case o.colorMapped:this._parseColorMapData(e);break;case o.RGB:this._parseRGBData(e);break;case o.blackAndWhite:this._parseBlackAndWhiteData(e);break;case o.runlengthColorMapped:this._parseColorMapData(e);break;case o.runlengthRGB:this._parseRGBData(e);break;case o.compressedBlackAndWhite:this._parseBlackAndWhiteData(e);break;case o.compressedColorMapped:case o.compressed4PassQTColorMapped:console.error("parser for compressed TGA is not implemeneted");break;default:throw new Error("unknown imageType: "+this._imageType)}this._setImage(),this._deleteBuffer()}},{key:"_readHeader",value:function(){this._idLength=this._buffer.readUIntLE(0,1),this._colorMapType=this._buffer.readUIntLE(1,1),this._imageType=this._buffer.readUIntLE(2,1),this._colorMapOrigin=this._buffer.readUIntLE(3,2),this._colorMapLength=this._buffer.readUIntLE(5,2),this._colorMapDepth=this._buffer.readUIntLE(7,1),this._imageXOrigin=this._buffer.readUIntLE(8,2),this._imageYOrigin=this._buffer.readUIntLE(10,2),this._imageWidth=this._buffer.readUIntLE(12,2),this._imageHeight=this._buffer.readUIntLE(14,2),this._imageDepth=this._buffer.readUIntLE(16,1);var e=this._buffer.readUIntLE(17,1);this._alphaDepth=15&e,this._leftToRight=0==(16&e),this._topToBottom=(32&e)>0,this._interleave=192&e}},{key:"_readImageID",value:function(){this._idLength>0&&(this._imageID=this._buffer.subarray(18,this._idLength))}},{key:"_initImage",value:function(){this._imageType!==o.noImage&&(this._imageWidth<=0||this._imageHeight<=0||(this._canvas=document.createElement("canvas"),this._canvas.width=this._imageWidth,this._canvas.height=this._imageHeight,this._context=this._canvas.getContext("2d"),this._imageData=this._context.createImageData(this._imageWidth,this._imageHeight)))}},{key:"_setImage",value:function(){var e=this;this._context.putImageData(this._imageData,0,0),this._image=new Image,this._image.width=this._imageWidth,this._image.height=this._imageHeight,this._image.onload=function(){e._resolve()},this._image.src=this._canvas.toDataURL()}},{key:"_deleteBuffer",value:function(){this._buffer&&(delete this._buffer,this._buffer=null),this._imageData&&(delete this._imageData,this._imageData=null)}},{key:"_parseColorMapData",value:function(e){if(24===this._colorMapDepth||16===this._colorMapDepth||15===this._colorMapDepth)this._hasAlpha=!1;else{if(32!==this._colorMapDepth)throw new Error("unknown colorMapDepth: "+this._colorMapDepth);this._hasAlpha=!0}for(var t=18+this._idLength,n=Math.ceil(this._colorMapDepth/8),r=(this._colorMapLength,[]),o=t,i=0;i<this._colorMapLength;i++){var a=this._getRGBA(this._buffer,o,this._colorMapDepth);r.push(a),o+=n}var u=this._imageData.data,s=0,l=0,c=1,f=1;this._leftToRight||(s=this._imageWidth-1,c=-1),this._topToBottom||(l=this._imageHeight-1,f=-1),o=0;for(var h=l,y=[255,255,255,255],p=0;p<this._imageHeight;p++){for(var m=s,d=0;d<this._imageWidth;d++){var _=4*(h*this._imageWidth+m),g=y,v=e[o]-this._colorMapOrigin;v>=0&&(g=r[v]),u[_]=g[0],u[_+1]=g[1],u[_+2]=g[2],u[_+3]=g[3],m+=c,o+=1}h+=f}}},{key:"_parseRGBData",value:function(e){if(24===this._imageDepth||16===this._imageDepth||15===this._imageDepth)this._hasAlpha=!1;else{if(32!==this._imageDepth)throw new Error("unknown imageDepth: "+this._imageDepth);this._hasAlpha=!0}var t=Math.ceil(this._imageDepth/8),n=this._imageData.data,r=0,o=0,i=1,a=1;this._leftToRight||(r=this._imageWidth-1,i=-1),this._topToBottom||(o=this._imageHeight-1,a=-1);for(var u=0,s=o,l=0;l<this._imageHeight;l++){for(var c=r,f=0;f<this._imageWidth;f++){var h=4*(s*this._imageWidth+c),y=this._getRGBA(e,u,this._imageDepth);n[h]=y[0],n[h+1]=y[1],n[h+2]=y[2],n[h+3]=y[3],c+=i,u+=t}s+=a}}},{key:"_getRGBA",value:function(e,t,n){if(15===n){return[(124&e[t+1])<<1,(3&e[t+1])<<6|(224&e[t])>>2,(31&e[t])<<3,255]}if(16===n){return[(124&e[t+1])<<1,(3&e[t+1])<<6|(224&e[t])>>2,(31&e[t])<<3,255]}if(24===n)return[e[t+2],e[t+1],e[t],255];if(32===n)return[e[t+2],e[t+1],e[t],e[t+3]];throw new Error("unsupported imageDepth: "+n)}},{key:"_parseBlackAndWhiteData",value:function(e){if(8==this._imageDepth)this._hasAlpha=!1;else{if(16!=this._imageDepth)throw new Error("unknown imageDepth: "+this._imageDepth);this._hasAlpha=!0}var t=this._imageDepth/8,n=this._imageData.data,r=0,o=0,i=1,a=1;this._leftToRight||(r=this._imageWidth-1,i=-1),this._topToBottom||(o=this._imageHeight-1,a=-1);var u=0;if(this._hasAlpha)for(var s=o,l=0;l<this._imageHeight;l++){for(var c=r,f=0;f<this._imageWidth;f++){var h=4*(s*this._imageWidth+c),y=e[u],p=e[u+1];n[h]=y,n[h+1]=y,n[h+2]=y,n[h+3]=p,c+=i,u+=t}s+=a}else for(var m=o,d=0;d<this._imageHeight;d++){for(var _=r,g=0;g<this._imageWidth;g++){var v=4*(m*this._imageWidth+_),b=e[u];n[v]=b,n[v+1]=b,n[v+2]=b,n[v+3]=255,_+=i,u+=t}m+=a}}},{key:"_getImageData",value:function(){var e=null;if(this._imageType!==o.none){var t=Math.ceil(this._colorMapDepth/8)*this._colorMapLength,n=18+this._idLength+t;e=this._buffer.subarray(n)}return this._imageType===o.runlengthColorMapped||this._imageType===o.runlengthRGB?e=this._decompressRunlengthData(e):this._imageType===o.compressedBlackAndWhite?e=this._decompressRunlengthData(e):this._imageType===o.compressedColorMapped?console.error("Compressed Color Mapped TGA Image data is not supported"):this._imageType===o.compressed4PassQTColorMapped&&console.error("Compressed Color Mapped TGA Image data is not supported"),e}},{key:"_decompressRunlengthData",value:function(e){for(var t=[],n=Math.ceil(this._imageDepth/8),o=n*this._imageWidth*this._imageHeight,i=0;t.length<o;){var a=e[i];if(i+=1,0!=(128&a)){var u=e.slice(i,i+n);i+=n;for(var s=1+(127&a),l=0;l<s;l++)t.push.apply(t,r(u))}else{var c=(a+1)*n;t.push.apply(t,r(e.slice(i,i+c))),i+=c}}return t}},{key:"_resolve",value:function(e){this.onload&&this.onload(e),this._resolveFunc(e)}},{key:"_reject",value:function(e){this.onerror&&this.onerror(e),this._rejectFunc(e)}},{key:"image",get:function(){return this._image}},{key:"canvas",get:function(){return this._canvas}},{key:"didLoad",get:function(){return this._didLoad}},{key:"src",get:function(){return this._src},set:function(e){this._loadURL(e)}}],[{key:"imageWithData",value:function(t){return new e(t)}},{key:"imageWithURL",value:function(t){var n=new e;return n._loadURL(t),n}}]),e}();e.exports=i}).call(t,n(1).Buffer)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(3),o=n(4),i=n(5);function a(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=s.prototype:(null===e&&(e=new s(t)),e.length=t),e}function s(e,t,n){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);s.TYPED_ARRAY_SUPPORT?(e=t).__proto__=s.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!s.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),o=(e=u(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(s.isBuffer(t)){var n=0|y(t.length);return 0===(e=u(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?u(e,0):h(e,t);if("Buffer"===t.type&&i(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(c(t),e=u(e,t<0?0:0|y(t)),!s.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|y(t.length);e=u(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function y(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(s.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function d(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:_(e,t,n,r,o);if("number"==typeof t)return t&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):_(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function _(e,t,n,r,o){var i,a=1,u=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,u/=2,s/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var c=-1;for(i=n;i<u;i++)if(l(e,i)===l(t,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===s)return c*a}else-1!==c&&(i-=i-c),c=-1}else for(n+s>u&&(n=u-s),i=n;i>=0;i--){for(var f=!0,h=0;h<s;h++)if(l(e,i+h)!==l(t,h)){f=!1;break}if(f)return i}return-1}function g(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var u=parseInt(t.substr(2*a,2),16);if(isNaN(u))return a;e[n+a]=u}return a}function v(e,t,n,r){return z(U(t,e.length-n),e,n,r)}function b(e,t,n,r){return z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return b(e,t,n,r)}function w(e,t,n,r){return z(V(t),e,n,r)}function T(e,t,n,r){return z(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,u,s,l=e[o],c=null,f=l>239?4:l>223?3:l>191?2:1;if(o+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(i=e[o+1]))&&(s=(31&l)<<6|63&i)>127&&(c=s);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(s=(15&l)<<12|(63&i)<<6|63&a)>2047&&(s<55296||s>57343)&&(c=s);break;case 4:i=e[o+1],a=e[o+2],u=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&u)&&(s=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&u)>65535&&s<1114112&&(c=s)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),o+=f}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=s,t.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},t.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),s.poolSize=8192,s._augment=function(e){return e.__proto__=s.prototype,e},s.from=function(e,t,n){return l(null,e,t,n)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?u(e,t):void 0!==n?"string"==typeof r?u(e,t).fill(n,r):u(e,t).fill(n):u(e,t)}(null,e,t,n)},s.allocUnsafe=function(e){return f(null,e)},s.allocUnsafeSlow=function(e){return f(null,e)},s.isBuffer=function(e){return!(null==e||!e._isBuffer)},s.compare=function(e,t){if(!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=s.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!s.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},s.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},s.prototype.compare=function(e,t,n,r,o){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),u=Math.min(i,a),l=this.slice(r,o),c=e.slice(t,n),f=0;f<u;++f)if(l[f]!==c[f]){i=l[f],a=c[f];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return d(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return d(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return S(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function x(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=L(e[i]);return o}function A(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,o,i){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function F(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function I(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,i){return i||I(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,i){return i||I(e,0,n,8),o.write(e,t,n,r,52,8),n+8}s.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),s.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=s.prototype;else{var o=t-e;n=new s(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},s.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},s.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},s.prototype.readUInt8=function(e,t){return t||N(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return t||N(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return t||N(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||N(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){t||N(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){t||N(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return t||N(e,4,this.length),o.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return t||N(e,4,this.length),o.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return t||N(e,8,this.length),o.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return t||N(e,8,this.length),o.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=0,a=1,u=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var i=n-1,a=1,u=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/a>>0)-u&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),s.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),s.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},s.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!s.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=s.isBuffer(e)?e:U(new s(e,r).toString()),u=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%u]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function L(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function V(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(t,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){return 3*e.length/4-l(e)},t.toByteArray=function(e){var t,n,r,a,u,s=e.length;a=l(e),u=new i(3*s/4-a),n=a>0?s-4:s;var c=0;for(t=0;t<n;t+=4)r=o[e.charCodeAt(t)]<<18|o[e.charCodeAt(t+1)]<<12|o[e.charCodeAt(t+2)]<<6|o[e.charCodeAt(t+3)],u[c++]=r>>16&255,u[c++]=r>>8&255,u[c++]=255&r;2===a?(r=o[e.charCodeAt(t)]<<2|o[e.charCodeAt(t+1)]>>4,u[c++]=255&r):1===a&&(r=o[e.charCodeAt(t)]<<10|o[e.charCodeAt(t+1)]<<4|o[e.charCodeAt(t+2)]>>2,u[c++]=r>>8&255,u[c++]=255&r);return u},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i="",a=[],u=0,s=n-o;u<s;u+=16383)a.push(c(e,u,u+16383>s?s:u+16383));1===o?(t=e[n-1],i+=r[t>>2],i+=r[t<<4&63],i+="=="):2===o&&(t=(e[n-2]<<8)+e[n-1],i+=r[t>>10],i+=r[t>>4&63],i+=r[t<<2&63],i+="=");return a.push(i),a.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,s=a.length;u<s;++u)r[u]=a[u],o[a.charCodeAt(u)]=u;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function c(e,t,n){for(var o,i,a=[],u=t;u<n;u+=3)o=(e[u]<<16)+(e[u+1]<<8)+e[u+2],a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,u=8*o-r-1,s=(1<<u)-1,l=s>>1,c=-7,f=n?o-1:0,h=n?-1:1,y=e[t+f];for(f+=h,i=y&(1<<-c)-1,y>>=-c,c+=u;c>0;i=256*i+e[t+f],f+=h,c-=8);for(a=i&(1<<-c)-1,i>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=h,c-=8);if(0===i)i=1-l;else{if(i===s)return a?NaN:1/0*(y?-1:1);a+=Math.pow(2,r),i-=l}return(y?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,u,s,l=8*i-o-1,c=(1<<l)-1,f=c>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,y=r?0:i-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=c?(u=0,a=c):a+f>=1?(u=(t*s-1)*Math.pow(2,o),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;e[n+y]=255&u,y+=p,u/=256,o-=8);for(a=a<<o|u,l+=o;l>0;e[n+y]=255&a,y+=p,a/=256,l-=8);e[n+y-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}}])},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=l(e),r=n[0],a=n[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,r,a)),s=0,c=a>0?r-4:r,f=0;f<c;f+=4)t=o[e.charCodeAt(f)]<<18|o[e.charCodeAt(f+1)]<<12|o[e.charCodeAt(f+2)]<<6|o[e.charCodeAt(f+3)],u[s++]=t>>16&255,u[s++]=t>>8&255,u[s++]=255&t;2===a&&(t=o[e.charCodeAt(f)]<<2|o[e.charCodeAt(f+1)]>>4,u[s++]=255&t);1===a&&(t=o[e.charCodeAt(f)]<<10|o[e.charCodeAt(f+1)]<<4|o[e.charCodeAt(f+2)]>>2,u[s++]=t>>8&255,u[s++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=0,u=n-o;a<u;a+=16383)i.push(c(e,a,a+16383>u?u:a+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,s=a.length;u<s;++u)r[u]=a[u],o[a.charCodeAt(u)]=u;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var o,i,a=[],u=t;u<n;u+=3)o=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,u=8*o-r-1,s=(1<<u)-1,l=s>>1,c=-7,f=n?o-1:0,h=n?-1:1,y=e[t+f];for(f+=h,i=y&(1<<-c)-1,y>>=-c,c+=u;c>0;i=256*i+e[t+f],f+=h,c-=8);for(a=i&(1<<-c)-1,i>>=-c,c+=r;c>0;a=256*a+e[t+f],f+=h,c-=8);if(0===i)i=1-l;else{if(i===s)return a?NaN:1/0*(y?-1:1);a+=Math.pow(2,r),i-=l}return(y?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,u,s,l=8*i-o-1,c=(1<<l)-1,f=c>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,y=r?0:i-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=c?(u=0,a=c):a+f>=1?(u=(t*s-1)*Math.pow(2,o),a+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;e[n+y]=255&u,y+=p,u/=256,o-=8);for(a=a<<o|u,l+=o;l>0;e[n+y]=255&a,y+=p,a/=256,l-=8);e[n+y-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";n.r(t);var r={butt:0,round:1,square:2},o={miter:0,round:1,bevel:2},i=n(11),a=n(7),u={normal:0,multiply:1,screen:2,overlay:3,darken:4,lighten:5,colorDodge:6,colorBurn:7,softLight:8,hardLight:9,difference:10,exclusion:11,hue:12,saturation:13,color:14,luminosity:15,clear:16,copy:17,sourceIn:18,sourceOut:19,sourceAtop:20,destinationOver:21,destinationIn:22,destinationOut:23,destinationAtop:24,xor:25,plusDarker:26,plusLighter:27};function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._boundingBox=null,this._boundingBoxOfPath=null,this._currentPoint=null,this._isEmpty=!1}var t,n,r;return t=e,r=[{key:"typeID",get:function(){return null}}],(n=[{key:"initEllipseIn",value:function(e,t){this._boundingBox=null,this._boundingBoxOfPath=null,this._currentPoint=null,this._isEmpty=!1}},{key:"initRoundedRect",value:function(e,t,n,r){this._boundingBox=null,this._boundingBoxOfPath=null,this._currentPoint=null,this._isEmpty=!1}},{key:"copy",value:function(){return null}},{key:"copyUsing",value:function(e){return null}},{key:"copyDashingWithPhase",value:function(e,t,n){return null}},{key:"copyStrokingWithWidth",value:function(e,t,n,r,o){return null}},{key:"mutableCopy",value:function(){return null}},{key:"mutableCopyUsing",value:function(e){return null}},{key:"containsUsing",value:function(e,t,n){return!1}},{key:"isRect",value:function(e){return!1}},{key:"apply",value:function(e,t){}},{key:"init__byDashing",value:function(e,t,n,r,o){this._boundingBox=null,this._boundingBoxOfPath=null,this._currentPoint=null,this._isEmpty=!1}},{key:"init__byStroking",value:function(e,t,n,r,o,i){this._boundingBox=null,this._boundingBoxOfPath=null,this._currentPoint=null,this._isEmpty=!1}},{key:"boundingBox",get:function(){return this._boundingBox}},{key:"boundingBoxOfPath",get:function(){return this._boundingBoxOfPath}},{key:"currentPoint",get:function(){return this._currentPoint}},{key:"isEmpty",get:function(){return this._isEmpty}}])&&s(t.prototype,n),r&&s(t,r),e}(),c=n(6),f=function(){},h={evenOdd:1,winding:0};function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"mutableCopy",value:function(){return null}},{key:"mutableCopyUsing",value:function(e){return null}},{key:"moveTo",value:function(e,t){}},{key:"addLineTo",value:function(e,t){}},{key:"addLinesBetween",value:function(e,t){}},{key:"addRect",value:function(e,t){}},{key:"addRects",value:function(e,t){}},{key:"addEllipseIn",value:function(e,t){}},{key:"addRoundedRectIn",value:function(e,t,n,r){}},{key:"addArc",value:function(e,t,n,r,o,i){}},{key:"addRelativeArc",value:function(e,t,n,r,o){}},{key:"addCurveTo",value:function(e,t,n,r){}},{key:"addQuadCurveTo",value:function(e,t,n){}},{key:"addPath",value:function(e,t){}},{key:"closeSubpath",value:function(){}}])&&y(t.prototype,n),r&&y(t,r),e}(),m=n(21),d=n(24);function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=null;"undefined"!=typeof HTMLCanvasElement?g=HTMLCanvasElement:g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getContext",value:function(e,t){throw new Error("getContext is not implemented")}}])&&_(t.prototype,n),r&&_(t,r),e}();var v=g,b=n(22),S=n(14),w=n(4),T=n(19),k=n(0);function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultOptions={method:"POST",async:!0,data:null,user:null,password:null,mimeType:null,isJSONP:!1,responseType:null,requestHeader:{}},this.jsonpScripts=[],this.jsonpCallbackPrefix="jsonpCallback_"}var t,n,r;return t=e,(n=[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.method="GET",this.request(e,t)}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.method="POST",this.request(e,t)}},{key:"jsonp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"callback",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e,o=document.createElement("script"),i=this._getNewFuncName(this.jsonpCallbackPrefix);n.data||(n.data={}),n.data[t]=i;var a=[];n.data.forEach(function(e,t){a.push(encodeURI(e)+"="+encodeURI(t))}),r+="?"+a.join("&");var u=new Promise(function(e,t){window[i]=e,o.addEventListener("error",t)}).catch(function(e){return delete window[i],document.head.removeChild(o),Promise.reject(e)}).then(function(e){return delete window[i],document.head.removeChild(o),Promise.resolve(e)});return o.src=r,document.head.appendChild(o),u}},{key:"_getNewFuncName",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";;){var t=e+Math.random().toString(16).slice(2);if(void 0===window[t])return t}}},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e,r=void 0===t.method?this.defaultOptions.method:t.method,o=void 0===t.async?this.defaultOptions.async:t.async,i=this.defaultOptions.data,a=void 0===t.user?this.defaultOptions.user:t.user,u=void 0===t.password?this.defaultOptions.password:t.password,s=void 0===t.mimeType?this.defaultOptions.mimeType:t.mimeType,l=void 0===t.requestHeader?this.defaultOptions.requestHeader:t.requestHeader,c=(void 0===t.isJSONP?this.defaultOptions.isJSONP:t.isJSONP,void 0===t.responseType?this.defaultOptions.responseType:t.responseType);if("POST"!==r&&"GET"!==r&&(r="POST"),t.data){var f=[];t.data instanceof Map?t.data.forEach(function(e,t){f.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):Object.keys(t.data).forEach(function(e){var n=t.data[e];f.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),"POST"===r?i=f.join("&").replace(/%20/g,"+"):n+="?"+f.join("&").replace(/%20/g,"+")}return"POST"===r&&void 0===l["Content-Type"]&&(l["Content-Type"]="application/x-www-form-urlencoded"),new Promise(function(e,t){var f=new XMLHttpRequest;if(s&&f.overrideMimeType(s),c&&(f.responseType=c),a?f.open(r,n,o,a,u):f.open(r,n,o),l)for(var h in l)({}).hasOwnProperty.call(l,h)&&f.setRequestHeader(h,l[h]);f.onload=function(){4===f.readyState&&200===f.status?e(f.response):t(new Error(f.statusText))},f.onerror=function(){t(new Error(f.statusText))},f.send(i)})}}])&&O(t.prototype,n),r&&O(t,r),e}(),x=new C,E=function(){var e=document.createElement("canvas").getContext("webgl2",{alpha:!0,depth:!0,stencil:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1});if(!e)return console.log("canvas.getContext returns null"),!1;var t=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(t,"#version 300 es\n  precision mediump float;\n\n  out vec3 position;\n\n  void main() {\n    position = vec3(0, 0, 0);\n    gl_Position = vec4(0, 0, 0, 0);\n  }\n"),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS)){var n=e.getShaderInfoLog(t);return console.log("vertexShader compile test error: ".concat(n)),!1}var r=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(r,"#version 300 es\n  precision mediump float;\n  precision highp sampler2DShadow;\n\n  in vec3 position;\n  out vec4 outColor;\n\n  void main() {\n    outColor = vec4(1, 1, 1, 1);\n  }\n"),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(r);return console.log("fragmentShader compile test error: ".concat(o)),!1}var i=e.createProgram();if(e.attachShader(i,t),e.attachShader(i,r),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){var a=e.getProgramInfoLog(i);return console.log("program link test error: ".concat(a)),!1}return!0};function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var F=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=A(this,N(t).call(this))).defaultOptions.mimeType="text/plain; charset=x-user-defined",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,C),t}()),D=n(15),I={pow2:0,integer:1,fractionalOdd:2,fractionalEven:3},M={seconds:function(e){return 1e3*e},milliseconds:function(e){return e},microseconds:function(e){return.001*e},nanoseconds:function(e){return 1e-6*e}};function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"activate",value:function(){}},{key:"resume",value:function(){}},{key:"setTarget",value:function(e){}},{key:"suspend",value:function(){}}])&&j(t.prototype,n),r&&j(t,r),e}();function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._uptimeNanoseconds=t}var t,n,r;return t=e,r=[{key:"now",value:function(){return Date.now()}},{key:"distantFuture",get:function(){return new e(1/0)}}],(n=[{key:"uptimeNanoseconds",get:function(){throw new Error("uptimeNanoseconds: not implemented")}}])&&L(t.prototype,n),r&&L(t,r),e}();function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H=null,W=function(e){function t(e,n,r,o,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=G(this,Y(t).call(this)))._label=e,a._qos=n,a._attributes=r,a._target=i,a}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,B),n=t,o=[{key:"concurrentPerformExecute",value:function(e,t){}},{key:"global",value:function(e){return null}},{key:"main",get:function(){return H}}],(r=[{key:"init__label",value:function(e,t){this._label="",this._qos=null}},{key:"init__labelQueue",value:function(e,t,n){this._label="",this._qos=null}},{key:"syncExecute",value:function(e){}},{key:"asyncExecute",value:function(e){}},{key:"asyncAfter",value:function(e,t){var n=e-Date.now();window.setTimeout(function(){t()},n)}},{key:"asyncAfterExecute",value:function(e,t,n,r){}},{key:"getSpecific",value:function(e){return null}},{key:"setSpecific",value:function(e,t){}},{key:"sync",value:function(e){}},{key:"label",get:function(){return this._label}},{key:"qos",get:function(){return this._qos}}])&&z(n.prototype,r),o&&z(n,o),t}();H=new W("com.apple.main-thread",null);var K={perFrame:0,perNode:1,perShadable:2},Z=n(12),q=function(e,t,n,r){return e.mult(Object(Z.a)(t,n,r))},J=n(2),Q="removed",$="linear";function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t,n){return t&&re(e.prototype,t),n&&re(e,n),e}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ae=function(e){function t(e,n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=te(this,ne(t).call(this)))._c1x=e,i._c1y=n,i._c2x=r,i._c2y=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(t,J["a"]),oe(t,null,[{key:"_propTypes",get:function(){return{c1x:["float","_c1x"],c1y:["float","_c1y"],c2x:["float","_c2x"],c2y:["float","_c2y"]}}}]),oe(t,[{key:"getControlPointAtValues",value:function(e,t){}},{key:"_getValueAtTime",value:function(e){var t=0,n=1,r=.5,o=0;if(e<=0)return 0;if(e>=1)return 1;for(var i=0;i<8;i++){e>3*r*(o=1-r)*(this._c1x*o+this._c2x*r)+r*r*r?t=r:n=r,r=.5*(t+n)}return 3*r*(o=1-r)*(this._c1y*o+this._c2y*r)+r*r*r}}],[{key:"functionWithName",value:function(e){switch(e){case"linear":return new t(0,0,1,1);case"easeIn":return new t(.42,0,1,1);case"easeOut":return new t(0,0,.58,1);case"easeInEaseOut":return new t(.42,0,.58,1);case"default":return new t(.25,.1,.25,1);default:throw new Error("CAMediaTimingFunction: unknown name: ".concat(e))}}},{key:"functionWithControlPoints",value:function(e,n,r,o){return new t(e,n,r,o)}}]),t}(),ue=n(1),se=n(8),le={linear:0,easeIn:1,easeOut:2,easeInEaseOut:3};function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t,n){return t&&ye(e.prototype,t),n&&ye(e,n),e}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var de=function(e){function t(e,n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=fe(this,he(t).call(this))).red=e,i.green=n,i.blue=r,i.alpha=o,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,J["a"]),pe(t,null,[{key:"_initWithData",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new t;return r?(o.red=e.readFloatBE(n+0),o.green=e.readFloatBE(n+4),o.blue=e.readFloatBE(n+8),o.alpha=e.readFloatBE(n+12)):(o.red=e.readFloatLE(n+0),o.green=e.readFloatLE(n+4),o.blue=e.readFloatLE(n+8),o.alpha=e.readFloatLE(n+12)),o}},{key:"_propTypes",get:function(){return{$constructor:function(e,n){if(void 0!==n.NSColorSpace){if(void 0!==n.NSRGB){var r=n.NSRGB.toString("ascii").split(" ");return new t(parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),1)}if(void 0!==n.NSWhite){var o=n.NSWhite.toString("ascii").split(" "),i=parseFloat(o[0]);return new t(i,i,i,1)}throw console.error("unknown color space"),new Error("unknown color space")}return new t},NSRGB:["bytes",null],NSWhite:["bytes",null],NSComponents:["bytes",null],NSColorSpace:["integer",null],NSCustomColorSpace:["NSColorSpace",null]}}}]),pe(t,[{key:"withAlphaComponent",value:function(e){return new t(this.red,this.green,this.blue,e)}},{key:"initPatternImage",value:function(e){}},{key:"set",value:function(){}},{key:"setFill",value:function(){}},{key:"setStroke",value:function(){}},{key:"getHSBA",value:function(){return{hue:0,saturation:0,brightness:0,alpha:0}}},{key:"getRGBA",value:function(e,t,n,r){return{red:this.red,green:this.green,blue:this.blue,alpha:this.alpha}}},{key:"_copy",value:function(){return new t(this.red,this.green,this.blue,this.alpha)}},{key:"_lerp",value:function(e,n){var r=new t;return r.red=this.red+n*(e.red-this.red),r.green=this.green+n*(e.green-this.green),r.blue=this.blue+n*(e.blue-this.blue),r.alpha=this.alpha+n*(e.alpha-this.alpha),r}},{key:"zero",value:function(){return new t(0,0,0,0)}},{key:"add",value:function(e){var n=new t;return n.red=this.red+e.red,n.green=this.green+e.green,n.blue=this.blue+e.blue,n.alpha=this.alpha+e.alpha,n}},{key:"sub",value:function(e){var n=new t;return n.red=this.red-e.red,n.green=this.green-e.green,n.blue=this.blue-e.blue,n.alpha=this.alpha-e.alpha,n}},{key:"_srgbToLinear",value:function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}},{key:"_linearToSrgb",value:function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)}},{key:"srgbToLinear",value:function(){var e=new t;return e.red=this._srgbToLinear(this.red),e.green=this._srgbToLinear(this.green),e.blue=this._srgbToLinear(this.blue),e.alpha=this.alpha,e}},{key:"linearToSrgb",value:function(){var e=new t;return e.red=this._linearToSrgb(this.red),e.green=this._linearToSrgb(this.green),e.blue=this._linearToSrgb(this.blue),e.alpha=this.alpha,e}},{key:"floatArray",value:function(){return[this.red,this.green,this.blue,this.alpha]}},{key:"float32Array",value:function(){return new Float32Array([this.red,this.green,this.blue,this.alpha])}},{key:"htmlColor",get:function(){var e=Math.round(255*this.red),t=Math.round(255*this.green),n=Math.round(255*this.blue);return"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(this.alpha,")")}},{key:"hexColor",get:function(){var e=Math.round(255*this.red).toString(16),t=Math.round(255*this.green).toString(16),n=Math.round(255*this.blue).toString(16);return"#".concat(e).concat(t).concat(n)}}],[{key:"black",get:function(){return new t(0,0,0,1)}},{key:"blue",get:function(){return new t(0,0,1,1)}},{key:"brown",get:function(){return new t(.6,.4,.2,1)}},{key:"clear",get:function(){return new t(0,0,0,0)}},{key:"cyan",get:function(){return new t(0,1,1,1)}},{key:"darkGray",get:function(){return new t(1/3,1/3,1/3,1)}},{key:"gray",get:function(){return new t(.5,.5,.5,1)}},{key:"green",get:function(){return new t(0,1,0,1)}},{key:"lightGray",get:function(){return new t(2/3,2/3,2/3,1)}},{key:"magenta",get:function(){return new t(1,0,1,1)}},{key:"orange",get:function(){return new t(1,.5,0,1)}},{key:"purple",get:function(){return new t(.5,0,.5,1)}},{key:"red",get:function(){return new t(1,0,0,1)}},{key:"white",get:function(){return new t(1,1,1,1)}},{key:"yellow",get:function(){return new t(1,1,0,1)}}]),t}();function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e,t){return!t||"object"!==_e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e,t,n){return(be="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Se(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Te=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ve(this,Se(t).call(this)))._duration=0,e._speed=1,e._timingMode=le.linear,e._timingFunction=null,e._finished=!1,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e._completionHandler=null,e.__actionStartTime=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}(t,J["a"]),n=t,o=[{key:"moveByXYZ",value:function(e,t,n,r){throw new Error("not implemented")}},{key:"moveBy",value:function(e,t){throw new Error("not implemented")}},{key:"moveTo",value:function(e,t){throw new Error("not implemented")}},{key:"rotateByXYZ",value:function(e,t,n,r){throw new Error("not implemented")}},{key:"rotateToXYZ",value:function(e,t,n,r){throw new Error("not implemented")}},{key:"rotateToXYZUsesShortestUnitArc",value:function(e,t,n,r,o){throw new Error("not implemented")}},{key:"rotateByAround",value:function(e,t,n){throw new Error("not implemented")}},{key:"rotateToAxisAngle",value:function(e,t){throw new Error("not implemented")}},{key:"scaleByDuration",value:function(e,t){throw new Error("not implemented")}},{key:"scaleToDuration",value:function(e,t){throw new Error("not implemented")}},{key:"fadeInDuration",value:function(e){throw new Error("not implemented")}},{key:"fadeOutDuration",value:function(e){throw new Error("not implemented")}},{key:"fadeOpacityByDuration",value:function(e,t){throw new Error("not implemented")}},{key:"fadeOpacityToDuration",value:function(e,t){throw new Error("not implemented")}},{key:"hide",value:function(){throw new Error("not implemented")}},{key:"unhide",value:function(){throw new Error("not implemented")}},{key:"removeFromParentNode",value:function(){throw new Error("not implemented")}},{key:"playAudioWaitForCompletion",value:function(e,t){throw new Error("not implemented")}},{key:"group",value:function(e){throw new Error("not implemented")}},{key:"sequence",value:function(e){throw new Error("not implemented")}},{key:"repeat",value:function(e,t){throw new Error("not implemented")}},{key:"repeatForever",value:function(e){throw new Error("not implemented")}},{key:"waitDuration",value:function(e){throw new Error("not implemented")}},{key:"waitDurationWithRange",value:function(e,t){throw new Error("not implemented")}},{key:"run",value:function(e){throw new Error("not implemented")}},{key:"customActionDurationAction",value:function(e,t){throw new Error("not implemented")}},{key:"javaScriptActionWithScriptDuration",value:function(e,t){throw new Error("not implemented")}}],(r=[{key:"reversed",value:function(){return null}},{key:"copy",value:function(){var e=be(Se(t.prototype),"copy",this).call(this);return e._beginTime=this._beginTime,e._duration=this._duration,e._speed=this.speed,e._timingMode=this.timingMode,e._timingFunction=this.timingFunction,e._finished=this._finished,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._getTime(t,n)}},{key:"_getTime",value:function(e,t){var n=this.__getTime(e,t);return this._timingMode===le.easeIn?ae.functionWithName("easeIn")._getValueAtTime(n):this._timingMode===le.easeOut?ae.functionWithName("easeOut")._getValueAtTime(n):this._timingMode===le.easeInEaseOut?ae.functionWithName("easeInEaseOut")._getValueAtTime(n):n}},{key:"__getTime",value:function(e,t){if(!t)return e>=1&&!this._finished&&(this._finished=!0),e;var n=this._basetimeFromTime(e);return null===this.timingFunction?n:this.timingFunction._getValueAtTime(n)}},{key:"_basetimeFromTime",value:function(e){var t=e-this._actionStartTime;return this._basetimeFromActivetime(t)}},{key:"_activetimeFromTime",value:function(e){return e-this._actionStartTime}},{key:"_basetimeFromActivetime",value:function(e){var t=e-this._beginTime;if(0===this.speed)return 0;if(0===this._duration)return t/Math.abs(this.speed);var n=this._duration/Math.abs(this.speed);return 0===n&&(n=.25),t>=n&&(this._finished||(this._finished=!0)),t/n}},{key:"_lerp",value:function(e,t,n){return null===n?t:Object(w.a)(e,se.a)?e.lerp(t,n):Object(w.a)(e,ue.a)?e.lerp(t,n):Object(w.a)(e,a.a)?e.lerp(t,n):Object(w.a)(e,c.a)?e.lerp(t,n):Object(w.a)(e,i.a)?e.lerp(t,n):Object(w.a)(e,de)?e._lerp(t,n):e+(t-e)*n}},{key:"_slerp",value:function(e,t,n){if(!Object(w.a)(e,se.a))throw new Error("SCNAction._slerp: object is not SCNVector4");return e.slerp(t,n)}},{key:"_resetFinished",value:function(){this._finished=!1}},{key:"_actionStartTime",get:function(){return this.__actionStartTime},set:function(e){this.__actionStartTime=e}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"speed",get:function(){return this._speed},set:function(e){this._speed=e}},{key:"timingMode",get:function(){return this._timingMode},set:function(e){this._timingMode=e}},{key:"timingFunction",get:function(){return this._timingFunction},set:function(e){this._timingFunction=e}}])&&ge(n.prototype,r),o&&ge(n,o),t}();function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ce(e,t,n){return(Ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pe(e,t,n){return t&&Ee(e.prototype,t),n&&Ee(e,n),e}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ne=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Oe(this,xe(t).call(this)))._timesToRepeat=0,e._repeatedAction=null,e._forever=!1,e._timesRepeated=0,e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,Te),Pe(t,null,[{key:"_propTypes",get:function(){return{_timesToRepeat:"float",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_repeatedAction:"SCNAction",_forever:"boolean",_timesRepeated:"integer",_pausedTime:"float",name:["string",null]}}}]),Pe(t,[{key:"copy",value:function(){var e=Ce(xe(t.prototype),"copy",this).call(this);return e._timesToRepeat=this._timesToRepeat,e._repeatedAction=this._repeatedAction.copy(),e._forever=this._forever,e._timesRepeated=this._timesRepeated,e}},{key:"_getTime",value:function(e,t){if(!t)return e;var n=this._basetimeFromTime(e);if(null===this.timingFunction)return n;var r=Math.floor(n);return r+this.timingFunction._getValueAtTime(n-r)}},{key:"_applyAction",value:function(e,t){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._getTime(t,n),o=Math.floor(r);o>this._timesRepeated;){if(this._timesRepeated+=1,this._repeatedAction._applyAction(e,1,!1),!this._forever&&this._timesRepeated>=this._timesToRepeat)return void(this._finished=!0);this._repeatedAction._resetFinished()}var i=r-this._timesRepeated;this._repeatedAction._applyAction(e,i,!1),this._finished=!1}},{key:"_resetFinished",value:function(){this._repeatedAction._resetFinished(),this._timesRepeated=0,this._finished=!1}},{key:"duration",get:function(){return this._forever?1/0:this._repeatedAction.duration*this._timesToRepeat}}],[{key:"repeat",value:function(e,n){var r=new t;return r._repeatedAction=e,r._duration=e.duration,r._timesToRepeat=n,r._forever=n===1/0,r}},{key:"repeatForever",value:function(e){return this.repeat(e,1/0)}}]),t}();function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e,t){return!t||"object"!==Re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Me(e,t){return(Me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Te.repeat=Ne.repeat,Te.repeatForever=Ne.repeatForever;var je=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=De(this,Ie(t).call(this))).connectionPosition=null,n.axle=null,n.steeringAxis=null,n.radius=0,n.frictionSlip=0,n.suspensionStiffness=0,n.suspensionCompression=0,n.suspensionDamping=0,n.maximumSuspensionTravel=0,n.maximumSuspensionForce=0,n.suspensionRestLength=0,n._node=null,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Me(e,t)}(t,J["a"]),n=t,(r=[{key:"node",get:function(){return this._node}}])&&Fe(n.prototype,r),o&&Fe(n,o),t}();function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){return!t||"object"!==Be(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ze=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Le(this,Ue(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(t,J["a"]),t}();function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t){return!t||"object"!==Ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ke=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Xe(this,He(t).call(this)))._chassisBody=null,r._wheels=null,r._speedInKilometersPerHour=0,r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(t,ze),n=t,(r=[{key:"applyEngineForceForWheelAt",value:function(e,t){}},{key:"applyBrakingForceForWheelAt",value:function(e,t){}},{key:"setSteeringAngleForWheelAt",value:function(e,t){}},{key:"chassisBody",get:function(){return this._chassisBody}},{key:"wheels",get:function(){return this._wheels}},{key:"speedInKilometersPerHour",get:function(){return this._speedInKilometersPerHour}}])&&Ye(n.prototype,r),o&&Ye(n,o),t}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e,t){return($e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var et=function(e){function t(e,n,r,o,i,a){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(u=Je(this,Qe(t).call(this))).axisA=null,u.anchorA=null,u.axisB=null,u.anchorB=null,u._bodyA=null,u._bodyB=null,u}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$e(e,t)}(t,ze),n=t,(r=[{key:"bodyA",get:function(){return this._bodyA}},{key:"bodyB",get:function(){return this._bodyB}}])&&qe(n.prototype,r),o&&qe(n,o),t}(),tt=n(3);function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t){return!t||"object"!==nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function it(e){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ut=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ot(this,it(t).call(this))).animationDidStart=null,n.animationDidStop=null,n.animationEvents=null,n.autoreverses=!1,n.blendInDuration=0,n.blendOutDuration=0,n.duration=0,n.fillsBackward=!1,n.fillsForward=!1,n.isAdditive=!1,n.isAppliedOnCompletion=!1,n.isCumulative=!1,n.isRemovedOnCompletion=!1,n.keyPath=null,n.repeatCount=0,n.startDelay=0,n.timeOffset=0,n.timingFunction=null,n.usesSceneTimeBase=!1,n._animation=e,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(t,J["a"]),n=t,o=[{key:"animationWithContentsOf",value:function(e){}},{key:"animationNamed",value:function(e){}}],(r=null)&&rt(n.prototype,r),o&&rt(n,o),t}();function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lt(e,t){return!t||"object"!==st(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ht(e,t,n){return t&&ft(e.prototype,t),n&&ft(e,n),e}function yt(e,t){return(yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=lt(this,ct(t).call(this))).blendFactor=0,n.paused=!1,n.speed=0,n._weight=0,n._animation=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yt(e,t)}(t,J["a"]),ht(t,null,[{key:"_propTypes",get:function(){return{speed:"float",weight:["float","_weight"],paused:"boolean"}}}]),ht(t,[{key:"play",value:function(){}},{key:"stop",value:function(){}},{key:"stopWithBlendOutDuration",value:function(e){}},{key:"animation",get:function(){return this._animation}}]),t}();function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){return!t||"object"!==mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _t(e){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=dt(this,_t(t).call(this))).influenceFactor=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(t,J["a"]),t}();function bt(e){return(bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wt(e,t){return!t||"object"!==bt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tt(e,t,n){return(Tt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=kt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ot(e,t){return(Ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ct=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=wt(this,kt(t).call(this))).isRemovedOnCompletion=!0,e.timingFunction=null,e.delegate=null,e.usesSceneTimeBase=!1,e.fadeInDuration=0,e.fadeOutDuration=0,e.animationEvents=null,e.beginTime=0,e.timeOffset=0,e.repeatCount=0,e.repeatDuration=0,e.duration=0,e.speed=1,e.autoreverses=!1,e.fillMode=Q,e._isFinished=!1,e._prevTime=null,e._animationStartTime=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}(t,J["a"]),n=t,o=[{key:"defaultValueForKey",value:function(e){return null}}],(r=[{key:"shouldArchiveValueForKey",value:function(e){return!1}},{key:"copy",value:function(){var e=Tt(kt(t.prototype),"copy",this).call(this);return e.isRemovedOnCompletion=this.isRemovedOnCompletion,e.timingFunction=this.timingFunction,e.delegate=this.delegate,e.usesSceneTimeBase=this.usesSceneTimeBase,e.fadeInDuration=this.fadeInDuration,e.fadeOutDuration=this.fadeOutDuration,e.animationEvents=this.animationEvents?this.animationEvents.slice(0):null,e.beginTime=this.beginTime,e.timeOffset=this.timeOffset,e.repeatCount=this.repeatCount,e.repeatDuration=this.repeatDuration,e.duration=this.duration,e.speed=this.speed,e.autoreverses=this.autoreverses,e.fillMode=this.fillMode,e}},{key:"_applyAnimation",value:function(e,t){var n=t;if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){var r=this._basetimeFromTime(t);n=r,null!==this.timingFunction&&(n=this.timingFunction._getValueAtTime(r))}this._handleEvents(e,n)}},{key:"_handleEvents",value:function(e,t){var n=this;if(null!==this.animationEvents){var r=this._prevTime;null===r&&(this.delegate&&this.delegate.animationDidStart&&this.delegate.animationDidStart(this),r=t-1e-7),this.animationEvents.forEach(function(o){r<o._time&&o._time<=t&&o._eventBlock&&o._eventBlock(n,e,!1)}),this._prevTime=t}}},{key:"_basetimeFromTime",value:function(e){var t=e-this._animationStartTime;return this._basetimeFromActivetime(t)}},{key:"_basetimeFromActivetime",value:function(e){var t=0;this.beginTime>0&&(t=this.beginTime-this._animationStartTime);var n=e-t;if(n<0){if("backwards"!==this.fillMode&&"both"!==this.fillMode)return null;n=0}if(0===this.speed)return 0;var r=this.duration/Math.abs(this.speed),o=r;0===o&&(o=.25);var i=this.repeatCount;if(this.usesSceneTimeBase&&(i=1/0),this.repeatDuration>0?o=this.repeatDuration:(i>0&&(o*=i),this.autoreverses&&(r*=2,o*=2)),n>o){if(this._isFinished||(this._isFinished=!0,this.delegate&&this.delegate.animationDidStop&&this.delegate.animationDidStop(this,!0)),"forwards"!==this.fillMode&&"both"!==this.fillMode)return null;n=o}var a=(n+this.timeOffset)/r;return Math.abs(a)>1&&(a-=Math.floor(a)),a<0&&(a=1+a),this.autoreverses?a<=.5?2*a:2*(1-a):a}}])&&St(n.prototype,r),o&&St(n,o),t}();function xt(e){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Et(e,t){return!t||"object"!==xt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pt(e,t,n){return(Pt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=At(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rt(e,t,n){return t&&Nt(e.prototype,t),n&&Nt(e,n),e}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Et(this,At(t).call(this))).animations=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}(t,Ct),Rt(t,null,[{key:"_propTypes",get:function(){return{animations:"LKNSArrayCodingProxy",duration:"integer",fillMode:"string",removedOnCompletion:["boolean","isRemovedOnCompletion"],__CACodingContents:"NSArray"}}}]),Rt(t,[{key:"_applyAnimation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;if(n){var o=this._basetimeFromTime(t);r=o,null!==this.timingFunction&&(r=this.timingFunction._getValueAtTime(o))}this.animations.forEach(function(t){t._applyAnimation(e,r,!1)}),this._handleEvents(e,r)}},{key:"copy",value:function(){var e=Pt(At(t.prototype),"copy",this).call(this);return e.animations=this.animations.slice(),e}}]),t}(),It=n(9);function Mt(e){return(Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bt(e,t){return!t||"object"!==Mt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lt(e,t,n){return(Lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ut(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Bt(this,Ut(t).call(this))).keyPath=e,n.isCumulative=!1,n.isAdditive=!1,n.valueFunction=null,n._isMultiplicative=!1,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(t,Ct),n=t,(r=[{key:"copy",value:function(){var e=Lt(Ut(t.prototype),"copy",this).call(this);return e.keyPath=this.keyPath,e.isCumulative=this.isCumulative,e.isAdditive=this.isAdditive,e.valueFunction=this.valueFunction,e._isMultiplicative=this._isMultiplicative,e}},{key:"_applyAnimation",value:function(e,t){var n=t;if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){var r=this._basetimeFromTime(t);n=r,null!==this.timingFunction&&(n=this.timingFunction._getValueAtTime(r))}var o=n;null!==this.valueFunction&&(o=this.valueFunction._getValueAtTime(n)),o=this._calculateWithBaseValue(e,o),this._applyValue(e,o),this._handleEvents(e,n)}},{key:"_calculateWithBaseValue",value:function(e,t){if(this.isAdditive){var n=e.valueForKeyPath(this.keyPath);return this._addValues(n,t)}if(this._isMultiplicative){var r=e.valueForKeyPath(this.keyPath);return this._mulValues(r,t)}return t}},{key:"_applyValue",value:function(e,t){e.setValueForKeyPath(t,this.keyPath)}},{key:"_addValues",value:function(e,t){return e instanceof Object?e.add(t):e+t}},{key:"_mulValues",value:function(e,t){return e instanceof Object?e.mul(t):e*t}},{key:"_lerp",value:function(e,t,n){if(null===n)return t;if(Object(w.a)(e,se.a))return e.lerp(t,n);if(Object(w.a)(e,ue.a))return e.lerp(t,n);if(Object(w.a)(e,It.a))return e.lerp(t,n);if(Object(w.a)(e,a.a));else if(Object(w.a)(e,c.a));else if(Object(w.a)(e,i.a));else if(Object(w.a)(e,de))return e._lerp(t,n);return e+(t-e)*n}},{key:"_slerp",value:function(e,t,n){if(!Object(w.a)(e,se.a))throw new Error("CABasicAnimation._slerp: object is not SCNVector4");return e.slerp(t,n)}}])&&jt(n.prototype,r),o&&jt(n,o),t}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xt(e,t){return!t||"object"!==Gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ht(e,t,n){return(Ht="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kt(e,t){return(Kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Xt(this,Wt(t).call(this,e))).fromValue=null,n.toValue=null,n.byValue=null,n._baseValue=null,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kt(e,t)}(t,zt),n=t,(r=[{key:"copy",value:function(){var e=Ht(Wt(t.prototype),"copy",this).call(this);return e.fromValue=this.fromValue,e.toValue=this.toValue,e.byValue=this.byValue,e}},{key:"_applyAnimation",value:function(e,t){var n=t;if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){var r=this._basetimeFromTime(t);if(null===r)return;n=r,null!==this.timingFunction&&(n=this.timingFunction._getValueAtTime(r)),n<0&&(n=0),n>1&&(n=1)}var o=!1;(null===this._baseValue||this.isAdditive)&&(this._baseValue=e.valueForKeyPath(this.keyPath,!1)),"number"!=typeof this._baseValue&&null!==this._baseValue&&(o=!0);var i=0,a=0;null!==this.fromValue&&null!==this.toValue?(i=this.fromValue,a=this.toValue):null!==this.fromValue&&null!==this.byValue?(i=this.fromValue,a=o?this.fromValue.add(this.byValue):this.fromValue+this.byValue):null!==this.byValue&&null!==this.toValue?(i=o?this.toValue.sub(this.byValue):this.toValue-this.byValue,a=a):null!==this.fromValue?(i=this.fromValue,a=this.isAdditive?o?this._baseValue.zero():0:this._baseValue):null!==this.toValue?(i=this.isAdditive?o?this._baseValue.zero():0:this._baseValue,a=this.toValue):null!==this.byValue&&(this.isAdditive?(i=o?this._baseValue.zero():0,a=this.byValue):(i=this._baseValue,a=o?this._baseValue.add(this.byValue):this._baseValue+this.byValue));var u=this._lerp(i,a,n);this.isAdditive&&(o?u=u.add(this._baseValue):u+=this._baseValue),this._applyValue(e,u),this._handleEvents(e,n)}}])&&Yt(n.prototype,r),o&&Yt(n,o),t}();function qt(e){return(qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jt(e,t){return!t||"object"!==qt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qt(e,t,n){return(Qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$t(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $t(e){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function en(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tn(e,t,n){return t&&en(e.prototype,t),n&&en(e,n),e}function nn(e,t){return(nn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Jt(this,$t(t).call(this,e))).values=null,n.path=null,n.keyTimes=null,n.timingFunctions=null,n.calculationMode=$,n.rotationMode=null,n.tensionValues=null,n.continuityValues=null,n.biasValues=null,n._indexCache=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nn(e,t)}(t,zt),tn(t,null,[{key:"_propTypes",get:function(){return{duration:"integer",fillMode:"string",keyPath:"string",keyTimes:"LKNSArrayCodingProxy",removedOnCompletion:["boolean","isRemovedOnCompletion"],timingFunctions:"LKNSArrayCodingProxy",values:"LKNSArrayCodingProxy",__CACodingContents:"NSArray"}}}]),tn(t,[{key:"copy",value:function(){var e=Qt($t(t.prototype),"copy",this).call(this);return e.values=this.values?this.values.slice():null,e.path=this.path,e.keyTimes=this.keyTimes?this.keyTimes.slice():null,e.timingFunctions=this.timingFunctions?this.timingFunctions.slice():null,e.calculationMode=this.calculationMode,e.rotationMode=this.rotationMode,e.tensionValues=this.tensionValues?this.tensionValues.slice():null,e.continuityValues=this.continuityValues?this.continuityValues.slice():null,e.biasValues=this.biasValues?this.biasValues.slice():null,e}},{key:"_applyAnimation",value:function(e,t){var n=t;arguments.length>2&&void 0!==arguments[2]&&!arguments[2]||(n=this._basetimeFromTime(t));var r=this._indexCache,o=0,i=0;if(n>1)throw new Error("CAKeyframeAnimation._applyAnimation: t ".concat(n," > 1"));var a=this.keyTimes.length;if(r>=a&&(console.log("CAKeyframeAnimation index >= len  ".concat(r," >= ").concat(a)),r=a-1),this.keyTimes[r]<n){for(;r<a&&!(this.keyTimes[r]>=n);r++);o=r-1,i=r}else{for(;r>=0&&!(this.keyTimes[r]<n);r--);o=r,i=r+1}o<=0&&(o=0),i>=a&&(i=a-1),this._indexCache=o;var u=this.keyTimes[o],s=this.keyTimes[i],l=this.values[o],c=this.values[i],f=l;if(u!==s){var h=(n-u)/(s-u),y=h;switch(null!==this.timingFunctions&&(y=this.timingFunctions[o]._getValueAtTime(h)),this.calculationMode){case $:f=this._lerp(l,c,y);break;case"discrete":throw new Error("kCAAnimationDiscrete not implemented");case"paced":throw new Error("kCAAnimationPaced not implemented");case"cubic":throw new Error("kCAAnimationCubic not implemented");case"cubicPaced":throw new Error("kCAAnimationCubicPaced not implemented");default:throw new Error("unknown calculation mode: ".concat(this.calculationMode))}}f=this._calculateWithBaseValue(e,f),this._applyValue(e,f),this._handleEvents(e,n)}}]),t}(),on={fixed:0,movable:1};function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function un(e,t,n){return t&&an(e.prototype,t),n&&an(e,n),e}var sn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._keys=[],this._values=[]}return un(e,null,[{key:"initWithCoder",value:function(t){var n=new e;if(void 0!==t._refObj["NS.objects"]){var r=t._refObj["NS.keys"],o=t._refObj["NS.objects"];if(!Array.isArray(r))throw new Error("NS.keys must be Array");if(!Array.isArray(o))throw new Error("NS.objects must be Array");if(r.length!==o.length)throw new Error("NS.keys.length !== NS.objects.length");var i=t.copy();i._refObj=r;var a=t.copy();a._refObj=o;for(var u=0;u<r.length;u++){var s=i.decodeObjectForKey(u),l=a.decodeObjectForKey(u);n._keys.push(s),n._values.push(l)}}else for(var c=0;;c++){var f="NS.object.".concat(c),h="NS.key.".concat(c);if(void 0===t._refObj[f])break;var y=t.decodeObjectForKey(h),p=t.decodeObjectForKey(f);n._keys.push(y),n._values.push(p)}return n}}]),un(e,[{key:"copy",value:function(){var t=new e;return t._keys=this._keys.slice(0),t._values=this._values.slice(0),t}},{key:"keys",value:function(){return this._keys.slice(0)}},{key:"dictionary",value:function(){for(var e={},t=this._keys.length,n=0;n<t;n++)e[this._keys[n]]=this._values[n];return e}},{key:"allValues",value:function(){return this._values.slice(0)}},{key:"allKeys",value:function(){return this.keys()}},{key:"count",value:function(){return this._keys.length}},{key:"removeAllObjects",value:function(){this._keys=[],this._values=[]}},{key:"removeObjectForKey",value:function(e){var t=this._keys.indexOf(e);t<0||(this._keys.splice(t,1),this._values.splice(t,1))}},{key:"objectForKey",value:function(e){var t=this._keys.indexOf(e);return t<0?null:this._values[t]}},{key:"setObjectForKey",value:function(e,t){var n=this._keys.indexOf(t);n<0&&(n=this._keys.length,this._keys[n]=t),this._values[n]=e}},{key:"valueForKey",value:function(e){return this.objectForKey(e)}},{key:"setValueForKey",value:function(e,t){this.setObjectForKey(e,t)}},{key:"set",value:function(e,t){this.setObjectForKey(t,e)}},{key:"get",value:function(e){return this.objectForKey(e)}},{key:"clear",value:function(){this.removeAllObjects()}},{key:"delete",value:function(e){this.removeObjectForKey(e)}},{key:"forEach",value:function(e){for(var t=this._keys.length,n=0;n<t;n++)e(this._values[n],this._keys[n])}}]),e}(),ln={alpha:0,add:1,subtract:2,multiply:3,screen:4,replace:5},cn={red:1,green:2,blue:4,alpha:8,all:15},fn={back:0,front:1},hn={fill:2,lines:1},yn={none:0,nearest:1,linear:2};function pn(e){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dn(e,t){return!t||"object"!==pn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gn(e,t){return(gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var bn=[],Sn=!0,wn=function e(){vn(this,e),this._animations=[],this._animationDuration=0,this._animationTimingFunction=null,this._disableActions=!1,this._completionBlock=null,this._values=new Map},Tn=new wn,kn=function(e){function t(){throw vn(this,t),dn(this,_n(t).call(this)),new Error("do not create an instance of SCNTransaction")}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}(t,J["a"]),n=t,o=[{key:"begin",value:function(){var e=new wn;e._disableActions=this._currentTransaction._disabledActions,bn.push(e)}},{key:"commit",value:function(){var e=bn.pop();e&&this._apply(e)}},{key:"flush",value:function(){this._apply(Tn)}},{key:"_apply",value:function(e){if(e._disableActions||0===e._animationDuration)e._animations.forEach(function(e){e.target.setValueForKeyPath(e.newValue,e.keyPath)}),e._completionBlock&&e._completionBlock();else{var t=[];e._animations.forEach(function(n){var r=new Promise(function(t,r){var o=new Zt(n.keyPath);o.fromValue=n.diff,o.timingFunction=e._animationTimingFunction,o.duration=e._animationDuration,o.isAdditive=!0,o.isRemovedOnCompletion=!0,o.delegate={animationDidStop:function(e,r){r&&(n.target.setValueForKeyPath(n.newValue,n.keyPath),t(n,o))}},n.target.addAnimationForKey(o,null)});t.push(r)}),Promise.all(t).then(function(){e._completionBlock&&e._completionBlock()})}}},{key:"lock",value:function(){throw new Error("lock() is not implemented")}},{key:"unlock",value:function(){throw new Error("unlock() is not implemented")}},{key:"setValueForKey",value:function(e,t){this._currentTransaction._values.set(t,e)}},{key:"valueForKey",value:function(e){for(var t=bn.length-1;t>=0;t--){var n=bn[t]._values.get(e);if(void 0!==n)return n}return Tn._values.get(e)}},{key:"_addChange",value:function(e,t,n,r){if(this.immediateMode)e.setValueForKeyPath(r,t);else{var o=null;if("number"==typeof r)o=n-r;else{if(void 0===r.sub)throw new Error("keyPath ".concat(t," does not have sub function"));o=n.sub(r)}this._currentTransaction._animations.push({target:e,keyPath:t,diff:o,oldValue:n,newValue:r})}}},{key:"animationDuration",get:function(){return this._currentTransaction._animationDuration},set:function(e){this._currentTransaction._animationDuration=e}},{key:"animationTimingFunction",get:function(){return this._currentTransaction._animationTimingFunction},set:function(e){this._currentTransaction._animationTimingFunction=e}},{key:"disableActions",get:function(){return this._currentTransaction._disableActions},set:function(e){this._currentTransaction._disableActions=e}},{key:"completionBlock",get:function(){return this._currentTransaction._completionBlock},set:function(e){this._currentTransaction._completionBlock=e}},{key:"_currentTransaction",get:function(){return bn.length>0?bn[bn.length-1]:Tn}},{key:"immediateMode",get:function(){return!(bn.length>0)&&Sn},set:function(e){Sn=e}}],(r=null)&&mn(n.prototype,r),o&&mn(n,o),t}(),On={clamp:1,repeat:2,clampToBorder:3,mirror:4};function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xn(e,t){return!t||"object"!==Cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function En(e,t,n){return(En="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function An(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nn(e,t,n){return t&&An(e.prototype,t),n&&An(e,n),e}function Rn(e,t){return(Rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=xn(this,Pn(t).call(this)))._contents=n,e.intensity=0,e.contentsTransform=Object(Z.a)(0,0,0),e.wrapS=On.clamp,e.wrapT=On.clamp,e.minificationFilter=yn.linear,e.magnificationFilter=yn.linear,e.mipFilter=yn.nearest,e.maxAnisotropy=0,e.mappingChannel=0,e.borderColor=null,e._parent=null,e._animations=new sn,e.__presentation=null,e._loadedPromise=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rn(e,t)}(t,J["a"]),Nn(t,null,[{key:"_propTypes",get:function(){return{color:["NSColor","_contents"],image:["NSMutableDictionary",function(e,t,n,r){if(void 0===t.data){var o="";void 0!==t.path?o=t.path:void 0!==t.URL&&(o=t.URL),r._urlTranslator&&(o=r._urlTranslator(o,r)),e._loadContentsImage(o,r._directoryPath)}else e._loadContentsImageByData(t.data)}],float:["float",function(e,t){e._contents=new de(t,t,t,1)}],intensity:"float",wrapS:"integer",wrapT:"integer",minificationFilter:"integer",magnificationFilter:"integer",mipFilter:"integer",maxAnisotropy:"float",mappingChannel:"integer",borderColor:"plist",propertyType:["integer",null],parent:["SCNMaterial","_parent"],isCommonProfileProperty:["boolean",null],sRGB:["boolean",null],customSlotName:["string",null],textureComponents:["integer",null]}}}]),Nn(t,[{key:"_createPresentation",value:function(){null===this.__presentation&&(this.__presentation=this.copy())}},{key:"_copyPresentation",value:function(){this.__presentation._contents=this._contents}},{key:"copy",value:function(){var e=new t;return e._contents=this._contents,e.intensity=this.intensity,e.contentsTransform=this.contentsTransform,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.minificationFilter=this.minificationFilter,e.magnicifactionFilter=this.maginicifactionFilter,e.mipFilter=this.mipFilter,e.maxAnisotropy=this.maxAnisotropy,e.mappingChannel=this.mappingChannel,e.borderColor=this.borderColor,e}},{key:"valueForKeyPath",value:function(e){var n=this.__presentation?this.__presentation:this;return"contents"===e?n._contents:En(Pn(t.prototype),"valueForKeyPath",this).call(this,e)}},{key:"setValueForKeyPath",value:function(e,n){var r=this.__presentation?this.__presentation:this;"contents"===n?r._contents=e:En(Pn(t.prototype),"setValueForKeyPath",this).call(this,e,n)}},{key:"addAnimationForKey",value:function(e,t){null==t&&(t=Symbol());var n=e.copy();n._animationStartTime=.001*Date.now(),n._prevTime=n._animationStartTime-1e-7,this._animations.set(t,n)}},{key:"animationForKey",value:function(e){return this._animations.get(e)}},{key:"removeAllAnimations",value:function(){this._animations.clear()}},{key:"removeAnimationForKey",value:function(e){this._animations.delete(e)}},{key:"removeAnimationForKeyFadeOutDuration",value:function(e,t){}},{key:"pauseAnimationForKey",value:function(e){}},{key:"resumeAnimationForKey",value:function(e){}},{key:"isAnimationPausedForKey",value:function(e){return!1}},{key:"setAnimationSpeedForKey",value:function(e,t){}},{key:"_wrapSFor",value:function(e){switch(this.wrapS){case On.clamp:return e.CLAMP_TO_EDGE;case On.repeat:return e.REPEAT;case On.clampToBorder:return e.CLAMP_TO_EDGE;case On.mirror:return e.MIRRORED_REPEAT;default:throw new Error("unknown wrapS: ".concat(this.wrapS))}}},{key:"_wrapTFor",value:function(e){switch(this.wrapT){case On.clamp:return e.CLAMP_TO_EDGE;case On.repeat:return e.REPEAT;case On.clampToBorder:return e.CLAMP_TO_EDGE;case On.mirror:return e.MIRRORED_REPEAT;default:throw new Error("unknown wrapT: ".concat(this.wrapT))}}},{key:"_minificationFilterFor",value:function(e){switch(this.minificationFilter){case yn.none:case yn.linear:switch(this.mipFilter){case yn.none:return e.LINEAR;case yn.nearest:return e.LINEAR_MIPMAP_NEAREST;case yn.linear:return e.LINEAR_MIPMAP_LINEAR;default:throw new Error("unknown mipmapFilter: ".concat(this.mipmapFilter))}case yn.nearest:switch(this.mipFilter){case yn.none:return e.NEAREST;case yn.nearest:return e.NEAREST_MIPMAP_NEAREST;case yn.linear:return e.NEAREST_MIPMAP_LINEAR;default:throw new Error("unknown mipmapFilter: ".concat(this.mipmapFilter))}default:throw new Error("unknown minificationFilter: ".concat(this.minificationFilter))}}},{key:"_magnificationFilterFor",value:function(e){switch(this.magnificationFilter){case yn.none:return e.LINEAR;case yn.nearest:return e.NEAREST;case yn.linear:return e.LINEAR;default:throw new Error("unknown magnificationFilter: ".concat(this.magnificationFilter))}}},{key:"_loadContentsImage",value:function(e,t){var n=this,r=new Image;if(r.crossOrigin="anonymous","object"===Cn(e)&&"function"==typeof e.then)return this._loadedPromise=new Promise(function(t,o){e.then(function(e){r.onload=function(){n._contents=r,t()},r.onerror=function(){o(new Error("image ".concat(e," load error.")))},r.src=e})}),r;var o=e;return 0===o.indexOf("file:///")&&(o=o.slice(8)),o=o.replace(/\.exr$/,".png"),this._loadedPromise=new Promise(function(i,a){var u=o.split("/"),s=1,l=t+u.slice(-s).join("/");r.onload=function(){n._contents=r,i()},r.onerror=function(){(s+=1)>u.length?(r.onerror=function(){throw a(),new Error("image ".concat(e," load error."))},r.src=o):(l=t+u.slice(-s).join("/"),r.src=l)},r.src=l}),r}},{key:"_loadContentsImageByData",value:function(e){var t=this,n=new Image;return n.crossOrigin="anonymous",this._loadedPromise=new Promise(function(r,o){n.onload=function(){t._contents=n,r()},n.onerror=function(){o()};var i=new Blob([e],{type:"image/png"}),a=URL.createObjectURL(i);n.src=a}),n}},{key:"float32Array",value:function(){var e=this.__presentation?this.__presentation:this;return Object(w.a)(e._contents,de)?e._contents.float32Array():new Float32Array([1,1,1,1])}},{key:"_getLoadedPromise",value:function(){return this._loadedPromise?this._loadedPromise:Promise.resolve()}},{key:"_presentation",get:function(){return null===this.__presentation?null:this.__presentation}},{key:"contents",get:function(){return this._contents},set:function(e){var t=this._contents;this._contents=e,kn._addChange(this,"contents",t,e)}},{key:"animationKeys",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this._animations.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}]),t}(),Dn={aOne:0,rgbZero:1};function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mn(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jn(e,t,n){return(jn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Bn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Bn(e){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Un(e,t,n){return t&&Ln(e.prototype,t),n&&Ln(e,n),e}function Vn(e,t){return(Vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zn={blinn:"SCNLightingModelBlinn",constant:"SCNLightingModelConstant",lambert:"SCNLightingModelLambert",phong:"SCNLightingModelPhong",physicallyBased:"SCNLightingModelPhysicallyBased"},Gn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Mn(this,Bn(t).call(this)))._diffuse=new Fn(de.white),n._ambient=new Fn(new de(.485,.485,.485,1)),n._specular=new Fn(de.black),n._normal=new Fn(de.white),n._reflective=new Fn(de.black),n._emission=new Fn(de.black),n._transparent=new Fn(de.white),n._multiply=new Fn(de.white),n._ambientOcclusion=new Fn(de.white),n._selfIllumination=new Fn(de.black),n._metalness=new Fn(de.black),n._roughness=new Fn(new de(.485,.485,.485,1)),n._displacement=new Fn(de.black),n.name=null,n.shininess=1,n.fresnelExponent=0,n.transparency=1,n.transparencyMode=Dn.aOne,n.lightingModel=zn.blinn,n.isLitPerPixel=!0,n.isDoubleSided=!1,n.cullMode=fn.back,n.blendMode=ln.alpha,n.locksAmbientWithDiffuse=!0,n.writesToDepthBuffer=!0,n.readsFromDepthBuffer=!0,n.colorBufferWriteMask=cn.all,n.fillMode=hn.fill,n.program=null,n.shaderModifiers=null,n._bindingHandler={},n._unbindingHandler={},n._valuesForUndefinedKeys={},n._animations=new sn,n._entityID=null,n._createPresentationProperties(),n._shadableHelper=null,n._loadedPromise=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vn(e,t)}(t,J["a"]),Un(t,null,[{key:"_propTypes",get:function(){return{diffuse:["SCNMaterialProperty",function(e,t){e._diffuse=t,t._createPresentation()}],ambient:["SCNMaterialProperty",function(e,t){e._ambient=t,t._createPresentation()}],specular:["SCNMaterialProperty",function(e,t){e._specular=t,t._createPresentation()}],normal:["SCNMaterialProperty",function(e,t){e._normal=t,t._createPresentation()}],reflective:["SCNMaterialProperty",function(e,t){e._reflective=t,t._createPresentation()}],emission:["SCNMaterialProperty",function(e,t){e._emission=t,t._createPresentation()}],transparent:["SCNMaterialProperty",function(e,t){e._transparent=t,t._createPresentation()}],multiply:["SCNMaterialProperty",function(e,t){e._multiply=t,t._createPresentation()}],ambientOcclusion:["SCNMaterialProperty",function(e,t){e._ambientOcclusion=t,t._createPresentation()}],selfIllumination:["SCNMaterialProperty",function(e,t){e._selfIllumination=t,t._createPresentation()}],metalness:["SCNMaterialProperty",function(e,t){e._metalness=t,t._createPresentation()}],roughness:["SCNMaterialProperty",function(e,t){e._roughness=t,t._createPresentation()}],displacement:["SCNMaterialProperty",function(e,t){e._displacement=t,t._createPresentation()}],name:"string",shininess:"float",fresnelExponent:"float",transparency:"integer",transparencyMode:"integer",lightingModelName:["string","lightingModel"],litPerPixel:["boolean","isLitPerPixel"],doubleSided:["boolean","isDoubleSided"],cullMode:"integer",blendMode:"integer",locksAmbientWithDiffuse:"boolean",writesToDepthBuffer:"boolean",readsFromDepthBuffer:"boolean",colorBufferWriteMask:"integer",fillMode:"integer",valuesForUndefinedKeys:["NSMutableDictionary","_valuesForUndefinedKeys"],shadableHelper:["SCNShadableHelper","_shadableHelper"],avoidsOverLighting:["boolean",null],entityID:["string","_entityID"],indexOfRefraction:["integer",null],selfIlluminationOcclusion:["integer",null]}}}]),Un(t,[{key:"_createPresentationProperties",value:function(){this._diffuse._createPresentation(),this._ambient._createPresentation(),this._specular._createPresentation(),this._normal._createPresentation(),this._reflective._createPresentation(),this._emission._createPresentation(),this._transparent._createPresentation(),this._multiply._createPresentation(),this._ambientOcclusion._createPresentation(),this._selfIllumination._createPresentation(),this._metalness._createPresentation(),this._roughness._createPresentation()}},{key:"_copyPresentationProperties",value:function(){this._diffuse._copyPresentation(),this._ambient._copyPresentation(),this._specular._copyPresentation(),this._normal._copyPresentation(),this._reflective._copyPresentation(),this._emission._copyPresentation(),this._transparent._copyPresentation(),this._multiply._copyPresentation(),this._ambientOcclusion._copyPresentation(),this._selfIllumination._copyPresentation(),this._metalness._copyPresentation(),this._roughness._copyPresentation()}},{key:"handleBindingOfSymbolHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._bindingHandler[e]=t}},{key:"handleUnbindingOfSymbolHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._unbindingHandler[e]=t}},{key:"_callBindingHandlerForNodeProgramContextRenderer",value:function(e,t,n,r){for(var o=Object.keys(this._bindingHandler),i=0;i<o.length;i++){var a=o[i];(0,this._bindingHandler[a])(t,n.getUniformBlockIndex(t,a),e,r)}}},{key:"_callUnindingHandlerForNodeProgramContextRenderer",value:function(e,t,n,r){for(var o=Object.keys(this._unbindingHandler),i=0;i<o.length;i++){var a=o[i];(0,this._unbindingHandler[a])(t,n.getUniformBlockIndex(t,a),e,r)}}},{key:"addAnimationForKey",value:function(e,t){null==t&&(t=Symbol());var n=e.copy();n._animationStartTime=.001*Date.now(),n._prevTime=n._animationStartTime-1e-7,this._animations.set(t,n)}},{key:"animationForKey",value:function(e){return this._animations.get(e)}},{key:"removeAllAnimations",value:function(){this._animations.clear()}},{key:"removeAnimationForKey",value:function(e){this._animations.delete(e)}},{key:"removeAnimationForKeyFadeOutDuration",value:function(e,t){}},{key:"pauseAnimationForKey",value:function(e){}},{key:"resumeAnimationForKey",value:function(e){}},{key:"isAnimationPausedForKey",value:function(e){return!1}},{key:"setAnimationSpeedForKey",value:function(e,t){}},{key:"_getLoadedPromise",value:function(){if(this._loadedPromise)return this._loadedPromise;for(var e=[this._ambient,this._specular,this._normal,this._reflective,this._emission,this._transparent,this._multiply,this._ambientOcclusion,this._metalness,this._roughness],t=[],n=0;n<e.length;n++){var r=e[n];r&&t.push(r.didLoad)}return Promise.all(t)}},{key:"setValueForUndefinedKey",value:function(e,t){this._valuesForUndefinedKeys[t]=e}},{key:"valueForUndefinedKey",value:function(e){return void 0!==this._valuesForUndefinedKeys[e]?this._valuesForUndefinedKeys[e]:jn(Bn(t.prototype),"valueForUndefinedKey",this).call(this,e)}},{key:"diffuse",get:function(){return this._diffuse}},{key:"ambient",get:function(){return this._ambient}},{key:"specular",get:function(){return this._specular}},{key:"normal",get:function(){return this._normal}},{key:"reflective",get:function(){return this._reflective}},{key:"emission",get:function(){return this._emission}},{key:"transparent",get:function(){return this._transparent}},{key:"multiply",get:function(){return this._multiply}},{key:"ambientOcclusion",get:function(){return this._ambientOcclusion}},{key:"selfIllumination",get:function(){return this._selfIllumination}},{key:"metalness",get:function(){return this._metalness}},{key:"roughness",get:function(){return this._roughness}},{key:"displacement",get:function(){return this._displacement}},{key:"animationKeys",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this._animations.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}],[{key:"LightingModel",get:function(){return zn}}]),t}();function Yn(e){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xn(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Hn(e,t){return!t||"object"!==Yn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wn(e,t,n){return(Wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kn(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Kn(e){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qn(e,t,n){return t&&Zn(e.prototype,t),n&&Zn(e,n),e}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=Hn(this,Kn(t).call(this)),!Array.isArray(n))throw new Error("SCNGeometry(sources, elements): sources must be Array");if(!Array.isArray(r))throw new Error("SCNGeometry(sources, elements): elements must be Array");return e.name=null,e.levelsOfDetail=null,e.materials=[],e._geometryElements=r,e._geometrySources=n,e._vertexArrayObjects=null,e._materialBuffer=null,e._shadowVAO=null,e._hitTestVAO=null,e.subdivisionLevel=0,e.edgeCreasesElement=null,e.edgeCreasesSource=null,e.program=null,e.shaderModifiers=null,e._bindingHandler={},e._unbindingHandler={},e._valuesForUndefinedKeys={},e._animations=new sn,e.boundingBox=null,e.tessellator=null,e.wantsAdaptiveSubdivision=!1,e._vertexBuffer=null,e._indexBuffer=null,e._isPresentationInstance=!1,e._presentation=null,e._entityID=null,e._shadableHelper=null,e._btVertices=null,e._btMesh=null,e._btShape=null,e._loadedPromise=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jn(e,t)}(t,J["a"]),qn(t,null,[{key:"_propTypes",get:function(){var e=function(e,t,n,r){var o;(o=e._geometrySources).push.apply(o,Xn(t))};return{name:"string",levelsOfDetail:"NSArray",materials:"NSArray",tessellator:"SCNGeometryTessellator",subdivisionLevel:"integer",elements:["NSArray","_geometryElements"],kGeometrySourceSemanticColor:["NSArray",e],kGeometrySourceSemanticEdgeCrease:["NSArray",e],kGeometrySourceSemanticNormal:["NSArray",e],kGeometrySourceSemanticTangent:["NSArray",e],kGeometrySourceSemanticTexcoord:["NSArray",e],kGeometrySourceSemanticVertex:["NSArray",function(t,n){e(t,n),t._updateBoundingBox()}],kGeometrySourceSemanticVertexCrease:["NSArray",e],wantsAdaptiveSubdivision:"boolean",adaptiveSubdivision:["boolean",null],entityID:["string","_entityID"],subdivisionSettings:["bytes",null],shadableHelper:["SCNShadableHelper","_shadableHelper"]}}}]),qn(t,[{key:"materialNamed",value:function(e){return null}},{key:"insertMaterialAt",value:function(e,t){}},{key:"removeMaterialAt",value:function(e){}},{key:"replaceMaterialAtIndexWith",value:function(e,t){}},{key:"geometryElementAtIndex",value:function(e){return this._geometryElements[e]}},{key:"getGeometrySourcesForSemantic",value:function(e){return this._geometrySources.filter(function(t){return t.semantic===e})}},{key:"getBoundingSphere",value:function(){if(null===this.boundingBox)return{center:new ue.a(0,0,0),radius:0};var e=this.boundingBox.max,t=this.boundingBox.min,n=.5*(e.x-t.x),r=.5*(e.y-t.y),o=.5*(e.z-t.z),i=Math.sqrt(n*n+r*r+o*o);return{center:new ue.a(t.x+n,t.y+r,t.z+o),radius:i}}},{key:"handleBindingOfSymbolHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._bindingHandler[e]=t}},{key:"handleUnbindingOfSymbolHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._unbindingHandler[e]=t}},{key:"_callBindingHandlerForNodeProgramContextRenderer",value:function(e,t,n,r){for(var o=Object.keys(this._bindingHandler),i=0;i<o.length;i++){var a=o[i];(0,this._bindingHandler[a])(t,n.getUniformBlockIndex(t,a),e,r)}}},{key:"_callUnindingHandlerForNodeProgramContextRenderer",value:function(e,t,n,r){for(var o=Object.keys(this._unbindingHandler),i=0;i<o.length;i++){var a=o[i];(0,this._unbindingHandler[a])(t,n.getUniformBlockIndex(t,a),e,r)}}},{key:"addAnimationForKey",value:function(e,t){null==t&&(t=Symbol());var n=e.copy();n._animationStartTime=.001*Date.now(),n._prevTime=n._animationStartTime-1e-7,this._animations.set(t,n)}},{key:"animationForKey",value:function(e){return this._animations.get(e)}},{key:"removeAllAnimations",value:function(){this._animations.clear()}},{key:"removeAnimationForKey",value:function(e){this._animations.delete(e)}},{key:"removeAnimationForKeyFadeOutDuration",value:function(e,t){}},{key:"pauseAnimationForKey",value:function(e){}},{key:"resumeAnimationForKey",value:function(e){}},{key:"isAnimationPausedForKey",value:function(e){return!1}},{key:"setAnimationSpeedForKey",value:function(e,t){}},{key:"_createVertexBuffer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=null===r?t.geometry:r,i=t.skinner,a=t.presentation.skinner;if(null===this._vertexBuffer)this._vertexBuffer=e.createBuffer();else if(!n)return this._vertexBuffer;e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer);var u=[],s=o.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],l=o.getGeometrySourcesForSemantic(tt.a.Semantic.normal)[0],c=o.getGeometrySourcesForSemantic(tt.a.Semantic.tangent)[0],f=o.getGeometrySourcesForSemantic(tt.a.Semantic.color)[0],h=o.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[0],y=o.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[1],p=i?i._boneIndices:null,m=i?i._boneWeights:null,d=s.vectorCount,_=this.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],g=this.getGeometrySourcesForSemantic(tt.a.Semantic.normal)[0],v=this.getGeometrySourcesForSemantic(tt.a.Semantic.tangent)[0],b=this.getGeometrySourcesForSemantic(tt.a.Semantic.color)[0],S=this.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[0],T=this.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[1],k=a?a._boneIndices:null,O=a?a._boneWeights:null;if(void 0===s)throw new Error("vertexSource is undefined");if(void 0!==l&&l.vectorCount!==d)throw new Error("normalSource.vectorCount !== vertexSource.vectorCount");if(void 0!==c&&c.vectorCount!==d)throw new Error("tangentSource.vectorCount !== vertexSource.vectorCount");if(void 0!==f&&f.vectorCount!==d)throw new Error("colorSource.vectorCount !== vertexSource.vectorCount");if(void 0!==h&&h.vectorCount!==d)throw new Error("texcoordSource0.vectorCount !== vertexSource.vectorCount");if(void 0!==y&&y.vectorCount!==d)throw new Error("texcoordSource1.vectorCount !== vertexSource.vectorCount");void 0===c&&this.materials.find(function(e){return!Object(w.a)(e._normal._contents,de)})&&(v=c=this._createTangentSource(),this._geometrySources.push(c),o!==this&&o._geometrySources.push(c));for(var C=s?s.componentsPerVector:0,x=l?l.componentsPerVector:0,E=c?c.componentsPerVector:0,P=f?f.componentsPerVector:0,A=h?h.componentsPerVector:0,N=y?y.componentsPerVector:0,R=0;R<d;R++)s&&u.push.apply(u,Xn(s._vectorAt(R))),l&&u.push.apply(u,Xn(l._vectorAt(R))),c&&u.push.apply(u,Xn(c._vectorAt(R))),f&&u.push.apply(u,Xn(f._vectorAt(R))),h&&u.push.apply(u,Xn(h._vectorAt(R))),y&&u.push.apply(u,Xn(y._vectorAt(R)));var F=0,D=4*(C+x+E+P+A+N);_._bytesPerComponent=4,_._dataOffset=F,_._dataStride=D,F+=4*C,g&&(g._bytesPerComponent=4,g._dataOffset=F,g._dataStride=D,F+=4*x),v&&(v._bytesPerComponent=4,v._dataOffset=F,v._dataStride=D,F+=4*E),b&&(b._bytesPerComponent=4,b._dataOffset=F,b._dataStride=D,F+=4*P),S&&(S._bytesPerComponent=4,S._dataOffset=F,S._dataStride=D,F+=4*A),T&&(T._bytesPerComponent=4,T._dataOffset=F,T._dataStride=D,F+=4*N),F*=d;p&&p.data;for(var I=p?p.componentsPerVector:0,M=(m&&m.data,m?m.componentsPerVector:0),j=4*(I+M),B=0;B<d;B++)p&&u.push.apply(u,Xn(p._vectorAt(B))),m&&u.push.apply(u,Xn(m._vectorAt(B)));k&&(k._bytesPerComponent=4,k._dataOffset=F,k._dataStride=j,F+=4*I),O&&(O._bytesPerComponent=4,O._dataOffset=F,O._dataStride=j,F+=4*M);var L=new Float32Array(u);return e.bufferData(e.ARRAY_BUFFER,L,e.DYNAMIC_DRAW),_._data=u,g&&(g._data=u),v&&(v._data=u),b&&(b._data=u),S&&(S._data=u),T&&(T._data=u),k&&(k._data=u),O&&(O._data=u),this._vertexBuffer}},{key:"_createIndexBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._indexBuffer&&!t?this._indexBuffer:(this._indexBuffer=this._geometryElements[0]._createBuffer(e),this._indexBuffer)}},{key:"_updateVertexBuffer",value:function(e,t){var n=this.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],r=new Float32Array(n._data);e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,r,e.DYNAMIC_DRAW)}},{key:"_bufferMaterialData",value:function(e,t,n,r){var o=this.materials.length,i=this.materials[n%o];if(i||(i=new Gn),i.lightingModel!==Gn.LightingModel.constant){var a=i.diffuse.float32Array();a[3]*=r;var u=null;i.locksAmbientWithDiffuse?u=a:(u=i.ambient.float32Array())[3]*=r;var s=new Float32Array([].concat(Xn(u),Xn(a),Xn(i.specular.float32Array()),Xn(i.normal.float32Array()),Xn(i.reflective.float32Array()),Xn(i.emission.float32Array()),Xn(i.transparent.float32Array()),Xn(i.multiply.float32Array()),Xn(i.ambientOcclusion.float32Array()),Xn(i.selfIllumination.float32Array()),Xn(i.metalness.float32Array()),Xn(i.roughness.float32Array()),[100*i.shininess,i.fresnelExponent,0,0]));e.bindBuffer(e.UNIFORM_BUFFER,this._materialBuffer),e.bufferData(e.UNIFORM_BUFFER,s,e.DYNAMIC_DRAW),e.bindBuffer(e.UNIFORM_BUFFER,null);var l=[],c=0;i._selfIllumination._contents instanceof Image||i._selfIllumination._contents instanceof WebGLTexture?(this._setTextureToName(e,i._selfIllumination,"TEXTURE0",l),c=1):i._emission._contents instanceof Image||i._emission._contents instanceof WebGLTexture?this._setTextureToName(e,i._emission,"TEXTURE0",l):l.push(0),e.uniform1i(e.getUniformLocation(t,"selfIllumination"),c),this._setTextureToName(e,i._ambient,"TEXTURE1",l),this._setTextureToName(e,i._diffuse,"TEXTURE2",l),this._setTextureToName(e,i._specular,"TEXTURE3",l),this._setCubeTextureToName(e,i._reflective,"TEXTURE4",l),this._setTextureToName(e,i._transparent,"TEXTURE5",l),this._setTextureToName(e,i._multiply,"TEXTURE6",l),this._setTextureToName(e,i._normal,"TEXTURE7",l),this._setTextureToName(e,i._ambientOcclusion,"TEXTURE8",l),this._setTextureToName(e,i._selfIllumination,"TEXTURE9",l),this._setTextureToName(e,i._metalness,"TEXTURE10",l),this._setTextureToName(e,i._roughness,"TEXTURE11",l),e.uniform1iv(e.getUniformLocation(t,"textureFlags"),new Int32Array(l)),i.isDoubleSided?e.disable(e.CULL_FACE):(e.enable(e.CULL_FACE),i.cullMode===fn.back?e.cullFace(e.BACK):e.cullFace(e.FRONT));var f=[e.SRC_ALPHA,e.ONE,e.ZERO,e.ZERO,e.SRC_ALPHA,e.ONE],h=[e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_COLOR,e.SRC_COLOR,e.ONE,e.ZERO];e.blendFunc(f[i.blendMode],h[i.blendMode])}else this._bindMaterialDataForConstantLighting(i,e,t,r)}},{key:"_bindMaterialDataForConstantLighting",value:function(e,t,n,r){var o=e.ambient.float32Array();o[3]*=r;var i=new Float32Array([].concat(Xn(o),[0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0]));t.bindBuffer(t.UNIFORM_BUFFER,this._materialBuffer),t.bufferData(t.UNIFORM_BUFFER,i,t.DYNAMIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null);var a=[];a.push(0),t.uniform1i(t.getUniformLocation(n,"selfIllumination"),0),this._setTextureToName(t,e._ambient,"TEXTURE1",a),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),a.push(0),t.uniform1iv(t.getUniformLocation(n,"textureFlags"),new Int32Array(a)),e.isDoubleSided?t.disable(t.CULL_FACE):(t.enable(t.CULL_FACE),e.cullMode===fn.back?t.cullFace(t.BACK):t.cullFace(t.FRONT));var u=[t.SRC_ALPHA,t.ONE,t.ZERO,t.ZERO,t.SRC_ALPHA,t.ONE],s=[t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_COLOR,t.SRC_COLOR,t.ONE,t.ZERO];t.blendFunc(u[e.blendMode],s[e.blendMode])}},{key:"_setCubeTextureToName",value:function(e,t,n,r){t._contents instanceof Image&&(t._contents=this._createCubeTexture(e,t._contents)),t._contents instanceof WebGLTexture?(r.push(1),e.activeTexture(e[n]),e.bindTexture(e.TEXTURE_CUBE_MAP,t._contents),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,t._magnificationFilterFor(e)),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,t._minificationFilterFor(e)),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,t._wrapSFor(e)),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,t._wrapTFor(e))):r.push(0)}},{key:"_setTextureToName",value:function(e,t,n,r){t._contents instanceof Image&&(t._contents=this._createTexture(e,t._contents)),t._contents instanceof WebGLTexture?(r.push(1),e.activeTexture(e[n]),e.bindTexture(e.TEXTURE_2D,t._contents),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t._magnificationFilterFor(e)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t._minificationFilterFor(e)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t._wrapSFor(e)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t._wrapTFor(e))):r.push(0)}},{key:"_createTangentSource",value:function(){for(var e=this._geometryElements,t=this.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],n=this.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[0],r=[],o=tt.a.Semantic.tangent,i=t.vectorCount,a=[],u=0;u<i;u++)a.push(new ue.a(0,0,0));var s=!0,l=!1,c=void 0;try{for(var f,h=e[Symbol.iterator]();!(s=(f=h.next()).done);s=!0)for(var y=f.value,p=y.primitiveCount,m=0;m<p;m++){var d=y._indexAt(m),_=t._scnVectorAt(d[0]),g=t._scnVectorAt(d[1]),v=t._scnVectorAt(d[2]),b=n._scnVectorAt(d[0]),S=n._scnVectorAt(d[1]),w=n._scnVectorAt(d[2]),T=g.sub(_),k=v.sub(_),O=S.sub(b),C=w.sub(b),x=T.mul(C.y).sub(k.mul(O.y));a[d[0]]=a[d[0]].add(x),a[d[1]]=a[d[1]].add(x),a[d[2]]=a[d[2]].add(x)}}catch(e){l=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}for(var E=0;E<i;E++)r.push.apply(r,Xn(a[E].normalize().floatArray()));return new tt.a(r,o,i,!0,3,4,0,12)}},{key:"copy",value:function(){var e=new t;return e.name=this.name,e.levelsOfDetail=this.levelsOfDetail,e.materials=this.materials,e._geometryElements=this._geometryElements.slice(0),e._geometrySources=this._geometrySources.slice(0),e._vertexArrayObjects=this._vertexArrayObjects?this._vertexArrayObjects.slice(0):null,e.subdivisonLevel=this.subdivisionLevel,e.edgeCreasesElement=this.edgeCreasesElement,e.edgeCreasesSource=this.edgeCreasesSource,e.program=this.program,e.shaderModifiers=this.shaderModifiers,e.boundingBox=this.boundingBox,e._vertexBuffer=this._vertexBuffer,e._indexBuffer=this._indexBuffer,e._animations=this._animations.copy(),e._shadableHelper=this._shadableHelper,e}},{key:"_createCubeTexture",value:function(e,t){var n=e.createTexture();e.bindTexture(e.TEXTURE_CUBE_MAP,n);for(var r=[e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Y],o=[4/6+.001,1/6+.001,5/6+.001,.001,2/6+.001,.501],i=(t.naturalWidth,t.naturalHeight),a=i-.002,u=0;u<6;u++){var s=document.createElement("canvas");s.width=i,s.height=i,s.getContext("2d").drawImage(t,o[u],0,a,i,0,0,i,i),e.texImage2D(r[u],0,e.RGBA,i,i,0,e.RGBA,e.UNSIGNED_BYTE,s)}return e.generateMipmap(e.TEXTURE_CUBE_MAP),n}},{key:"_createTexture",value:function(e,t){var n=e.createTexture(),r=document.createElement("canvas");return r.width=t.naturalWidth,r.height=t.naturalHeight,r.getContext("2d").drawImage(t,0,0),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.width,t.height,0,e.RGBA,e.UNSIGNED_BYTE,r),e.generateMipmap(e.TEXTURE_2D),n}},{key:"_createBtCollisionShape",value:function(){return this._createBtConvexTriangleMeshShape()}},{key:"_createBtConvexTriangleMeshShape",value:function(){}},{key:"_destroyShape",value:function(){}},{key:"_execDestory",value:function(){this._destroyShape()}},{key:"_updateBoundingBox",value:function(){return this._updateBoundingBoxForSkinner()}},{key:"_updateBoundingBoxForSkinner",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null;e&&(t=e.baseGeometryBindTransform);var n=this.getGeometrySourcesForSemantic(tt.a.Semantic.vertex),r=new ue.a(1/0,1/0,1/0),o=new ue.a(-1/0,-1/0,-1/0),i=!0,a=!1,u=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value._createBoundingBox(t);c.min.x<r.x&&(r.x=c.min.x),c.max.x>o.x&&(o.x=c.max.x),c.min.y<r.y&&(r.y=c.min.y),c.max.y>o.y&&(o.y=c.max.y),c.min.z<r.z&&(r.z=c.min.z),c.max.z>o.z&&(o.z=c.max.z)}}catch(e){a=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw u}}return this.boundingBox={min:r,max:o},this.boundingBox}},{key:"_intersectsBoundingBox",value:function(e){var t=this.boundingBox,n=e.boundingBox;return!(t.min.x>n.max.x||t.max.x<n.min.x)&&(!(t.min.y>n.max.y||t.max.y<n.min.y)&&!(t.min.z>n.max.z||t.max.z<n.min.z))}},{key:"_getLoadedPromise",value:function(){if(this._loadedPromise)return this._loadedPromise;var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this.materials[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a.didLoad)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return Promise.all(e)}},{key:"setValueForUndefinedKey",value:function(e,t){this._valuesForUndefinedKeys[t]=e}},{key:"valueForUndefinedKey",value:function(e){return void 0!==this._valuesForUndefinedKeys[e]?this._valuesForUndefinedKeys[e]:Wn(Kn(t.prototype),"valueForUndefinedKey",this).call(this,e)}},{key:"firstMaterial",get:function(){return this.materials[0]},set:function(e){this.materials[0]=e}},{key:"geometryElements",get:function(){return this._geometryElements.slice(0)}},{key:"geometrySources",get:function(){return this._geometrySources.slice(0)}},{key:"geometryGLSource",get:function(){return new Float32Array(this._geometrySources[0])}},{key:"geometryElementCount",get:function(){return this._geometryElements.length}},{key:"animationKeys",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this._animations.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}]),t}(),$n=n(10),er=n(5);function tr(e){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nr(e,t){return!t||"object"!==tr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rr(e,t,n){return(rr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=or(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function or(e){return(or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ar(e,t,n){return t&&ir(e.prototype,t),n&&ir(e,n),e}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=nr(this,or(t).call(this,[],[]))).width=n,e.height=r,e.length=o,e.widthSegmentCount=1,e.heightSegmentCount=1,e.lengthSegmentCount=1,e.chamferRadius=i,e.chamferSegmentCount=10,e._createGeometry(),e.materials.push(new Gn),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(t,Qn),ar(t,null,[{key:"_propTypes",get:function(){return{$constructor:function(e,n){var r=new t(n.boxwidth,n.boxheight,n.boxlength,n.boxchamferRadius);return r.widthSegmentCount=n.boxwidthSegmentCount,r.heightSegmentCount=n.boxheightSegmentCount,r.lengthSegmentCount=n.boxlengthSegmentCount,r.chamferSegmentCount=n.boxchamferSegmentCount,r.name=n.name,r.materials=n.materials,r.tessellator=n.tessellator,r.wantsAdaptiveSubdivision=n.wantsAdaptiveSubdivision,r.subdivisionLevel=n.subdivisionLevel,r},name:["string",null],boxwidth:["float",null],boxheight:["float",null],boxlength:["float",null],boxwidthSegmentCount:["integer",null],boxheightSegmentCount:["integer",null],boxlengthSegmentCount:["integer",null],boxchamferRadius:["float",null],boxchamferSegmentCount:["integer",null],boxprimitiveType:["integer",null],materials:["NSArray",null],tessellator:["SCNGeometryTessellator",null],wantsAdaptiveSubdivision:["boolean",null],subdivisionLevel:["integer",null],subdivisionSettings:["bytes",null]}}}]),ar(t,[{key:"_createGeometry",value:function(){var e=[],t=[],n=.5*-this.width,r=.5*this.width,o=.5*this.height,i=.5*-this.height,a=.5*this.length,u=.5*-this.length;e.push(n,i,a),e.push(0,0,1),e.push(0,1),e.push(n,o,a),e.push(0,0,1),e.push(0,0),e.push(r,i,a),e.push(0,0,1),e.push(1,1),e.push(r,o,a),e.push(0,0,1),e.push(1,0),t.push(0,3,1),t.push(0,2,3),e.push(r,i,a),e.push(1,0,0),e.push(0,1),e.push(r,o,a),e.push(1,0,0),e.push(0,0),e.push(r,i,u),e.push(1,0,0),e.push(1,1),e.push(r,o,u),e.push(1,0,0),e.push(1,0),t.push(4,7,5),t.push(4,6,7),e.push(r,i,u),e.push(0,0,-1),e.push(0,1),e.push(r,o,u),e.push(0,0,-1),e.push(0,0),e.push(n,i,u),e.push(0,0,-1),e.push(1,1),e.push(n,o,u),e.push(0,0,-1),e.push(1,0),t.push(8,11,9),t.push(8,10,11),e.push(n,i,u),e.push(-1,0,0),e.push(0,1),e.push(n,o,u),e.push(-1,0,0),e.push(0,0),e.push(n,i,a),e.push(-1,0,0),e.push(1,1),e.push(n,o,a),e.push(-1,0,0),e.push(1,0),t.push(12,15,13),t.push(12,14,15),e.push(n,o,a),e.push(0,1,0),e.push(0,1),e.push(n,o,u),e.push(0,1,0),e.push(0,0),e.push(r,o,a),e.push(0,1,0),e.push(1,1),e.push(r,o,u),e.push(0,1,0),e.push(1,0),t.push(16,19,17),t.push(16,18,19),e.push(n,i,u),e.push(0,-1,0),e.push(0,1),e.push(n,i,a),e.push(0,-1,0),e.push(0,0),e.push(r,i,u),e.push(0,-1,0),e.push(1,1),e.push(r,i,a),e.push(0,-1,0),e.push(1,0),t.push(20,23,21),t.push(20,22,23);var s=new tt.a(e,tt.a.Semantic.vertex,24,!0,3,4,0,32),l=new tt.a(e,tt.a.Semantic.normal,24,!0,3,4,12,32),c=new tt.a(e,tt.a.Semantic.texcoord,24,!0,2,4,24,32),f=new $n.a(t,er.a.triangles);this._geometryElements=[f],this._geometrySources=[s,l,c],this.boundingBox={min:new ue.a(n,i,u),max:new ue.a(r,o,a)}}},{key:"_updateBoundingBoxForSkinner",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this.boundingBox:rr(or(t.prototype),"_updateBoundingBoxForSkinner",this).call(this,e)}},{key:"_createFace",value:function(e,t,n,r,o,i,a,u){}},{key:"_createBtCollisionShape",value:function(){}}]),t}();function lr(e){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cr(e,t){return!t||"object"!==lr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fr(e,t,n){return(fr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hr(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function hr(e){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pr(e,t,n){return t&&yr(e.prototype,t),n&&yr(e,n),e}function mr(e,t){return(mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=cr(this,hr(t).call(this,[],[]))).capRadius=n,e.height=r,e.radialSegmentCount=24,e.capSegmentCount=48,e.heightSegmentCount=1,e._createGeometry(),e.materials.push(new Gn),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mr(e,t)}(t,Qn),pr(t,null,[{key:"_propTypes",get:function(){return{capsulecapRadius:["float","capRadius"],capsulecapSegmentCount:["integer","capSegmentCount"],capsuleheight:["float",null],capsuleheightSegmentCount:["integer",null],capsuleprimitiveType:["integer",null],capsuleradialSegmentCount:["integer","radialSegmentCount"],materials:"NSArray",subdivisionLevel:"integer",subdivisionSettings:["bytes",null],tessellator:"SCNGeometryTessellator",wantsAdaptiveSubdivision:"boolean"}}}]),pr(t,[{key:"_createGeometry",value:function(){for(var e=[],t=[],n=(2*this.radialSegmentCount+1)*(this.capSegmentCount+4),r=[],o=[],i=0;i<=this.capSegmentCount;i++)r.push(-Math.cos(Math.PI*i/this.capSegmentCount)),o.push(Math.sin(Math.PI*i/this.capSegmentCount));for(var a=this.height-2*this.capRadius,u=this.capSegmentCount/2,s=2*this.radialSegmentCount,l=0;l<=s;l++){for(var c=-Math.sin(2*Math.PI*l/s),f=-Math.cos(2*Math.PI*l/s),h=l/s,y=.5*-a,p=0;p<=u;p++){var m=c*o[p],d=f*o[p];e.push(m*this.capRadius,y+r[p]*this.capRadius,d*this.capRadius),e.push(m,r[p],d),e.push(h,1-.25*p/u),p===u&&(e.push(m*this.capRadius,y+r[p]*this.capRadius,d*this.capRadius),e.push(m,r[p],d),e.push(h,1-.25*p/u))}y=.5*a;for(var _=u;_<=this.capSegmentCount;_++){var g=c*o[_],v=f*o[_];e.push(g*this.capRadius,y+r[_]*this.capRadius,v*this.capRadius),e.push(g,r[_],v),e.push(h,.5-.25*_/u),_===u&&(e.push(g*this.capRadius,y+r[_]*this.capRadius,v*this.capRadius),e.push(g,r[_],v),e.push(h,.5-.25*_/u))}}for(var b=this.capSegmentCount,S=2*this.radialSegmentCount+1,w=0;w<b;w++){var T=w*(this.capSegmentCount+4),k=T+this.capSegmentCount+5;t.push(T,k,T+1),T+=1;for(var O=0;O<S;O++)1!==Math.abs(O-this.radialSegmentCount)&&(t.push(T,k+1,T+1),t.push(T,k,k+1)),T+=1,k+=1;t.push(T,k,k+1)}var C=new tt.a(e,tt.a.Semantic.vertex,n,!0,3,4,0,32),x=new tt.a(e,tt.a.Semantic.normal,n,!0,3,4,12,32),E=new tt.a(e,tt.a.Semantic.texcoord,n,!0,2,4,24,32),P=new $n.a(t,er.a.triangles);this._geometryElements=[P],this._geometrySources=[C,x,E],this.boundingBox={min:new ue.a(-this.capRadius,.5*-this.height,-this.capRadius),max:new ue.a(this.capRadius,.5*this.height,this.capRadius)}}},{key:"_createBtCollisionShape",value:function(){}},{key:"getBoundingSphere",value:function(){return{center:new ue.a(0,0,0),radius:.5*this.height}}},{key:"_updateBoundingBoxForSkinner",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this.boundingBox:fr(hr(t.prototype),"_updateBoundingBoxForSkinner",this).call(this,e)}}]),t}();function _r(e){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vr(e,t){return!t||"object"!==_r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function br(e){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sr(e,t){return(Sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wr=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=vr(this,br(t).call(this)))._node=null,e._geometryIndex=0,e._faceIndex=0,e._localCoordinates=null,e._worldCoordinates=null,e._localNormal=null,e._worldNormal=null,e._modelTransform=null,e._distance=null,e._boneNode=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sr(e,t)}(t,J["a"]),n=t,(r=[{key:"textureCoordinatesWithMappingChannel",value:function(e){return null}},{key:"node",get:function(){return this._node}},{key:"geometryIndex",get:function(){return this._geometryIndex}},{key:"faceIndex",get:function(){return this._faceIndex}},{key:"localCoordinates",get:function(){return this._localCoordinates}},{key:"worldCoordinates",get:function(){return this._worldCoordinates}},{key:"localNormal",get:function(){return this._localNormal}},{key:"worldNormal",get:function(){return this._worldNormal}},{key:"modelTransform",get:function(){return this._modelTransform}},{key:"boneNode",get:function(){return this._boneNode}}])&&gr(n.prototype,r),o&&gr(n,o),t}(),Tr={static:0,dynamic:1,kinematic:2};function kr(e){return(kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cr(e,t){return!t||"object"!==kr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xr(e){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Er(e,t){return(Er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pr=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Cr(this,xr(t).call(this)))._nodeA=null,e._nodeB=null,e._contactPoint=null,e._contactNormal=null,e._collisionImpulse=0,e._penetrationDistance=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Er(e,t)}(t,J["a"]),n=t,(r=[{key:"nodeA",get:function(){return this._nodeA}},{key:"nodeB",get:function(){return this._nodeB}},{key:"contactPoint",get:function(){return this._contactPoint}},{key:"contactNormal",get:function(){return this._contactNormal}},{key:"collisionImpulse",get:function(){return this._collisionImpulse}},{key:"penetrationDistance",get:function(){return this._penetrationDistance}}])&&Or(n.prototype,r),o&&Or(n,o),t}();function Ar(e){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nr(e,t){return!t||"object"!==Ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rr(e,t,n){return(Rr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fr(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fr(e){return(Fr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ir(e,t,n){return t&&Dr(e.prototype,t),n&&Dr(e,n),e}function Mr(e,t){return(Mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Nr(this,Fr(t).call(this,[],[]))).radius=n,e.isGeodesic=!1,e.segmentCount=24,e._sphereRadialSpan=0,e._spherePrimitiveType=0,e._isHemispheric=!1,e._createGeometry(),e.materials.push(new Gn),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mr(e,t)}(t,Qn),Ir(t,null,[{key:"_propTypes",get:function(){return{$constructor:function(e,n){var r=new t(n.sphereradius);return r.isGeodesic=n.spheregeodesic,r.segmentCount=n.spheresegmentCount,r.name=n.name,r._sphereRadialSpan=n.sphereRadialSpan,r._isHemispheric=n.spherehemispheric,r._spherePrimitiveType=n.sphereprimitiveType,r.materials=n.materials,r.tessellator=n.tessellator,r.subdivisionLevel=n.subdivisionLevel,r.wantsAdaptiveSubdivision=n.wantsAdaptiveSubdivision,r._createGeometry(),r},sphereradius:["float",null],spheregeodesic:["boolean",null],spheresegmentCount:["integer",null],materials:["NSArray",null],tessellator:["SCNGeometryTessellator",null],wantsAdaptiveSubdivision:["boolean",null],adaptiveSubdivision:["boolean",null],name:["string",null],sphereradialSpan:["float",null],spherehemispheric:["boolean",null],sphereprimitiveType:["integer",null],subdivisionLevel:["integer",null],subdivisionSettings:["bytes",null]}}}]),Ir(t,[{key:"_createGeometry",value:function(){for(var e=[],t=[],n=(this.segmentCount+1)*(this.segmentCount+1),r=(this.segmentCount,this.segmentCount,[]),o=[],i=0;i<=this.segmentCount;i++)r.push(-Math.cos(Math.PI*i/this.segmentCount)),o.push(Math.sin(Math.PI*i/this.segmentCount));for(var a=0;a<=this.segmentCount;a++)for(var u=-Math.sin(2*Math.PI*a/this.segmentCount),s=-Math.cos(2*Math.PI*a/this.segmentCount),l=0;l<=this.segmentCount;l++){var c=u*o[l],f=s*o[l];e.push(c*this.radius,r[l]*this.radius,f*this.radius),e.push(c,r[l],f),e.push(a/this.segmentCount,1-l/this.segmentCount)}for(var h=0;h<this.segmentCount;h++){var y=h*(this.segmentCount+1),p=y+this.segmentCount+2;t.push(y,p,y+1),y+=1;for(var m=0;m<this.segmentCount-2;m++)t.push(y,p+1,y+1),t.push(y,p,p+1),y+=1,p+=1;t.push(y,p,p+1)}var d=new tt.a(e,tt.a.Semantic.vertex,n,!0,3,4,0,32),_=new tt.a(e,tt.a.Semantic.normal,n,!0,3,4,12,32),g=new tt.a(e,tt.a.Semantic.texcoord,n,!0,2,4,24,32),v=new $n.a(t,er.a.triangles);this._geometryElements=[v],this._geometrySources=[d,_,g],this.boundingBox={min:new ue.a(-this.radius,-this.radius,-this.radius),max:new ue.a(this.radius,this.radius,this.radius)}}},{key:"_updateBoundingBoxForSkinner",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this.boundingBox:Rr(Fr(t.prototype),"_updateBoundingBoxForSkinner",this).call(this,e)}}]),t}();function Br(e){return(Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lr(e,t){return!t||"object"!==Br(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ur(e){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zr(e,t,n){return t&&Vr(e.prototype,t),n&&Vr(e,n),e}function Gr(e,t){return(Gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yr={collisionMargin:"SCNPhysicsShapeCollisionMarginKey",keepAsCompound:"SCNPhysicsShapeKeepAsCompoundKey",scale:"SCNPhysicsShapeScaleKey",type:"SCNPhysicsShapeTypeKey"},Xr={boundingBox:"boundingBox",concavePolyhedron:"concaveMesh",convexHull:"convexHull"},Hr=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=Lr(this,Ur(t).call(this));var o=r;if(Array.isArray(r)){o={};var i=!0,a=!1,u=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;o[c[0]]=c[1]}}catch(e){a=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw u}}}return n._sourceGeometry=null,n._options=o,n._transforms=null,n._shape=null,n._center=new ue.a(0,0,0),n._sourceObject=null,n._setSourceObject(e),n._createShape(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gr(e,t)}(t,J["a"]),zr(t,null,[{key:"_propTypes",get:function(){return{$constructor:function(e,n){return new t(n.referenceObject,n.options)},options:["NSArray",null],referenceObject:["NSObject",null],transform0:["SCNMatrix4",null],transform1:["SCNMatrix4",null],transform2:["SCNMatrix4",null],transform3:["SCNMatrix4",null],transformsCount:["integer",null]}}}]),zr(t,[{key:"_setSourceObject",value:function(e){this._sourceObject=e,Object(w.a)(this._sourceObject,Qn)?this._sourceGeometry=this._sourceObject:Object(w.a)(this._sourceObject,po)&&this._sourceObject.geometry&&(this._sourceGeometry=this._sourceObject.geometry),this._sourceGeometry}},{key:"_createShape",value:function(){this._sourceGeometry&&(this._options&&this._options[Yr.type]===Xr.boundingBox?this._createShapeAsBoundingBox():Object(w.a)(this._sourceGeometry,dr)?this._createShapeAsBoundingBox():Object(w.a)(this._sourceGeometry,sr)?this._createShapeAsBox():Object(w.a)(this._sourceGeometry,jr)?this._createShapeAsSphere():this._options&&this._options[Yr.type]===Xr.concavePolyhedron?this._shape=this._sourceGeometry:this._createShapeAsSphere())}},{key:"_createShapeAsBoundingBox",value:function(){var e=this._sourceGeometry._updateBoundingBox(),t=e.max.x-e.min.x,n=e.max.y-e.min.y,r=e.max.z-e.min.z,o=new sr(t,n,r,0);this._shape=o,this._center=new ue.a(e.min.x+.5*t,e.min.y+.5*n,e.min.z+.5*r)}},{key:"_createShapeAsBox",value:function(){this._shape=this._sourceGeometry,this._center=new ue.a(0,0,0)}},{key:"_createShapeAsSphere",value:function(){if(Object(w.a)(this._sourceGeometry,jr))return this._shape=this._sourceGeometry,void(this._center=new ue.a(0,0,0));var e=this._sourceGeometry.getBoundingSphere(),t=new jr(e.radius);this._shape=t,this._center=e.center}},{key:"_createBtCollisionShape",value:function(){if(null===this._sourceObject)throw new Error("_sourceObject is null");return this._sourceObject._createBtCollisionShape()}},{key:"sourceObject",get:function(){return this._sourceObject}},{key:"options",get:function(){return this._options}},{key:"_type",get:function(){return this._options?this._options[Yr.type]:null}},{key:"transforms",get:function(){return this._transforms}}],[{key:"Option",get:function(){return Yr}},{key:"ShapeType",get:function(){return Xr}}]),t}();function Wr(e){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Zr(e,t){return!t||"object"!==Wr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qr(e){return(qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qr(e,t,n){return t&&Jr(e.prototype,t),n&&Jr(e,n),e}function $r(e,t){return($r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eo={backfaceCulling:"backfaceCulling",collisionBitMask:"collisionBitMask",searchMode:"results"},to={all:"all",any:"any",closest:"closest"},no=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Zr(this,qr(t).call(this))).gravity=new ue.a(0,0,0),e.speed=0,e.timeStep=0,e._scale=1,e._allBehaviors=[],e.contactDelegate=null,e._prevTime=null,e._scene=null,e._renderer=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$r(e,t)}(t,J["a"]),Qr(t,null,[{key:"_propTypes",get:function(){return{gravity:"SCNVector3",speed:"double",timeStep:"double",scale:["double","_scale"],scene:["SCNScene","_scene"]}}}]),Qr(t,[{key:"updateCollisionPairs",value:function(){}},{key:"addBehavior",value:function(e){this._allBehaviors.indexOf(e)>=0||this._allBehaviors.push(e)}},{key:"removeBehavior",value:function(e){var t=this._allBehaviors.indexOf(e);t<0||this._allBehaviors.splice(t,1)}},{key:"removeAllBehaviors",value:function(){this._allBehaviors=[]}},{key:"contactTestBetween",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0==(e.categoryBitMask&n.contactTestBitMask))return[];if(!e.physicsShape||!n.physicsShape)return[];if(e.type===Tr.static&&n.type===Tr.static)return[];if(e._position.sub(n._position).length()>e._radius+n._radius)return[];var o=e.physicsShape._shape,i=n.physicsShape._shape;return o instanceof sr&&i instanceof sr?t._contactTestBetweenBoxes(e,n,r):o instanceof sr&&i instanceof jr?t._contactTestBetweenBoxAndSphere(e,n,r):i instanceof sr&&o instanceof jr?t._contactTestBetweenBoxAndSphere(n,e,r,!0):o instanceof jr&&i instanceof jr?t._contactTestBetweenSpheres(e,n,r):[]}},{key:"contactTestWith",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return[]}},{key:"rayTestWithSegmentFromTo",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=r;Array.isArray(r)?o=new Map(r):null===r&&(o=new Map);var i=[],a=-1,u=to.any;if(o.has(eo.backfaceCulling)&&o.get(eo.backfaceCulling),o.has(eo.collisionBitMask)&&(a=o.get(eo.collisionBitMask)),o.has(eo.searchMode)&&(u=o.get(eo.searchMode)),this._scene.rootNode.enumerateChildNodes(function(r){if(r.presentation&&r.presentation.physicsBody&&r.presentation.physicsBody.categoryBitMask&a){var o=t._hitTestWithSegmentPhysicsNode(e,n,r.presentation);if(o.length>0){var s=!0,l=!1,c=void 0;try{for(var f,h=o[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var y=f.value;y._node=r,y._worldCoordinates=r.convertPositionTo(y._localCoordinates,null),y._worldNormal=r.convertPositionTo(y._localNormal,null),y._localCoordinates=r.convertPositionFrom(y._localCoordinates,r),y._localNormal=r.convertPositionFrom(y._localNormal,r)}}catch(e){l=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(l)throw c}}if(i.push.apply(i,Kr(o)),u===to.any)return!0}}return!1}),0===i.length)return i;var s=i.sort(function(e,t){return e._distance-t._distance});return u===to.closest&&(s=[s[0]]),s}},{key:"convexSweepTestWith",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return[]}},{key:"_simulate",value:function(e){if(this._renderer){var n=this._renderer._createRenderingPhysicsNodeArray(),r=[],o=!0,i=!1,a=void 0;try{for(var u,s=n[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value.physicsBody;l._prevPosition=l._position,l.type===Tr.kinematic?l._resetTransform():(l.type,Tr.dynamic),l._positionDiff=l._position.sub(l._prevPosition)}}catch(e){i=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}Tr.static;for(var c=0;c<n.length;c++){var f=n[c].presentation.physicsBody;f.physicsShape._sourceGeometry instanceof dr&&r.push.apply(r,Kr(t._capsuleTestWithObjects(f,n)));for(var h=0;h<n.length;h++)if(c!==h){var y=n[h].presentation.physicsBody;r.push.apply(r,Kr(this.contactTestBetween(f,y)))}}if(this.contactDelegate)for(var p=0;p<r.length;p++){var m=r[p];this.contactDelegate.physicsWorldDidBegin&&this.contactDelegate.physicsWorldDidBegin(this,m)}var d=!0,_=!1,g=void 0;try{for(var v,b=n[Symbol.iterator]();!(d=(v=b.next()).done);d=!0){var S=v.value.physicsBody;S._prevPosition=S._position}}catch(e){_=!0,g=e}finally{try{d||null==b.return||b.return()}finally{if(_)throw g}}}}},{key:"allBehaviors",get:function(){return this._allBehaviors.slice(0)}}],[{key:"_contactTestBetweenBoxes",value:function(e,t,n){var r=e.physicsShape._shape,o=t.physicsShape._shape,i=t._transform.mult(e._invTransform),a=new ue.a(i.m11,i.m12,i.m13).normalize(),u=new ue.a(i.m21,i.m22,i.m23).normalize(),s=new ue.a(i.m31,i.m32,i.m33).normalize(),l=a.mul(.5*o.width),c=u.mul(.5*o.height),f=s.mul(.5*o.length),h=i.getTranslation(),y=.5*r.width,p=.5*r.height,m=.5*r.length,d=y,_=Math.abs(l.x)+Math.abs(c.x)+Math.abs(f.x),g=Math.abs(h.x);if(g>d+_)return[];if(d=p,_=Math.abs(l.y)+Math.abs(c.y)+Math.abs(f.y),(g=Math.abs(h.y))>d+_)return[];if(d=m,_=Math.abs(l.z)+Math.abs(c.z)+Math.abs(f.z),(g=Math.abs(h.z))>d+_)return[];if(d=Math.abs(a.x*y)+Math.abs(a.y*p)+Math.abs(a.z*m),_=l.length(),(g=Math.abs(h.dot(a)))>d+_)return[];if(d=Math.abs(u.x*y)+Math.abs(u.y*p)+Math.abs(u.z*m),_=c.length(),(g=Math.abs(h.dot(u)))>d+_)return[];if(d=Math.abs(s.x*y)+Math.abs(s.y*p)+Math.abs(s.z*m),_=f.length(),(g=Math.abs(h.dot(s)))>d+_)return[];var v=new ue.a(0,-a.z,a.y);if(d=Math.abs(v.y*p)+Math.abs(v.z*m),_=Math.abs(v.dot(c))+Math.abs(v.dot(f)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(0,-u.z,u.y),d=Math.abs(v.y*p)+Math.abs(v.z*m),_=Math.abs(v.dot(f))+Math.abs(v.dot(l)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(0,-s.z,s.y),d=Math.abs(v.y*p)+Math.abs(v.z*m),_=Math.abs(v.dot(l))+Math.abs(v.dot(c)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(a.z,0,-a.x),d=Math.abs(v.x*y)+Math.abs(v.z*m),_=Math.abs(v.dot(c))+Math.abs(v.dot(f)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(u.z,0,-u.x),d=Math.abs(v.x*y)+Math.abs(v.z*m),_=Math.abs(v.dot(f))+Math.abs(v.dot(l)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(s.z,0,-s.x),d=Math.abs(v.x*y)+Math.abs(v.z*m),_=Math.abs(v.dot(l))+Math.abs(v.dot(c)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(-a.y,a.x,0),d=Math.abs(v.x*y)+Math.abs(v.y*p),_=Math.abs(v.dot(c))+Math.abs(v.dot(f)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(-u.y,u.x,0),d=Math.abs(v.x*y)+Math.abs(v.y*p),_=Math.abs(v.dot(f))+Math.abs(v.dot(l)),(g=Math.abs(h.dot(v)))>d+_)return[];if(v=new ue.a(-s.y,s.x,0),d=Math.abs(v.x*y)+Math.abs(v.y*p),_=Math.abs(v.dot(l))+Math.abs(v.dot(c)),(g=Math.abs(h.dot(v)))>d+_)return[];var b=new Pr;return b._nodeA=e._node,b._nodeB=t._node,b._contactPoint=e._position.add(h.mul(.5)),b._contactNormal=h.normalize(),b._penetrationDistance=0,[b]}},{key:"_contactTestBetweenSpheres",value:function(e,t,n){var r=e.physicsShape._shape,o=t.physicsShape._shape,i=e._position,a=t._position,u=r.radius,s=o.radius,l=i.sub(a),c=l.length();if(c>u+s)return[];var f=new Pr;return f._nodeA=e._node,f._nodeB=t._node,f._contactPoint=i.add(l.mul(.5*(u-s+c))),f._contactNormal=l.mul(-1).normalize(),f._penetrationDistance=u+s-c,[f]}},{key:"_contactTestBetweenBoxAndSphere",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.physicsShape._shape,o=t.physicsShape._shape,i=(new ue.a,t._position.transform(e._invTransform)),a=new ue.a,u=.5*r.width,s=.5*r.height,l=.5*r.length;Math.abs(i.x)-u<=0?a.x=0:a.x=i.x-u,Math.abs(i.y)-s<=0?a.y=0:a.y=i.y-s,Math.abs(i.z)-l<=0?a.z=0:a.z=i.z-l;var c=a.length();if(c>o.radius)return[];var f=new Pr;return n?(f._nodeA=t._node,f._nodeB=e._node):(f._nodeA=e._node,f._nodeB=t._node),f._contactPoint=a.transform(e._transform),f._contactNormal=a.rotate(e._transform).normalize(),n&&(f._contactNormal=f._contactNormal.mul(-1)),f._penetrationDistance=c-o.radius,[f]}},{key:"_capsuleTestWithObjects",value:function(e,t){var n=[],r=t.filter(function(t){var n=t.presentation.physicsBody;return n!==e&&(n.physicsShape._type===Hr.ShapeType.concavePolyhedron&&(0!=(e.categoryBitMask&n.contactTestBitMask)||0!=(n.categoryBitMask&e.contactTestBitMask)))});if(0===r.length)return n;e._node._worldTransform,e.physicsShape._sourceGeometry;var o=!0,i=!1,a=void 0;try{for(var u,s=r[Symbol.iterator]();!(o=(u=s.next()).done);o=!0){var l=u.value;if(this._intersectsBoundingBox(e._node,l)){var c=this._contactTestCapsuleAndConcave(e._node,l);n.push.apply(n,Kr(c))}}}catch(e){i=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return n}},{key:"_intersectsBoundingBox",value:function(e,t){var n=e._worldTranslation,r=t._worldTranslation,o=e.physicsBody.physicsShape._sourceGeometry,i=t.physicsBody.physicsShape._sourceGeometry;if(!o||!i)return!1;var a=o.boundingBox,u=i.boundingBox;return!(a.min.x+n.x>u.max.x+r.x||a.max.x+n.x<u.min.x+r.x)&&(!(a.min.y+n.y>u.max.y+r.y||a.max.y+n.y<u.min.y+r.y)&&!(a.min.z+n.z>u.max.z+r.z||a.max.z+n.z<u.min.z+r.z))}},{key:"_contactTestCapsuleAndConcave",value:function(e,t){var n=[],r=e.physicsBody,o=t.physicsBody,i=r.physicsShape._sourceGeometry,a=o.physicsShape._sourceGeometry,u=r._transform.mult(o._invTransform),s=i.capRadius,l=.5*i.height-s,c=(r._positionDiff.rotate(u).normalize(),new ue.a(0,l,0).transform(u)),f=new ue.a(0,-l,0).transform(u),h=a.geometryElements,y=a.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],p=!0,m=!1,d=void 0;try{for(var _,g=h[Symbol.iterator]();!(p=(_=g.next()).done);p=!0){var v=_.value;if(v._primitiveType===er.a.triangles)for(var b=v._data,S=v._primitiveCount,w=0,T=0;T<S;T++){var k=y._scnVectorAt(b[w]),O=y._scnVectorAt(b[w+1]),C=y._scnVectorAt(b[w+2]);w+=3;var x=this._capsuleTriangleContact(c,f,s,k,O,C);if(x){var E=new Pr;E._nodeA=e,E._nodeB=t,E._contactPoint=x.point,E._contactNormal=x.normal,E._penetrationDistance=x.penetration,n.push(E)}}}}catch(e){m=!0,d=e}finally{try{p||null==g.return||g.return()}finally{if(m)throw d}}return n}},{key:"_capsuleTriangleContact",value:function(e,t,n,r,o,i){t.sub(e);var a=this._segmentTriangleIntersection(e,t,r,o,i);if(a.intersection){var u=0;return u=a.d0<0?n-a.d0:n-a.d1,{point:a.intersection,normal:a.normal,distance:0,penetration:u}}var s=this._segmentSegmentDist(e,t,r,o),l=this._segmentSegmentDist(e,t,o,i);l.distance<s.distance&&(s=l);var c=this._segmentSegmentDist(e,t,i,r);c.distance<s.distance&&(s=c);var f=e.add(a.normal.mul(-a.d0));this._pointIsInsideTriangle(f,r,o,i)&&Math.abs(a.d0)<s.distance&&(s.distance=Math.abs(a.d0),s.nearestPos1=f);var h=t.add(a.normal.mul(-a.d1));return this._pointIsInsideTriangle(h,r,o,i)&&Math.abs(a.d1)<s.distance&&(s.distance=Math.abs(a.d1),s.nearestPos1=h),s.distance<n?{point:s.nearestPos1,normal:a.normal,distance:0,penetration:n-s.distance}:null}},{key:"_segmentTriangleIntersection",value:function(e,t,n,r,o){var i=e.sub(n),a=t.sub(n),u=this._normalOfTriangle(n,r,o),s=i.dot(u),l=a.dot(u),c={normal:u,d0:s,d1:l,intersection:null};if(s*l>0)return c;var f=s/(s-l),h=i.mul(1-f).add(a.mul(f)).add(n);return this._pointIsInsideTriangle(h,n,r,o)?(c.intersection=h,c):c}},{key:"_normalOfTriangle",value:function(e,t,n){var r=t.sub(e),o=n.sub(e);return r.cross(o).normalize()}},{key:"_pointIsInsideTriangle",value:function(e,t,n,r){var o=this._normalOfTriangle(t,n,r),i=n.sub(t).cross(o).dot(e.sub(t)),a=r.sub(n).cross(o).dot(e.sub(n)),u=t.sub(r).cross(o).dot(e.sub(r));return i<0&&a<0&&u<0||i>0&&a>0&&u>0}},{key:"_pointLineDist",value:function(e,t,n){var r=n.length2(),o=0;r>0&&(o=n.dot(e.sub(t))/r);var i=t.add(n.mul(o)),a=i.sub(e).length();return{coeff:o,nearestPos:i,distance:a}}},{key:"_pointSegmentDist",value:function(e,t,n){var r=n.sub(t),o=this._pointLineDist(e,t,r);if(o.coeff<0){var i=t.sub(e).length();return{coeff:o.coeff,nearestPos:t,distance:i}}if(o.coeff>1){var a=n.sub(e).length();return{coeff:o.coeff,nearestPos:n,distance:a}}return o}},{key:"_lineLineDist",value:function(e,t,n,r){if(this._isParallel(t,r)){var o=this._pointLineDist(e,n,r);return{coeff0:0,nearestPos0:e,coeff1:o.coeff,nearestPos1:o.nearestPos,distance:o.distance}}var i=t.dot(r),a=t.dot(t),u=r.dot(r),s=e.sub(n),l=(i*r.dot(s)-u*t.dot(s))/(a*u-i*i),c=e.add(t.mul(l)),f=r.dot(c.sub(n))/u,h=n.add(r.mul(f)),y=h.sub(c).length();return{coeff0:l,nearestPos0:c,coeff1:f,nearestPos1:h,distance:y}}},{key:"_isParallel",value:function(e,t){return e.cross(t).length2()<1e-13}},{key:"_clamp",value:function(e){return e<0?0:e>1?1:e}},{key:"_segmentSegmentDist",value:function(e,t,n,r){var o=t.sub(e),i=r.sub(n),a=null;if(this._isParallel(o,i)){if(0<=(a=this._pointSegmentDist(e,n,r)).coeff&&a.coeff<=1)return{coeff0:0,nearestPos0:e,coeff1:a.coeff,nearestPos1:a.nearestPos,distance:a.distance};a.coeff0=0,a.coeff1=a.coeff}else if(0<=(a=this._lineLineDist(e,o,n,i)).coeff0&&a.coeff0<=1&&0<=a.coeff1&&a.coeff1<=1)return a;var u=a,s=this._clamp(a.coeff0);if(s!==a.coeff0){var l=e.add(o.mul(s));if(0<=(u=this._pointSegmentDist(l,n,r)).coeff&&u.coeff<=1)return{coeff0:s,nearestPos0:l,coeff1:u.coeff,nearestPos1:u.nearestPos,distance:u.distance};u.coeff1=u.coeff}var c=this._clamp(u.coeff1),f=n.add(i.mul(c)),h=this._pointSegmentDist(f,e,t);if(0<=h.coeff&&h.coeff<=1)return{coeff0:h.coeff,nearestPos0:h.nearestPos,coeff1:c,nearestPos1:f,distance:h.distance};var y=this._clamp(h.coeff),p=e.add(o.mul(y)),m=f.sub(p).length();return{coeff0:y,nearestPos0:p,coeff1:c,nearestPos1:f,distance:m}}},{key:"_hitTestWithSegmentNode",value:function(e,t,n){var r=n;n.presentation&&n.presentation.geometry&&(r=n.presentation);var o=r.geometry;if(!o)return[];var i=r.convertPositionFrom(e,null),a=r.convertPositionFrom(t,null),u=this._segmentBoundingBoxIntersects(i,a,o.boundingBox);return null!==u?(console.error("segmentBoundingBoxIntersects: "+u.near+", "+u.far),this._hitTestWithSegmentGeometry(i,a,o)):[]}},{key:"_hitTestWithSegmentPhysicsNode",value:function(e,t,n){var r=n;n.presentation&&n.presentation.physicsBody&&(r=n.presentation);var o=r.physicsBody;if(null===o)return[];var i=o.physicsShape;if(null===i)return[];var a=i._sourceGeometry;if(null===a)return[];var u=e.transform(o._invTransform),s=t.transform(o._invTransform);return null!==this._segmentBoundingBoxIntersects(u,s,a.boundingBox)?this._hitTestWithSegmentGeometry(u,s,a):[]}},{key:"_segmentBoundingBoxIntersects",value:function(e,t,n){var r=t.sub(e),o=this._lineBoundingBoxIntersects(e,r,n);return null===o?null:o.near>1||o.far<0?null:o}},{key:"_lineBoundingBoxIntersects",value:function(e,t,n){var r=new ue.a(1/t.x,1/t.y,1/t.z),o=n.min,i=n.max,a=o.sub(e).mulv(r),u=i.sub(e).mulv(r),s=-1/0,l=1/0;if(Math.abs(t.x)<1e-6){if(e.x<o.x||i.x<e.x)return null}else a.x<u.x?(s=Math.max(s,a.x),l=Math.min(l,u.x)):(s=Math.max(s,u.x),l=Math.min(l,a.x));if(Math.abs(t.y)<1e-6){if(e.y<o.y||i.y<e.y)return null}else a.y<u.y?(s=Math.max(s,a.y),l=Math.min(l,u.y)):(s=Math.max(s,u.y),l=Math.min(l,a.y));if(Math.abs(t.z)<1e-6){if(e.z<o.z||i.z<e.z)return null}else a.z<u.z?(s=Math.max(s,a.z),l=Math.min(l,u.z)):(s=Math.max(s,u.z),l=Math.min(l,a.z));return s>l?null:{near:s,far:l}}},{key:"_hitTestWithSegmentGeometry",value:function(e,t,n){for(var r=[],o=n.geometryElements,i=o.length,a=n.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],u=0;u<i;u++){var s=o[u];if(s._primitiveType===er.a.triangles)for(var l=s._data,c=s._primitiveCount,f=0,h=0;h<c;h++){var y=a._scnVectorAt(l[f]),p=a._scnVectorAt(l[f+1]),m=a._scnVectorAt(l[f+2]);f+=3;var d=this._segmentTriangleIntersection(e,t,y,p,m);if(d.intersection){var _=new wr;_._geometryIndex=u,_._faceIndex=h,_._localCoordinates=d.intersection,_._localNormal=d.normal,_._distance=d.intersection.sub(e).length(),r.push(_)}}}return r}},{key:"TestOption",get:function(){return eo}},{key:"TestSearchMode",get:function(){return to}}]),t}();function ro(e){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oo(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function io(e,t){return!t||"object"!==ro(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ao(e,t,n){return(ao="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uo(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uo(e){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lo(e,t,n){return t&&so(e.prototype,t),n&&so(e,n),e}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fo=new ue.a(0,0,1),ho=new ue.a(1,0,0),yo=new ue.a(0,1,0),po=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=io(this,uo(t).call(this))).name=null,e.light=null,e.camera=null,e._geometry=n,e.morpher=null,e.skinner=null,e.categoryBitMask=0,e.isPaused=!1,e._presentation=null,e._isPresentationInstance=!1,e._transform=new It.a,e._worldTransform=new It.a,e._transformUpToDate=!1,e._position=new ue.a(0,0,0),e._rotation=new se.a(1,0,0,0),e._scale=new ue.a(1,1,1),e.pivot=null,e.constraints=null,e.isHidden=!1,e._opacity=1,e._worldOpacity=1,e.renderingOrder=0,e.castsShadow=!1,e.movabilityHint=on.fixed,e._parent=null,e._childNodes=[],e.filters=null,e.rendererDelegate=null,e._physicsBody=null,e.physicsField=null,e._particleSystems=null,e._audioPlayers=[],e.entity=null,e.focusBehavior=null,e._actions=new Map,e._animations=new sn,e._animationPlayers=new sn,e._boundingBox=null,e._fixedBoundingBox=null,e._entityID=null,e._nodeID=null,e._updateBoundingBox(),e._loadedPromise=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(t,J["a"]),lo(t,null,[{key:"_propTypes",get:function(){var e=this;return{name:"string",light:"SCNLight",camera:"SCNCamera",geometry:["SCNGeometry",function(e,t){e.geometry=t,e.boundingBox=t.boundingBox}],morpher:"SCNMorpher",skinner:"SCNSkinner",categoryBitMask:"integer",paused:["boolean","isPaused"],position:["SCNVector3","_position"],rotation:["SCNVector4","_rotation"],orientation:["SCNVector4",function(e,t){e.orientation=t}],scale:["SCNVector3","_scale"],hidden:["boolean","isHidden"],opacity:["float","_opacity"],renderingOrder:"integer",castsShadow:"boolean",childNodes:["NSArray",function(e,t){t.forEach(function(t){t&&e.addChildNode(t)})}],physicsBody:["SCNPhysicsBody",function(e,t){e.physicsBody=t}],physicsField:"SCNPhysicsField",particleSystem:["NSArray","_particleSystems"],animations:["NSMutableDictionary",function(t,n){e._loadAnimationArray(t,n),t._setAnimationsToPlayers()}],"animation-keys":["NSMutableArray",function(e,t){e._animationPlayers._keys=t}],"animation-players":["NSMutableArray",function(e,t){e._animationPlayers._values=t,e._setAnimationsToPlayers()}],"action-keys":["NSArray",null],actions:["NSMutableDictionary",function(t,n){e._loadActionArray(t,n)}],eulerAngles:["SCNVector3",function(e,t){e.eulerAngles=t}],movabilityHint:"integer",clientAttributes:["NSMutableDictionary",null],nodeID:["string","_nodeID"],entityID:["string","_entityID"]}}}]),lo(t,[{key:"_createPresentation",value:function(){if(!this._isPresentationInstance&&!this._presentation){var e=this.copy();if(e._isPresentationInstance=!0,null!==this.geometry&&(e.geometry=this.geometry.copy(),e.geometry._isPresentationInstance=!0,e.geometry._geometryElements=[],this.geometry._geometryElements.forEach(function(t){e.geometry._geometryElements.push(t.copy())}),e.geometry._geometrySources=[],this.geometry._geometrySources.forEach(function(t){e.geometry._geometrySources.push(t.copy())}),this.geometry._presentation=e.geometry),this._particleSystems){e._particleSystems=[];var t=!0,n=!1,r=void 0;try{for(var o,i=this._particleSystems[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value._createPresentation();e._particleSystems.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}this._presentation=e}}},{key:"_updateWorldTransform",value:function(){var e=null;if(e=null===this._parent?Object(Z.a)(0,0,0):this._parent._worldTransform,this._worldTransform=this.transform.mult(e),this._presentation){var t=null,n=1;null===this._parent?t=Object(Z.a)(0,0,0):null===this._parent._presentation?(t=this._parent._worldTransform,n=this._parent._worldOpacity):(t=this._parent._presentation._worldTransform,n=this._parent._presentation._worldOpacity),this._presentation._updateTransform(),this._presentation._worldTransform=this._presentation.transform.mult(t),this._presentation._worldOpacity=this._presentation._opacity*n}this._childNodes.forEach(function(e){e._updateWorldTransform()})}},{key:"addChildNode",value:function(e){this._childNodes.indexOf(e)>=0||(e.removeFromParentNode(),this._childNodes.push(e),e._parent=this,e._resetPhysicsTransformRecursively(!0))}},{key:"insertChildNodeAt",value:function(e,t){this._childNodes.indexOf(e)>=0||(e.removeFromParentNode(),this._insertObjectInChildNodesAtIndex(e,t),this._parent=this)}},{key:"removeFromParentNode",value:function(){var e=this._parent;if(null!==e){var t=e._childNodes.indexOf(this);t<0||e._removeObjectFromChildNodesAtIndex(t)}}},{key:"replaceChildNodeWith",value:function(e,t){var n=this._childNodes.indexOf(e);n<0||(this._removeObjectFromChildNodesAtIndex(n),this._insertObjectInChildNodesAtIndex(t,n))}},{key:"_removeObjectFromChildNodesAtIndex",value:function(e){var t=this._childNodes.splice(e,1);if(0!==t.length){var n=t[0];n._parent=null,n._transformUpToDate=!1}}},{key:"_insertObjectInChildNodesAtIndex",value:function(e,t){var n=this._childNodes.length;if(t>n)throw new Error("SCNNode.childNodes out of index: ".concat(t," > ").concat(n));this._childNodes.splice(t,0,e)}},{key:"childNodesPassingTest",value:function(e){return[]}},{key:"childNodeWithNameRecursively",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0;n<this._childNodes.length;n++){if(this._childNodes[n].name===e)return this._childNodes[n];if(t){var r=this._childNodes[n].childNodeWithNameRecursively(e,t);if(null!==r)return r}}return null}},{key:"childNodeWithName",value:function(e){return this.childNodeWithNameRecursively(e,!1)}},{key:"_childNodeWithNodeIDRecursively",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0;n<this._childNodes.length;n++){if(this._childNodes[n]._nodeID===e)return this._childNodes[n];if(t){var r=this._childNodes[n]._childNodeWithNodeIDRecursively(e,t);if(null!==r)return r}}return null}},{key:"_childNodeWithNodeID",value:function(e){return this._childNodeWithNodeIDRecursively(name,!1)}},{key:"enumerateChildNodes",value:function(e){var t=this;this.childNodes.some(function(n){return t._enumerateChildNodesRecursive(n,e)})}},{key:"enumerateHierarchy",value:function(e){this._enumerateChildNodesRecursive(this,e)}},{key:"_enumerateChildNodesRecursive",value:function(e,t){var n=this,r=t(e);return!0===r||(r=e._childNodes.some(function(e){return n._enumerateChildNodesRecursive(e,t)}))}},{key:"_resetPhysicsTransformRecursively",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._physicsBody&&this._physicsBody._resetTransform(e);var t=!0,n=!1,r=void 0;try{for(var o,i=this._childNodes[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value._resetPhysicsTransformRecursively(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"addParticleSystem",value:function(e){null===this._particleSystems&&(this._particleSystems=[]),e.reset(),this._particleSystems.push(e)}},{key:"removeParticleSystem",value:function(e){if(null!==this._particleSystems){var t=this._particleSystems.indexOf(e);this._particleSystems.splice(t,1)}}},{key:"removeAllParticleSystems",value:function(){this._particleSystems=[]}},{key:"addAudioPlayer",value:function(e){this._audioPlayers.indexOf(e)<0&&(this._audioPlayers.push(e),e._play())}},{key:"removeAudioPlayer",value:function(e){var t=this._audioPlayers.indexOf(e);t>=0&&(e._stop(),delete this._audioPlayers[t])}},{key:"removeAllAudioPlayers",value:function(){this._audioPlayers.forEach(function(e){e._stop()}),this._audioPlayers=[]}},{key:"clone",value:function(){var e=this.copy();return this._childNodes.forEach(function(t){e.addChildNode(t.clone())}),e}},{key:"flattenedClone",value:function(){return null}},{key:"hitTestWithSegmentFromTo",value:function(e,t){var n=this,r=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.convertPositionTo(e,null)),o=this.convertPositionTo(t,null),i=[];return this.enumerateChildNodes(function(e){if(e.presentation.geometry){var t=no._hitTestWithSegmentNode(r,o,e.presentation);if(t.length>0){var a=!0,u=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;f._node=e,f._worldCoordinates=e.convertPositionTo(f._localCoordinates,null),f._worldNormal=e.convertPositionTo(f._localNormal,null),f._localCoordinates=n.convertPositionFrom(f._localCoordinates,e),f._localNormal=n.convertPositionFrom(f._localNormal,e)}}catch(e){u=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}i.push.apply(i,oo(t))}}}),i.length>0&&console.error("hitTestWithSegmentFromTo: "+i.length),i}},{key:"convertPositionFrom",value:function(e,t){return null===t?e.transform(this._worldTransform.invert()):e.transform(t._worldTransform).transform(this._worldTransform.invert())}},{key:"convertPositionTo",value:function(e,t){return null===t?e.transform(this._worldTransform):e.transform(this._worldTransform).transform(t._worldTransform.invert())}},{key:"convertTransformFrom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t?e.mult(this._worldTransform.invert()):e.mult(t._worldTransform).mult(this._worldTransform.invert())}},{key:"convertTransformTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t?e.mult(this._worldTransform):e.mult(this._worldTransform).mult(t._worldTransform.invert())}},{key:"convertVectorFrom",value:function(e,t){}},{key:"convertVectorTo",value:function(e,t){}},{key:"localRotateBy",value:function(e){}},{key:"localTranslateBy",value:function(e){}},{key:"lookAt",value:function(e){}},{key:"lookAtUp",value:function(e,t,n){}},{key:"rotateByAroundTarget",value:function(e,t){}},{key:"setWorldTransform",value:function(e){}},{key:"runAction",value:function(e){this.runActionForKey(e,Symbol())}},{key:"runActionCompletionHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.runActionForKeyCompletionHandler(e,Symbol(),t)}},{key:"runActionForKey",value:function(e,t){this.runActionForKeyCompletionHandler(e,t,null)}},{key:"runActionForKeyCompletionHandler",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null==t&&(t=Symbol());var r=e.copy();r._actionStartTime=.001*Date.now(),r._completionHandler=n,this._actions.set(t,r)}},{key:"actionForKey",value:function(e){return this._actions.get(e)}},{key:"removeActionForKey",value:function(e){this._actions.delete(e)}},{key:"removeAllActions",value:function(){this._actions.clear()}},{key:"addAnimationForKey",value:function(e,t){null==t&&(t=Symbol());var n=e;n._animationStartTime=.001*Date.now(),this._animations.set(t,n),this._copyTransformToPresentationRecursive()}},{key:"animationForKey",value:function(e){return this._animations.get(e)}},{key:"removeAllAnimations",value:function(){this._animations.clear()}},{key:"removeAnimationForKey",value:function(e){this.removeAnimationForKeyBlendOutDuration(e,0)}},{key:"removeAnimationForKeyBlendOutDuration",value:function(e,t){this._animations.delete(e),this._copyTransformToPresentationRecursive()}},{key:"removeAnimationForKeyFadeOutDuration",value:function(e,t){this.removeAnimationForKey(e)}},{key:"pauseAnimationForKey",value:function(e){}},{key:"resumeAnimationForKey",value:function(e){}},{key:"isAnimationPausedForKey",value:function(e){return!1}},{key:"setAnimationSpeedForKey",value:function(e,t){}},{key:"_setAnimationsToPlayers",value:function(){var e=this._animationPlayers._values.length;if(e>0&&this._animations._values.length>0)for(var t=0;t<e;t++)this._animationPlayers._values[t]._animation=this._animations._values[t]}},{key:"addAnimationPlayerForKey",value:function(e,t){null==t&&(t=Symbol()),this._animationPlayers.set(t,e),this._copyTransformToPresentationRecursive()}},{key:"animationPlayerForKey",value:function(e){return this._animationPlayers.get(e)}},{key:"_geometryBoundingBox",value:function(){if(null===this._geometry)return{min:new ue.a(1/0,1/0,1/0),max:new ue.a(-1/0,-1/0,-1/0)};var e=this._geometry.boundingBox;if(this.skinner&&this.skinner.baseGeometryBindTransform){var t=this.skinner.baseGeometryBindTransform.m41,n=this.skinner.baseGeometryBindTransform.m42,r=this.skinner.baseGeometryBindTransform.m43;e.min.x+=t,e.min.y+=n,e.min.z+=r,e.max.x+=t,e.max.y+=n,e.max.z+=r}return e}},{key:"_updateBoundingBox",value:function(){var e=this._geometryBoundingBox(),t=this._presentation?this._presentation:this;null!==t.geometry&&(null===e&&(e=t.geometry._updateBoundingBox()),e=this._unionBoundingBox(e,t.geometry.boundingBox));var n=t._scale;if(n.x<0){var r=e.max.x*n.x,o=e.min.x*n.x;e.min.x=r,e.max.x=o}else e.min.x*=n.x,e.max.x*=n.x;if(n.y<0){var i=e.max.y*n.y,a=e.min.y*n.y;e.min.y=i,e.max.y=a}else e.min.y*=n.y,e.max.y*=n.y;if(n.z<0){var u=e.max.z*n.z,s=e.min.z*n.z;e.min.z=u,e.max.z=s}else e.min.z*=n.z,e.max.z*=n.z;var l=!0,c=!1,f=void 0;try{for(var h,y=this._childNodes[Symbol.iterator]();!(l=(h=y.next()).done);l=!0){var p=h.value._updateBoundingBox();e=this._unionChildBoundingBox(e,p)}}catch(e){c=!0,f=e}finally{try{l||null==y.return||y.return()}finally{if(c)throw f}}return this._boundingBox=e,e}},{key:"_unionBoundingBox",value:function(e,t){if(null===e)return t;if(null===t)return e;var n=new ue.a,r=new ue.a;return n.x=Math.min(e.min.x,t.min.x),n.y=Math.min(e.min.y,t.min.y),n.z=Math.min(e.min.z,t.min.z),r.x=Math.max(e.max.x,t.max.x),r.y=Math.max(e.max.y,t.max.y),r.z=Math.max(e.max.z,t.max.z),{min:n,max:r}}},{key:"_unionChildBoundingBox",value:function(e,t){var n=this._presentation?this._presentation:this,r=n._position,o=n._scale,i=new ue.a((t.min.x+r.x)*o.x,(t.min.y+r.y)*o.y,(t.min.z+r.z)*o.z),a=new ue.a((t.max.x+r.x)*o.x,(t.max.y+r.y)*o.y,(t.max.z+r.z)*o.z);return this._unionBoundingBox(e,{min:i,max:a})}},{key:"_updateTransform",value:function(){var e=It.a.matrixWithScale(this._scale).rotation(this._rotation).translation(this._position);this._transform=e,this._transformUpToDate=!0}},{key:"copy",value:function(){var e=new t;return e.name=this.name,e.light=this.light,e.camera=this.camera,e._geometry=this._geometry,e.morpher=this.morpher?this.morpher._copy():null,e.skinner=this.skinner,e.categoryBitMask=this.categoryBitMask,e.isPaused=this.isPaused,e._presentation=this._presentation?this._presentation.copy():null,e._isPresentationInstance=this._isPresentationInstance,e.constraints=this.constraints?this.constraints.slice(0):null,e.isHidden=this.isHidden,e._opacity=this._opacity,e.renderingOrder=this.renderingOrder,e.castsShadow=this.castsShadow,e.movabilityHint=this.movabilityHint,e.filters=this.filters?this.filters.slice(0):null,e.rendererDelegate=this.rendererDelegate,e._physicsBody=this._physicsBody,e.physicsField=this.physicsField,e._particleSystems=this._particleSystems?this._particleSystems.slice(0):null,e._audioPlayers=this._audioPlayers,e._actions=new Map(this._actions),e._animations=this._animations.copy(),e._boundingBox=this._boundingBox,e._position=new ue.a(this._position.x,this._position.y,this._position.z),e._rotation=new se.a(this._rotation.x,this._rotation.y,this._rotation.z,this._rotation.w),e._scale=new ue.a(this._scale.x,this._scale.y,this._scale.z),e._transformUpToDate=!1,e}},{key:"_copyTransformToPresentation",value:function(){if(null!==this._presentation){var e=this._presentation;e._position=this._position._copy(),e._rotation=this._rotation._copy(),e._scale=this._scale._copy()}}},{key:"_copyTransformToPresentationRecursive",value:function(){for(var e=[this];e.length>0;){var t=e.shift();t._copyTransformToPresentation(),e.push.apply(e,oo(t._childNodes))}}},{key:"_copyMaterialPropertiesToPresentation",value:function(){var e=this._presentation;if(this._geometry){var t=!0,n=!1,r=void 0;try{for(var o,i=this._geometry.materials[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value._copyPresentationProperties()}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}e.opacity=this.opacity}},{key:"_copyMorpherToPresentation",value:function(){var e=this._presentation;this.morpher&&(e.morpher.targets=this.morpher.targets.slice(0),e.morpher._weights=this.morpher._weights.slice(0),e.morpher.calculationMode=this.morpher.calculationMode)}},{key:"valueForUndefinedKey",value:function(e){if("/"===e.charAt(0)){var n=e.substr(1);if(this._nodeID===n)return this;var r=this._childNodeWithNodeIDRecursively(n);if(r)return r;if(r=this.childNodeWithNameRecursively(n))return r;var o=this._rootNode;if(o!==this){if(r=o._childNodeWithNodeIDRecursively(n))return r;if(r=o.childNodeWithNameRecursively(n))return r}}return ao(uo(t.prototype),"valueForUndefinedKey",this).call(this,e)}},{key:"valueForKeyPath",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=n&&this._presentation?this._presentation:this,o=e.split("."),i=o[0],a=o[1];return"position"===i?a?r.position[a]:r.position:"rotation"===i?a?r.rotation[a]:r.rotation:"scale"===i?a?r.scale[a]:r.scale:"eulerAngles"===i?a?r.eulerAngles[a]:r.eulerAngles:"orientation"===i?a?r.orientation[a]:r.orientation:"transform"===i?a?r.transform[a]:r.transform:ao(uo(t.prototype),"valueForKeyPath",this).call(this,e,n)}},{key:"setValueForKey",value:function(e,n){var r=this._presentation?this._presentation:this;"position"===n?r.position=e:"rotation"===n?r.rotation=e:"scale"===n?r.scale=e:"eulerAngles"===n?r.eulerAngles=e:"orientation"===n?r.orientation=e:"transform"===n?r.transform=e:ao(uo(t.prototype),"setValueForKey",this).call(this,e,n)}},{key:"setValueForKeyPath",value:function(e,n){var r=this._presentation?this._presentation:this,o=n.split("."),i=o.shift(),a=o.join(".");if("transform"===i)switch(a){case"rotation.x":return r._rotation.x=e,void(r._transformUpToDate=!1);case"rotation.y":return r._rotation.y=e,void(r._transformUpToDate=!1);case"rotation.z":case"rotation":return r._rotation.z=e,void(r._transformUpToDate=!1);case"quaternion":return r.orientation=e,void(r._transformUpToDate=!1);case"scale.x":return r._scale.x=e,void(r._transformUpToDate=!1);case"scale.y":return r._scale.y=e,void(r._transformUpToDate=!1);case"scale.z":return r._scale.z=e,void(r._transformUpToDate=!1);case"scale":return r._scale.x=e.x,r._scale.y=e.y,r._scale.z=e.z,void(r._transformUpToDate=!1);case"translation.x":return r._position.x=e,void(r._transformUpToDate=!1);case"translation.y":return r._position.y=e,void(r._transformUpToDate=!1);case"translation.z":return r._position.z=e,void(r._transformUpToDate=!1);case"translation":return r._position.x=e.x,r._position.y=e.y,void(r._transformUpToDate=!1)}else{if("position"===i)return void(""!==a?r._position[a]=e:r._position=e);if("rotation"===i)return void(""!==a?r._rotation[a]=e:r._rotation=e);if("orientation"===i){if(""!==a){var u=r.orientation;u[a]=e,r.orientation=u}else r.orientation=e;return}if("eulerAngles"===i){if(""!==a){var s=r.eulerAngles;s[a]=e,r.eulerAngles=s}else r.eulerAngles=e;return}if("scale"===i)return void(""!==a?r._scale[a]=e:r._scale=e);if("morpher"===i){if(null===r.morpher)throw new Error("target morpher === null");return void r.morpher.setValueForKeyPath(e,a)}}ao(uo(t.prototype),"setValueForKeyPath",this).call(this,e,n)}},{key:"_createBtTransform",value:function(){}},{key:"_createBtCollisionShape",value:function(){}},{key:"destory",value:function(){}},{key:"_resetPromise",value:function(){this._loadedPromise=null}},{key:"_resetPromiseRecursively",value:function(){this._resetPromise();var e=!0,t=!1,n=void 0;try{for(var r,o=this._childNodes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value._resetPromiseRecursively()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"_getLoadedPromise",value:function(){if(this._loadedPromise)return this._loadedPromise;var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this._childNodes[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a.didLoad)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}if(this._particleSystems){var u=!0,s=!1,l=void 0;try{for(var c,f=this._particleSystems[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;e.push(h.didLoad)}}catch(e){s=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}this._geometry&&e.push(this._geometry.didLoad);var y=!0,p=!1,m=void 0;try{for(var d,_=this._audioPlayers[Symbol.iterator]();!(y=(d=_.next()).done);y=!0){var g=d.value;e.push(g.didLoad)}}catch(e){p=!0,m=e}finally{try{y||null==_.return||_.return()}finally{if(p)throw m}}return Promise.all(e)}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this._updateBoundingBox()}},{key:"presentation",get:function(){return null!==this._presentation||this._isPresentationInstance||this._createPresentation(),this._presentation}},{key:"transform",get:function(){return this._transformUpToDate||this._updateTransform(),this._transform},set:function(e){this._transform=e,this._position=this._transform.getTranslation(),this._rotation=this._transform.getRotation(),this._scale=this._transform.getScale(),this._transformUpToDate=!0}},{key:"worldTransform",get:function(){return this._worldTransform}},{key:"position",get:function(){return this._position},set:function(e){if("number"!=typeof e.x||"number"!=typeof e.y||"number"!=typeof e.z)throw new Error("error: SCNNode.position must have x, y, z values");this._position.x=e.x,this._position.y=e.y,this._position.z=e.z,this._transformUpToDate=!1,this._updateWorldTransform()}},{key:"rotation",get:function(){return this._rotation},set:function(e){if("number"!=typeof e.x||"number"!=typeof e.y||"number"!=typeof e.z||"number"!=typeof e.w)throw new Error("error: SCNNode.rotation must have x, y, z, w values");var t=this._rotation._copy();this._rotation.x=e.x,this._rotation.y=e.y,this._rotation.z=e.z,this._rotation.w=e.w,this._transformUpToDate=!1,this._updateWorldTransform(),kn._addChange(this,"rotation",t,e)}},{key:"scale",get:function(){return this._scale},set:function(e){if("number"!=typeof e.x||"number"!=typeof e.y||"number"!=typeof e.z)throw new Error("error: SCNNode.scale must have x, y, z values");this._scale.x=e.x,this._scale.y=e.y,this._scale.z=e.z,this._transformUpToDate=!1,this._updateWorldTransform()}},{key:"eulerAngles",get:function(){return this._rotation.rotationToEulerAngles()},set:function(e){this._rotation=e.eulerAnglesToRotation(),this._transformUpToDate=!1}},{key:"orientation",get:function(){return this._rotation.rotationToQuat()},set:function(e){if(!Object(w.a)(e,se.a))throw new Error("orientation must be SCNVector4");this._rotation=e.quatToRotation(),this._transformUpToDate=!1}},{key:"_presentationWorldOrientation",get:function(){return null===this._parent?this.presentation.orientation:this._parent._presentationWorldOrientation.cross(this.presentation.orientation)}},{key:"_worldOrientation",get:function(){return null===this._parent?this.orientation:this._parent._worldOrientation.cross(this.orientation)}},{key:"_worldRotation",get:function(){return this._worldOrientation.quatToRotation()}},{key:"_presentationWorldTranslation",get:function(){return this.presentation.worldTransform.getTranslation()}},{key:"_worldTranslation",get:function(){return this.worldTransform.getTranslation()}},{key:"worldPosition",get:function(){return this.worldTransform.getTranslation()},set:function(e){var t=null;t=null===this._parent?Object(Z.a)(0,0,0):this._parent.worldTransform;var n=Object(Z.a)(e.x,e.y,e.z),r=t.invert(),o=n.mult(r);this._transform.m41=o.m41,this._transform.m42=o.m42,this._transform.m43=o.m43,this.transform=this._transform}},{key:"_worldScale",get:function(){return this.worldTransform.getScale()}},{key:"opacity",get:function(){return this._opacity},set:function(e){var t=this._opacity;this._opacity=e,kn._addChange(this,"_opacity",t,e)}},{key:"_rootNode",get:function(){return null===this._parent?this:this._parent._rootNode}},{key:"parent",get:function(){return this._parent}},{key:"childNodes",get:function(){return this._childNodes.slice(0)}},{key:"physicsBody",get:function(){return this._physicsBody},set:function(e){this._physicsBody&&(this._physicsBody._node=null),this._physicsBody=e,this._physicsBody&&(this._physicsBody._node=this,this._physicsBody.resetTransform())}},{key:"particleSystems",get:function(){return this._particleSystems}},{key:"audioPlayers",get:function(){return this._audioPlayers.slice(0)}},{key:"worldFront",get:function(){return fo.rotate(this.worldTransform)}},{key:"worldRight",get:function(){return ho.rotate(this.worldTransform)}},{key:"worldUp",get:function(){return yo.rotate(this.worldTransform)}},{key:"hasActions",get:function(){return this._actions.size>0}},{key:"actionKeys",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this._actions.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"animationKeys",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this._animations.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"boundingBox",get:function(){return this._fixedBoundingBox?this._fixedBoundingBox:(this._updateBoundingBox(),this._boundingBox)},set:function(e){this._fixedBoundingBox=e}},{key:"boundingSphere",get:function(){return{center:new ue.a,radius:0}}},{key:"viewTransform",get:function(){return this.worldTransform.invert()}},{key:"inverseViewTransform",get:function(){return this.worldTransform}},{key:"projectionTransform",get:function(){return null===this.camera?null:this.camera.projectionTransform}},{key:"viewProjectionTransform",get:function(){if(null===this.camera)return null;var e=this.camera.projectionTransform;return this.viewTransform.mult(e)}},{key:"lightViewProjectionTransform",get:function(){if(null===this.light)return null;this.light._updateProjectionTransform();var e=this.light._projectionTransform;return this.viewTransform.mult(e)}},{key:"shadowProjectionTransform",get:function(){if(null===this.light)return null;var e=this.lightViewProjectionTransform,t=Object(Z.a)(1,1,0).scale(.5,.5,1);return e.mult(t)}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}],[{key:"_loadAnimationArray",value:function(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var o=n[r],i=t[o],a=this._loadAnimationData(i,o);e.addAnimationForKey(a,o)}}},{key:"_loadAnimationData",value:function(e,t){if("group"===e.class)return this._loadAnimationGroup(e);if("keyframe"===e.class)return this._loadKeyframeAnimation(e.animation,t);if("basic"===e.class){var n=e.keyPath||t;return this._loadBasicAnimation(e.animation,n)}if("keyframedAnimation"===e.type)return this._loadKeyframeAnimation(e,t);throw new Error("unknown animation class: ".concat(e.class,", type: ").concat(e.type,", key: ").concat(t))}},{key:"_loadAnimationGroup",value:function(e){var t=this,n=new Dt,r=e.animation;n.isRemovedOnCompletion=Boolean(e.removeOnCompletion),n.usesSceneTimeBase=Boolean(e.usesSceneTimeBase),n.fadeInDuration=r.fadeInDuration,n.fadeOutDuration=r.fadeOutDuration,n.beginTime=r.beginTime,n.timeOffset=r.timeOffset,n.repeatCount=r.repeatCount,n.duration=r.duration,n.speed=r.speed,n.autoreverses=r.autoreverses;var o=[Q,"forwards","backwards","both"];return n.fillMode=o[r.fillModeMask],r.channels.forEach(function(e){var r=e.targetPath.join("."),o=t._loadAnimationData(e.animation,r);n.animations.push(o)}),n}},{key:"_loadKeyframeAnimation",value:function(e,t){var n=new rn(t);n.isRemovedOnCompletion=Boolean(e.removeOnCompletion),n.usesSceneTimeBase=Boolean(e.sceneTimeBased),n.fadeInDuration=e.fadeInDuration,n.fadeOutDuration=e.fadeOutDuration,n.beginTime=e.beginTime,n.timeOffset=e.timeOffset,n.repeatCount=e.repeatCount,n.duration=e.duration,n.speed=e.speed,n.autoreverses=e.autoreverses;var r=[Q,"forwards","backwards","both"];n.fillMode=r[e.fillModeMask],n.isCumulative=Boolean(e.cumulative),n.isAdditive=Boolean(e.additive);var o=e.keyframeController;n.values=this._loadData(o,"values"),n.keyTimes=this._loadData(o,"keytimes"),o.interpolationMode,n.keyTimes=n.keyTimes.map(function(e){return e/n.duration});var i=[$,"discrete","paced","cubic","cubicPaced"];return n.calculationMode=i[o.calculationMode],n}},{key:"_loadBasicAnimation",value:function(e,t){var n=new Zt(t);n.isRemovedOnCompletion=Boolean(e.removeOnCompletion),n.timingFunction=new ae(e.timingFunction.c0,e.timingFunction.c1,e.timingFunction.c2,e.timingFunction.c3),n.usesSceneTimeBase=Boolean(e.sceneTimeBased),n.fadeInDuration=e.fadeInDuration,n.fadeOutDuration=e.fadeOutDuration,n.beginTime=e.beginTime,n.timeOffset=e.timeOffset,n.repeatCount=e.repeatCount,n.duration=e.duration,n.speed=e.speed,n.autoreverses=e.autoreverses;var r=[Q,"forwards","backwards","both"];return n.fillMode=r[e.fillModeMask],n.isCumulative=Boolean(e.cumulative),n.isAdditive=Boolean(e.additive),n}},{key:"_loadActionArray",value:function(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var o=n[r],i=t[o];e.runActionForKey(i,o)}}},{key:"_loadData",value:function(e,t){var n=e[t].accessor,r=(n.componentsPerValue,n.stride),o=n.offset,i=(n.sourceTypeID,n.padding,n.valuesCount),a=e["".concat(t,"-data")],u=[],s=o;if(1===n.componentsType)for(var l=0;l<i;l++)u.push(a.readFloatBE(s)),s+=r;else if(6===n.componentsType)for(var c=0;c<i;c++)u.push(a.readDoubleBE(s)),s+=r;else if(9===n.componentsType)for(var f=0;f<i;f++)u.push(ue.a._initWithData(a,s,!0)),s+=r;else if(10===n.componentsType)for(var h=0;h<i;h++)u.push(se.a._initWithData(a,s,!0)),s+=r;else if(11===n.componentsType)for(var y=0;y<i;y++)u.push(It.a._initWithData(a,s,!0)),s+=r;else if(13===n.componentsType)for(var p=0;p<i;p++)u.push(de._initWithData(a,s,!0)),s+=r;else console.error("unknown accessor componentsType: ".concat(n.componentsType));return u}},{key:"node",value:function(){return new t}},{key:"nodeWithGeometry",value:function(e){return new t(e)}},{key:"localFront",get:function(){return fo}},{key:"localRight",get:function(){return ho}},{key:"localUp",get:function(){return yo}}]),t}(),mo=se.a;function _o(e){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function go(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vo(e,t){return!t||"object"!==_o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bo(e){return(bo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function So(e,t){return(So=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vo(this,bo(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&So(e,t)}(t,vt),n=t,o=[{key:"constraintInWorldSpaceWith",value:function(e,n){return new t}},{key:"orientationConstraintInWorldSpaceWith",value:function(e,n){return new t}},{key:"positionConstraintInWorldSpaceWith",value:function(e,n){return new t}}],(r=null)&&go(n.prototype,r),o&&go(n,o),t}();function To(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ko=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._hasActions=!1,this._actionKeys=null}var t,n,r;return t=e,(n=[{key:"runAction",value:function(e){}},{key:"runActionCompletionHandler",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"runActionForKey",value:function(e,t){}},{key:"runActionForKeyCompletionHandler",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]}},{key:"actionForKey",value:function(e){return null}},{key:"removeActionForKey",value:function(e){}},{key:"removeAllActions",value:function(){}},{key:"hasActions",get:function(){return this._hasActions}},{key:"actionKeys",get:function(){return this._actionKeys}}])&&To(t.prototype,n),r&&To(t,r),e}();var Oo=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=null},Co={surface:0,volume:1,vertex:2};function xo(e){return(xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eo(e,t){return!t||"object"!==xo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Po(e){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function No(e,t,n){return t&&Ao(e.prototype,t),n&&Ao(e,n),e}function Ro(e,t){return(Ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fo=function(){};"undefined"!=typeof AudioContext?Fo=AudioContext:"undefined"!=typeof webkitAudioContext?Fo=webkitAudioContext:console.error("error: AudioContext is not supported");var Do=new Fo,Io=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Eo(this,Po(t).call(this))).isPositional=!1,n.rate=0,n.reverbBlend=0,n.shouldStream=!1,n._loading=!1,n._loadedPromise=new Promise(function(e,t){n._resolve=e,n._reject=t}),n._url=e,n._buffer=null,n._gainNode=Do.createGain(),n._loops=!1,n._source=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ro(e,t)}(t,J["a"]),No(t,null,[{key:"sourceNamed",value:function(e){return new t(e)}},{key:"sourceWithFileNamed",value:function(e){return new t(e)}}]),No(t,[{key:"load",value:function(){var e=this;if(!this._loading){this._loading=!0;x.get(this._url,{responseType:"arraybuffer"}).then(function(t){Do.decodeAudioData(t,function(t){e._buffer=t,e._resolve()})})}}},{key:"_play",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.load(),this._loadedPromise.then(function(){e._source=Do.createBufferSource(),e._source.buffer=e._buffer,e._source.connect(e._gainNode),e._gainNode.connect(Do.destination),e._source.loop=e._loops,e._source.start(t)})}},{key:"_stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._source&&(this._source.stop(e),this._source=null)}},{key:"_getLoadedPromise",value:function(){return this._loadedPromise?this._loadedPromise:Promise.resolve()}},{key:"volume",get:function(){return this._gainNode.gain.value},set:function(e){this._gainNode.gain.value=e}},{key:"loops",get:function(){return this._loops},set:function(e){this._loops=e,null!==this._source&&(this._source.loop=e)}},{key:"_duration",get:function(){return this._buffer?this._buffer.duration:null}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}]),t}(),Mo={metal:0,openGLLegacy:1,openGLCore32:2,openGLCore41:3,openGLES2:999,webGL:998},jo={preDynamics:0,postDynamics:1,preCollision:2,postCollision:3},Bo=function(e){return null};function Lo(e){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uo(e,t){return!t||"object"!==Lo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vo(e){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zo(e,t){return(zo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Go=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Uo(this,Vo(t).call(this))).extrusionDepth=0,r.path=null,r.chamferMode=null,r.chamferProfile=null,r.chamferRadius=0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zo(e,t)}(t,Qn),t}();function Yo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"writeWithSceneDocumentURL",value:function(e,t,n){return null}}])&&Yo(t.prototype,n),r&&Yo(t,r),e}(),Ho=function(e,t,n,r,o){},Wo=function(e,t){return e.mult(t)},Ko={horizontal:0,vertical:1};function Zo(e){return(Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qo(e,t){return!t||"object"!==Zo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jo(e){return(Jo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $o(e,t,n){return t&&Qo(e.prototype,t),n&&Qo(e,n),e}function ei(e,t){return(ei=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ti=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=qo(this,Jo(t).call(this))).name=null,e.zNear=1,e.zFar=100,e.yFov=0,e.xFov=0,e.automaticallyAdjustsZRange=!1,e.usesOrthographicProjection=!1,e.orthographicScale=1,e.projectionDirection=Ko.horizontal,e.categoryBitMask=-1,e.focalDistance=10,e.focalSize=0,e.focalBlurRadius=0,e.aperture=.125,e.motionBlurIntensity=0,e.wantsHDR=!1,e.exposureOffset=0,e.averageGray=.18,e.whitePoint=1,e.minimumExposure=-15,e.maximumExposure=15,e.wantsExposureAdaptation=!1,e.exposureAdaptationBrighteningSpeedFactor=.4,e.exposureAdaptationDarkeningSpeedFactor=.6,e.contrast=0,e.saturation=1,e._colorGrading=new Fn,e.bloomIntensity=0,e.bloomThreshold=.5,e.bloomBlurRadius=4,e.colorFringeIntensity=1,e.colorFringeStrength=0,e.vignettingIntensity=1,e.vignettingPower=0,e.projectionTransform=null,e._entityID=null,e.apertureBladeCount=0,e.fStop=0,e.fieldOfView=0,e.focalBlurSampleCount=0,e.focalLength=0,e.focalDistance=0,e.screenSpaceAmbientOcclusionBias=0,e.screenSpaceAmbientOcclusionDepthThreshold=0,e.screenSpaceAmbientOcclusionIntensity=0,e.screenSpaceAmbientOcclusionNormalThreshold=0,e.screenSpaceAmbientOcclusionRadius=0,e.sensorHeight=0,e.wantsDepthOfField=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ei(e,t)}(t,J["a"]),$o(t,null,[{key:"_propTypes",get:function(){return{name:"string",zNear:"float",zFar:"float",yFov:"float",xFov:"float",fov:["float",null],automaticallyAdjustsZRange:"boolean",usesOrthographicProjection:"boolean",orthographicScale:"float",projectionDirection:"integer",categoryBitMask:"integer",focalDistance:"float",focalSize:"float",focalBlurRadius:"float",aperture:"float",motionBlurIntensity:"float",wantsHDR:"boolean",exposureOffset:"float",averageGray:"float",whitePoint:"float",minimumExposure:"float",maximumExposure:"float",wantsExposureAdaptation:"boolean",exposureAdaptationDarkeningSpeedFactor:"float",exposureAdaptationBrighteningSpeedFactor:"float",exposureAdaptationDuration:["float",null],exposureAdaptationHistogramRangeHighProbability:["float",null],exposureAdaptationHistogramRangeLowProbability:["float",null],exposureAdaptationMode:["integer",null],contrast:"float",saturation:"float",bloomIntensity:"float",bloomThreshold:"float",bloomBlurRadius:"float",colorFringeIntensity:"float",colorFringeStrength:"float",vignettingIntensity:"float",vignettingPower:"float",bladeCount:["integer","apertureBladeCount"],fStop:"float",focalBlurSampleCount:"integer",focusDistance:"float",screenSpaceAmbientOcclusionBias:"float",screenSpaceAmbientOcclusionDepthThreshold:"float",screenSpaceAmbientOcclusionIntensity:"float",screenSpaceAmbientOcclusionNormalThreshold:"float",screenSpaceAmbientOcclusionRadius:"float",sensorSize:["float","sensorHeight"],entityID:["string","_entityID"],screenSpaceAmbientOcclusionSampleCount:["integer",null],screenSpaceAmbientOcclusionDownSample:["integer",null],dofIntensity:["float",null],fillMode:["integer",null]}}}]),$o(t,[{key:"init",value:function(e){}},{key:"_updateProjectionTransform",value:function(e){var t=new It.a,n=e.minX,r=e.maxX,o=e.maxY,i=e.minY,a=e.size.width/e.size.height;if(this.usesOrthographicProjection)t.m11=2/(r-n),t.m12=0,t.m13=0,t.m14=0,t.m21=0,t.m22=2/(o-i),t.m23=0,t.m24=0,t.m31=0,t.m32=0,t.m33=-2/(this.zFar-this.zNear),t.m34=0,t.m41=-(r+n)/(r-n),t.m42=-(o+i)/(o-i),t.m43=-(this.zFar+this.zNear)/(this.zFar-this.zNear),t.m44=1;else{var u=1,s=1;if(this.yFov<=0&&this.xFov<=0){var l=1/Math.tan(Math.PI/6);u=l/a,s=l}else if(this.yFov<=0){var c=1/Math.tan(this.xFov*Math.PI/360);u=c,s=c*a}else if(this.xFov<=0){var f=1/Math.tan(this.yFov*Math.PI/360);u=f/a,s=f}else{var h=1/Math.tan(this.yFov*Math.PI/360);u=h/a,s=h}t.m11=u,t.m12=0,t.m13=0,t.m14=0,t.m21=0,t.m22=s,t.m23=0,t.m24=0,t.m31=0,t.m32=0,t.m33=-(this.zFar+this.zNear)/(this.zFar-this.zNear),t.m34=-1,t.m41=0,t.m42=0,t.m43=-2*this.zFar*this.zNear/(this.zFar-this.zNear),t.m44=0}this.projectionTransform=t}},{key:"colorGrading",get:function(){return this._colorGrading}}]),t}(),ni=function(e,t,n,r,o){},ri="#version 300 es\n  precision mediump float;\n\n  #define NUM_AMBIENT_LIGHTS __NUM_AMBIENT_LIGHTS__\n  #define NUM_DIRECTIONAL_LIGHTS __NUM_DIRECTIONAL_LIGHTS__\n  #define NUM_DIRECTIONAL_SHADOW_LIGHTS __NUM_DIRECTIONAL_SHADOW_LIGHTS__\n  #define NUM_OMNI_LIGHTS __NUM_OMNI_LIGHTS__\n  #define NUM_SPOT_LIGHTS __NUM_SPOT_LIGHTS__\n  #define NUM_IES_LIGHTS __NUM_IES_LIGHTS__\n  #define NUM_PROBE_LIGHTS __NUM_PROBE_LIGHTS__\n\n  #define NUM_SHADOW_LIGHTS (NUM_DIRECTIONAL_LIGHTS + NUM_DIRECTIONAL_SHADOW_LIGHTS + NUM_OMNI_LIGHTS + NUM_SPOT_LIGHTS)\n  #define NUM_LIGHTS (NUM_AMBIENT_LIGHTS + NUM_DIRECTIONAL_LIGHTS + NUM_DIRECTIONAL_SHADOW_LIGHTS + NUM_OMNI_LIGHTS + NUM_SPOT_LIGHTS + NUM_IES_LIGHTS + NUM_PROBE_LIGHTS)\n\n  #define USE_SHADER_MODIFIER_GEOMETRY __USE_SHADER_MODIFIER_GEOMETRY__\n\n  layout (std140) uniform cameraUniform {\n    vec4 position;\n    mat4 viewTransform;\n    mat4 inverseViewTransform;\n    mat4 viewProjectionTransform;\n  } camera;\n\n  layout (std140) uniform materialUniform {\n    vec4 ambient;\n    vec4 diffuse;\n    vec4 specular;\n    vec4 normal;\n    vec4 reflective;\n    vec4 emission;\n    vec4 transparent;\n    vec4 multiply;\n    vec4 ambientOcclusion;\n    vec4 selfIllumination;\n    vec4 metalness;\n    vec4 roughness;\n    float shininess;\n    float fresnelExponent;\n  } material;\n\n  struct AmbientLight {\n    vec4 color;\n  };\n\n  struct DirectionalLight {\n    vec4 color;\n    vec4 direction; // should use vec4; vec3 might cause problem for the layout\n  };\n\n  struct DirectionalShadowLight {\n    vec4 color;\n    vec4 direction; // should use vec4; vec3 might cause problem for the layout\n    vec4 shadowColor;\n    mat4 viewProjectionTransform;\n    mat4 shadowProjectionTransform;\n  };\n\n  struct OmniLight {\n    vec4 color;\n    vec4 position; // should use vec4; vec3 might cause problem for the layout\n  };\n\n  struct SpotLight {\n    // TODO: implement\n    vec4 color;\n  };\n\n  struct IESLight {\n    // TODO: implement\n    vec4 color;\n  };\n\n  struct ProbeLight {\n    // TODO: implement\n    vec4 color;\n  };\n\n  layout (std140) uniform lightUniform {\n    #if NUM_AMBIENT_LIGHTS > 0\n      AmbientLight ambient[NUM_AMBIENT_LIGHTS];\n    #endif\n    #if NUM_DIRECTIONAL_LIGHTS > 0\n      DirectionalLight directional[NUM_DIRECTIONAL_LIGHTS];\n    #endif\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 0\n      DirectionalShadowLight directionalShadow[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    #endif\n    #if NUM_OMNI_LIGHTS > 0\n      OmniLight omni[NUM_OMNI_LIGHTS];\n    #endif\n    #if NUM_SPOT_LIGHTS > 0\n      SpotLight spot[NUM_SPOT_LIGHTS];\n    #endif\n    #if NUM_IES_LIGHTS > 0\n      IESLight ies[NUM_IES_LIGHTS];\n    #endif\n    #if NUM_PROBE_LIGHTS > 0\n      ProbeLight probe[NUM_PROBE_LIGHTS];\n    #endif\n    #if NUM_LIGHTS == 0\n      vec4 dummy;\n    #endif\n  } light;\n\n  #if NUM_SHADOW_LIGHTS > 0\n    out vec3 v_light[NUM_SHADOW_LIGHTS];\n  #endif\n  #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 0\n    out vec4 v_directionalShadowDepth[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    out vec4 v_directionalShadowTexcoord[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n  #endif\n\n  layout (std140) uniform fogUniform {\n    vec4 color;\n    float startDistance;\n    float endDistance;\n    float densityExponent;\n  } fog;\n\n  #define kSCNTexcoordCount 2\n  struct SCNShaderGeometry {\n    vec3 position;\n    vec3 normal;\n    vec4 tangent;\n    vec4 color;\n    vec2 texcoords[kSCNTexcoordCount];\n  };\n  //struct _SCNShaderGeometry {\n  //  vec3 position;\n  //  vec3 normal;\n  //  vec4 tangent;\n  //  vec4 color;\n  //  vec2 texcoord0;\n  //  vec2 texcoord1;\n  //};\n\n  uniform float u_time;\n  //uniform mat3x4[255] skinningJoints;\n  uniform vec4[765] skinningJoints;\n  uniform int numSkinningJoints;\n  uniform mat4 modelTransform;\n\n  in vec3 position;\n  in vec3 normal;\n  in vec3 tangent;\n  in vec4 color;\n  in vec2 texcoord0;\n  in vec2 texcoord1;\n  in vec4 boneIndices;\n  in vec4 boneWeights;\n\n  out vec3 v_position;\n  out vec3 v_normal;\n  out vec3 v_tangent;\n  out vec3 v_bitangent;\n  out vec2 v_texcoord0;\n  out vec2 v_texcoord1;\n  //out vec4 v_color;\n  out vec3 v_eye;\n  out float v_fogFactor;\n\n  //out _SCNShaderGeometry __geometry;\n\n  __USER_CUSTOM_UNIFORM__\n\n  #if USE_SHADER_MODIFIER_GEOMETRY\n  void shaderModifierGeometry(inout SCNShaderGeometry _geometry) {\n    __SHADER_MODIFIER_GEOMETRY__\n  }\n  #endif\n\n  void main() {\n    SCNShaderGeometry _geometry;\n    _geometry.position = position;\n    _geometry.normal = normal;\n    _geometry.tangent = vec4(tangent, 1.0);\n    _geometry.color = color;\n    _geometry.texcoords[0] = texcoord0;\n    _geometry.texcoords[1] = texcoord1;\n    \n    #if USE_SHADER_MODIFIER_GEOMETRY\n      shaderModifierGeometry(_geometry);\n    #endif\n\n    vec3 pos = vec3(0, 0, 0);\n    vec3 nom = vec3(0, 0, 0);\n    vec3 tng = vec3(0, 0, 0);\n    vec4 col = _geometry.color;\n\n    if(numSkinningJoints > 0){\n      for(int i=0; i<numSkinningJoints; i++){\n        float weight = boneWeights[i];\n        if(int(boneIndices[i]) < 0){\n          continue;\n        }\n        int idx = int(boneIndices[i]) * 3;\n        mat4 jointMatrix = transpose(mat4(skinningJoints[idx],\n                                          skinningJoints[idx+1],\n                                          skinningJoints[idx+2],\n                                          vec4(0, 0, 0, 1)));\n        pos += (jointMatrix * vec4(_geometry.position, 1.0)).xyz * weight;\n        nom += (mat3(jointMatrix) * _geometry.normal) * weight;\n        tng += (mat3(jointMatrix) * _geometry.tangent.xyz) * weight;\n      }\n    }else{\n      mat4 jointMatrix = transpose(mat4(skinningJoints[0],\n                                        skinningJoints[1],\n                                        skinningJoints[2],\n                                        vec4(0, 0, 0, 1)));\n      pos = (jointMatrix * vec4(_geometry.position, 1.0)).xyz;\n      nom = mat3(jointMatrix) * _geometry.normal;\n      tng = mat3(jointMatrix) * _geometry.tangent.xyz;\n    }\n    //v_position = pos;\n    //v_normal = normalize(nom);\n    //v_tangent = normalize(tng);\n    v_position = (camera.viewTransform * vec4(pos, 1.0)).xyz;\n    v_normal = normalize((camera.viewTransform * vec4(nom, 0.0)).xyz);\n    v_tangent = normalize((camera.viewTransform * vec4(tng, 0.0)).xyz);\n    v_bitangent = cross(v_tangent, v_normal);\n\n    //vec3 viewVec = camera.position.xyz - pos;\n    vec3 viewVec = (camera.viewTransform * vec4(camera.position.xyz - pos, 0.0)).xyz;\n    v_eye = viewVec;\n\n    //v_color = material.emission;\n\n    // Lighting\n    int numLights = 0;\n\n    //#if NUM_AMBIENT_LIGHTS > 0\n    //  for(int i=0; i<NUM_AMBIENT_LIGHTS; i++){\n    //    v_color += light.ambient[i].color * material.ambient;\n    //    v_ambient += light.ambient[i].color;\n    //  }\n    //#endif\n\n    #if NUM_DIRECTIONAL_LIGHTS > 0\n      for(int i=0; i<NUM_DIRECTIONAL_LIGHTS; i++){\n        //v_light[numLights + i] = -light.directional[i].direction.xyz;\n        v_light[numLights + i] = (camera.viewTransform * (-light.directional[i].direction)).xyz;\n      }\n      numLights += NUM_DIRECTIONAL_LIGHTS;\n    #endif\n\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 0\n      for(int i=0; i<NUM_DIRECTIONAL_SHADOW_LIGHTS; i++){\n        //v_light[numLights + i] = -light.directionalShadow[i].direction.xyz;\n        v_light[numLights + i] = (camera.viewTransform * (-light.directionalShadow[i].direction)).xyz;\n        v_directionalShadowDepth[i] = light.directionalShadow[i].viewProjectionTransform * vec4(pos, 1.0);\n        v_directionalShadowTexcoord[i] = light.directionalShadow[i].shadowProjectionTransform * vec4(pos, 1.0);\n      }\n      numLights += NUM_DIRECTIONAL_SHADOW_LIGHTS;\n    #endif\n\n    #if NUM_OMNI_LIGHTS > 0\n      for(int i=0; i<NUM_OMNI_LIGHTS; i++){\n        //v_light[numLights + i] = light.omni[i].position.xyz - pos;\n        v_light[numLights + i] = (camera.viewTransform * vec4(light.omni[i].position.xyz - pos, 0.0)).xyz;\n      }\n      numLights += NUM_OMNI_LIGHTS;\n    #endif\n\n    #if NUM_SPOT_LIGHTS > 0\n      for(int i=0; i<NUM_SPOT_LIGHTS; i++){\n        //v_light[numLights + i] = light.spot[i].position.xyz - pos;\n        v_light[numLights + i] = (camera.viewTransform * vec4(light.spot[i].position.xyz - pos, 0.0)).xyz;\n      }\n      numLights += NUM_SPOT_LIGHTS;\n    #endif\n\n    #if NUM_IES_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n    #if NUM_PROBE_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n\n    float distance = length(viewVec);\n    v_fogFactor = clamp((distance - fog.startDistance) / (fog.endDistance - fog.startDistance), 0.0, 1.0);\n\n    v_texcoord0 = _geometry.texcoords[0];\n    v_texcoord1 = _geometry.texcoords[1];\n    gl_Position = camera.viewProjectionTransform * vec4(pos, 1.0);\n  }\n";function oi(e){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ai(e,t){return!t||"object"!==oi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ui(e,t,n){return(ui="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=si(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function si(e){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function li(e,t){return(li=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ci=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.25,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ai(this,si(t).call(this))).outerRadius=r,e.innerRadius=n,e.height=o,e.radialSegmentCount=48,e.heightSegmentCount=1,e._createGeometry(),e.materials.push(new Gn),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&li(e,t)}(t,Qn),n=t,(r=[{key:"_createGeometry",value:function(){for(var e=[],t=.5*this.height,n=.5*-this.height,r=[],o=[],i=[],a=[],u=2*Math.PI/this.radialSegmentCount,s=1/this.radialSegmentCount,l=0;l<=this.radialSegmentCount;l++){var c=-Math.sin(u*l),f=-Math.cos(u*l),h=c*this.outerRadius,y=f*this.outerRadius,p=c*this.innerRadius,m=f*this.innerRadius;r.push(h,n,y),o.push(p,t,m),i.push(h,t,y),a.push(-h,n,y),r.push(c,0,f),o.push(-c,0,-f),i.push(0,1,0),a.push(0,-1,0);var d=s*l;r.push(d,1),o.push(1-d,0);var _=.5+.5*Math.cos(u*l),g=.5+.5*Math.sin(u*l);i.push(_,g),a.push(_,g),r.push(h,t,y),o.push(p,n,m),i.push(p,t,m),a.push(-p,n,m),r.push(c,0,f),o.push(-c,0,-f),i.push(0,1,0),a.push(0,-1,0),r.push(d,0),o.push(1-d,1);var v=.5+.25*Math.cos(u*l),b=.5+.25*Math.sin(u*l);i.push(v,b),a.push(v,b)}e.push.apply(e,r.concat(o,i,a));for(var S=8*(this.radialSegmentCount+1),w=new tt.a(e,tt.a.Semantic.vertex,S,!0,3,4,0,32),T=new tt.a(e,tt.a.Semantic.normal,S,!0,3,4,12,32),k=new tt.a(e,tt.a.Semantic.texcoord,S,!0,2,4,24,32),O=[],C=0;C<4;C++){for(var x=[],E=(this.radialSegmentCount+1)*C*2,P=0;P<this.radialSegmentCount;P++){var A=E+2*P;x.push(A,A+3,A+1),x.push(A,A+2,A+3)}O.push(new $n.a(x,er.a.triangles))}this._geometryElements=O,this._geometrySources=[w,T,k],this.boundingBox={min:new ue.a(-this.outerRadius,n,-this.outerRadius),max:new ue.a(this.outerRadius,t,this.outerRadius)}}},{key:"_updateBoundingBoxForSkinner",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this.boundingBox:ui(si(t.prototype),"_updateBoundingBoxForSkinner",this).call(this,e)}}])&&ii(n.prototype,r),o&&ii(n,o),t}();function fi(e){return(fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hi(e,t){return!t||"object"!==fi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yi(e,t,n){return(yi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pi(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pi(e){return(pi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function di(e,t,n){return t&&mi(e.prototype,t),n&&mi(e,n),e}function _i(e,t){return(_i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gi=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=hi(this,pi(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_i(e,t)}(t,Te),di(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float",name:["string",null]}}}]),di(t,[{key:"copy",value:function(){var e=yi(pi(t.prototype),"copy",this).call(this);return e._block=this._block,e}},{key:"_applyAction",value:function(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._block(e),this._finished=!0}}],[{key:"run",value:function(e){var n=new t;return n._block=e,n}}]),t}();Te.run=gi.run;var vi="#version 300 es\n  precision mediump float;\n\n  uniform sampler2D particleTexture;\n\n  in vec2 v_texcoord;\n  in vec4 v_color;\n\n  out vec4 outColor;\n\n  void main() {\n    vec4 texColor = texture(particleTexture, v_texcoord);\n    if(texColor.a <= 0.0){\n      // avoid overwriting the depth buffer\n      discard;\n    }\n\n    texColor.rgb *= texColor.a;\n    outColor = v_color * texColor;\n  }\n",bi={error:-1,parsing:4,validating:8,processing:12,complete:16},Si={immediate:0,onDemand:1},wi=n(25),Ti=n.n(wi);function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Oi=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._filePath=r,this._reader=null,null!==n&&(this._reader=new T.a(n,"utf-8")),this._node=null;var o={"#":this._Comment,newmtl:this._Material,Ka:this._Ambient,Kd:this._Diffuse,Ks:this._Specular,Tf:this._TransmissionFilter,illum:this._Illumination,d:this._Dissolve,Ns:this._Exponent,sharpness:this._Sharpness,Ni:this._Density,map_Ka:this._AmbientTexture,map_Kd:this._DiffuseTexture,map_Ks:this._SpecularTexture,map_Ns:this._ExponentTexture,map_d:this._DissolveTexture,map_aat:this._AntiAliasingTexture,decal:this._Decal,disp:this._Roughness,bump:this._Bump,refl:this._Reflection,Ke:this._Emission,map_Ke:this._EmissionTexture};this._funcs={},Object.keys(o).forEach(function(e){t._funcs[e]=o[e].bind(t)})}var t,n,r;return t=e,r=[{key:"unarchiveObjectWithData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new e(t);return r._filePath=n,r._loadMtlFile()}},{key:"unarchiveObjectWithFile",value:function(t){return e._getBufferOfFile(t).then(function(n){return e.unarchiveObjectWithData(n,t)})}},{key:"_getBufferOfFile",value:function(e){return new Promise(function(t,n){var r=new S.a([],e),o=new D.a;o.onload=function(){var e=o.result;t(e)},o.onerror=function(){n(o.error)},o.readAsText(r)})}}],(n=[{key:"_getTokens",value:function(e){return e.split(" ").filter(function(e){return""!==e}).map(function(e){return e.trim()})}},{key:"_loadTexture",value:function(e){var t=this;return new Promise(function(n,r){var o=t._filePath+e;if(console.log("obj texture path: "+o),o.endsWith("tga")){var i=Ti.a.imageWithURL(o);i.didLoad.then(function(){n(i.image)})}else{var a=new Image;a.crossOrigin="anonymous",a.onload=function(){n(a)},a.onerror=function(){r(new Error("image ".concat(o," load error")))},a.src=o}})}},{key:"_loadMtlFile",value:function(){console.warn("_loadMtlFile"),this._materials={},this._workingMaterial=null,this._promises=[];var e=this._reader.readLine();for(this._break=!1;!this._break&&null!==e;){var t=this._getTokens(e);if(0!==t.lengt){var n=this._funcs[t[0]];if(void 0===n)throw new Error("_SCNMtlLoader unknown type: "+t[0]);n(t),e=this._reader.readLine()}else e=this._reader.readLine()}return this._materials}},{key:"_Material",value:function(e){e.shift();var t=e.join(" "),n=new Gn;this._materials[t]=n,this._workingMaterial=n}},{key:"_Comment",value:function(e){}},{key:"_Comment",value:function(e){}},{key:"_Ambient",value:function(e){if("spectral"===e[1]);else if("xyz"===e[1]);else{var t=parseFloat(e[1]),n=parseFloat(e[2]),r=parseFloat(e[3]);this._workingMaterial.ambient.contents=new de(t,n,r,1)}}},{key:"_Diffuse",value:function(e){var t=parseFloat(e[1]),n=parseFloat(e[2]),r=parseFloat(e[3]);this._workingMaterial.diffuse.contents=new de(t,n,r,1)}},{key:"_Specular",value:function(e){var t=parseFloat(e[1]),n=parseFloat(e[2]),r=parseFloat(e[3]);this._workingMaterial.specular.contents=new de(t,n,r,1)}},{key:"_TransmissionFilter",value:function(e){}},{key:"_Illumination",value:function(e){}},{key:"_Dissolve",value:function(e){var t=parseFloat(e[1]);this._workingMaterial.multiply.contents=new de(t,t,t,1)}},{key:"_Exponent",value:function(e){this._workingMaterial.shininess=parseFloat(e[1])}},{key:"_Sharpness",value:function(e){}},{key:"_Density",value:function(e){}},{key:"_AmbientTexture",value:function(e){}},{key:"_DiffuseTexture",value:function(e){var t=this._workingMaterial;this._loadTexture(e[1]).then(function(e){t.diffuse.contents=e})}},{key:"_SpecularTexture",value:function(e){}},{key:"_ExponentTexture",value:function(e){}},{key:"_DissolveTexture",value:function(e){}},{key:"_AntiAliasingTexture",value:function(e){}},{key:"_Decal",value:function(e){}},{key:"_Roughness",value:function(e){}},{key:"_Bump",value:function(e){}},{key:"_Reflection",value:function(e){}},{key:"_Emission",value:function(e){var t=parseFloat(e[1]),n=parseFloat(e[2]),r=parseFloat(e[3]);this._workingMaterial.emission.contents=new de(t,n,r,1)}},{key:"_EmissionTexture",value:function(e){}}])&&ki(t.prototype,n),r&&ki(t,r),e}();function Ci(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xi=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._filePath=r,this._reader=null,null!==n&&(this._reader=new T.a(n,"utf-8")),this._node=null,this._currentNode=null;var o={"#":this._Comment,v:this._GeometricVertices,vt:this._TextureVertices,vn:this._VertexNormals,vp:this._ParameterSpaceVertices,cstype:this._CurveSurfaceType,deg:this._Degree,bmat:this._BasisMatrix,step:this._StepSize,p:this._Point,l:this._Line,f:this._Face,curv:this._Curve,curv2:this._2DCurve,surf:this._Surface,parm:this._ParameterValues,trim:this._OuterTrimmingLoop,hole:this._InnerTrimmingLoop,scrv:this._SpecialCurve,sp:this._SpecialPoint,end:this._EndStatement,con:this._Connect,g:this._GroupName,s:this._SmoothingGroup,mg:this._MergingGroup,o:this._ObjectName,bevel:this._BevelInterpolation,c_interp:this._ColorInterpolation,d_interp:this._DissolveInterpolation,lod:this._LevelOfDetail,usemtl:this._MaterialName,mtllib:this._MaterialLibrary,shadow_obj:this._ShadowCasting,trace_obj:this._RayTracing,ctech:this._CurveApproximationTechnique,stech:this._SurfaceApproximationTechnique};this._funcs={},Object.keys(o).forEach(function(e){t._funcs[e]=o[e].bind(t)})}var t,n,r;return t=e,r=[{key:"unarchiveObjectWithData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new e(t);return r._filePath=n,r._loadObjFile()}},{key:"unarchiveObjectWithFile",value:function(t){return e._getBufferOfFile(t).then(function(n){return e.unarchiveObjectWithData(n,t)})}},{key:"_getBufferOfFile",value:function(e){return new Promise(function(t,n){var r=new S.a([],e),o=new D.a;o.onload=function(){var e=o.result;t(e)},o.onerror=function(){n(o.error)},o.readAsText(r)})}}],(n=[{key:"_getTokens",value:function(e){return e.split(" ").filter(function(e){return""!==e}).map(function(e){return e.trim()})}},{key:"_loadObjFile",value:function(){var e=this;console.error("_loadObjFile");var t,n,r;this._scene=new Yi,this._node=new po,this._currentNode=new po,this._scene.rootNode.addChildNode(this._node),this._vertexArray=[new ue.a(0,0,0)],this._normalArray=[new ue.a(0,0,0)],this._texcoordArray=[new c.a(0,0)],this._materialPromise=Promise.resolve(),this._materialMap={},this._skinArray=[],this._indexArrayMap=(r=[],(n="_SCNObjLoader.default")in(t={})?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t),this._currentMtlName="_SCNObjLoader.default",this._currentIndexArray=this._indexArrayMap["_SCNObjLoader.default"],this._currentGroupName="default",this._vertexSource=null,this._elementArray=[];var o=this._reader.readLine();for(this._break=!1;!this._break&&null!==o;){var i=this._getTokens(o);if(0!==i.length){var a=this._funcs[i[0]];if(void 0===a)throw new Error("_SCNObjLoader unknown type: "+i[0]);a(i),o=this._reader.readLine()}else o=this._reader.readLine()}var u=this._materialPromise.then(function(t){for(var n=function(n){var r=t[n];Object.keys(r).forEach(function(t){e._materialMap[t]=r[t]})},r=t.length-1;r>=0;r--)n(r);e._createGeometry()});return this._node._loadedPromise=u,this._scene}},{key:"_createGeometry",value:function(){for(var e=this,t=this._skinArray.length,n=[],r=[],o=[],i=0;i<t;i++){var a=this._skinArray[i],u=null,s=null,l=null;a&&(u=this._vertexArray[a.vertex],s=this._texcoordArray[a.texcoord],l=this._normalArray[a.normal]),u?n.push(u.x,u.y,u.z):n.push(0,0,0),s?r.push(s.x,s.y):r.push(0,0),l?o.push(l.x,l.y,l.z):o.push(0,0,0)}var c=new tt.a(n,tt.a.Semantic.vertex,t,!0,3,4,0,12),f=new tt.a(o,tt.a.Semantic.normal,t,!0,3,4,0,12),h=new tt.a(r,tt.a.Semantic.texcoord,t,!0,2,4,0,8),y=Object.keys(this._indexArrayMap),p=[];y.forEach(function(t){var n=e._indexArrayMap[t],r=n.length/3;if(0!==r){var o=e._materialMap[t]||new Gn,i=new $n.a(n,er.a.triangles,r,4);p.push(o),e._elementArray.push(i)}});var m=new Qn([c,f,h],this._elementArray);m.materials=p,m.name="Geometry";var d=new po(m);d.name="Geometry",this._node.addChildNode(d)}},{key:"_Comment",value:function(e){}},{key:"_GeometricVertices",value:function(e){var t=new ue.a;t.x=parseFloat(e[1]),t.y=parseFloat(e[2]),t.z=parseFloat(e[3]),this._vertexArray.push(t)}},{key:"_TextureVertices",value:function(e){var t=new c.a;t.x=parseFloat(e[1]),t.y=1-parseFloat(e[2]),this._texcoordArray.push(t)}},{key:"_VertexNormals",value:function(e){var t=new ue.a;t.x=parseFloat(e[1]),t.y=parseFloat(e[2]),t.z=parseFloat(e[3]),this._normalArray.push(t)}},{key:"_ParameterSpaceVertices",value:function(e){}},{key:"_CurveSurfaceType",value:function(e){}},{key:"_Degree",value:function(e){}},{key:"_BasisMatrix",value:function(e){}},{key:"_StepSize",value:function(e){}},{key:"_Point",value:function(e){}},{key:"_Line",value:function(e){}},{key:"_Face",value:function(e){var t=e.length-3;if(t<=0)throw new Error("numFaces(".concat(t,") <= 0"));for(var n=this._getIndexForData(e[1].split("/")),r=null,o=this._getIndexForData(e[2].split("/")),i=0;i<t;i++)r=o,o=this._getIndexForData(e[i+3].split("/")),this._currentIndexArray.push(n,r,o)}},{key:"_getIndexForData",value:function(e){var t=parseInt(e[0]),n=parseInt(e[1])||0,r=parseInt(e[2])||0,o=this._skinArray[t];void 0===o&&(o={index:t,vertex:t,texcoord:n,normal:r,next:null},this._skinArray[t]=o);for(var i=o;o&&(o.texcoord!==n||o.normal!==r);)i=o,o=o.next;if(!o){var a=this._skinArray.length;o={index:a,vertex:t,texcoord:n,normal:r,next:null},this._skinArray[a]=o,i.next=o}return o.index}},{key:"_Curve",value:function(e){}},{key:"_2DCurve",value:function(e){}},{key:"_Surface",value:function(e){}},{key:"_ParameterValues",value:function(e){}},{key:"_OuterTrimmingLoop",value:function(e){}},{key:"_InnerTrimmingLoop",value:function(e){}},{key:"_SpecialCurve",value:function(e){}},{key:"_SpecialPoint",value:function(e){}},{key:"_EndStatement",value:function(e){this._break=!0}},{key:"_Connect",value:function(e){}},{key:"_GroupName",value:function(e){if(e.length<=1)throw new Error("group name format error");e.shift(),this._currentGroupName=e.join(" ")}},{key:"_SmoothingGroup",value:function(e){}},{key:"_MergingGroup",value:function(e){}},{key:"_ObjectName",value:function(e){}},{key:"_BevelInterpolation",value:function(e){}},{key:"_ColorInterpolation",value:function(e){}},{key:"_DissolveInterpolation",value:function(e){}},{key:"_LevelOfDetail",value:function(e){}},{key:"_MaterialName",value:function(e){e.shift(),this._currentMtlName=e.join(" "),this._currentIndexArray=this._indexArrayMap[this._currentMtlName],void 0===this._currentIndexArray&&(this._currentIndexArray=[],this._indexArrayMap[this._currentMtlName]=this._currentIndexArray)}},{key:"_MaterialLibrary",value:function(e){for(var t=this,n=[],r=function(r){var o=t._filePath+e[r],i=o.substring(0,o.lastIndexOf("/")+1),a=F.get(o).then(function(e){return console.log("mtl data: "+e),Oi.unarchiveObjectWithData(e,i)});n.push(a)},o=1;o<e.length;o++)r(o);this._materialPromise=Promise.all(n)}},{key:"_ShadowCasting",value:function(e){}},{key:"_RayTracing",value:function(e){}},{key:"_CurveApproximationTechnique",value:function(e){}},{key:"_SurfaceApproximationTechnique",value:function(e){}}])&&Ci(t.prototype,n),r&&Ci(t,r),e}(),Ei=n(17);function Pi(e){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ni(e,t){return!t||"object"!==Pi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ri(e){return(Ri=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fi(e,t){return(Fi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Di={doNotPlay:"keepSeparate",play:"playOnce",playRepeatedly:"playRepeatedly",playUsingSceneTimeBase:"playUsingSceneTime"},Ii={animationImportPolicy:"kSceneSourceAnimationLoadingMode",assetDirectoryURLs:"kSceneSourceAssetDirectoryURLs",checkConsistency:"kSceneSourceCheckConsistency",convertToYUp:"kSceneSourceConvertToYUpIfNeeded",convertUnitsToMeters:"kSceneSourceConvertToUnit",createNormalsIfAbsent:"kSceneSourceCreateNormalsIfAbsent",flattenScene:"kSceneSourceFlattenScene",overrideAssetURLs:"kSceneSourceOverrideAssetURLs",preserveOriginalTopology:"kSceneSourcePreserveOriginalTopology",strictConformance:"kSceneSourceStrictConformanceKey",useSafeMode:"kSceneSourceUseSafeMode",_urlTranslator:"kSceneSourceURLTranslator"},Mi=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ni(this,Ri(t).call(this)))._url=null,n._options=r,n._data=e,n._loadedPromise=new Promise(function(e,t){n._resolveFunction=e,n._rejectFunction=t}),e&&n._resolveFunction(),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fi(e,t)}(t,J["a"]),n=t,o=[{key:"sceneSourceWithDataOptions",value:function(e,n){return new t(e,n)}},{key:"sceneSourceWithURLOptions",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===n&&(n=new Map),void 0===n.get(Ii.assetDirectoryURLs)){var r=e.split("/"),o=(r.pop(),r.join("/"));n.set(Ii.assetDirectoryURLs,o)}var i=new t;return i._url=e,F.get(e).then(function(e){i._data=e,i._options=n,i._resolveFunction()}),i}},{key:"AnimationImportPolicy",get:function(){return Di}},{key:"LoadingOption",get:function(){return Ii}}],(r=[{key:"scene",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],e);t||this._options&&(t=this._options);var n=this._url,r=t.get(Ii.assetDirectoryURLs);if(r){var o=r;Array.isArray(o)&&(o=o[0]),n=o+"/",this._url&&(n+=this._url.split("/").pop())}return this._data.match(/\nv -?[0-9]+(\.[0-9]+)? -?[0-9]+(\.[0-9]+)? -?[0-9]+(\.[0-9]+)?\s*\n/)?xi.unarchiveObjectWithData(this._data,n,t):Ei.a.unarchiveObjectWithData(this._data,n,t)}},{key:"identifiersOfEntriesWithClass",value:function(e){return null}},{key:"entriesPassingTest",value:function(e){return null}},{key:"propertyForKey",value:function(e){return null}},{key:"entryWithIdentifierWithClass",value:function(e,t){return null}},{key:"_getLoadedPromise",value:function(){return this._loadedPromise}},{key:"url",get:function(){return this._url}},{key:"data",get:function(){return this._data}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}])&&Ai(n.prototype,r),o&&Ai(n,o),t}();function ji(e){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bi(e){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ui(e,t,n){return t&&Li(e.prototype,t),n&&Li(e,n),e}function Vi(e,t){return(Vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Gi={endTime:"kSceneEndTimeAttributeKey",frameRate:"kSceneFrameRateAttributeKey",startTime:"kSceneStartTimeAttributeKey",upAxis:"kSceneUpAxisAttributeKey"},Yi=function(e){function t(e){var n,r,o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=Bi(t).call(this),(n=!o||"object"!==ji(o)&&"function"!=typeof o?zi(r):o).isPaused=!1,n._rootNode=new po,n._lightingEnvironment=null,n.fogStartDistance=0,n.fogEndDistance=0,n.fogDensityExponent=0,n.fogColor=null,n._physicsWorld=new no,n._physicsWorld._scene=zi(zi(n)),n._particleSystems=null,n._particleSystemsTransform=null,n._dataLoadedPromise=null,e){var s=n._loadSceneWithURL(e,i).then(function(e){n._copyValue(e),a&&a(zi(zi(n)))}).catch(function(e){u&&u(e)});n._dataLoadedPromise=s}return n._createSkyBox(),n._loadedPromise=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vi(e,t)}(t,J["a"]),Ui(t,null,[{key:"_propTypes",get:function(){return{paused:["boolean","isPaused"],rootNode:["SCNNode","_rootNode"],upAxis:["SCNVector3",null],physicsWorld:["SCNPhysicsWorld",function(e,t){e._physicsWorld=t,e._physicsWorld._scene=e}],background:["SCNMaterialProperty",function(e,t){e._skyBox.geometry.firstMaterial._emission=t,e._skyBox.geometry.firstMaterial._emission._createPresentation()}],startTime:["double",null],endTime:["double",null],frameRate:["double",null],fogDensityExponent:"double",fogStartDistance:"double",fogEndDistance:"double",fogColor:"plist",environment:["SCNMaterialProperty","_lightingEnvironment"],version:["float",null],userAttributes:["NSMutableDictionary",null],sourceURL:["NSURL",null]}}}]),Ui(t,[{key:"_copyValue",value:function(e){this.isPaused=e.isPaused,this._rootNode=e._rootNode,this._skyBox.geometry=e._skyBox.geometry.copy(),this._lightingEnvironment=e._lightingEnvironment,this.fogStartDistance=e.fogStartDistance,this.fogEndDistance=e.fogEndDistance,this.fogDensityExponent=e.fogDensityExponent,this.fogColor=e.fogColor,this._physicsWorld=e._physicsWorld,this._particleSystems=e._particleSystems?e._particleSystems.slice(0):null,this._particleSystemsTransform=e._particleSystemsTransform?e._particleSystemsTransform.slice(0):null}},{key:"_loadSceneWithURL",value:function(e,t){var n=this,r=t;if(null===r&&(r=new Map),void 0===r.get(Mi.LoadingOption.assetDirectoryURLs)){var o=e.split("/"),i=(o.pop(),o.join("/"));r.set(Mi.LoadingOption.assetDirectoryURLs,i)}return e instanceof S.a?Promise(function(t,o){var i=new D.a;i.onload=function(){var e=n._loadSceneWithData(i.result,r);t(e)},i.onerror=function(){o(i.error)},i.readAsBinaryString(e)}):F.get(e).then(function(e){return n._loadSceneWithData(e,r)})}},{key:"_loadSceneWithData",value:function(e,t){return new Mi(e,t).scene()}},{key:"_createSkyBox",value:function(){var e=new sr,t=new Gn;t._diffuse._contents=de.black,t._ambient._contents=de.black,t._emission._contents=null,t.isDoubleSided=!0,e.firstMaterial=t;for(var n=e.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[0],r=[5/6-.001,1,5/6-.001,0,4/6+.001,1,4/6+.001,0,2/6-.001,1,2/6-.001,0,1/6+.001,1,1/6+.001,0,.999,1,.999,0,5/6+.001,1,5/6+.001,0,1/6-.001,1,1/6-.001,0,.001,1,.001,0,.499,1,.499,0,2/6+.001,1,2/6+.001,0,4/6-.001,1,4/6-.001,0,.501,1,.501,0],o=0,i=6,a=0;a<24;a++)n._data[i+0]=r[o+0],n._data[i+1]=r[o+1],i+=8,o+=2;this._skyBox=new po(e),this._skyBox._presentation=this._skyBox}},{key:"attributeForKey",value:function(e){return null}},{key:"setAttributeForKey",value:function(e,t){}},{key:"writeTo",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!1}},{key:"addParticleSystem",value:function(e,t){if(null===this._particleSystems&&(this._particleSystems=[],this._particleSystemsTransform=[]),e.reset(),this._particleSystems.push(e),this._particleSystemsTransform.push(t),this._particleSystems.length!==this._particleSystemsTransform.length)throw new Error("particleSystems array length inconsistency")}},{key:"removeParticleSystem",value:function(e){if(null!==this._particleSystems){var t=this._particleSystems.indexOf(e);t<0||(this._particleSystems.splice(t,1),this._particleSystemsTransform.splice(t,1))}}},{key:"removeAllParticleSystems",value:function(){this._particleSystems=[],this._particleSystemsTransform=[]}},{key:"_getLoadedPromise",value:function(){var e=this;return this._loadedPromise?this._loadedPromise:this._dataLoadedPromise?(this._loadedPromise=this._dataLoadedPromise.then(function(){var t=[];return t.push(e._rootNode.didLoad),t.push(e._skyBox.didLoad),e._lightingEnvironment&&t.push(e._lightingEnvironment.didLoad),Promise.all(t)}),this._loadedPromise):Promise.resolve()}},{key:"rootNode",get:function(){return this._rootNode}},{key:"background",get:function(){return this._skyBox.geometry.firstMaterial._emission}},{key:"lightingEnvironment",get:function(){return this._lightingEnvironment}},{key:"physicsWorld",get:function(){return this._physicsWorld}},{key:"particleSystems",get:function(){return this._particleSystems.slice(0)}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}],[{key:"sceneNamed",value:function(e){return this.sceneNamedInDirectory(e)}},{key:"sceneNamedInDirectory",value:function(e,n){var r=e;return n&&(r=n+"/"+e),new t(r,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"scene",value:function(e){return new t(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}},{key:"Attribute",get:function(){return Gi}}]),t}();function Xi(e){return(Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hi(e,t){return!t||"object"!==Xi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wi(e,t,n){return(Wi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ki(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ki(e){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qi(e,t,n){return t&&Zi(e.prototype,t),n&&Zi(e,n),e}function Ji(e,t){return(Ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qi=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Hi(this,Ki(t).call(this)))._isLoading=!1,n._isLoaded=!1,n.loadingPolicy=null,n._referenceURL=e,n._scene=null,e&&n.load(),n._loadedPromise=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ji(e,t)}(t,po),qi(t,null,[{key:"_propTypes",get:function(){return{paused:["boolean","isPaused"],scale:["SCNVector3","_scale"],rotation:["SCNVector4","_rotation"],orientation:["SCNVector4",function(e,t){e.orientation=t}],position:["SCNVector3","_position"],loadingPolicy:"integer",referenceURL:["NSURL",function(e,t){e.referenceURL=t,e.load()}],opacity:["float","_opacity"],castsShadow:"boolean",categoryBitMask:"integer",hidden:["boolean","isHidden"],name:"string",renderingOrder:"integer",movabilityHint:"integer",clientAttributes:["NSMutableDictionary",null],overrides:["NSObject",null]}}}]),qi(t,[{key:"load",value:function(){var e=this;if(!this._isLoaded&&!this._isLoading&&this._referenceURL){this._isLoading=!0;var n=new Promise(function(n,r){var o=new Yi(e._referenceURL,null);o.didLoad.then(function(){o.rootNode.name="referenceRoot",Wi(Ki(t.prototype),"addChildNode",e).call(e,o.rootNode),e._scene=o,e._isLoaded=!0,e._isLoading=!1,n()}).catch(function(){r()})});this._loadedPromise=n.then(function(){return e._scene.didLoad})}}},{key:"unload",value:function(){this._isLoaded&&(this.childNodes.forEach(function(e){e.removeFromParentNode()}),this._isLoaded=!1,this._loadedPromise=null)}},{key:"initCoder",value:function(e){}},{key:"addChildNode",value:function(e){throw new Error("cannot add a child node to SCNReferenceNode")}},{key:"insertChildNodeAt",value:function(e,t){throw new Error("cannot add a child node to SCNReferenceNode")}},{key:"replaceChildNodeWith",value:function(e,t){throw new Error("cannot add a child node to SCNReferenceNode")}},{key:"_getLoadedPromise",value:function(){return this._loadedPromise?this._loadedPromise:(this.load(),this._loadedPromise)}},{key:"isLoaded",get:function(){return this._isLoaded}},{key:"referenceURL",get:function(){return this._referenceURL},set:function(e){this.unload(),this._referenceURL=e,this.loadingPolicy===Si.immediate&&this.load()}},{key:"childNodes",get:function(){return this._isLoaded||this.load(),this._childNodes.slice(0)}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}]),t}(),$i="#version 300 es\n  precision mediump float;\n\n  in vec3 v_position;\n\n  layout(location = 0) out vec4 out_depth;\n  //layout(location = 0) out float out_depth;\n\n  void main() {\n    float r = (v_position.z + 1.0) * 0.5;\n    float g = fract(r * 255.0);\n    float b = fract(g * 255.0);\n    float a = fract(b * 255.0);\n    float coef = 1.0 / 255.0;\n\n    r -= g * coef;\n    g -= b * coef;\n    b -= a * coef;\n    out_depth = vec4(r, g, b, a);\n    //out_depth = v_position.z;\n  }\n",ea=function(e,t,n,r){var o=Math.cos(e),i=Math.sin(e),a=new ue.a(t,n,r),u=new It.a,s=a.x,l=a.y,c=a.z;return u.m11=s*s*(1-o)+o,u.m12=s*l*(1-o)-c*i,u.m13=s*c*(1-o)+l*i,u.m14=0,u.m21=l*s*(1-o)+c*i,u.m22=l*l*(1-o)+o,u.m23=l*c*(1-o)-s*i,u.m24=0,u.m31=c*s*(1-o)-l*i,u.m32=c*l*(1-o)+s*i,u.m33=c*c*(1-o)+o,u.m34=0,u.m41=0,u.m42=0,u.m43=0,u.m44=1,u};function ta(e){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function na(e,t){return!t||"object"!==ta(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ra(e){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oa(e,t){return(oa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ia=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=na(this,ra(t).call(this))).freeAxes=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oa(e,t)}(t,vt),t}();function aa(e){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ua(e,t){return!t||"object"!==aa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sa(e){return(sa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function la(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ca(e,t){return(ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fa=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=ua(this,sa(o).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ca(e,t)}(o,Te),t=o,r=[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float",name:["string",null]}}}],(n=null)&&la(t.prototype,n),r&&la(t,r),o}();function ha(e){return(ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ya(e,t){return!t||"object"!==ha(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pa(e,t,n){return(pa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ma(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ma(e){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function da(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _a(e,t,n){return t&&da(e.prototype,t),n&&da(e,n),e}function ga(e,t){return(ga=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var va=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ya(this,ma(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e._toValue=null,e._byValue=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ga(e,t)}(t,Te),_a(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}]),_a(t,[{key:"reversed",value:function(){var e=this.copy();return e._toValue?(e._toValue=null,e._byValue=new ue.a(0,0,0)):this._byValue&&(e._byValue=this._byValue.mul(-1)),e}},{key:"copy",value:function(){var e=pa(ma(t.prototype),"copy",this).call(this);return e._toValue=this._toValue?this._toValue._copy():null,e._byValue=this._byValue?this._byValue._copy():null,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._getTime(t,n);if(!Object(w.a)(e,po))throw new Error("unsupported class for SCNActionMove: ".concat(e.constructor.name));var o=e.position,i=null;if(null!==this._toValue)i=this._toValue;else{if(null===this._byValue)throw new Error("both toValue and byValue are null");i=o.add(this._byValue)}var a=this._lerp(o,i,r);e.presentation.position=a,this._finished&&(e.position=i)}}],[{key:"moveByXYZ",value:function(e,n,r,o){var i=new t;return i._byValue=new ue.a(e,n,r),i._duration=o,i}},{key:"moveBy",value:function(e,n){var r=new t;return r._byValue=e._copy(),r._duration=n,r}},{key:"moveTo",value:function(e,n){var r=new t;return r._toValue=e._copy(),r._duration=n,r}}]),t}();function ba(e){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wa(e,t){return!t||"object"!==ba(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ta(e){return(Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ka(e,t){return(ka=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Te.moveByXYZ=va.moveByXYZ,Te.moveBy=va.moveBy,Te.moveTo=va.moveTo;var Oa=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=wa(this,Ta(t).call(this))).vertexShader=null,e.fragmentShader=null,e.geometryShader=null,e.tessellationControlShader=null,e.tessellationEvaluationShader=null,e.delegate=null,e.isOpaque=!1,e.vertexFunctionName=null,e.fragmentFunctionName=null,e.library=null,e._semantics=new Map,e._bufferBindings=[new Map,new Map,new Map],e._programCompiled=!1,e._context=null,e._glProgram=null,e._glVertexShader=null,e._glFragmentShader=null,e._dummyTexture=null,e._dummyCubeMapTexture=null,e._parentObject=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ka(e,t)}(t,J["a"]),n=t,(r=[{key:"setSemanticForSymbol",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._semantics.set(t,e)}},{key:"semanticForSymbol",value:function(e){return this._semantics.set(e)}},{key:"handleBindingOfBufferNamedHandler",value:function(e,t,n){this._bufferBindings[t].set(e,n)}},{key:"_getGLProgramForContext",value:function(e){return this._context===e&&this._glProgram?this._glProgram:(this._context=e,this._glProgram=e.createProgram(),this._glProgram)}},{key:"_setDummyTextureForContext",value:function(e){var t=e;this._createDummyTextureForContext(t);for(var n=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3,t.TEXTURE4,t.TEXTURE5,t.TEXTURE6,t.TEXTURE7,t.TEXTURE8,t.TEXTURE9,t.TEXTURE10,t.TEXTURE11],r=["u_emissionTexture","u_ambientTexture","u_diffuseTexture","u_specularTexture","u_reflectiveTexture","u_transparentTexture","u_multiplyTexture","u_normalTexture","u_ambientOcclusionTexture","u_selfIlluminationTexture","u_metalnessTexture","u_roughnessTexture"],o=[!1,!1,!1,!1,!0,!1,!1,!1,!1,!1,!1,!1],i=0;i<n.length;i++){var a=n[i],u=r[i],s=t.getUniformLocation(this._glProgram,u);null!==s&&(t.uniform1i(s,i),t.activeTexture(a),o[i]?t.bindTexture(t.TEXTURE_CUBE_MAP,this._dummyCubeMapTexture):t.bindTexture(t.TEXTURE_2D,this._dummyTexture))}}},{key:"_createDummyTextureForContext",value:function(e){if(null===this._dummyTexture){var t=e,n=document.createElement("canvas");n.width=1,n.height=1;var r=n.getContext("2d");r.fillStyle="rgba(255, 255, 255, 1.0)",r.fillRect(0,0,1,1),this._dummyTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._dummyTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,n),t.bindTexture(t.TEXTURE_2D,null),this._dummyCubeMapTexture=t.createTexture();var o=[t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_NEGATIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.TEXTURE_CUBE_MAP_POSITIVE_Y];t.bindTexture(t.TEXTURE_CUBE_MAP,this._dummyCubeMapTexture);for(var i=0;i<6;i++)t.texImage2D(o[i],0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,n);t.bindTexture(t.TEXTURE_CUBE_MAP,null)}}}])&&Sa(n.prototype,r),o&&Sa(n,o),t}();function Ca(e){return(Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xa(e,t){return!t||"object"!==Ca(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ea(e){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Aa(e,t,n){return t&&Pa(e.prototype,t),n&&Pa(e,n),e}function Na(e,t){return(Na=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ra={IES:"ies",ambient:"ambient",directional:"directional",omni:"omni",probe:"probe",spot:"spot"},Fa=function(e){function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=xa(this,Ea(t).call(this))).type=Ra.omni,e.color=new de(1,1,1,1),e.temperature=6500,e.intensity=1e3,e.name=null,e.attenuationStartDistance=0,e.attenuationEndDistance=0,e.attenuationFalloffExponent=0,e.spotInnerAngle=0,e.spotOuterAngle=45,e._gobo=new Fn,e.castsShadow=!1,e.shadowRadius=3,e.shadowColor=new de(0,0,0,1),e.shadowMapSize=new a.a(0,0),e.shadowSampleCount=0,e.shadowMode=null,e.shadowBias=1,e.orthographicScale=1,e.zFar=100,e.zNear=1,e.categoryBitMask=-1,e.iesProfileURL=null,e._entityID=null,e._context=null,e._shadowFrameBuffer=null,e._shadowDepthBuffer=null,e._shadowDepthTexture=null,e._projectionTransform=null,e.automaticallyAdjustsShadowProjection=!1,e.forcesBackFaceCasters=!1,e.maximumShadowDistance=0,e.sampleDistributedShadowMaps=!1,e.shadowCascadeCount=1,e.shadowCascadeSplittingFactor=1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Na(e,t)}(t,J["a"]),Aa(t,null,[{key:"_propTypes",get:function(){return{type:"string",color:"plist",temperature:"float",intensity:"float",name:"string",attenuationStartDistance:"float",attenuationEndDistance:"float",attenuationFalloffExponent:"float",spotInnerAngle:"float",spotOuterAngle:"float",gobo:["SCNMaterialProperty","_gobo"],castsShadow:"boolean",shadowRadius:"float",shadowColor:"plist",shadowMapSize:"CGSize",shadowSampleCount:"integer",shadowMode:"integer",shadowBias:"float",orthographicScale:"float",zFar:"float",zNear:"float",lightCategoryBitMask:["integer","categoryBitMask"],automaticallyAdjustsShadowProjection:"boolean",forcesBackFaceCasters:"boolean",maximumShadowDistance:"float",sampleDistributedShadowMaps:"boolean",shadowCascadeCount:"integer",shadowCascadeSplittingFactor:"float",entityID:["string","_entityID"],version:["float",null],spotFallOffExponent:["float",null],usesDeferredShadows:["boolean",null],usesModulatedMode:["boolean",null],shouldBakeIndirectLighting:["boolean",null],shouldBakeDirectLighting:["boolean",null],baked:["boolean",null],goboProjectShadows:["boolean",null],shadowSampleCount2:["integer",null],sphericalHarmonics:["NSMutableData",null],autoShadowProjection:["boolean",null]}}}]),Aa(t,[{key:"attributeForKey",value:function(e){return null}},{key:"setAttributeForKey",value:function(e,t){}},{key:"_getDepthBufferForContext",value:function(e){if(this._shadowFrameBuffer&&this._context===e)return this._shadowFrameBuffer;this._context=e;var t=e,n=this._shadowMapWidth,r=this._shadowMapHeight;return this._shadowFrameBuffer=t.createFramebuffer(),this._shadowDepthBuffer=t.createRenderbuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this._shadowFrameBuffer),t.bindRenderbuffer(t.RENDERBUFFER,this._shadowDepthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this._shadowDepthBuffer),this._shadowDepthTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._shadowDepthTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,r,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.generateMipmap(t.TEXTURE_2D),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._shadowDepthTexture,0),t.drawBuffers([t.COLOR_ATTACHMENT0]),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),this._shadowFrameBuffer}},{key:"_updateProjectionTransform",value:function(){var e=new It.a,t=(this._shadowMapWidth,this._shadowMapHeight,this._shadowMapWidth/this._shadowMapHeight);if(this.type===Ra.directional)e.m11=.1,e.m12=0,e.m13=0,e.m14=0,e.m21=0,e.m22=.1,e.m23=0,e.m24=0,e.m31=0,e.m32=0,e.m33=-2/(this.zFar-this.zNear),e.m34=0,e.m41=0,e.m42=0,e.m43=-(this.zFar+this.zNear)/(this.zFar-this.zNear),e.m44=1;else{var n=1,r=1;if(this.yFov<=0&&this.xFov<=0){var o=1/Math.tan(Math.PI/6);n=o/t,r=o}else if(this.yFov<=0){var i=1/Math.tan(this.xFov*Math.PI/360);n=i,r=i*t}else if(this.xFov<=0){var a=1/Math.tan(this.yFov*Math.PI/360);n=a/t,r=a}else{var u=1/Math.tan(this.yFov*Math.PI/360);n=u/t,r=u}e.m11=n,e.m12=0,e.m13=0,e.m14=0,e.m21=0,e.m22=r,e.m23=0,e.m24=0,e.m31=0,e.m32=0,e.m33=-(this.zFar+this.zNear)/(this.zFar-this.zNear),e.m34=-1,e.m41=0,e.m42=0,e.m43=-2*this.zFar*this.zNear/(this.zFar-this.zNear),e.m44=0}this._projectionTransform=e}},{key:"gobo",get:function(){return this._gobo}},{key:"_shadowMapWidth",get:function(){return this.shadowMapSize.width>0?this.shadowMapSize.width:2048}},{key:"_shadowMapHeight",get:function(){return this.shadowMapSize.height>0?this.shadowMapSize.height:2048}}],[{key:"LightType",get:function(){return Ra}}]),t}(),Da={backFaceCulling:"kHitTestBackFaceCulling",boundingBoxOnly:"kHitTestBoundingBoxOnly",categoryBitMask:"kHitTestCategoryBitMask",clipToZRange:"kHitTestClipToZRange",firstFoundOnly:"kHitTestFirstFoundOnly",ignoreChildNodes:"kHitTestIgnoreChildNodes",ignoreHiddenNodes:"kHitTestSkipHiddenNode",rootNode:"kHitTestRootNode",sortResults:"kHitTestSortResults"},Ia={alpha:0,add:1,subtract:2,multiply:3,multiplyX2:4,screen:5,replace:6};function Ma(e){return(Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ba(e,t){return!t||"object"!==Ma(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function La(e,t,n){return(La="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ua(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ua(e){return(Ua=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Va(e,t){return(Va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var za=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ba(this,Ua(t).call(this))).position=new c.a(0,0),e.zPosition=0,e._frame=new i.a(new c.a(0,0),new a.a(0,0)),e.xScale=1,e.yScale=1,e.zRotation=0,e.alpha=1,e.isHidden=!1,e.isUserInteractionEnabled=!1,e._children=[],e._parent=null,e._scene=null,e.name=null,e.speed=1,e.isPaused=!1,e._actions=new Map,e.physicsBody=null,e.userData=null,e.constraints=null,e.reachConstraints=null,e.accessibilityChildren=[],e.accessibilityFrame=new i.a(new c.a(0,0),new a.a(0,0)),e.accessibilityHelp=null,e.accessibilityLabel=null,e.accessibilityParent=null,e.accessibilityRole="AXImage",e.accessibilityRoleDescription="SKNode",e.accessibilitySubrole=null,e.attributeValues=new Map,e.isAccessibilityElement=!1,e.isAccessibilityEnabled=!1,e.__presentation=null,e._isPresentationInstance=!1,e._worldPosition=new c.a(0,0),e._worldZPosition=0,e._worldXScale=1,e._worldYScale=1,e._worldZRotation=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Va(e,t)}(t,J["a"]),n=t,o=[{key:"nodeWithFileNamed",value:function(e){return new t}},{key:"obstaclesFromNodeBounds",value:function(e){return null}},{key:"obstaclesFromNodePhysicsBodies",value:function(e){return null}},{key:"obstaclesFromSpriteTextures",value:function(e,t){return null}}],(r=[{key:"calculateAccumulatedFrame",value:function(){var e=this._frame.copy(),t=!0,n=!1,r=void 0;try{for(var o,i=this._children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e=e.union(a.calculateAccumulatedFrame())}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"setScale",value:function(e){this.xScale=e,this.yScale=e}},{key:"addChild",value:function(e){this._children.indexOf(e)>=0||(e.removeFromParent(),this._children.push(e),e._parent=this)}},{key:"insertChildAt",value:function(e,t){this._children.indexOf(e)>=0||(e.removeFromParent(),this._insertObjectInChildrenAtIndex(e,t),this._parent=this)}},{key:"isEqualTo",value:function(e){return!1}},{key:"moveToParent",value:function(e){e.addChild(this)}},{key:"removeFromParent",value:function(){var e=this._parent;if(null!==e){var t=e._children.indexOf(this);t<0||e._removeObjectFromChildrenAtIndex(t)}}},{key:"removeAllChildren",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._children[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.removeFromParent()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"removeChildrenIn",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this._children.indexOf(a)>=0&&a.removeFromParent()}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"_removeObjectFromChildrenAtIndex",value:function(e){var t=this._children.splice(e,1);0!==t.length&&(t[0]._parent=null)}},{key:"_insertObjectInChildrenAtIndex",value:function(e,t){var n=this._children.length;if(t>n)throw new Error("SKNode.children out of index: ".concat(t," > ").concat(n));this._children.splice(t,0,e)}},{key:"inParentHierarchy",value:function(e){return!1}},{key:"childNodeWithName",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._children[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(a.name===e)return a}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return null}},{key:"enumerateChildNodesWithNameUsing",value:function(e,t){}},{key:"run",value:function(e){this.runWithKey(e,Symbol())}},{key:"runCompletion",value:function(e,t){this._runActionForKeyCompletionHandler(e,Symbol(),t)}},{key:"runWithKey",value:function(e,t){this._runActionForKeyCompletionHandler(e,t,null)}},{key:"_runActionForKeyCompletionHandler",value:function(e,t,n){var r=t;null==t&&(r=Symbol());var o=e.copy();o._actionStartTime=.001*Date.now(),o._completionHandler=n,this._actions.set(r,o)}},{key:"actionForKey",value:function(e){return this._actions.get(e)}},{key:"hasActions",value:function(){return this._actions.size>0}},{key:"removeAllActions",value:function(){this._actions.clear()}},{key:"removeActionForKey",value:function(e){this._actions.delete(e)}},{key:"convertFrom",value:function(e,t){return null}},{key:"convertTo",value:function(e,t){return null}},{key:"contains",value:function(e){return!1}},{key:"atPoint",value:function(e){return null}},{key:"nodesAt",value:function(e){return null}},{key:"intersects",value:function(e){return!1}},{key:"accessibilityHitTest",value:function(e){return null}},{key:"setValueForAttribute",value:function(e,t){this.attributeValues.set(t,e)}},{key:"valueForAttributeNamed",value:function(e){return this.attributeValues.get(e)}},{key:"copy",value:function(){var e=La(Ua(t.prototype),"copy",this).call(this);return e._copyValue(this),e}},{key:"_copyValue",value:function(e){this.position=e.position.copy(),this.zPosition=e.zPosition,this._frame=e._frame,this.xScale=e.xScale,this.yScale=e.yScale,this.zRotation=e.zRotation,this.alpha=e.alpha,this.isHidden=e.isHidden,this.isUserInteractionEnabled=e.isUserInteractionEnabled,this.name=e.name,this.speed=e.speed,this.isPaused=e.isPaused,this._actions=new Map(e._actions),this.physicsBody=e.physicsBody,this.userData=e.userData,this.constraints=e.constraints,this.reachConstraints=e.reachConstraints,this.accessibilityChildren=e.accessibilityChildren,this.accessibilityFrame=e.accessibilityFrame.copy(),this.accessibilityHelp=e.accessibilityHelp,this.accessibilityLabel=e.accessibilityLabel,this.accessibilityParent=e.accessibilityParent,this.accessibilityRole=e.accessibilityRole,this.accessibilityRoleDescription=e.accessibilityRoleDescription,this.accessibilitySubrole=e.accessibilitySubrole,this.attributeValues=new Map(e.attributeValues),this.isAccessibilityElement=e.isAccessibilityElement,this.isAccessibilityEnabled=e.isAccessibilityEnabled}},{key:"_render",value:function(e){}},{key:"_copyTransformToPresentation",value:function(){if(null!==this.__presentation){var e=this.__presentation;e.position=this.position,e.zPosition=this.zPosition,e.xScale=this.xScale,e.yScale=this.yScale,e.zRotation=this.zRotation}}},{key:"_updateWorldTransform",value:function(){var e=null,t=0;if(null===this._parent?e=new c.a(0,0):(e=this._parent._worldPosition,t=this._parent._worldZPosition),this._worldPosition=this.position.add(e),this._worldZPosition=this.zPosition+t,this._presentation){var n=null,r=0,o=1,i=1;null===this._parent?n=new c.a(0,0):null===this._parent._presentation?(n=this._parent._worldPosition,r=this._parent._worldZPosition,o=this._parent._worldXScale,i=this._parent._worldYScale):(n=this._parent._presentation._worldPosition,r=this._parent._presentation._worldZPosition,o=this._parent._presentation._worldXScale,i=this._parent._presentation._worldYScale),this._presentation._worldPosition.x=n.x+this._presentation.position.x*o,this._presentation._worldPosition.y=n.y+this._presentation.position.y*i,this._presentation._worldZPosition=this._presentation.zPosition+r,this._presentation._worldXScale=this._presentation.xScale*o,this._presentation._worldYScale=this._presentation.yScale*i}var a=!0,u=!1,s=void 0;try{for(var l,f=this._children[Symbol.iterator]();!(a=(l=f.next()).done);a=!0){l.value._updateWorldTransform()}}catch(e){u=!0,s=e}finally{try{a||null==f.return||f.return()}finally{if(u)throw s}}}},{key:"frame",get:function(){return this._frame}},{key:"children",get:function(){return this._children.slice(0)}},{key:"parent",get:function(){return this._parent}},{key:"scene",get:function(){return this._scene}},{key:"_presentation",get:function(){return this.__presentation}}])&&ja(n.prototype,r),o&&ja(n,o),t}(),Ga={nearest:0,linear:1};function Ya(e){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ha(e,t){return!t||"object"!==Ya(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wa(e){return(Wa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ka(e,t){return(Ka=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Za=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ha(this,Wa(t).call(this))).filteringMode=Ga.linear,e.usesMipmaps=!1,e._customPlaygroundQuickLook=null,e._image=null,e._glTexture=null,e._loadingImagePromise=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ka(e,t)}(t,J["a"]),n=t,o=[{key:"textureWithImageNamed",value:function(e){var n=new t;return n._loadImage(e),n}},{key:"textureWithImage",value:function(e){var n=new t;return n._image=e,this._loadingImagePromise=Promise.resolve(this),n}},{key:"textureWithCgImage",value:function(e){var n=new t;return n._image=e,this._loadingImagePromise=Promise.resolve(this),n}},{key:"textureWithRectIn",value:function(e,n){new t;return n}},{key:"textureWithDataSize",value:function(e,t){}},{key:"textureWithVectorNoiseWithSmoothness",value:function(e,t){}},{key:"textureWithNoiseWithSmoothness",value:function(e,t,n){}},{key:"preloadWithCompletionHandler",value:function(e,t){}}],(r=[{key:"applying",value:function(e){return null}},{key:"cgImage",value:function(){return this._image}},{key:"generatingNormalMap",value:function(){return null}},{key:"generatingNormalMapWithSmoothness",value:function(e,t){return null}},{key:"size",value:function(){return null===this._image?new a.a(0,0):new a.a(this._image.naturalWidth,this._image.naturalHeight)}},{key:"textureRect",value:function(){return null}},{key:"preload",value:function(e){}},{key:"_loadImage",value:function(e){var t=this,n=new Image;n.crossOrigin="anonymous",this._loadingImagePromise=new Promise(function(r,o){if(0===e.indexOf("file:///")){var i=e.slice(8).split("/"),a=1,u=i.slice(-a).join("/");n.onload=function(){console.info("image ".concat(u," onload")),t._image=n,r(t)},n.onerror=function(){(a+=1)>i.length?(console.error("image ".concat(e," load error.")),o(t)):(console.info("image ".concat(u," load error.")),u=i.slice(-a).join("/"),console.info("try ".concat(u)),n.src=u)}}else n.onload=function(){t._image=n,r(t)},n.onerror=function(){console.info("image ".concat(e," load error.")),o(t)},n.src=e})}},{key:"_createTexture",value:function(e){if(null!==this._image){var t=e.createTexture(),n=document.createElement("canvas");n.width=this._image.naturalWidth,n.height=this._image.naturalHeight,n.getContext("2d").drawImage(this._image,0,0),e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this._image.width,this._image.height,0,e.RGBA,e.UNSIGNED_BYTE,n),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),this._glTexture=t}}},{key:"customPlaygroundQuickLook",get:function(){return this._customPlaygroundQuickLook}}])&&Xa(n.prototype,r),o&&Xa(n,o),t}();function qa(e){return(qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qa(e,t){return!t||"object"!==qa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $a(e,t,n){return($a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eu(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function eu(e){return(eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tu(e,t){return(tu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Qa(this,eu(t).call(this))).size=new a.a(0,0),e.anchorPoint=new c.a(.5,.5),e._texture=null,e.centerRect=new i.a(new c.a(0,0),new a.a(1,1)),e.colorBlendFactor=0,e.color=new de(1,1,1,0),e.blendMode=Ia.alpha,e.lightingBitMask=0,e.shadowedBitMask=0,e.shadowCastBitMask=0,e.normalTexture=null,e.shader=null,e.attributeValues=new Map,e._customPlaygroundQuickLook=null,e._program=null,e._vertexArrayObject=null,e._vertexBuffer=null,e._indexBuffer=null,e._loadingImagePromise=null,null!==n&&(e.texture=Za.textureWithImageNamed(n)),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tu(e,t)}(t,za),n=t,o=[{key:"nodeWithColorSize",value:function(e,n){var r=new t;return r.size=n,r.color=e,r}},{key:"nodeWithImageNamed",value:function(e){return new t(e)}},{key:"nodeWithImageNamedNormalMapped",value:function(e,n){return new t(e,n)}}],(r=[{key:"scaleTo",value:function(e){}},{key:"setValueForAttribute",value:function(e,t){}},{key:"valueForAttributeNamed",value:function(e){return null}},{key:"initCoder",value:function(e){}},{key:"_render",value:function(e,t){var n=this.__presentation;if(null!==this.texture){if(null===this.texture._glTexture){if(this.texture._createTexture(e),null===this.texture._glTexture)return;this.size=new a.a(this.texture._image.naturalWidth,this.texture._image.naturalHeight),n.size=this.size.copy()}null===this._program&&(this._program=this._createProgram(e));var r=this._program;e.useProgram(r),null===this._vertexArrayObject&&this._createVertexArrayObject(e,r),e.bindVertexArray(this._vertexArrayObject),e.uniform1f(e.getUniformLocation(r,"screenWidth"),t.size.width),e.uniform1f(e.getUniformLocation(r,"screenHeight"),t.size.height),e.uniform1f(e.getUniformLocation(r,"alpha"),n.alpha);var o=this._createVertexData();e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW),e.uniform1i(e.getUniformLocation(r,"spriteTexture"),0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture._glTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_BYTE,0)}}},{key:"_createProgram",value:function(e){var t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(n,"#version 300 es\n  precision mediump float;\n\n  in vec3 position;\n  in vec2 texcoord;\n\n  uniform float screenWidth;\n  uniform float screenHeight;\n\n  //out vec3 v_position;\n  out vec2 v_texcoord;\n\n  void main() {\n    vec3 pos = position;\n    pos.x = (pos.x * 2.0 / screenWidth) - 1.0;\n    pos.y = (pos.y * 2.0 / screenHeight) - 1.0;\n    v_texcoord = texcoord;\n    gl_Position = vec4(pos, 1.0);\n  }\n"),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(n);throw new Error("SKSpriteNode vertex shader compile error: ".concat(r))}var o=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(o,"#version 300 es\n  precision mediump float;\n\n  uniform sampler2D spriteTexture;\n  uniform float alpha;\n  in vec2 v_texcoord;\n\n  out vec4 outColor;\n\n  void main() {\n    outColor = texture(spriteTexture, v_texcoord);\n    outColor.a *= alpha;\n  }\n"),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(o);throw new Error("particle fragment shader compile error: ".concat(i))}if(e.attachShader(t,n),e.attachShader(t,o),e.linkProgram(t),!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t);throw new Error("program link error: ".concat(a))}return t}},{key:"_createVertexArrayObject",value:function(e,t){this._vertexArrayObject=e.createVertexArray(),e.bindVertexArray(this._vertexArrayObject),this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer);var n=e.getAttribLocation(t,"position");e.bindAttribLocation(t,n,"position"),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,3,e.FLOAT,!1,20,0);var r=e.getAttribLocation(t,"texcoord");e.bindAttribLocation(t,r,"texcoord"),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,20,12),this._indexBuffer=e.createBuffer();var o=new Uint8Array([0,3,2,0,1,3]);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,o,e.STATIC_DRAW)}},{key:"_createVertexData",value:function(){var e=this.__presentation,t=e.size.width*e._worldXScale,n=e.size.height*e._worldYScale,r=e._worldPosition,o=e._worldZPosition,i=r.x-e.anchorPoint.x*t,a=r.x+(1-e.anchorPoint.x)*t,u=r.y+(1-e.anchorPoint.y)*n,s=r.y-e.anchorPoint.y*n,l=[i,u,o,e.centerRect.minX,e.centerRect.minY,a,u,o,e.centerRect.maxX,e.centerRect.minY,i,s,o,e.centerRect.minX,e.centerRect.maxY,a,s,o,e.centerRect.maxX,e.centerRect.maxY];return new Float32Array(l)}},{key:"_copyValue",value:function(e){$a(eu(t.prototype),"_copyValue",this).call(this,e),this.size=e.size.copy(),this.anchorPoint=e.anchorPoint.copy(),this._texture=e._texture?e._texture:null,this.centerRect=e.centerRect.copy(),this.colorBlendFactor=e.colorBlendFactor,this.color=e.color.copy(),this.blendMode=e.blendMode,this.lightingBitMask=e.lightingBitMask,this.shadowedBitMask=e.shadowedBitMask,this.shadowCastBitMask=e.shadowCastBitMask,this.normalTexture=e.normalTexture?e.normalTexture:null,this.shader=e.shader,this.attributeValues=e.attributeValues,this._customerPlaygroundQuickLook=e._customerPlaygroundQuickLook}},{key:"_getLoadedPromise",value:function(){return this._loadingImagePromise?this._loadingImagePromise:Promise.resolve()}},{key:"customPlaygroundQuickLook",get:function(){return this._customPlaygroundQuickLook}},{key:"texture",get:function(){return this._texture},set:function(e){var t=this;this._texture=e,this.size=new a.a(0,0),this._frame=new i.a(new c.a(0,0),this.size),this._texture?this._loadingImagePromise=this._texture._loadingImagePromise.then(function(e){if(t._texture===e){t.size=t._texture.size();var n=-t.size.width*t.anchorPoint.x,r=-t.size.height*(1-t.anchorPoint.y);t._frame=new i.a(new c.a(n,r),t.size)}}):this._loadingImagePromise=null}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}])&&Ja(n.prototype,r),o&&Ja(n,o),t}(),ru="#version 300 es\n  precision mediump float;\n  precision highp sampler2DShadow;\n\n  uniform bool[12] textureFlags;\n  #define TEXTURE_EMISSION_INDEX 0\n  #define TEXTURE_AMBIENT_INDEX 1\n  #define TEXTURE_DIFFUSE_INDEX 2\n  #define TEXTURE_SPECULAR_INDEX 3\n  #define TEXTURE_REFLECTIVE_INDEX 4\n  #define TEXTURE_TRANSPARENT_INDEX 5\n  #define TEXTURE_MULTIPLY_INDEX 6\n  #define TEXTURE_NORMAL_INDEX 7\n  #define TEXTURE_AMBIENT_OCCLUSION_INDEX 8\n  #define TEXTURE_SELF_ILLUMINATION_INDEX 9\n  #define TEXTURE_METALNESS_INDEX 10\n  #define TEXTURE_ROUGHNESS_INDEX 11\n\n  uniform bool selfIllumination;\n\n  uniform sampler2D u_emissionTexture;\n  uniform sampler2D u_ambientTexture;\n  uniform sampler2D u_diffuseTexture;\n  uniform sampler2D u_specularTexture;\n  uniform samplerCube u_reflectiveTexture;\n  uniform sampler2D u_transparentTexture;\n  uniform sampler2D u_multiplyTexture;\n  uniform sampler2D u_normalTexture;\n  uniform sampler2D u_ambientOcclusionTexture;\n  uniform sampler2D u_selfIlluminationTexture;\n  uniform sampler2D u_metalnessTexture;\n  uniform sampler2D u_roughnessTexture;\n\n  #define NUM_AMBIENT_LIGHTS __NUM_AMBIENT_LIGHTS__\n  #define NUM_DIRECTIONAL_LIGHTS __NUM_DIRECTIONAL_LIGHTS__\n  #define NUM_DIRECTIONAL_SHADOW_LIGHTS __NUM_DIRECTIONAL_SHADOW_LIGHTS__\n  #define NUM_OMNI_LIGHTS __NUM_OMNI_LIGHTS__\n  #define NUM_SPOT_LIGHTS __NUM_SPOT_LIGHTS__\n  #define NUM_IES_LIGHTS __NUM_IES_LIGHTS__\n  #define NUM_PROBE_LIGHTS __NUM_PROBE_LIGHTS__\n\n  #define NUM_SHADOW_LIGHTS (NUM_DIRECTIONAL_LIGHTS + NUM_DIRECTIONAL_SHADOW_LIGHTS + NUM_OMNI_LIGHTS + NUM_SPOT_LIGHTS)\n  #define NUM_LIGHTS (NUM_AMBIENT_LIGHTS + NUM_DIRECTIONAL_LIGHTS + NUM_DIRECTIONAL_SHADOW_LIGHTS + NUM_OMNI_LIGHTS + NUM_SPOT_LIGHTS + NUM_IES_LIGHTS + NUM_PROBE_LIGHTS)\n\n  #define USE_SHADER_MODIFIER_SURFACE __USE_SHADER_MODIFIER_SURFACE__\n  #define USE_SHADER_MODIFIER_FRAGMENT __USE_SHADER_MODIFIER_FRAGMENT__\n\n  layout (std140) uniform cameraUniform {\n    vec4 position;\n    mat4 viewTransform;\n    mat4 inverseViewTransform;\n    mat4 viewProjectionTransform;\n  } camera;\n\n  layout (std140) uniform materialUniform {\n    vec4 ambient;\n    vec4 diffuse;\n    vec4 specular;\n    vec4 normal;\n    vec4 reflective;\n    vec4 emission;\n    vec4 transparent;\n    vec4 multiply;\n    vec4 ambientOcclusion;\n    vec4 selfIllumination;\n    vec4 metalness;\n    vec4 roughness;\n    float shininess;\n    float fresnelExponent;\n  } material;\n\n  struct AmbientLight {\n    vec4 color;\n  };\n\n  struct SCNShaderLightingContribution {\n    vec3 ambient;\n    vec3 diffuse;\n    vec3 specular;\n  } _lightingContribution;\n\n  struct DirectionalLight {\n    vec4 color;\n    vec4 direction; // should use vec4; vec3 might cause problem for the layout\n  };\n\n  struct DirectionalShadowLight {\n    vec4 color;\n    vec4 direction; // should use vec4; vec3 might cause problem for the layout\n    vec4 shadowColor;\n    mat4 viewProjectionTransform;\n    mat4 shadowProjectionTransform;\n  };\n\n  struct OmniLight {\n    vec4 color;\n    vec4 position; // should use vec4; vec3 might cause problem for the layout\n  };\n\n  struct ProbeLight {\n    // TODO: implement\n    vec4 color;\n  };\n\n  struct SpotLight {\n    // TODO: implement\n    vec4 color;\n  };\n\n  layout (std140) uniform lightUniform {\n    #if NUM_AMBIENT_LIGHTS > 0\n      AmbientLight ambient[NUM_AMBIENT_LIGHTS];\n    #endif\n    #if NUM_DIRECTIONAL_LIGHTS > 0\n      DirectionalLight directional[NUM_DIRECTIONAL_LIGHTS];\n    #endif\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 0\n      DirectionalShadowLight directionalShadow[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    #endif\n    #if NUM_OMNI_LIGHTS > 0\n      OmniLight omni[NUM_OMNI_LIGHTS];\n    #endif\n    #if NUM_SPOT_LIGHTS > 0\n      SpotLight spot[NUM_SPOT_LIGHTS];\n    #endif\n    #if NUM_IES_LIGHTS > 0\n      IESLight ies[NUM_IES_LIGHTS];\n    #endif\n    #if NUM_PROBE_LIGHTS > 0\n      ProbeLight probe[NUM_PROBE_LIGHTS];\n    #endif\n    #if NUM_LIGHTS == 0\n      vec4 dummy;\n    #endif\n  } light;\n  #if NUM_SHADOW_LIGHTS > 0\n    in vec3 v_light[NUM_SHADOW_LIGHTS];\n  #endif\n  #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 0\n    in vec4 v_directionalShadowDepth[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    in vec4 v_directionalShadowTexcoord[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    uniform sampler2D u_shadowTexture0;\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 1\n      uniform sampler2D u_shadowTexture1;\n    #endif\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 2\n      uniform sampler2D u_shadowTexture2;\n    #endif\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 3\n      uniform sampler2D u_shadowTexture3;\n    #endif\n  #endif\n\n  layout (std140) uniform SCNLightsUniform {\n    vec4 direction0;\n    mat4 shadowMatrix0;\n  } scn_lights;\n\n  layout (std140) uniform fogUniform {\n    vec4 color;\n    float startDistance;\n    float endDistance;\n    float densityExponent;\n  } fog;\n\n  struct SCNShaderSurface {\n    vec3 view;\n    vec3 position;\n    vec3 normal;\n    vec2 normalTexcoord;\n    vec3 geometryNormal;\n    vec3 tangent;\n    vec3 bitangent;\n    vec4 ambient;\n    vec2 ambientTexcoord;\n    vec4 diffuse;\n    vec2 diffuseTexcoord;\n    vec4 specular;\n    vec2 specularTexcoord;\n    vec4 emission;\n    vec2 emissionTexcoord;\n    vec4 multiply;\n    vec2 multiplyTexcoord;\n    vec4 transparent;\n    vec2 transparentTexcoord;\n    vec4 reflective;\n    float ambientOcclusion;\n    float shininess;\n    float fresnel;\n    __USER_CUSTOM_SURFACE__\n  } _surface;\n\n  struct SCNShaderOutput {\n    vec4 color;\n  } _output;\n\n  vec2 poissonDisk[4] = vec2[](\n    vec2( -0.94201624, -0.39906216 ),\n    vec2( 0.94558609, -0.76890725 ),\n    vec2( -0.094184101, -0.92938870 ),\n    vec2( 0.34495938, 0.29387760 )\n  );\n\n  //#define kSCNTexcoordCount 2\n  //struct SCNShaderGeometry {\n  //  vec3 position;\n  //  vec3 normal;\n  //  vec4 tangent;\n  //  vec4 color;\n  //  vec2 texcoords[kSCNTexcoordCount];\n  //};\n\n  uniform float u_time;\n\n  in vec3 v_position;\n  in vec3 v_normal;\n  in vec2 v_texcoord0;\n  in vec2 v_texcoord1;\n  //in vec4 v_color;\n  in vec3 v_eye;\n  in vec3 v_tangent;\n  in vec3 v_bitangent;\n  in float v_fogFactor;\n\n  //in SCNShaderGeometry _geometry;\n\n  out vec4 outColor;\n\n  __USER_CUSTOM_UNIFORM__\n\n  float saturate(float value) {\n    return clamp(value, 0.0, 1.0);\n  }\n\n  float convDepth(vec4 color) {\n    const float rMask = 1.0;\n    const float gMask = 1.0 / 255.0;\n    const float bMask = 1.0 / (255.0 * 255.0);\n    const float aMask = 1.0 / (255.0 * 255.0 * 255.0);\n    float depth = dot(color, vec4(rMask, gMask, bMask, aMask));\n    return depth * 2.0 - 1.0;\n  }\n\n  #if USE_SHADER_MODIFIER_SURFACE\n  void shaderModifierSurface() {\n    __SHADER_MODIFIER_SURFACE__\n  }\n  #endif\n\n  #if USE_SHADER_MODIFIER_FRAGMENT\n  void shaderModifierFragment() {\n    __SHADER_MODIFIER_FRAGMENT__\n  }\n  #endif\n\n    \n  void main() {\n    //_output.color = v_color;\n    //_output.color = vec4(0, 0, 0, 1);\n\n    //vec3 viewVec = normalize(v_eye);\n    //vec3 nom = normalize(v_normal);\n    _surface.view = normalize(v_eye);\n    _surface.position = v_position;\n    _surface.normal = normalize(v_normal);\n    _surface.tangent = normalize(v_tangent);\n    _surface.bitangent = normalize(v_bitangent);\n\n    // normal texture\n    if(textureFlags[TEXTURE_NORMAL_INDEX]){\n      mat3 tsInv = mat3(_surface.tangent, _surface.bitangent, _surface.normal);\n      vec3 color = normalize(texture(u_normalTexture, v_texcoord0).rgb * 2.0 - 1.0); // FIXME: check mappingChannel to decide which texture you use.\n      _surface.normal = normalize(tsInv * color);\n    }\n\n    //_surface.ambient = material.ambient;\n    _surface.ambient = vec4(0, 0, 0, 1); // FIXME: check: lock ambient with diffuse\n    _surface.diffuse = material.diffuse;\n    _surface.specular = material.specular;\n    _surface.emission = material.emission;\n    _surface.multiply = material.multiply;\n    _surface.transparent = material.transparent;\n    _surface.reflective = material.reflective;\n    _surface.ambientOcclusion = 1.0; // TODO: calculate AO\n    _surface.shininess = material.shininess;\n    _surface.fresnel = 0.4 * pow(1.0 - clamp(dot(_surface.view, _surface.normal), 0.0, 1.0), material.fresnelExponent); // TODO: calculate coefficient\n\n    // TODO: check mapping channel for each material\n    _surface.ambientTexcoord = v_texcoord0;\n    _surface.diffuseTexcoord = v_texcoord0;\n    _surface.specularTexcoord = v_texcoord0;\n    if(selfIllumination){\n      _surface.emissionTexcoord = v_texcoord1;\n    }else{\n      _surface.emissionTexcoord = v_texcoord0;\n    }\n    _surface.multiplyTexcoord = v_texcoord0;\n    _surface.transparentTexcoord = v_texcoord0;\n\n    if(textureFlags[TEXTURE_AMBIENT_INDEX]){\n      _surface.ambient = texture(u_ambientTexture, _surface.ambientTexcoord);\n    }\n    if(textureFlags[TEXTURE_DIFFUSE_INDEX]){\n      _surface.diffuse = texture(u_diffuseTexture, _surface.diffuseTexcoord);\n      _surface.diffuse.a *= material.diffuse.a;\n    }\n    if(textureFlags[TEXTURE_SPECULAR_INDEX]){\n      _surface.specular = texture(u_specularTexture, _surface.specularTexcoord);\n    }\n    if(textureFlags[TEXTURE_EMISSION_INDEX]){\n      _surface.emission = texture(u_emissionTexture, _surface.emissionTexcoord);\n    }\n    if(textureFlags[TEXTURE_MULTIPLY_INDEX]){\n      _surface.multiply = texture(u_multiplyTexture, _surface.multiplyTexcoord);\n    }\n    if(textureFlags[TEXTURE_TRANSPARENT_INDEX]){\n      _surface.transparent = texture(u_transparentTexture, _surface.transparentTexcoord);\n    }\n\n    __USER_CUSTOM_TEXCOORD__\n\n    #if USE_SHADER_MODIFIER_SURFACE\n      shaderModifierSurface();\n    #endif\n\n    // Lighting\n    int numLights = 0;\n    _lightingContribution.ambient = vec3(0);\n    _lightingContribution.diffuse = vec3(0);\n    _lightingContribution.specular = vec3(0);\n\n    #if NUM_AMBIENT_LIGHTS > 0\n      for(int i=0; i<NUM_AMBIENT_LIGHTS; i++){\n        _lightingContribution.ambient += light.ambient[i].color.rgb;\n      }\n    #endif\n\n    #if NUM_DIRECTIONAL_LIGHTS > 0\n      for(int i=0; i<NUM_DIRECTIONAL_LIGHTS; i++){\n        // diffuse\n        vec3 lightVec = normalize(v_light[numLights + i]);\n        float diffuse = clamp(dot(lightVec, _surface.normal), 0.0f, 1.0f);\n        //_output.color.rgb += light.directional[i].color.rgb * material.diffuse.rgb * diffuse;\n        _lightingContribution.diffuse += light.directional[i].color.rgb * diffuse;\n\n        // specular\n        if(diffuse > 0.0f){\n          vec3 halfVec = normalize(lightVec + _surface.view);\n          float specular = pow(dot(halfVec, _surface.normal), _surface.shininess);\n          // TODO: use intensity\n          _lightingContribution.specular += vec3(specular);\n        }\n      }\n      numLights += NUM_DIRECTIONAL_LIGHTS;\n    #endif\n\n    #if NUM_OMNI_LIGHTS > 0\n      for(int i=0; i<NUM_OMNI_LIGHTS; i++){\n        // diffuse\n        vec3 lightVec = normalize(v_light[numLights + i]);\n        float diffuse = clamp(dot(lightVec, _surface.normal), 0.0f, 1.0f);\n        //_output.color.rgb += light.omni[i].color.rgb * material.diffuse.rgb * diffuse;\n        _lightingContribution.diffuse += light.omni[i].color.rgb * diffuse;\n\n        // specular\n        if(diffuse > 0.0f){\n          vec3 halfVec = normalize(lightVec + _surface.view);\n          float specular = pow(dot(halfVec, _surface.normal), _surface.shininess);\n          // TODO: use intensity\n          _lightingContribution.specular += vec3(1, 1, 1) * specular;\n        }\n      }\n      numLights += NUM_OMNI_LIGHTS;\n    #endif\n\n    #if NUM_SPOT_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n    #if NUM_IES_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n    #if NUM_PROBE_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n    __FS_LIGHTING__\n\n\n    // calculate color\n    _output.color = vec4(0, 0, 0, _surface.diffuse.a);\n\n    vec3 D = _lightingContribution.diffuse;\n\n    // lock ambient with diffuse\n    D += _lightingContribution.ambient * _surface.ambientOcclusion;\n\n    // emission\n    if(selfIllumination){\n      D += _surface.emission.rgb;\n    }\n\n    // diffuse\n    _output.color.rgb = _surface.diffuse.rgb * D;\n\n    vec3 S = _lightingContribution.specular;\n    //S += _surface.reflective.rgb * _surface.ambientOcclusion;\n    S *= _surface.specular.rgb;\n    _output.color.rgb += S;\n\n    // ambient\n    _output.color.rgb += _surface.ambient.rgb * _lightingContribution.ambient;\n\n    if(!selfIllumination){\n      _output.color.rgb += _surface.emission.rgb;\n    }\n\n    // multiply\n    _output.color.rgb *= _surface.multiply.rgb;\n\n    // fresnel reflection\n    if(textureFlags[TEXTURE_REFLECTIVE_INDEX]){\n      vec3 r = reflect(_surface.view, _surface.normal);\n      //float fresnel = f0 + (1.0 - f0) * pow(1.0 - clamp(dot(viewVec, nom), 0.0, 1.0), material.fresnelExponent);\n      //float fresnel = 0.4 * pow(1.0 - clamp(dot(_surface.view, _surface.normal), 0.0, 1.0), material.fresnelExponent);\n      _output.color.rgb += texture(u_reflectiveTexture, r).rgb * _surface.fresnel;\n    }\n\n    float fogFactor = pow(v_fogFactor, fog.densityExponent);\n    _output.color = mix(_output.color, fog.color, fogFactor);\n\n    _output.color.rgb *= _surface.diffuse.a;\n\n    #if USE_SHADER_MODIFIER_FRAGMENT\n      shaderModifierFragment();\n    #endif\n\n    if(_output.color.a <= 0.0){\n      // avoid overwriting the depth buffer\n      discard;\n    }\n\n    outColor = _output.color;\n\n    // linear To sRGB\n    //outColor.rgb = pow(_output.color.rgb, vec3(1.0/2.2));\n    //outColor.a = _output.color.a;\n  }\n",ou="#version 300 es\n  precision mediump float;\n  precision highp sampler2DShadow;\n\n  uniform bool[12] textureFlags;\n  #define TEXTURE_EMISSION_INDEX 0\n  #define TEXTURE_AMBIENT_INDEX 1\n  #define TEXTURE_DIFFUSE_INDEX 2\n  #define TEXTURE_SPECULAR_INDEX 3\n  #define TEXTURE_REFLECTIVE_INDEX 4\n  #define TEXTURE_TRANSPARENT_INDEX 5\n  #define TEXTURE_MULTIPLY_INDEX 6\n  #define TEXTURE_NORMAL_INDEX 7\n  #define TEXTURE_AMBIENT_OCCLUSION_INDEX 8\n  #define TEXTURE_SELF_ILLUMINATION_INDEX 9\n  #define TEXTURE_METALNESS_INDEX 10\n  #define TEXTURE_ROUGHNESS_INDEX 11\n\n  uniform bool selfIllumination;\n\n  uniform sampler2D u_emissionTexture;\n  uniform sampler2D u_ambientTexture;\n  uniform sampler2D u_diffuseTexture;\n  uniform sampler2D u_specularTexture;\n  uniform samplerCube u_reflectiveTexture;\n  uniform sampler2D u_transparentTexture;\n  uniform sampler2D u_multiplyTexture;\n  uniform sampler2D u_normalTexture;\n  uniform sampler2D u_ambientOcclusionTexture;\n  uniform sampler2D u_selfIlluminationTexture;\n  uniform sampler2D u_metalnessTexture;\n  uniform sampler2D u_roughnessTexture;\n\n  #define NUM_AMBIENT_LIGHTS __NUM_AMBIENT_LIGHTS__\n  #define NUM_DIRECTIONAL_LIGHTS __NUM_DIRECTIONAL_LIGHTS__\n  #define NUM_DIRECTIONAL_SHADOW_LIGHTS __NUM_DIRECTIONAL_SHADOW_LIGHTS__\n  #define NUM_OMNI_LIGHTS __NUM_OMNI_LIGHTS__\n  #define NUM_SPOT_LIGHTS __NUM_SPOT_LIGHTS__\n  #define NUM_IES_LIGHTS __NUM_IES_LIGHTS__\n  #define NUM_PROBE_LIGHTS __NUM_PROBE_LIGHTS__\n\n  #define NUM_SHADOW_LIGHTS (NUM_DIRECTIONAL_LIGHTS + NUM_DIRECTIONAL_SHADOW_LIGHTS + NUM_OMNI_LIGHTS + NUM_SPOT_LIGHTS)\n  #define NUM_LIGHTS (NUM_AMBIENT_LIGHTS + NUM_DIRECTIONAL_LIGHTS + NUM_DIRECTIONAL_SHADOW_LIGHTS + NUM_OMNI_LIGHTS + NUM_SPOT_LIGHTS + NUM_IES_LIGHTS + NUM_PROBE_LIGHTS)\n\n  #define USE_SHADER_MODIFIER_SURFACE __USE_SHADER_MODIFIER_SURFACE__\n  #define USE_SHADER_MODIFIER_FRAGMENT __USE_SHADER_MODIFIER_FRAGMENT__\n\n  layout (std140) uniform cameraUniform {\n    vec4 position;\n    mat4 viewTransform;\n    mat4 inverseViewTransform;\n    mat4 viewProjectionTransform;\n  } camera;\n\n  layout (std140) uniform materialUniform {\n    vec4 ambient;\n    vec4 diffuse;\n    vec4 specular;\n    vec4 normal;\n    vec4 reflective;\n    vec4 emission;\n    vec4 transparent;\n    vec4 multiply;\n    vec4 ambientOcclusion;\n    vec4 selfIllumination;\n    vec4 metalness;\n    vec4 roughness;\n    float shininess;\n    float fresnelExponent;\n  } material;\n\n  struct AmbientLight {\n    vec4 color;\n  };\n\n  struct SCNShaderLightingContribution {\n    vec3 ambient;\n    vec3 diffuse;\n    vec3 specular;\n  } _lightingContribution;\n\n  struct DirectionalLight {\n    vec4 color;\n    vec4 direction; // should use vec4; vec3 might cause problem for the layout\n  };\n\n  struct DirectionalShadowLight {\n    vec4 color;\n    vec4 direction; // should use vec4; vec3 might cause problem for the layout\n    vec4 shadowColor;\n    mat4 viewProjectionTransform;\n    mat4 shadowProjectionTransform;\n  };\n\n  struct OmniLight {\n    vec4 color;\n    vec4 position; // should use vec4; vec3 might cause problem for the layout\n  };\n\n  struct ProbeLight {\n    // TODO: implement\n    vec4 color;\n  };\n\n  struct SpotLight {\n    // TODO: implement\n    vec4 color;\n  };\n\n  layout (std140) uniform lightUniform {\n    #if NUM_AMBIENT_LIGHTS > 0\n      AmbientLight ambient[NUM_AMBIENT_LIGHTS];\n    #endif\n    #if NUM_DIRECTIONAL_LIGHTS > 0\n      DirectionalLight directional[NUM_DIRECTIONAL_LIGHTS];\n    #endif\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 0\n      DirectionalShadowLight directionalShadow[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    #endif\n    #if NUM_OMNI_LIGHTS > 0\n      OmniLight omni[NUM_OMNI_LIGHTS];\n    #endif\n    #if NUM_SPOT_LIGHTS > 0\n      SpotLight spot[NUM_SPOT_LIGHTS];\n    #endif\n    #if NUM_IES_LIGHTS > 0\n      IESLight ies[NUM_IES_LIGHTS];\n    #endif\n    #if NUM_PROBE_LIGHTS > 0\n      ProbeLight probe[NUM_PROBE_LIGHTS];\n    #endif\n    #if NUM_LIGHTS == 0\n      vec4 dummy;\n    #endif\n  } light;\n  #if NUM_SHADOW_LIGHTS > 0\n    in vec3 v_light[NUM_SHADOW_LIGHTS];\n  #endif\n  #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 0\n    in vec4 v_directionalShadowDepth[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    in vec4 v_directionalShadowTexcoord[NUM_DIRECTIONAL_SHADOW_LIGHTS];\n    uniform sampler2D u_shadowTexture0;\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 1\n      uniform sampler2D u_shadowTexture1;\n    #endif\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 2\n      uniform sampler2D u_shadowTexture2;\n    #endif\n    #if NUM_DIRECTIONAL_SHADOW_LIGHTS > 3\n      uniform sampler2D u_shadowTexture3;\n    #endif\n  #endif\n\n  layout (std140) uniform SCNLightsUniform {\n    vec4 direction0;\n    mat4 shadowMatrix0;\n  } scn_lights;\n\n  layout (std140) uniform fogUniform {\n    vec4 color;\n    float startDistance;\n    float endDistance;\n    float densityExponent;\n  } fog;\n\n  struct SCNShaderSurface {\n    vec3 view;\n    vec3 position;\n    vec3 normal;\n    vec2 normalTexcoord;\n    vec3 geometryNormal;\n    vec3 tangent;\n    vec3 bitangent;\n    vec4 ambient;\n    vec2 ambientTexcoord;\n    vec4 diffuse;\n    vec2 diffuseTexcoord;\n    vec4 specular;\n    vec2 specularTexcoord;\n    vec4 emission;\n    vec2 emissionTexcoord;\n    vec4 multiply;\n    vec2 multiplyTexcoord;\n    vec4 transparent;\n    vec2 transparentTexcoord;\n    vec4 reflective;\n    vec2 metalnessTexcoord;\n    vec2 roughnessTexcoord;\n    float ambientOcclusion;\n    float shininess;\n    float fresnel;\n    float metalness;\n    float roughness;\n    __USER_CUSTOM_SURFACE__\n  } _surface;\n\n  struct SCNShaderOutput {\n    vec4 color;\n  } _output;\n\n  vec2 poissonDisk[4] = vec2[](\n    vec2( -0.94201624, -0.39906216 ),\n    vec2( 0.94558609, -0.76890725 ),\n    vec2( -0.094184101, -0.92938870 ),\n    vec2( 0.34495938, 0.29387760 )\n  );\n\n  //#define kSCNTexcoordCount 2\n  //struct SCNShaderGeometry {\n  //  vec3 position;\n  //  vec3 normal;\n  //  vec4 tangent;\n  //  vec4 color;\n  //  vec2 texcoords[kSCNTexcoordCount];\n  //};\n\n  uniform float u_time;\n\n  in vec3 v_position;\n  in vec3 v_normal;\n  in vec2 v_texcoord0;\n  in vec2 v_texcoord1;\n  //in vec4 v_color;\n  in vec3 v_eye;\n  in vec3 v_tangent;\n  in vec3 v_bitangent;\n  in float v_fogFactor;\n\n  //in SCNShaderGeometry _geometry;\n\n  out vec4 outColor;\n\n  __USER_CUSTOM_UNIFORM__\n\n  float saturate(float value) {\n    return clamp(value, 0.0, 1.0);\n  }\n\n  float convDepth(vec4 color) {\n    const float rMask = 1.0;\n    const float gMask = 1.0 / 255.0;\n    const float bMask = 1.0 / (255.0 * 255.0);\n    const float aMask = 1.0 / (255.0 * 255.0 * 255.0);\n    float depth = dot(color, vec4(rMask, gMask, bMask, aMask));\n    return depth * 2.0 - 1.0;\n  }\n\n  #if USE_SHADER_MODIFIER_SURFACE\n  void shaderModifierSurface() {\n    __SHADER_MODIFIER_SURFACE__\n  }\n  #endif\n\n  #if USE_SHADER_MODIFIER_FRAGMENT\n  void shaderModifierFragment() {\n    __SHADER_MODIFIER_FRAGMENT__\n  }\n  #endif\n\n    \n  void main() {\n    //_output.color = v_color;\n    //_output.color = vec4(0, 0, 0, 1);\n\n    //vec3 viewVec = normalize(v_eye);\n    //vec3 nom = normalize(v_normal);\n    _surface.view = normalize(v_eye);\n    _surface.position = v_position;\n    _surface.normal = normalize(v_normal);\n    _surface.tangent = normalize(v_tangent);\n    _surface.bitangent = normalize(v_bitangent);\n\n    // normal texture\n    if(textureFlags[TEXTURE_NORMAL_INDEX]){\n      mat3 tsInv = mat3(_surface.tangent, _surface.bitangent, _surface.normal);\n      vec3 color = normalize(texture(u_normalTexture, v_texcoord0).rgb * 2.0 - 1.0); // FIXME: check mappingChannel to decide which texture you use.\n      _surface.normal = normalize(tsInv * color);\n    }\n\n    //_surface.ambient = material.ambient;\n    _surface.ambient = vec4(0, 0, 0, 1); // FIXME: check: lock ambient with diffuse\n    _surface.diffuse = material.diffuse;\n    _surface.specular = material.specular;\n    _surface.emission = material.emission;\n    _surface.multiply = material.multiply;\n    _surface.transparent = material.transparent;\n    _surface.reflective = material.reflective;\n    _surface.ambientOcclusion = material.ambientOcclusion.r;\n    _surface.shininess = material.shininess;\n    _surface.fresnel = 0.4 * pow(1.0 - clamp(dot(_surface.view, _surface.normal), 0.0, 1.0), material.fresnelExponent); // TODO: calculate coefficient\n    _surface.metalness = material.metalness.r;\n    _surface.roughness = material.roughness.r;\n\n    // TODO: check mapping channel for each material\n    _surface.ambientTexcoord = v_texcoord0;\n    _surface.diffuseTexcoord = v_texcoord0;\n    _surface.specularTexcoord = v_texcoord0;\n    if(selfIllumination){\n      _surface.emissionTexcoord = v_texcoord1;\n    }else{\n      _surface.emissionTexcoord = v_texcoord0;\n    }\n    _surface.multiplyTexcoord = v_texcoord0;\n    _surface.transparentTexcoord = v_texcoord0;\n    _surface.metalnessTexcoord = v_texcoord0;\n    _surface.roughnessTexcoord = v_texcoord0;\n\n    if(textureFlags[TEXTURE_AMBIENT_INDEX]){\n      _surface.ambient = texture(u_ambientTexture, _surface.ambientTexcoord);\n    }\n    if(textureFlags[TEXTURE_DIFFUSE_INDEX]){\n      _surface.diffuse = texture(u_diffuseTexture, _surface.diffuseTexcoord);\n      _surface.diffuse.a *= material.diffuse.a;\n    }\n    if(textureFlags[TEXTURE_SPECULAR_INDEX]){\n      _surface.specular = texture(u_specularTexture, _surface.specularTexcoord);\n    }\n    if(textureFlags[TEXTURE_EMISSION_INDEX]){\n      _surface.emission = texture(u_emissionTexture, _surface.emissionTexcoord);\n    }\n    if(textureFlags[TEXTURE_MULTIPLY_INDEX]){\n      _surface.multiply = texture(u_multiplyTexture, _surface.multiplyTexcoord);\n    }\n    if(textureFlags[TEXTURE_TRANSPARENT_INDEX]){\n      _surface.transparent = texture(u_transparentTexture, _surface.transparentTexcoord);\n    }\n    if(textureFlags[TEXTURE_METALNESS_INDEX]){\n      _surface.metalness = texture(u_metalnessTexture, _surface.metalnessTexcoord).r;\n    }\n    if(textureFlags[TEXTURE_ROUGHNESS_INDEX]){\n      _surface.roughness = texture(u_roughnessTexture, _surface.roughnessTexcoord).r;\n    }\n\n    __USER_CUSTOM_TEXCOORD__\n\n    #if USE_SHADER_MODIFIER_SURFACE\n      shaderModifierSurface();\n    #endif\n\n    // Lighting\n    int numLights = 0;\n    _lightingContribution.ambient = vec3(0);\n    _lightingContribution.diffuse = vec3(0);\n    _lightingContribution.specular = vec3(0);\n\n    #if NUM_AMBIENT_LIGHTS > 0\n      for(int i=0; i<NUM_AMBIENT_LIGHTS; i++){\n        _lightingContribution.ambient += light.ambient[i].color.rgb;\n      }\n    #endif\n\n    #if NUM_DIRECTIONAL_LIGHTS > 0\n      for(int i=0; i<NUM_DIRECTIONAL_LIGHTS; i++){\n        // diffuse\n        vec3 lightVec = normalize(v_light[numLights + i]);\n        float diffuse = clamp(dot(lightVec, _surface.normal), 0.0f, 1.0f);\n        _lightingContribution.diffuse += light.directional[i].color.rgb * diffuse;\n\n        // specular\n        if(diffuse > 0.0f){\n          vec3 halfVec = normalize(lightVec + _surface.view);\n          float specular = pow(dot(halfVec, _surface.normal), _surface.shininess);\n          _lightingContribution.specular += vec3(specular);\n        }\n      }\n      numLights += NUM_DIRECTIONAL_LIGHTS;\n    #endif\n\n    #if NUM_OMNI_LIGHTS > 0\n      for(int i=0; i<NUM_OMNI_LIGHTS; i++){\n        // diffuse\n        vec3 lightVec = normalize(v_light[numLights + i]);\n        float diffuse = clamp(dot(lightVec, _surface.normal), 0.0f, 1.0f);\n        //_output.color.rgb += light.omni[i].color.rgb * material.diffuse.rgb * diffuse;\n        _lightingContribution.diffuse += light.omni[i].color.rgb * diffuse;\n\n        // specular\n        if(diffuse > 0.0f){\n          vec3 halfVec = normalize(lightVec + _surface.view);\n          float specular = pow(dot(halfVec, _surface.normal), _surface.shininess);\n          // TODO: use intensity\n          _lightingContribution.specular += vec3(1, 1, 1) * specular;\n        }\n      }\n      numLights += NUM_OMNI_LIGHTS;\n    #endif\n\n    #if NUM_SPOT_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n    #if NUM_IES_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n    #if NUM_PROBE_LIGHTS > 0\n      // TODO: implement\n    #endif\n\n    __FS_LIGHTING__\n\n\n    // calculate color\n    _output.color = vec4(0, 0, 0, _surface.diffuse.a);\n\n    //vec3 D = _lightingContribution.diffuse;\n    //// lock ambient with diffuse\n    //D += _lightingContribution.ambient * _surface.ambientOcclusion;\n    //// emission\n    //if(selfIllumination){\n    //  D += _surface.emission.rgb;\n    //}\n    //// diffuse\n    //_output.color.rgb = _surface.diffuse.rgb * D;\n    //vec3 S = _lightingContribution.specular;\n    ////S += _surface.reflective.rgb * _surface.ambientOcclusion;\n    //S *= _surface.specular.rgb;\n    //_output.color.rgb += S;\n    //// ambient\n    //_output.color.rgb += _surface.ambient.rgb * _lightingContribution.ambient;\n    //if(!selfIllumination){\n    //  _output.color.rgb += _surface.emission.rgb;\n    //}\n    //// multiply\n    //_output.color.rgb *= _surface.multiply.rgb;\n    //// fresnel reflection\n    //if(textureFlags[TEXTURE_REFLECTIVE_INDEX]){\n    //  vec3 r = reflect(_surface.view, _surface.normal);\n    //  //float fresnel = f0 + (1.0 - f0) * pow(1.0 - clamp(dot(viewVec, nom), 0.0, 1.0), material.fresnelExponent);\n    //  //float fresnel = 0.4 * pow(1.0 - clamp(dot(_surface.view, _surface.normal), 0.0, 1.0), material.fresnelExponent);\n    //  _output.color.rgb += texture(u_reflectiveTexture, r).rgb * _surface.fresnel;\n    //}\n    //float fogFactor = pow(v_fogFactor, fog.densityExponent);\n    //_output.color = mix(_output.color, fog.color, fogFactor);\n    //_output.color.rgb *= _surface.diffuse.a;\n\n    #define pi 3.14159265\n    vec4 debugColor;\n    float alpha = pow(_surface.roughness, 4.0);\n    float invAlpha = 1.0 - alpha;\n    float nv = clamp(dot(_surface.normal, _surface.view), 0.0, 1.0);\n    float f0 = 0.6;\n    float Gv = 1.0 / (nv + sqrt(alpha + invAlpha * nv * nv));\n    for(int i=0; i<NUM_SHADOW_LIGHTS; i++){\n      vec3 lightVec = normalize(v_light[i]);\n      vec3 halfVec = normalize(lightVec + _surface.view);\n\n      float nh = clamp(dot(_surface.normal, halfVec), 0.0, 1.0);\n      float nl = clamp(dot(_surface.normal, lightVec), 0.0, 1.0);\n      //float vh = clamp(dot(_surface.view, halfVec), 0.0, 1.0);\n\n      float D = alpha / (pi * pow(nh * nh * (alpha - 1.0) + 1.0, 2.0));\n      //float F = f0 + (1.0 - f0) * pow(vh, 5.0);\n      float F = f0 + (1.0 - f0) * pow(1.0 - nh, 5.0);\n      float G = Gv / (nl + sqrt(alpha + invAlpha * nl * nl));\n      float specular = D * F * G;\n      float diffuse = (1.0 - F) * nl / pi;\n      _output.color.rgb += _surface.diffuse.rgb * mix(diffuse, specular, _surface.metalness);\n\n      debugColor = vec4(F, nl, diffuse, 1.0);\n    }\n\n    #if USE_SHADER_MODIFIER_FRAGMENT\n      shaderModifierFragment();\n    #endif\n\n    if(_output.color.a <= 0.0){\n      // avoid overwriting the depth buffer\n      discard;\n    }\n\n    outColor = _output.color;\n\n    // linear To sRGB\n    //outColor.rgb = pow(_output.color.rgb, vec3(1.0/2.2));\n    //outColor.a = _output.color.a;\n\n    //outColor = vec4(1.0, 0.0, 0.0, 1.0);\n    //outColor = debugColor;\n  }\n\n",iu="#version 300 es\n  precision mediump float;\n\n  uniform mat4 viewProjectionTransform;\n  uniform vec4[765] skinningJoints;\n  uniform int numSkinningJoints;\n\n  in vec3 position;\n  //in vec3 normal;\n  in vec4 boneIndices;\n  in vec4 boneWeights;\n\n  out vec3 v_position;\n\n  void main() {\n    vec3 pos = vec3(0, 0, 0);\n    if(numSkinningJoints > 0){\n      for(int i=0; i<numSkinningJoints; i++){\n        float weight = boneWeights[i];\n        if(int(boneIndices[i]) < 0){\n          continue;\n        }\n        int idx = int(boneIndices[i]) * 3;\n        mat4 jointMatrix = transpose(mat4(skinningJoints[idx],\n                                          skinningJoints[idx+1],\n                                          skinningJoints[idx+2],\n                                          vec4(0, 0, 0, 1)));\n        pos += (jointMatrix * vec4(position, 1.0)).xyz * weight;\n      }\n    }else{\n      mat4 jointMatrix = transpose(mat4(skinningJoints[0],\n                                        skinningJoints[1],\n                                        skinningJoints[2],\n                                        vec4(0, 0, 0, 1)));\n      pos = (jointMatrix * vec4(position, 1.0)).xyz;\n    }\n    //v_position = pos;\n\n    gl_Position = viewProjectionTransform * vec4(pos, 1.0);\n    v_position = gl_Position.xyz / gl_Position.w;\n  }\n",au="#version 300 es\n  precision mediump float;\n\n  uniform mat4 modelTransform;\n  uniform mat4 viewTransform;\n  uniform mat4 projectionTransform;\n  uniform int orientationMode;\n  uniform float stretchFactor;\n\n  in vec3 position;\n  in vec3 velocity;\n  in vec4 rotation;\n  in vec4 color;\n  in float size;\n  //in float life;\n  in vec2 corner;\n  in vec2 texcoord;\n\n  out vec2 v_texcoord;\n  out vec4 v_color;\n\n  void main() {\n    vec4 pos = viewTransform * vec4(position, 1.0);\n    vec3 d;\n\n    if(stretchFactor > 0.0){\n      vec4 v = viewTransform * vec4(velocity, 0.0) * stretchFactor;\n      if(corner.y > 0.0){\n        pos.xyz += v.xyz;\n      }\n      vec2 cy = normalize(v.xy);\n      vec2 cx = vec2(-cy.y, cy.x);\n      d = vec3(cx * corner.x + cy * corner.y, 0) * size;\n    }else{\n      float sinAngle = sin(rotation.w);\n      float cosAngle = cos(rotation.w);\n      float tcos = 1.0 - cosAngle;\n\n      d = vec3(\n          corner.x * (rotation.x * rotation.x * tcos + cosAngle)\n        + corner.y * (rotation.x * rotation.y * tcos - rotation.z * sinAngle),\n          corner.x * (rotation.y * rotation.x * tcos + rotation.z * sinAngle)\n        + corner.y * (rotation.y * rotation.y * tcos + cosAngle),\n          corner.x * (rotation.z * rotation.x * tcos - rotation.y * sinAngle)\n        + corner.y * (rotation.z * rotation.y * tcos + rotation.x * sinAngle)) * size;\n      if(orientationMode == 2){\n        // orientation: free\n        d = mat3(viewTransform) * mat3(modelTransform) * d;\n      }\n    }\n    pos.xyz += d;\n\n    v_color = color;\n    v_texcoord = texcoord;\n    gl_Position = projectionTransform * pos;\n  }\n",uu="#version 300 es\n  precision mediump float;\n\n  uniform mat4 viewProjectionTransform;\n  uniform vec4[765] skinningJoints;\n  uniform int numSkinningJoints;\n\n  in vec3 position;\n  in vec3 normal;\n  in vec4 boneIndices;\n  in vec4 boneWeights;\n  \n  out vec3 v_normal;\n  out vec3 v_position;\n\n  void main() {\n    vec3 pos = vec3(0, 0, 0);\n    vec3 nom = vec3(0, 0, 0);\n    if(numSkinningJoints > 0){\n      for(int i=0; i<numSkinningJoints; i++){\n        float weight = boneWeights[i];\n        if(int(boneIndices[i]) < 0){\n          continue;\n        }\n        int idx = int(boneIndices[i]) * 3;\n        mat4 jointMatrix = transpose(mat4(skinningJoints[idx],\n                                          skinningJoints[idx+1],\n                                          skinningJoints[idx+2],\n                                          vec4(0, 0, 0, 1)));\n        pos += (jointMatrix * vec4(position, 1.0)).xyz * weight;\n        nom += (mat3(jointMatrix) * normal) * weight;\n      }\n    }else{\n      mat4 jointMatrix = transpose(mat4(skinningJoints[0],\n                                        skinningJoints[1],\n                                        skinningJoints[2],\n                                        vec4(0, 0, 0, 1)));\n      pos = (jointMatrix * vec4(position, 1.0)).xyz;\n      nom = mat3(jointMatrix) * normal;\n    }\n    //v_position = pos;\n    v_normal = nom;\n\n    gl_Position = viewProjectionTransform * vec4(pos, 1.0);\n    v_position = gl_Position.xyz / gl_Position.w;\n  }\n",su="#version 300 es\n  precision mediump float;\n\n  uniform int objectID;\n  uniform int geometryID;\n\n  in vec3 v_normal;\n  in vec3 v_position;\n\n  layout(location = 0) out vec4 out_objectID;\n  layout(location = 1) out vec4 out_faceID;\n  layout(location = 2) out vec4 out_position;\n  layout(location = 3) out vec4 out_normal;\n\n  void main() {\n    out_objectID = vec4(\n      float(objectID >> 8) / 255.0,\n      float(objectID & 0xFF) / 255.0,\n      float(geometryID >> 8) / 255.0,\n      float(geometryID & 0xFF) / 255.0\n    );\n    //out_faceID = vec4(\n    //  (gl_PrimitiveID >> 24) / 255.0,\n    //  ((gl_PrimitiveID >> 16) & 0xFF) / 255.0,\n    //  ((gl_PrimitiveID >> 8) & 0xFF) / 255.0,\n    //  (gl_PrimitiveID & 0xFF) / 255.0\n    //);\n    out_faceID = vec4(0, 0, 0, 0); // TODO: implement\n    vec3 n = normalize(v_normal);\n    out_normal = vec4((n.x + 1.0) * 0.5, (n.y + 1.0) * 0.5, (n.z + 1.0) * 0.5, 0);\n    //out_position = vec4((v_position.x + 1.0) * 0.5, (v_position.y + 1.0) * 0.5, (v_position.z + 1.0) * 0.5, 0);\n    float r = (v_position.z + 1.0) * 0.5;\n    float g = fract(r * 255.0);\n    float b = fract(g * 255.0);\n    float a = fract(b * 255.0);\n    float coef = 1.0 / 255.0;\n\n    r -= g * coef;\n    g -= b * coef;\n    b -= a * coef;\n    out_position = vec4(r, g, b, a);\n  }\n";function lu(e){return(lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cu(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hu(e,t){return!t||"object"!==lu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yu(e){return(yu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pu(e,t){return(pu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mu=15,du=function(e){function t(e){var n;arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=hu(this,yu(t).call(this))).scene=null,n._nextFrameTime=0,n._context=null,n._backgroundColor=null,n._pointOfView=null,n.autoenablesDefaultLighting=!1,n.isJitteringEnabled=!1,n.showsStatistics=!1,n.debugOptions=null,n._renderingAPI=null,n.sceneTime=0,n._time=0,n.isPlaying=!1,n.loops=!1,n.delegate=null,n._currentRenderCommandEncoder=null,n._device=null,n._commandQueue=null,n._colorPixelFormat=null,n._depthPixelFormat=null,n._stencilPixelFormat=null,n.overlaySKScene=null,n.currentTime=0,n.__defaultProgram=null,n.__defaultPBRProgram=null,n.__defaultParticleProgram=null,n.__defaultHitTestProgram=null,n.__defaultShadowProgram=null,n._location=new Map,n._defaultCameraPosNode=new po,n._defaultCameraRotNode=new po,n._defaultCameraNode=new po,n._defaultCameraNode.name="kSCNFreeViewCameraName";var r=new ti;r.name="kSCNFreeViewCameraNameCamera",n._defaultCameraNode.camera=r,n._defaultCameraNode.position=new ue.a(0,0,mu),n._defaultCameraNode._presentation=n._defaultCameraNode.copy(),n._defaultCameraPosNode.addChildNode(n._defaultCameraRotNode),n._defaultCameraPosNode._presentation=n._defaultCameraPosNode.copy(),n._defaultCameraRotNode.addChildNode(n._defaultCameraNode),n._defaultCameraRotNode._presentation=n._defaultCameraRotNode.copy(),n._defaultLightNode=new po;var o=new Fa;return o.color=de.white,o.type=Fa.LightType.omni,o.position=new ue.a(0,10,10),n._defaultLightNode.light=o,n._defaultLightNode._presentation=n._defaultLightNode.copy(),n._viewRect=new i.a(new c.a(0,0),new a.a(0,0)),n._backgroundColor=de.white,n.__dummyTexture=null,n._lightNodes={},n._numLights={},n._cameraBuffer=null,n._lightBuffer=null,n._scnLightsBuffer=null,n._fogBuffer=null,n._hitFrameBuffer=null,n._hitDepthBuffer=null,n._hitObjectIDTexture=null,n._hitFaceIDTexture=null,n._hitPositionTexture=null,n._hitNormalTexture=null,n._currentProgram=null,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pu(e,t)}(t,J["a"]),n=t,(r=[{key:"renderAtTimePassDescriptor",value:function(e,t,n,r){}},{key:"render",value:function(){var e=this;if(null!==this.context){var t=this.context;if(null!==this.scene){this._lightNodes=this._createLightNodeArray();var n=this._defaultProgram,r=n._getGLProgramForContext(t);t.clearColor(this._backgroundColor.red,this._backgroundColor.green,this._backgroundColor.blue,this._backgroundColor.alpha),t.clearDepth(1),t.clearStencil(0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._useProgram(n),t.depthFunc(t.LEQUAL),t.depthMask(!0),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),null===this._cameraBuffer&&this._initializeCameraBuffer(r);var o=[],i=this._getCameraNode();i._updateWorldTransform();var a=i.presentation||i,u=a.camera;u._updateProjectionTransform(this._viewRect),o.push.apply(o,cu(a.worldTransform.getTranslation().floatArray()).concat([0])),o.push.apply(o,cu(a.viewTransform.floatArray())),o.push.apply(o,cu(a.inverseViewTransform.floatArray())),o.push.apply(o,cu(a.viewProjectionTransform.floatArray())),t.bindBuffer(t.UNIFORM_BUFFER,this._cameraBuffer),t.bufferData(t.UNIFORM_BUFFER,new Float32Array(o),t.DYNAMIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null),null===this._fogBuffer&&this._initializeFogBuffer(r);var s=[];null!==this.scene.fogColor&&0!==this.scene.fogEndDistance?s.push.apply(s,cu(this.scene.fogColor.floatArray()).concat([this.scene.fogStartDistance,this.scene.fogEndDistance,this.scene.fogDensityExponent,0])):s.push(0,0,0,0,2*u.zFar,2*u.zFar+1,1,0),t.bindBuffer(t.UNIFORM_BUFFER,this._fogBuffer),t.bufferData(t.UNIFORM_BUFFER,new Float32Array(s),t.DYNAMIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null),null===this._lightBuffer&&this._initializeLightBuffer(r);var l=this._lightNodes,c=[];l.ambient.forEach(function(e){c.push.apply(c,cu(e.presentation.light.color.float32Array()))}),l.directional.forEach(function(e){var t=new ue.a(0,0,-1).rotateWithQuaternion(e.presentation._worldOrientation);c.push.apply(c,cu(e.presentation.light.color.float32Array()).concat(cu(t.float32Array()),[0]))}),l.directionalShadow.forEach(function(e){var t=new ue.a(0,0,-1).rotateWithQuaternion(e.presentation._worldOrientation);e.presentation.light._updateProjectionTransform(),c.push.apply(c,cu(e.presentation.light.color.float32Array()).concat(cu(t.float32Array()),[0],cu(e.presentation.light.shadowColor.float32Array()),cu(e.presentation.lightViewProjectionTransform.float32Array()),cu(e.presentation.shadowProjectionTransform.float32Array())))}),l.omni.forEach(function(e){c.push.apply(c,cu(e.presentation.light.color.float32Array()).concat(cu(e.presentation._worldTranslation.float32Array()),[0]))}),l.probe.forEach(function(e){c.push.apply(c,cu(e.presentation.light.color.float32Array()))}),l.spot.forEach(function(e){c.push.apply(c,cu(e.presentation.light.color.float32Array()))}),t.bindBuffer(t.UNIFORM_BUFFER,this._lightBuffer),t.bufferData(t.UNIFORM_BUFFER,new Float32Array(c),t.DYNAMIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null);var f=[];if(l.directionalShadow.length>0){var h=l.directionalShadow[0].presentation,y=new ue.a(0,0,-1).rotateWithQuaternion(h._worldOrientation);f.push.apply(f,cu(y.float32Array()).concat([0])),f.push.apply(f,cu(h.shadowProjectionTransform.float32Array()))}else f.push(0,0,0,0),f.push(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);if(t.bindBuffer(t.UNIFORM_BUFFER,this._scnLightsBuffer),t.bufferData(t.UNIFORM_BUFFER,new Float32Array(f),t.DYNAMIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null),null!==this.scene.background._contents){var p=this.scene._skyBox;p.position=a._worldTranslation;var m=1.154*u.zFar;p.scale=new ue.a(m,m,m),p._updateWorldTransform();var d=s.slice(0);d[4]=2*u.zFar,d[5]=2.1*u.zFar,d[6]=1,t.bindBuffer(t.UNIFORM_BUFFER,this._fogBuffer),t.bufferData(t.UNIFORM_BUFFER,new Float32Array(d),t.DYNAMIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null),this._renderNode(p),t.bindBuffer(t.UNIFORM_BUFFER,this._fogBuffer),t.bufferData(t.UNIFORM_BUFFER,new Float32Array(s),t.DYNAMIC_DRAW),t.bindBuffer(t.UNIFORM_BUFFER,null)}this._useProgram(this._defaultShadowProgram),t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.LEQUAL),t.clearDepth(1),t.clearColor(1,1,1,1),t.disable(t.BLEND);for(var _=this._createShadowNodeArray(),g=Object.keys(l),v=0;v<g.length;v++){var b=g[v],S=!0,w=!1,T=void 0;try{for(var k,O=l[b][Symbol.iterator]();!(S=(k=O.next()).done);S=!0){var C=k.value;this._renderNodesShadowOfLight(_,C)}}catch(e){w=!0,T=e}finally{try{S||null==O.return||O.return()}finally{if(w)throw T}}}this._setViewPort(),this._useProgram(n);for(var x=0;x<l.directionalShadow.length;x++){var E=l.directionalShadow[x],P="TEXTURE".concat(x+8);t.activeTexture(t[P]),t.bindTexture(t.TEXTURE_2D,E.presentation.light._shadowDepthTexture)}t.enable(t.BLEND),this._createRenderingNodeArray().forEach(function(t){e._renderNode(t)});var A=this._defaultParticleProgram._glProgram;if(this._useProgram(this._defaultParticleProgram),t.depthMask(!1),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),t.uniformMatrix4fv(t.getUniformLocation(A,"viewTransform"),!1,a.viewTransform.float32Array()),t.uniformMatrix4fv(t.getUniformLocation(A,"projectionTransform"),!1,a.projectionTransform.float32Array()),null!==this.scene._particleSystems){var N=!0,R=!1,F=void 0;try{for(var D,I=this.scene._particleSystems[Symbol.iterator]();!(N=(D=I.next()).done);N=!0){var M=D.value;this._renderParticleSystem(M)}}catch(e){R=!0,F=e}finally{try{N||null==I.return||I.return()}finally{if(R)throw F}}}this._createParticleNodeArray().forEach(function(t){e._renderParticle(t)}),this._renderOverlaySKScene(),t.flush()}else if(this.overlaySKScene){var j=this.overlaySKScene;t.clearColor(j.backgroundColor.red,j.backgroundColor.green,j.backgroundColor.blue,j.backgroundColor.alpha),t.clear(t.COLOR_BUFFER_BIT),this._renderOverlaySKScene()}}else console.error("SCNRenderer.render(): context is null")}},{key:"_renderOverlaySKScene",value:function(){if(null!==this.overlaySKScene){var e=this.context;e.disable(e.CULL_FACE),e.enable(e.DEPTH_TEST),e.depthFunc(e.GEQUAL),e.enable(e.BLEND),e.depthMask(!0),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.clearStencil(0),e.clearDepth(-1),e.clear(e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT);var t=this._createSKNodeArray(),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;this._renderSKNode(u)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}},{key:"_getCameraNode",value:function(){var e=this._pointOfView;return null===e&&(e=this._searchCameraNode(),this._pointOfView=e,null===e&&(e=this._defaultCameraNode)),e===this._defaultCameraNode&&this._defaultCameraPosNode._updateWorldTransform(),e}},{key:"_createShadowNodeArray",value:function(){for(var e=[this.scene._rootNode],t=[];e.length>0;){var n=e.shift();null!==n.presentation&&null!==n.presentation.geometry&&n.presentation.castsShadow&&n.presentation._worldOpacity>0&&!n.presentation.isHidden&&t.push(n),e.push.apply(e,cu(n.childNodes))}return t}},{key:"_createRenderingNodeArray",value:function(){for(var e=[this.scene._rootNode],t=[];e.length>0;){var n=e.shift();null!==n.presentation&&null!==n.presentation.geometry&&t.push(n),e.push.apply(e,cu(n.childNodes))}return t.sort(function(e,t){return e.presentation.renderingOrder-t.presentation.renderingOrder+.5*(t.presentation._worldOpacity-e.presentation._worldOpacity)}),t}},{key:"_createParticleNodeArray",value:function(){for(var e=[this.scene._rootNode],t=[];e.length>0;){var n=e.shift();null!==n.presentation&&null!==n.presentation.particleSystems&&t.push(n),e.push.apply(e,cu(n.childNodes))}return t.sort(function(e,t){return e.renderingOrder-t.renderingOrder+.5*(t.opacity-e.opacity)}),t}},{key:"_createLightNodeArray",value:function(){for(var e={ies:[],ambient:[],directional:[],omni:[],probe:[],spot:[],directionalShadow:[]},t=[this.scene.rootNode],n=0;t.length>0;){var r=t.shift();null!==r.presentation&&null!==r.presentation.light&&("directional"===r.presentation.light.type&&r.presentation.light.castsShadow?e.directionalShadow.push(r):e[r.presentation.light.type].push(r),r.presentation.light.type!==Fa.LightType.ambient&&(n+=1)),t.push.apply(t,cu(r.childNodes))}return this.autoenablesDefaultLighting&&0===n&&e[this._defaultLightNode.light.type].push(this._defaultLightNode),e}},{key:"_createRenderingPhysicsNodeArray",value:function(){for(var e=[this.scene._rootNode],t=[];e.length>0;){var n=e.shift();null!==n.presentation&&null!==n.presentation.physicsBody&&null!==n.presentation.physicsBody.physicsShape&&t.push(n),e.push.apply(e,cu(n.childNodes))}return t.sort(function(e,t){return e.renderingOrder-t.renderingOrder}),t}},{key:"_renderNodesShadowOfLight",value:function(e,t){var n=t.presentation,r=n.light;if(n.castsShadow){this._setViewPort(r._shadowMapWidth,r._shadowMapHeight);var o=this.context,i=this._defaultShadowProgram._getGLProgramForContext(o);o.bindFramebuffer(o.FRAMEBUFFER,r._getDepthBufferForContext(o)),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.uniformMatrix4fv(o.getUniformLocation(i,"viewProjectionTransform"),!1,n.lightViewProjectionTransform.float32Array());var a=!0,u=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value,h=f.presentation.geometry,y=h.geometryElements.length;if(0!==y){null===h._shadowVAO&&this._initializeShadowVAO(f,i),f.morpher,null!==f.presentation.skinner?f.presentation.skinner._useGPU?(o.uniform1i(o.getUniformLocation(i,"numSkinningJoints"),f.presentation.skinner.numSkinningJoints),o.uniform4fv(o.getUniformLocation(i,"skinningJoints"),f.presentation.skinner.float32Array())):(o.uniform1i(o.getUniformLocation(i,"numSkinningJoints"),0),o.uniform4fv(o.getUniformLocation(i,"skinningJoints"),Object(Z.a)(0,0,0).float32Array3x4f())):(o.uniform1i(o.getUniformLocation(i,"numSkinningJoints"),0),o.uniform4fv(o.getUniformLocation(i,"skinningJoints"),f.presentation._worldTransform.float32Array3x4f()));for(var p=0;p<y;p++){var m=h._shadowVAO[p],d=h.geometryElements[p];o.bindVertexArray(m);var _=null;switch(d.primitiveType){case er.a.triangles:_=o.TRIANGLES;break;case er.a.triangleStrip:_=o.TRIANGLE_STRIP;break;case er.a.line:_=o.LINES;break;case er.a.point:_=o.POINTS;break;case er.a.polygon:_=o.TRIANGLE_FAN;break;default:throw new Error("unsupported primitiveType: ".concat(d.primitiveType))}var g=null;switch(d.bytesPerIndex){case 1:g=o.UNSIGNED_BYTE;break;case 2:g=o.UNSIGNED_SHORT;break;case 4:g=o.UNSIGNED_INT;break;default:throw new Error("unsupported index size: ".concat(d.bytesPerIndex))}o.drawElements(_,d._glData.length,g,0)}}}}catch(e){u=!0,s=e}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}o.bindFramebuffer(o.FRAMEBUFFER,null)}}},{key:"_renderNode",value:function(e){if(!(e.presentation.isHidden||e.presentation._worldOpacity<=0)){var t=this.context,n=e.presentation.geometry,r=n.geometryElements.length;if(0!==r){var o=this._getProgramForGeometry(n),i=o._getGLProgramForContext(t);this._switchProgram(o),null===n._vertexArrayObjects&&(this._initializeVAO(e,i),this._initializeUBO(e,i)),(null!==e.morpher||e.skinner&&!e.skinner._useGPU)&&this._updateVAO(e),t.uniformMatrix4fv(t.getUniformLocation(i,"modelTransform"),!1,e._worldTransform.float32Array()),null!==e.presentation.skinner?e.presentation.skinner._useGPU?(t.uniform1i(t.getUniformLocation(i,"numSkinningJoints"),e.presentation.skinner.numSkinningJoints),t.uniform4fv(t.getUniformLocation(i,"skinningJoints"),e.presentation.skinner.float32Array())):(t.uniform1i(t.getUniformLocation(i,"numSkinningJoints"),0),t.uniform4fv(t.getUniformLocation(i,"skinningJoints"),Object(Z.a)(0,0,0).float32Array3x4f())):(t.uniform1i(t.getUniformLocation(i,"numSkinningJoints"),0),t.uniform4fv(t.getUniformLocation(i,"skinningJoints"),e.presentation._worldTransform.float32Array3x4f()));for(var a=0;a<r;a++){var u=n.materials.length,s=n.materials[a%u],l=i;if(s&&(s.program||s.lightingModel===Gn.LightingModel.physicallyBased)){var c=s.program?s.program:this._defaultPBRProgram;this._switchProgram(c),l=c._getGLProgramForContext(t),null!==e.presentation.skinner?e.presentation.skinner._useGPU?(t.uniform1i(t.getUniformLocation(l,"numSkinningJoints"),e.presentation.skinner.numSkinningJoints),t.uniform4fv(t.getUniformLocation(l,"skinningJoints"),e.presentation.skinner.float32Array())):(t.uniform1i(t.getUniformLocation(l,"numSkinningJoints"),0),t.uniform4fv(t.getUniformLocation(l,"skinningJoints"),Object(Z.a)(0,0,0).float32Array3x4f())):(t.uniform1i(t.getUniformLocation(l,"numSkinningJoints"),0),t.uniform4fv(t.getUniformLocation(l,"skinningJoints"),e.presentation._worldTransform.float32Array3x4f()));var f=t.getUniformBlockIndex(l,"materialUniform");t.uniformBlockBinding(l,f,1),t.bindBufferBase(t.UNIFORM_BUFFER,1,n._materialBuffer),s._callBindingHandlerForNodeProgramContextRenderer(e,l,t,this)}else this._switchProgram(o),n._callBindingHandlerForNodeProgramContextRenderer(e,i,t,this);var h=n._vertexArrayObjects[a],y=n.geometryElements[a];t.bindVertexArray(h),t.bindBufferBase(t.UNIFORM_BUFFER,1,n._materialBuffer),n._bufferMaterialData(t,l,a,e.presentation._worldOpacity);var p=null;switch(y.primitiveType){case er.a.triangles:p=t.TRIANGLES;break;case er.a.triangleStrip:p=t.TRIANGLE_STRIP;break;case er.a.line:p=t.LINES;break;case er.a.point:p=t.POINTS;break;case er.a.polygon:p=t.TRIANGLE_FAN;break;default:throw new Error("unsupported primitiveType: ".concat(y.primitiveType))}var m=null;switch(y.bytesPerIndex){case 1:m=t.UNSIGNED_BYTE;break;case 2:m=t.UNSIGNED_SHORT;break;case 4:m=t.UNSIGNED_INT;break;default:throw new Error("unsupported index size: ".concat(y.bytesPerIndex))}t.drawElements(p,y._glData.length,m,0)}}}}},{key:"_renderParticle",value:function(e){var t=this;e.presentation.isHidden||e.particleSystems.forEach(function(n){t._renderParticleSystem(n,e)})}},{key:"_renderParticleSystem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.context,r=this._defaultParticleProgram;null!==e._program&&(r=e._program);var o=r._getGLProgramForContext(n);if(this._useProgram(r),n.disable(n.CULL_FACE),null===e._vertexBuffer&&e._initializeVAO(n,o),n.bindVertexArray(e._vertexArray),e._bufferMaterialData(n,o),t)n.uniformMatrix4fv(n.getUniformLocation(o,"modelTransform"),!1,t._worldTransform.float32Array());else{var i=Object(Z.a)(0,0,0);n.uniformMatrix4fv(n.getUniformLocation(o,"modelTransform"),!1,i.float32Array())}n.drawElements(n.TRIANGLES,6*e._particles.length,e._glIndexSize,0)}},{key:"_renderNodeForHitTest",value:function(e,t,n){var r=this.context,o=e.presentation.geometry,i=this._defaultHitTestProgram._getGLProgramForContext(r),a=o.geometryElements.length;if(0!==a&&null!==o._vertexArrayObjects){null===o._hitTestVAO&&this._initializeHitTestVAO(e,i),r.uniform1i(r.getUniformLocation(i,"objectID"),t),null!==e.presentation.skinner&&e.presentation.skinner._useGPU?e.presentation.skinner._useGPU?(r.uniform1i(r.getUniformLocation(i,"numSkinningJoints"),e.presentation.skinner.numSkinningJoints),r.uniform4fv(r.getUniformLocation(i,"skinningJoints"),e.presentation.skinner.float32Array())):(r.uniform1i(r.getUniformLocation(i,"numSkinningJoints"),0),r.uniform4fv(r.getUniformLocation(i,"skinningJoints"),Object(Z.a)(0,0,0).float32Array3x4f())):(r.uniform1i(r.getUniformLocation(i,"numSkinningJoints"),0),r.uniform4fv(r.getUniformLocation(i,"skinningJoints"),e.presentation._worldTransform.float32Array3x4f()));for(var u=0;u<a;u++){var s=o._hitTestVAO[u],l=o.geometryElements[u];r.bindVertexArray(s),r.uniform1i(r.getUniformLocation(i,"geometryID"),u);var c=null;switch(l.primitiveType){case er.a.triangles:c=r.TRIANGLES;break;case er.a.triangleStrip:c=r.TRIANGLE_STRIP;break;case er.a.line:c=r.LINES;break;case er.a.point:c=r.POINTS;break;case er.a.polygon:c=r.TRIANGLE_FAN;break;default:throw new Error("unsupported primitiveType: ".concat(l.primitiveType))}var f=null;switch(l.bytesPerIndex){case 1:f=r.UNSIGNED_BYTE;break;case 2:f=r.UNSIGNED_SHORT;break;case 4:f=r.UNSIGNED_INT;break;default:throw new Error("unsupported index size: ".concat(l.bytesPerIndex))}r.drawElements(c,l._glData.length,f,0)}}}},{key:"_renderPhysicsNodeForHitTest",value:function(e,t,n){var r=this.context,o=e.presentation.physicsBody.physicsShape._sourceGeometry,i=o.geometryElements.length;if(0!==i){var a=this._defaultHitTestProgram._getGLProgramForContext(r);null===o._vertexBuffer&&o._createVertexBuffer(r,e,!1,o),null===o._hitTestVAO&&this._initializeHitTestVAO(e,a,!0),r.uniform1i(r.getUniformLocation(a,"objectID"),t),null!==e.presentation.skinner&&e.presentation.skinner._useGPU?e.presentation.skinner._useGPU?(r.uniform1i(r.getUniformLocation(a,"numSkinningJoints"),e.presentation.skinner.numSkinningJoints),r.uniform4fv(r.getUniformLocation(a,"skinningJoints"),e.presentation.skinner.float32Array())):(r.uniform1i(r.getUniformLocation(a,"numSkinningJoints"),0),r.uniform4fv(r.getUniformLocation(a,"skinningJoints"),Object(Z.a)(0,0,0).float32Array3x4f())):(r.uniform1i(r.getUniformLocation(a,"numSkinningJoints"),0),r.uniform4fv(r.getUniformLocation(a,"skinningJoints"),e.presentation._worldTransform.float32Array3x4f()));for(var u=0;u<i;u++){var s=o._hitTestVAO[u],l=o.geometryElements[u];r.bindVertexArray(s),r.uniform1i(r.getUniformLocation(a,"geometryID"),u);var c=null;switch(l.primitiveType){case er.a.triangles:c=r.TRIANGLES;break;case er.a.triangleStrip:c=r.TRIANGLE_STRIP;break;case er.a.line:c=r.LINES;break;case er.a.point:c=r.POINTS;break;case er.a.polygon:c=r.TRIANGLE_FAN;break;default:throw new Error("unsupported primitiveType: ".concat(l.primitiveType))}var f=null;switch(l.bytesPerIndex){case 1:f=r.UNSIGNED_BYTE;break;case 2:f=r.UNSIGNED_SHORT;break;case 4:f=r.UNSIGNED_INT;break;default:throw new Error("unsupported index size: ".concat(l.bytesPerIndex))}r.drawElements(c,l._glData.length,f,0)}}}},{key:"_createSKNodeArray",value:function(){if(null===this.overlaySKScene)return[];for(var e=[this.overlaySKScene],t=[];e.length>0;){var n=e.shift();t.push(n),e.push.apply(e,cu(n.children))}return t}},{key:"_renderSKNode",value:function(e){e._render(this.context,this._viewRect)}},{key:"renderAtTime",value:function(e){}},{key:"snapshotAtTimeWith",value:function(e,t,n){return null}},{key:"updateProbesAtTime",value:function(e,t){}},{key:"presentWithIncomingPointOfView",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"prepareShouldAbortBlock",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!1}},{key:"prepare",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"hitTest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===this.scene)return[];var n=new Map;t instanceof Map?n=t:Array.isArray(t)&&(n=new Map(t));var r=this._getCameraNode();r.camera._updateProjectionTransform(this._viewRect);var o=new ue.a(e.x,e.y,0),i=new ue.a(e.x,e.y,1);return this._hitTestByCPU(r.viewProjectionTransform,o,i,n)}},{key:"_initializeHitFrameBuffer",value:function(){var e=this.context,t=this._viewRect.size.width,n=this._viewRect.size.height;this._hitFrameBuffer=e.createFramebuffer(),this._hitDepthBuffer=e.createRenderbuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this._hitFrameBuffer),e.bindRenderbuffer(e.RENDERBUFFER,this._hitDepthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t,n),this._hitObjectIDTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._hitObjectIDTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),this._hitFaceIDTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._hitFaceIDTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),this._hitPositionTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._hitPositionTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),this._hitNormalTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._hitNormalTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this._hitDepthBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._hitObjectIDTexture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT1,e.TEXTURE_2D,this._hitFaceIDTexture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT2,e.TEXTURE_2D,this._hitPositionTexture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT3,e.TEXTURE_2D,this._hitNormalTexture,0),e.drawBuffers([e.COLOR_ATTACHMENT0,e.COLOR_ATTACHMENT1,e.COLOR_ATTACHMENT2,e.COLOR_ATTACHMENT3]),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"_hitTestByCPU",value:function(e,t,n,r){var o=[],i=e.invert(),a=t.transform(i),u=n.transform(i),s=this._createRenderingNodeArray(),l=r.get(Da.categoryBitMask);void 0===l&&(l=-1);var c=!0,f=!1,h=void 0;try{for(var y,p=s[Symbol.iterator]();!(c=(y=p.next()).done);c=!0){var m=y.value;if(m.categoryBitMask&l){var d=no._hitTestWithSegmentNode(a,u,m);if(d.length>0){var _=!0,g=!1,v=void 0;try{for(var b,S=d[Symbol.iterator]();!(_=(b=S.next()).done);_=!0){var w=b.value;w._node=m,w._worldCoordinates=m.convertPositionTo(w._localCoordinates,null),w._worldNormal=m.convertPositionTo(w._localNormal,null)}}catch(e){g=!0,v=e}finally{try{_||null==S.return||S.return()}finally{if(g)throw v}}o.push.apply(o,cu(d))}}}}catch(e){f=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}return o}},{key:"_hitTestByGPU",value:function(e,t,n,r){var o=[],i=this._context;null===this._hitFrameBuffer&&this._initializeHitFrameBuffer();var a=this._defaultHitTestProgram,u=a._glProgram;this._useProgram(a),i.bindFramebuffer(i.FRAMEBUFFER,this._hitFrameBuffer),i.depthMask(!0),i.depthFunc(i.LEQUAL),i.enable(i.SCISSOR_TEST),i.disable(i.BLEND),i.clearColor(0,0,0,0),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);var s=.5*(t.x+1)*this._viewRect.size.width,l=.5*(t.y+1)*this._viewRect.size.height,c=s-1,f=l-1;c<0?c=0:c+3>this._viewRect.size.width&&(c=this._viewRect.size.width-3),f<0?f=0:f+3>this._viewRect.size.height&&(f=this._viewRect.size.width-3),i.scissor(c,f,3,3),i.uniformMatrix4fv(i.getUniformLocation(u,"viewProjectionTransform"),!1,e.float32Array());var h=r.get(Da.backFaceCulling);void 0===h&&(h=!0),h?(i.enable(i.CULL_FACE),i.cullFace(i.BACK)):i.disable(i.CULL_FACE);var y=r.get(Da.categoryBitMask);void 0===y&&(y=-1);var p=r.get(Da.ignoreHiddenNodes);void 0===p&&(p=!0);for(var m=this._createRenderingNodeArray(),d=m.length,_=0;_<d;_++){var g=m[_];0!=(g.categoryBitMask&y)&&(p&&g.isHidden||this._renderNodeForHitTest(g,_+100,r))}var v=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(s,l,1,1,i.RGBA,i.UNSIGNED_BYTE,v,0);var b=256*v[0]+v[1],S=256*v[2]+v[3],w=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT1),i.readPixels(s,l,1,1,i.RGBA,i.UNSIGNED_BYTE,w,0);var T=16777216*w[0]+65536*w[1]+256*w[2]+w[3],k=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT2),i.readPixels(s,l,1,1,i.RGBA,i.UNSIGNED_BYTE,k,0);var O=((k[3]/255+k[2])/255+k[1]/255+k[0])/255,C=t.lerp(n,O),x=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT3),i.readPixels(s,l,1,1,i.RGBA,i.UNSIGNED_BYTE,x,0);var E=new ue.a(x[0]/127.5-1,x[1]/127.5-1,x[2]/127.5-1);if(b>=100){var P=new wr,A=m[b-100],N=A.presentation._worldTransform.invert();P._node=A,P._geometryIndex=S,P._faceIndex=T,P._worldCoordinates=C,P._worldNormal=E,P._modelTransform=A.presentation._worldTransform,P._localCoordinates=C.transform(N),P._localNormal=E.transform(N),o.push(P)}return i.disable(i.SCISSOR_TEST),i.bindFramebuffer(i.FRAMEBUFFER,null),o}},{key:"_physicsHitTestByGPU",value:function(e,t,n,r){var o=[],i=this._context,a=this._createViewProjectionTransformForRay(e,t),u=e.transform(a),s=t.transform(a);null===this._hitFrameBuffer&&this._initializeHitFrameBuffer();var l=this._defaultHitTestProgram,c=l._glProgram;this._useProgram(l),i.bindFramebuffer(i.FRAMEBUFFER,this._hitFrameBuffer),i.depthMask(!0),i.depthFunc(i.LEQUAL),i.enable(i.SCISSOR_TEST),i.disable(i.BLEND),i.clearColor(0,0,0,0),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);var f=.5*(u.x+1)*this._viewRect.size.width,h=.5*(u.y+1)*this._viewRect.size.height,y=f-1,p=h-1;y<0?y=0:y+3>this._viewRect.size.width&&(y=this._viewRect.size.width-3),p<0?p=0:p+3>this._viewRect.size.height&&(p=this._viewRect.size.width-3),i.scissor(y,p,3,3),i.uniformMatrix4fv(i.getUniformLocation(c,"viewProjectionTransform"),!1,a.float32Array());var m=n.get(no.TestOption.backfaceCulling);void 0===m&&(m=!0),m?(i.enable(i.CULL_FACE),i.cullFace(i.BACK)):i.disable(i.CULL_FACE);var d=n.get(no.TestOption.collisionBitMask);void 0===d&&(d=-1);var _=n.get(no.TestOption.searchMode);void 0===_&&(_=no.TestSearchMode.closest);var g=null;r&&r.targets?(g=r.targets,d=-1):g=this._createRenderingPhysicsNodeArray();for(var v=g.length,b=0;b<v;b++){var S=g[b];0!=(S.physicsBody.categoryBitMask&d)&&this._renderPhysicsNodeForHitTest(S,b+100,n)}var w=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(f,h,1,1,i.RGBA,i.UNSIGNED_BYTE,w,0);var T=256*w[0]+w[1],k=256*w[2]+w[3],O=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT1),i.readPixels(f,h,1,1,i.RGBA,i.UNSIGNED_BYTE,O,0);var C=16777216*O[0]+65536*O[1]+256*O[2]+O[3],x=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT2),i.readPixels(f,h,1,1,i.RGBA,i.UNSIGNED_BYTE,x,0);var E=((x[3]/255+x[2])/255+x[1]/255+x[0])/255,P=u.lerp(s,E).transform(a.invert()),A=new Uint8Array(4);i.readBuffer(i.COLOR_ATTACHMENT3),i.readPixels(f,h,1,1,i.RGBA,i.UNSIGNED_BYTE,A,0);var N=new ue.a(A[0]/127.5-1,A[1]/127.5-1,A[2]/127.5-1);if(T>=100){var R=new wr,F=g[T-100],D=F.presentation._worldTransform.invert();R._node=F,R._geometryIndex=k,R._faceIndex=C,R._worldCoordinates=P,R._worldNormal=N,R._modelTransform=F.presentation._worldTransform,R._localCoordinates=P.transform(D),R._localNormal=N.transform(D),o.push(R)}return i.disable(i.SCISSOR_TEST),i.bindFramebuffer(i.FRAMEBUFFER,null),o}},{key:"_createViewProjectionTransformForRay",value:function(e,t){var n=t.sub(e),r=n.length(),o=1+r,i=new It.a;i.m11=1,i.m22=1,i.m33=-(o+1)/r,i.m34=-1,i.m43=-2*o*1/r;var a=new It.a,u=new ue.a(0,1,0);0===n.x&&0===n.z&&(u.y=0,u.z=1);var s=n.normalize(),l=s.cross(u).normalize(),c=l.cross(s).normalize();a.m11=l.x,a.m21=l.y,a.m31=l.z,a.m12=c.x,a.m22=c.y,a.m32=c.z,a.m13=-s.x,a.m23=-s.y,a.m33=-s.z,a.m44=1;var f=e.sub(s.mul(1)).transform(a);return a.m41=-f.x,a.m42=-f.y,a.m43=-f.z,a.mult(i)}},{key:"isNodeInsideFrustumOf",value:function(e,t){return!1}},{key:"nodesInsideFrustumOf",value:function(e){return null}},{key:"projectPoint",value:function(e){return null}},{key:"unprojectPoint",value:function(e){return null}},{key:"_setContext",value:function(e){this._context=e,this._createDummyTexture()}},{key:"_getProgramForGeometry",value:function(e){if(null!==e.program&&e.program._programCompiled)return e.program;(e.program||null!==e.shaderModifiers||null!==e._shadableHelper)&&this._compileProgramForObject(e);var t=!0,n=!1,r=void 0;try{for(var o,i=e.materials[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;(a.program||null!==a.shaderModifiers||null!==a._shadableHelper)&&this._compileProgramForObject(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e.program?e.program:this._defaultProgram}},{key:"_compileProgramForObject",value:function(e){var t=this.context,n=e.program;if(n){if(n._programCompiled)return n}else n=new Oa,e.program=n;n._parentObject=e;var r=n._getGLProgramForContext(t),o=this._vertexShaderForObject(e),i=this._fragmentShaderForObject(e),a=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(a,o),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS)){var u=t.getShaderInfoLog(a);throw new Error("vertex shader compile error: ".concat(u))}n._glVertexShader=a;var s=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(s,i),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS)){var l=t.getShaderInfoLog(s);throw new Error("fragment shader compile error: ".concat(l))}if(n._glFragmentShader=s,t.attachShader(r,a),t.attachShader(r,s),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS)){var c=t.getProgramInfoLog(r);throw new Error("program link error: ".concat(c))}return n._programCompiled=!0,n}},{key:"_useProgram",value:function(e){if(this._currentProgram!==e){var t=this.context,n=e._getGLProgramForContext(t);t.useProgram(n),e._setDummyTextureForContext(t),this._currentProgram=e}}},{key:"_switchProgram",value:function(e){if(this._currentProgram!==e){var t=this.context,n=e._getGLProgramForContext(t);t.useProgram(n),e._setDummyTextureForContext(t);for(var r=this._lightNodes,o=0;o<r.directionalShadow.length;o++){var i=r.directionalShadow[o],a="TEXTURE".concat(o+8);t.activeTexture(t[a]),t.bindTexture(t.TEXTURE_2D,i.presentation.light._shadowDepthTexture)}var u=t.getUniformBlockIndex(n,"cameraUniform");t.uniformBlockBinding(n,u,0),t.bindBufferBase(t.UNIFORM_BUFFER,0,this._cameraBuffer);var s=t.getUniformBlockIndex(n,"fogUniform");t.uniformBlockBinding(n,s,4),t.bindBufferBase(t.UNIFORM_BUFFER,4,this._fogBuffer);var l=t.getUniformBlockIndex(n,"lightUniform");t.uniformBlockBinding(n,l,2),t.bindBufferBase(t.UNIFORM_BUFFER,2,this._lightBuffer);var c=t.getUniformBlockIndex(n,"SCNLightsUniform");t.uniformBlockBinding(n,c,3),t.bindBufferBase(t.UNIFORM_BUFFER,3,this._scnLightsBuffer);var f=t.getUniformLocation(n,"u_time");if(f){var h=this._time%1e5;t.uniform1f(f,h)}var y=e._parentObject;if(y)for(var p=16,m=Object.keys(y._valuesForUndefinedKeys),d=0;d<m.length;d++){var _=m[d],g=t.getUniformLocation(n,_);if(null!==g){var v=y._valuesForUndefinedKeys[_];if("number"==typeof v)t.uniform1f(g,v);else if(Object(w.a)(v,ue.a))t.uniform3fv(g,v.float32Array());else if(Object(w.a)(v,se.a)||Object(w.a)(v,de))t.uniform4fv(g,v.float32Array());else if(Object(w.a)(v,Fn)){if(v._contents instanceof Image){var b=v._contents,S=t.createTexture(),T=document.createElement("canvas");T.width=b.naturalWidth,T.height=b.naturalHeight,T.getContext("2d").drawImage(b,0,0),t.bindTexture(t.TEXTURE_2D,S),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,b.width,b.height,0,t.RGBA,t.UNSIGNED_BYTE,T),t.generateMipmap(t.TEXTURE_2D),v._contents=S}v._contents instanceof WebGLTexture&&(t.uniform1i(g,p),t.activeTexture(t["TEXTURE".concat(p)]),t.bindTexture(t.TEXTURE_2D,v._contents),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,v._magnificationFilterFor(t)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,v._minificationFilterFor(t)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,v._wrapSFor(t)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,v._wrapTFor(t))),p+=1}}}this._currentProgram=e}}},{key:"_programForGeometry",value:function(e){}},{key:"_vertexShaderForObject",value:function(e){var t=e.program.vertexShader;return t||(t=ri),this._replaceTexts(t,e)}},{key:"_fragmentShaderForObject",value:function(e){var t=e.program.fragmentShader;return t||(t=ru),this._replaceTexts(t,e)}},{key:"_replaceTexts",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new Map,r=this._numLights[Fa.LightType.ambient],o=this._numLights[Fa.LightType.directional],i=this._numLights.directionalShadow,a=this._numLights[Fa.LightType.omni],u=this._numLights[Fa.LightType.spot],s=this._numLights[Fa.LightType.IES],l=this._numLights[Fa.LightType.probe],c=t?t._shadableHelper:null,f=t?t._valuesForUndefinedKeys:{},h=t?t.shaderModifiers:null;n.set("__NUM_AMBIENT_LIGHTS__",r),n.set("__NUM_DIRECTIONAL_LIGHTS__",o),n.set("__NUM_DIRECTIONAL_SHADOW_LIGHTS__",i),n.set("__NUM_OMNI_LIGHTS__",a),n.set("__NUM_SPOT_LIGHTS__",u),n.set("__NUM_IES_LIGHTS__",s),n.set("__NUM_PROBE_LIGHTS__",l),n.set("__USE_SHADER_MODIFIER_GEOMETRY__",0),n.set("__SHADER_MODIFIER_GEOMETRY__",""),n.set("__USE_SHADER_MODIFIER_SURFACE__",0),n.set("__SHADER_MODIFIER_SURFACE__",""),n.set("__USE_SHADER_MODIFIER_FRAGMENT__",0),n.set("__SHADER_MODIFIER_FRAGMENT__","");var y="",p="",m="";if(h)for(var d=Object.keys(h),_=0;_<d.length;_++){var g=h[d[_]].split(/^\s*#pragma\s+body\s*$/m);if(1===g.length);else{if(2!==g.length)throw new Error('found multiple "#pragma body" in the shaderModifier');y+=g[0].replace(/^\s*#pragma\s+.*$/gm,"")}}else for(var v=Object.keys(f),b=0;b<v.length;b++){var S=v[b],T=f[S];if("number"==typeof T)y+="uniform float ".concat(S,";");else{if(!Object(w.a)(T,Fn))throw new Error("custom property for ".concat(S," is not implemented"));y+="uniform sampler2D ".concat(S,";"),m+="_surface.".concat(S,"Texcoord = v_texcoord").concat(T.mappingChannel,";"),p+="vec2 ".concat(S,"Texcoord;")}}n.set("__USER_CUSTOM_UNIFORM__",y),n.set("__USER_CUSTOM_SURFACE__",p),n.set("__USER_CUSTOM_TEXCOORD__",m);var k=null;if(h?k=h:c&&(k=c._shaderModifiers),k){if(k.SCNShaderModifierEntryPointGeometry){var O=this._processShaderText(k.SCNShaderModifierEntryPointGeometry);n.set("__USE_SHADER_MODIFIER_GEOMETRY__",1),n.set("__SHADER_MODIFIER_GEOMETRY__",O)}if(k.SCNShaderModifierEntryPointSurface){var C=this._processShaderText(k.SCNShaderModifierEntryPointSurface);n.set("__USE_SHADER_MODIFIER_SURFACE__",1),n.set("__SHADER_MODIFIER_SURFACE__",C)}if(k.SCNShaderModifierEntryPointFragment){var x=this._processShaderText(k.SCNShaderModifierEntryPointFragment);n.set("__USE_SHADER_MODIFIER_FRAGMENT__",1),n.set("__SHADER_MODIFIER_FRAGMENT__",x)}}var E="";if(i>0)for(var P=0;P<i;P++){E+="\n  //float shadow = convDepth(texture(u_shadowTexture__I__, v_directionalShadowTexcoord[__I__].xy / v_directionalShadowTexcoord[__I__].w));\n  //if(v_directionalShadowDepth[__I__].z / v_directionalShadowDepth[__I__].w - 0.0001 > shadow){\n  //  _output.color.rgb += material.diffuse.rgb * light.directionalShadow[__I__].shadowColor.rgb;\n  //}else{\n  //  // diffuse\n  //  vec3 lightVec = normalize(v_light[numLights]);\n  //  float diffuse = clamp(dot(lightVec, _surface.normal), 0.0f, 1.0f);\n  //  _output.color.rgb += light.directionalShadow[__I__].color.rgb * material.diffuse.rgb * diffuse;\n\n  //  // specular\n  //  if(diffuse > 0.0f){\n  //    vec3 halfVec = normalize(lightVec + _surface.view);\n  //    float specular = pow(dot(halfVec, _surface.normal), material.shininess);\n  //    _output.color.rgb += specularColor.rgb * specular;\n  //  }\n  //}\n\n  {\n    float shadow = 0.0;\n    for(int i=0; i<4; i++){\n      float d = convDepth(texture(u_shadowTexture__I__, (v_directionalShadowTexcoord[__I__].xy + poissonDisk[i]/700.0) / v_directionalShadowTexcoord[__I__].w));\n      if(v_directionalShadowDepth[__I__].z / v_directionalShadowDepth[__I__].w - 0.0001 > d){\n        shadow += 0.25;\n      }\n    }\n    //vec3 shadowColor = material.diffuse.rgb * light.directionalShadow[__I__].shadowColor.rgb;\n    vec3 shadowColor = light.directionalShadow[__I__].shadowColor.rgb;\n    // diffuse\n    vec3 lightVec = normalize(v_light[numLights]);\n    float diffuse = clamp(dot(lightVec, _surface.normal), 0.0f, 1.0f);\n    vec3 lightDiffuse = light.directionalShadow[__I__].color.rgb * diffuse;\n    _lightingContribution.diffuse += shadowColor * shadow + lightDiffuse * (1.0 - shadow);\n\n    // specular\n    if(diffuse > 0.0f){\n      vec3 halfVec = normalize(lightVec + _surface.view);\n      float specular = pow(dot(halfVec, _surface.normal), _surface.shininess);\n      // TODO: use intensity\n      _lightingContribution.specular += vec3(specular);\n    }\n    //_output.color.rgb += shadowColor * shadow + lightColor * (1.0 - shadow);\n  }\n\n  numLights += 1;\n".replace(new RegExp("__I__","g"),P)}n.set("__FS_LIGHTING__",E);var A=e;return n.forEach(function(e,t){var n=new RegExp(t,"g");A=A.replace(n,e)}),A}},{key:"_processShaderText",value:function(e){var t=e,n=e.split(/^\s*#pragma\s+body\s*$/m);return 2==n.length&&(t=n[1].replace(/^\s*#pragma\s+.*$/gm,"")),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/texture2D/g,"texture")).replace(/float2/g,"vec2")).replace(/float3/g,"vec3")).replace(/float4/g,"vec4")).replace(/scn_frame\.time/g,"u_time")).replace(/half /g,"float ")).replace(/u_modelTransform/g,"modelTransform")).replace(/u_viewTransform/g,"camera.viewTransform")).replace(/u_inverseViewTransform/g,"camera.inverseViewTransform")).replace(/u_viewProjectionTransform/g,"caemra.viewProjectionTransform")).replace(/\s*uniform[^;]*;/g,"")).replace("uvs.x *= 2","uvs.x *= 2.0")).replace("tn * 2 - 1","tn * 2.0 - vec3(1)")).replace("tn2 * 2 - 1","tn2 * 2.0 - vec3(1)")).replace("pow(_surface.ambientOcclusion,3)","pow(_surface.ambientOcclusion,3.0)")).replace("pow(AO,5)","pow(AO,5.0)")).replace("pow(1.-fresnelBasis , 6)","pow(1.-fresnelBasis , 6.0)")).replace("pow(1.-fresnelBasis , 4)","pow(1.-fresnelBasis , 4.0)")).replace("vec3(1,0.4,0.0) * 1;","vec3(1,0.4,0.0);")).replace("vec3(0.6,0.3,0.2) * 1;","vec3(0.6,0.3,0.2);")).replace("vec4 WorldPos","vec3 WorldPos")).replace("mult * 5;","mult * 5.0;")).replace("mask * (1 - feather) + feather / 2","mask * (1.0 - feather) + feather / 2.0")).replace("vec4 pos = modelTransform * _geometry.position;","vec4 pos = modelTransform * vec4(_geometry.position, 1);")).replace("cos((u_time * 0.5 + pos.x) * 2)","cos((u_time * 0.5 + pos.x) * 2.0)")).replace("(WorldPos.x * 10)","(WorldPos.x * 10.0)")).replace("(WorldPos.z + WorldPos.x) * 3)","(WorldPos.z + WorldPos.x) * 3.0)")).replace("pow(flowmap, 1.0/2.2)","pow(flowmap, vec2(1.0/2.2))")).replace(/\(flowmap\/2\)/g,"(flowmap/2.0)")}},{key:"_initializeVAO",value:function(e,t){var n=this.context,r=e.presentation.geometry,o=(e.geometry,r._createVertexBuffer(n,e)),i=n.getAttribLocation(t,"position"),a=n.getAttribLocation(t,"normal"),u=n.getAttribLocation(t,"tangent"),s=n.getAttribLocation(t,"color"),l=n.getAttribLocation(t,"texcoord0"),c=n.getAttribLocation(t,"texcoord1"),f=n.getAttribLocation(t,"boneIndices"),h=n.getAttribLocation(t,"boneWeights");r._vertexArrayObjects=[];for(var y=e.presentation.geometry.geometryElements.length,p=0;p<y;p++){var m=e.presentation.geometry.geometryElements[p],d=(e.presentation.geometry.materials[p],n.createVertexArray());n.bindVertexArray(d),n.bindBuffer(n.ARRAY_BUFFER,o),n.bindAttribLocation(t,i,"position"),n.bindAttribLocation(t,a,"normal"),n.bindAttribLocation(t,u,"tangent"),n.bindAttribLocation(t,s,"color"),n.bindAttribLocation(t,l,"texcoord0"),n.bindAttribLocation(t,c,"texcoord1"),n.bindAttribLocation(t,f,"boneIndices"),n.bindAttribLocation(t,h,"boneWeights");var _=r.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0];_?(n.enableVertexAttribArray(i),n.vertexAttribPointer(i,_.componentsPerVector,n.FLOAT,!1,_.dataStride,_.dataOffset)):n.disableVertexAttribArray(i);var g=r.getGeometrySourcesForSemantic(tt.a.Semantic.normal)[0];g?(n.enableVertexAttribArray(a),n.vertexAttribPointer(a,g.componentsPerVector,n.FLOAT,!1,g.dataStride,g.dataOffset)):n.disableVertexAttribArray(a);var v=r.getGeometrySourcesForSemantic(tt.a.Semantic.tangent)[0];v?(n.enableVertexAttribArray(u),n.vertexAttribPointer(u,v.componentsPerVector,n.FLOAT,!1,v.dataStride,v.dataOffset)):n.disableVertexAttribArray(u);var b=r.getGeometrySourcesForSemantic(tt.a.Semantic.color)[0];b?(n.enableVertexAttribArray(s),n.vertexAttribPointer(s,b.componentsPerVector,n.FLOAT,!1,b.dataStride,b.dataOffset)):n.disableVertexAttribArray(s);var S=r.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[0];S?(n.enableVertexAttribArray(l),n.vertexAttribPointer(l,S.componentsPerVector,n.FLOAT,!1,S.dataStride,S.dataOffset)):n.disableVertexAttribArray(l);var w=r.getGeometrySourcesForSemantic(tt.a.Semantic.texcoord)[1];w?(n.enableVertexAttribArray(c),n.vertexAttribPointer(c,w.componentsPerVector,n.FLOAT,!1,w.dataStride,w.dataOffset)):n.disableVertexAttribArray(c);var T=e.skinner&&e.skinner._useGPU?e.skinner._boneIndices:null;T?(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,T.componentsPerVector,n.FLOAT,!1,T.dataStride,T.dataOffset)):n.disableVertexAttribArray(f);var k=e.skinner&&e.skinner._useGPU?e.skinner._boneWeights:null;k?(n.enableVertexAttribArray(h),n.vertexAttribPointer(h,k.componentsPerVector,n.FLOAT,!1,k.dataStride,k.dataOffset)):n.disableVertexAttribArray(h),n.disable(n.CULL_FACE);var O=m._createBuffer(n);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,O),r._vertexArrayObjects.push(d)}}},{key:"_initializeShadowVAO",value:function(e,t){var n=this.context,r=e.presentation.geometry,o=(e.geometry,r._createVertexBuffer(n,e)),i=n.getAttribLocation(t,"position"),a=n.getAttribLocation(t,"boneIndices"),u=n.getAttribLocation(t,"boneWeights");r._shadowVAO=[];for(var s=e.presentation.geometry.geometryElements.length,l=0;l<s;l++){var c=e.presentation.geometry.geometryElements[l],f=(e.presentation.geometry.materials[l],n.createVertexArray());n.bindVertexArray(f),n.bindBuffer(n.ARRAY_BUFFER,o),n.bindAttribLocation(t,i,"position"),n.bindAttribLocation(t,a,"boneIndices"),n.bindAttribLocation(t,u,"boneWeights");var h=r.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0];h?(n.enableVertexAttribArray(i),n.vertexAttribPointer(i,h.componentsPerVector,n.FLOAT,!1,h.dataStride,h.dataOffset)):n.disableVertexAttribArray(i);var y=e.skinner&&e.skinner._useGPU?e.skinner._boneIndices:null;y?(n.enableVertexAttribArray(a),n.vertexAttribPointer(a,y.componentsPerVector,n.FLOAT,!1,y.dataStride,y.dataOffset)):n.disableVertexAttribArray(a);var p=e.skinner&&e.skinner._useGPU?e.skinner._boneWeights:null;p?(n.enableVertexAttribArray(u),n.vertexAttribPointer(u,p.componentsPerVector,n.FLOAT,!1,p.dataStride,p.dataOffset)):n.disableVertexAttribArray(u),n.disable(n.CULL_FACE);var m=c._createBuffer(n);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,m),r._shadowVAO.push(f)}}},{key:"_initializeHitTestVAO",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.context,o=n?e.physicsBody.physicsShape._sourceGeometry:e.presentation.geometry,i=(n||e.geometry,r.getAttribLocation(t,"position")),a=r.getAttribLocation(t,"normal"),u=r.getAttribLocation(t,"boneIndices"),s=r.getAttribLocation(t,"boneWeights");o._hitTestVAO=[];for(var l=o.geometryElements.length,c=0;c<l;c++){var f=o.geometryElements[c],h=r.createVertexArray();r.bindVertexArray(h),r.bindBuffer(r.ARRAY_BUFFER,o._vertexBuffer),r.bindAttribLocation(t,i,"position"),r.bindAttribLocation(t,a,"normal"),r.bindAttribLocation(t,u,"boneIndices"),r.bindAttribLocation(t,s,"boneWeights");var y=o.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0];y?(r.enableVertexAttribArray(i),r.vertexAttribPointer(i,y.componentsPerVector,r.FLOAT,!1,y.dataStride,y.dataOffset)):r.disableVertexAttribArray(i);var p=o.getGeometrySourcesForSemantic(tt.a.Semantic.normal)[0];p?(r.enableVertexAttribArray(a),r.vertexAttribPointer(a,p.componentsPerVector,r.FLOAT,!1,p.dataStride,p.dataOffset)):r.disableVertexAttribArray(a);var m=e.skinner?e.skinner._boneIndices:null;m?(r.enableVertexAttribArray(u),r.vertexAttribPointer(u,m.componentsPerVector,r.FLOAT,!1,m.dataStride,m.dataOffset)):r.disableVertexAttribArray(u);var d=e.skinner?e.skinner._boneWeights:null;d?(r.enableVertexAttribArray(s),r.vertexAttribPointer(s,d.componentsPerVector,r.FLOAT,!1,d.dataStride,d.dataOffset)):r.disableVertexAttribArray(s);f._createBuffer(r);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f._buffer),o._hitTestVAO.push(h)}}},{key:"_initializeCameraBuffer",value:function(e){var t=this.context,n=t.getUniformBlockIndex(e,"cameraUniform");this._cameraBuffer=t.createBuffer(),t.uniformBlockBinding(e,n,0),t.bindBufferBase(t.UNIFORM_BUFFER,0,this._cameraBuffer)}},{key:"_initializeFogBuffer",value:function(e){var t=this.context,n=t.getUniformBlockIndex(e,"fogUniform");this._fogBuffer=t.createBuffer(),t.uniformBlockBinding(e,n,4),t.bindBufferBase(t.UNIFORM_BUFFER,4,this._fogBuffer)}},{key:"_initializeLightBuffer",value:function(e){var t=this.context,n=t.getUniformBlockIndex(e,"lightUniform");this._lightBuffer=t.createBuffer(),t.uniformBlockBinding(e,n,2),t.bindBufferBase(t.UNIFORM_BUFFER,2,this._lightBuffer);var r=t.getUniformBlockIndex(e,"SCNLightsUniform");this._scnLightsBuffer=t.createBuffer(),t.uniformBlockBinding(e,r,3),t.bindBufferBase(t.UNIFORM_BUFFER,3,this._scnLightsBuffer);for(var o=0;o<this._lightNodes.directionalShadow.length;o++){var i=this._lightNodes.directionalShadow[o],a="TEXTURE".concat(o+8),u="u_shadowTexture".concat(o);t.uniform1i(t.getUniformLocation(e,u),o+8),t.activeTexture(t[a]),t.bindTexture(t.TEXTURE_2D,i.presentation.light._shadowDepthTexture)}}},{key:"_initializeUBO",value:function(e,t){var n=this.context,r=e.presentation.geometry,o=n.getUniformBlockIndex(t,"materialUniform");r._materialBuffer=n.createBuffer(),n.uniformBlockBinding(t,o,1),n.bindBufferBase(n.UNIFORM_BUFFER,1,r._materialBuffer)}},{key:"_updateVAO",value:function(e){var t=this.context,n=e.presentation.geometry,r=e.geometry;n._updateVertexBuffer(t,r)}},{key:"_createDummyTexture",value:function(){var e=this.context,t=document.createElement("canvas");t.width=1,t.height=1;var n=t.getContext("2d");n.fillStyle="rgba(255, 255, 255, 1.0)",n.fillRect(0,0,1,1),this.__dummyTexture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.__dummyTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null)}},{key:"_switchToDefaultCamera",value:function(){if(null===this._pointOfView)this._defaultCameraPosNode.position=new ue.a(0,0,0),this._defaultCameraRotNode.rotation=new se.a(0,0,0,0),this._defaultCameraNode.position=new ue.a(0,0,mu);else if(this._pointOfView!==this._defaultCameraNode){var e=this.pointOfView.presentation._worldRotation,t=It.a.matrixWithRotation(e),n=this.pointOfView.presentation._worldTranslation;this._defaultCameraPosNode.position=new ue.a(0,0,-mu).rotate(t).add(n),this._defaultCameraRotNode.rotation=e,this._defaultCameraNode.position=new ue.a(0,0,mu)}this._pointOfView=this._defaultCameraNode}},{key:"_setDefaultCameraOrientation",value:function(e){this._defaultCameraRotNode.orientation=e}},{key:"_searchCameraNode",value:function(){for(var e=[this.scene._rootNode],t=e.shift();t;){if(null!==t.camera)return t;e.push.apply(e,cu(t._childNodes)),t=e.shift()}return null}},{key:"_getCameraPosition",value:function(){if(this._pointOfView===this._defaultCameraNode)return this._defaultCameraPosNode.position;if(null===this._pointOfView)return new ue.a(0,0,0);var e=this._getCameraOrientation(),t=It.a.matrixWithRotation(e);return this._pointOfView.presentation._worldTranslation.add(new ue.a(0,0,-mu).rotate(t))}},{key:"_getCameraOrientation",value:function(){return this._pointOfView===this._defaultCameraNode?this._defaultCameraRotNode.presentation.orientation:null===this._pointOfView?new se.a(0,0,0,0):this._pointOfView.presentation._worldOrientation}},{key:"_getCameraDistance",value:function(){return this._pointOfView===this._defaultCameraNode?this._defaultCameraNode.presentation.position.z:mu}},{key:"_numLightsChanged",value:function(){var e=!1,t=[].concat(cu(Object.values(Fa.LightType)),["directionalShadow"]),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value,s=this._lightNodes[u].length;s!==this._numLights[u]&&(e=!0,this._numLights[u]=s)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return e}},{key:"_nodeHitTestByCPU",value:function(e,t,n){var r=[],o=e.presentation.geometry,i=o.geometryElements.length;if(0===i)return r;var a=n.mul(-1),u=o.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],s=u.vectorCount,l=[],c=e.presentation._worldTransform,f=[];if(e.presentation.skinner){for(var h=e.presentation.skinner,y=h._bones.length,p=0;p<y;p++){var m=h._bones[p],d=h._boneInverseBindTransforms[p].mult(m._presentation._worldTransform);f.push(d)}for(var _=0;_<s;_++){for(var g=h._boneWeights._vectorAt(_),v=h._boneIndices._vectorAt(_),b=new It.a,S=0;S<h.numSkinningJoints;S++)b.add(f[v[S]].mul(g[S]));l.push(u._scnVectorAt(_).transform(b))}}else for(var w=0;w<s;w++)l.push(u._scnVectorAt(w).transform(c));for(var T=0;T<i;T++){var k=o.geometryElements[T];switch(k.primitiveType){case er.a.line:console.warn("hitTest for line is not implemented");continue;case er.a.point:console.warn("hitTest for point is not implemented");continue}k._glData;for(var O=k.primitiveCount,C=0;C<O;C++){var x=k._indexAt(C),E=l[x[0]],P=l[x[1]],A=l[x[2]],N=P.sub(E),R=A.sub(E),F=this._det(N,R,a);if(!(F<=0)){F=1/F;var D=t.sub(E),I=this._det(D,R,a)*F;if(!(I<0||I>1)){var M=this._det(N,D,a)*F;if(!(M<0||M>1)){var j=this._det(N,R,D)*F;if(!(j<0)){var B=t.add(n.mul(j)),L=c.invert(),U=new wr;U._node=e,U._geometryIndex=T,U._faceIndex=C,U._worldCoordinates=B,U._localCoordinates=B.transform(L);var V=N.cross(R);U._worldNormal=V.normalize(),U._localNormal=V.transform(L),U._modelTransform=c,U._boneNode=null,r.push(U)}}}}}}return r}},{key:"_setDummyParticleTextureAsDefault",value:function(){for(var e=this.context,t=this._defaultParticleProgram._getGLProgramForContext(e),n=[e.TEXTURE0],r=["particleTexture"],o=0;o<n.length;o++){var i=n[o],a=r[o];e.uniform1i(e.getUniformLocation(t,a),o),e.activeTexture(i),e.bindTexture(e.TEXTURE_2D,this.__dummyTexture)}}},{key:"_showShadowMapOfLight",value:function(e){var t=this.context,n=e.presentation.light;if(!this.__debugShadowMapSprite){var r=new nu;r.size=new a.a(100,100),r.anchorPoint=new c.a(0,0);var o=new Za;o._glTexture=n._shadowDepthTexture,o._image={naturalWidth:100,naturalHeight:100},r._texture=o,r.__presentation=r.copy(),r.__presentation._isPresentationInstance=!0,r.position=new c.a(100,100),r._updateWorldTransform(),this.__debugShadowMapSprite=r}t.clearDepth(-1),t.clearStencil(0),t.depthMask(!0),t.enable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.depthFunc(t.GEQUAL),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clear(t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._renderSKNode(this.__debugShadowMapSprite)}},{key:"_setViewPort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==e&&null!==t||(e=this._viewRect.size.width,t=this._viewRect.size.height),this.context.viewport(0,0,e,t)}},{key:"_det",value:function(e,t,n){return e.x*t.y*n.z+e.y*t.z*n.x+e.z*t.x*n.y-e.x*t.z*n.y-e.y*t.x*n.z-e.z*t.y*n.x}},{key:"nextFrameTime",get:function(){return this._nextFrameTime}},{key:"pointOfView",get:function(){return this._getCameraNode()},set:function(e){this._pointOfView=e}},{key:"renderingAPI",get:function(){return this._renderingAPI}},{key:"currentRenderCommandEncoder",get:function(){return this._currentRenderCommandEncoder}},{key:"device",get:function(){return this._device}},{key:"commandQueue",get:function(){return this._commandQueue}},{key:"colorPixelFormat",get:function(){return this._colorPixelFormat}},{key:"depthPixelFormat",get:function(){return this._depthPixelFormat}},{key:"stencilPixelFormat",get:function(){return this._stencilPixelFormat}},{key:"context",get:function(){return this._context}},{key:"audioEnvironmentNode",get:function(){return this._audioEnvironmentNode}},{key:"audioEngine",get:function(){return this._audioEngine}},{key:"_defaultProgram",get:function(){var e=this._numLightsChanged();if(null!==this.__defaultProgram&&!e)return this.__defaultProgram;var t=this.context;null===this.__defaultProgram&&(this.__defaultProgram=new Oa);var n=this.__defaultProgram,r=n._getGLProgramForContext(t),o=this._defaultVertexShader,i=this._defaultFragmentShader,a=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(a,o),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS)){var u=t.getShaderInfoLog(a);throw new Error("vertex shader compile error: ".concat(u))}this.__defaultProgram._glVertexShader=a;var s=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(s,i),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS)){var l=t.getShaderInfoLog(s);throw new Error("fragment shader compile error: ".concat(l))}if(this.__defaultProgram._glFragmentShader=s,t.attachShader(r,a),t.attachShader(r,s),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS)){var c=t.getProgramInfoLog(r);throw new Error("program link error: ".concat(c))}return this._switchProgram(n),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.enable(t.CULL_FACE),t.cullFace(t.BACK),this.__defaultProgram}},{key:"_defaultPBRProgram",get:function(){var e=this._numLightsChanged();if(null!==this.__defaultPBRProgram&&!e)return this.__defaultPBRProgram;var t=this.context;null===this.__defaultPBRProgram&&(this.__defaultPBRProgram=new Oa);var n=this.__defaultPBRProgram,r=n._getGLProgramForContext(t),o=this._defaultVertexShader,i=this._defaultPBRFragmentShader,a=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(a,o),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS)){var u=t.getShaderInfoLog(a);throw new Error("vertex shader compile error: ".concat(u))}this.__defaultPBRProgram._glVertexShader=a;var s=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(s,i),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS)){var l=t.getShaderInfoLog(s);throw new Error("fragment shader compile error: ".concat(l))}if(this.__defaultPBRProgram._glFragmentShader=s,t.attachShader(r,a),t.attachShader(r,s),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS)){var c=t.getProgramInfoLog(r);throw new Error("program link error: ".concat(c))}return this._switchProgram(n),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.enable(t.CULL_FACE),t.cullFace(t.BACK),this.__defaultPBRProgram}},{key:"_defaultVertexShader",get:function(){return this._replaceTexts(ri)}},{key:"_defaultFragmentShader",get:function(){return this._replaceTexts(ru)}},{key:"_defaultPBRFragmentShader",get:function(){return this._replaceTexts(ou)}},{key:"_dummyTexture",get:function(){return this.__dummyTexture}},{key:"_defaultParticleProgram",get:function(){if(null!==this.__defaultParticleProgram)return this.__defaultParticleProgram;var e=this.context;null===this.__defaultParticleProgram&&(this.__defaultParticleProgram=new Oa);var t=this.__defaultParticleProgram,n=t._getGLProgramForContext(e),r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,"#version 300 es\n  precision mediump float;\n\n  uniform mat4 modelTransform;\n  uniform mat4 viewTransform;\n  uniform mat4 projectionTransform;\n  uniform int orientationMode;\n  uniform float stretchFactor;\n\n  in vec3 position;\n  in vec3 velocity;\n  in vec4 rotation;\n  in vec4 color;\n  in float size;\n  //in float life;\n  in vec2 corner;\n  in vec2 texcoord;\n\n  out vec2 v_texcoord;\n  out vec4 v_color;\n\n  void main() {\n    vec4 pos = viewTransform * vec4(position, 1.0);\n    vec3 d;\n\n    if(stretchFactor > 0.0){\n      vec4 v = viewTransform * vec4(velocity, 0.0) * stretchFactor;\n      if(corner.y > 0.0){\n        pos.xyz += v.xyz;\n      }\n      vec2 cy = normalize(v.xy);\n      vec2 cx = vec2(-cy.y, cy.x);\n      d = vec3(cx * corner.x + cy * corner.y, 0) * size;\n    }else{\n      float sinAngle = sin(rotation.w);\n      float cosAngle = cos(rotation.w);\n      float tcos = 1.0 - cosAngle;\n\n      d = vec3(\n          corner.x * (rotation.x * rotation.x * tcos + cosAngle)\n        + corner.y * (rotation.x * rotation.y * tcos - rotation.z * sinAngle),\n          corner.x * (rotation.y * rotation.x * tcos + rotation.z * sinAngle)\n        + corner.y * (rotation.y * rotation.y * tcos + cosAngle),\n          corner.x * (rotation.z * rotation.x * tcos - rotation.y * sinAngle)\n        + corner.y * (rotation.z * rotation.y * tcos + rotation.x * sinAngle)) * size;\n      if(orientationMode == 2){\n        // orientation: free\n        d = mat3(viewTransform) * mat3(modelTransform) * d;\n      }\n    }\n    pos.xyz += d;\n\n    v_color = color;\n    v_texcoord = texcoord;\n    gl_Position = projectionTransform * pos;\n  }\n"),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(r);throw new Error("particle vertex shader compile error: ".concat(o))}var i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,"#version 300 es\n  precision mediump float;\n\n  uniform sampler2D particleTexture;\n\n  in vec2 v_texcoord;\n  in vec4 v_color;\n\n  out vec4 outColor;\n\n  void main() {\n    vec4 texColor = texture(particleTexture, v_texcoord);\n    if(texColor.a <= 0.0){\n      // avoid overwriting the depth buffer\n      discard;\n    }\n\n    texColor.rgb *= texColor.a;\n    outColor = v_color * texColor;\n  }\n"),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(i);throw new Error("particle fragment shader compile error: ".concat(a))}if(e.attachShader(n,r),e.attachShader(n,i),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var u=e.getProgramInfoLog(n);throw new Error("program link error: ".concat(u))}return this._useProgram(t),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.enable(e.CULL_FACE),e.cullFace(e.BACK),this._setDummyParticleTextureAsDefault(),this.__defaultParticleProgram}},{key:"_defaultShadowProgram",get:function(){if(null!==this.__defaultShadowProgram)return this.__defaultShadowProgram;var e=this.context;null===this.__defaultShadowProgram&&(this.__defaultShadowProgram=new Oa);var t=this.__defaultShadowProgram,n=t._getGLProgramForContext(e),r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,"#version 300 es\n  precision mediump float;\n\n  uniform mat4 viewProjectionTransform;\n  uniform vec4[765] skinningJoints;\n  uniform int numSkinningJoints;\n\n  in vec3 position;\n  //in vec3 normal;\n  in vec4 boneIndices;\n  in vec4 boneWeights;\n\n  out vec3 v_position;\n\n  void main() {\n    vec3 pos = vec3(0, 0, 0);\n    if(numSkinningJoints > 0){\n      for(int i=0; i<numSkinningJoints; i++){\n        float weight = boneWeights[i];\n        if(int(boneIndices[i]) < 0){\n          continue;\n        }\n        int idx = int(boneIndices[i]) * 3;\n        mat4 jointMatrix = transpose(mat4(skinningJoints[idx],\n                                          skinningJoints[idx+1],\n                                          skinningJoints[idx+2],\n                                          vec4(0, 0, 0, 1)));\n        pos += (jointMatrix * vec4(position, 1.0)).xyz * weight;\n      }\n    }else{\n      mat4 jointMatrix = transpose(mat4(skinningJoints[0],\n                                        skinningJoints[1],\n                                        skinningJoints[2],\n                                        vec4(0, 0, 0, 1)));\n      pos = (jointMatrix * vec4(position, 1.0)).xyz;\n    }\n    //v_position = pos;\n\n    gl_Position = viewProjectionTransform * vec4(pos, 1.0);\n    v_position = gl_Position.xyz / gl_Position.w;\n  }\n"),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(r);throw new Error("particle vertex shader compile error: ".concat(o))}var i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,"#version 300 es\n  precision mediump float;\n\n  in vec3 v_position;\n\n  layout(location = 0) out vec4 out_depth;\n  //layout(location = 0) out float out_depth;\n\n  void main() {\n    float r = (v_position.z + 1.0) * 0.5;\n    float g = fract(r * 255.0);\n    float b = fract(g * 255.0);\n    float a = fract(b * 255.0);\n    float coef = 1.0 / 255.0;\n\n    r -= g * coef;\n    g -= b * coef;\n    b -= a * coef;\n    out_depth = vec4(r, g, b, a);\n    //out_depth = v_position.z;\n  }\n"),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(i);throw new Error("particle fragment shader compile error: ".concat(a))}if(e.attachShader(n,r),e.attachShader(n,i),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var u=e.getProgramInfoLog(n);throw new Error("program link error: ".concat(u))}return this._useProgram(t),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.disable(e.BLEND),e.enable(e.CULL_FACE),e.cullFace(e.BACK),this.__defaultShadowProgram}},{key:"_defaultHitTestProgram",get:function(){if(null!==this.__defaultHitTestProgram)return this.__defaultHitTestProgram;var e=this.context;null===this.__defaultHitTestProgram&&(this.__defaultHitTestProgram=new Oa);var t=this.__defaultHitTestProgram,n=t._getGLProgramForContext(e),r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,"#version 300 es\n  precision mediump float;\n\n  uniform mat4 viewProjectionTransform;\n  uniform vec4[765] skinningJoints;\n  uniform int numSkinningJoints;\n\n  in vec3 position;\n  in vec3 normal;\n  in vec4 boneIndices;\n  in vec4 boneWeights;\n  \n  out vec3 v_normal;\n  out vec3 v_position;\n\n  void main() {\n    vec3 pos = vec3(0, 0, 0);\n    vec3 nom = vec3(0, 0, 0);\n    if(numSkinningJoints > 0){\n      for(int i=0; i<numSkinningJoints; i++){\n        float weight = boneWeights[i];\n        if(int(boneIndices[i]) < 0){\n          continue;\n        }\n        int idx = int(boneIndices[i]) * 3;\n        mat4 jointMatrix = transpose(mat4(skinningJoints[idx],\n                                          skinningJoints[idx+1],\n                                          skinningJoints[idx+2],\n                                          vec4(0, 0, 0, 1)));\n        pos += (jointMatrix * vec4(position, 1.0)).xyz * weight;\n        nom += (mat3(jointMatrix) * normal) * weight;\n      }\n    }else{\n      mat4 jointMatrix = transpose(mat4(skinningJoints[0],\n                                        skinningJoints[1],\n                                        skinningJoints[2],\n                                        vec4(0, 0, 0, 1)));\n      pos = (jointMatrix * vec4(position, 1.0)).xyz;\n      nom = mat3(jointMatrix) * normal;\n    }\n    //v_position = pos;\n    v_normal = nom;\n\n    gl_Position = viewProjectionTransform * vec4(pos, 1.0);\n    v_position = gl_Position.xyz / gl_Position.w;\n  }\n"),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(r);throw new Error("hitTest vertex shader compile error: ".concat(o))}var i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,"#version 300 es\n  precision mediump float;\n\n  uniform int objectID;\n  uniform int geometryID;\n\n  in vec3 v_normal;\n  in vec3 v_position;\n\n  layout(location = 0) out vec4 out_objectID;\n  layout(location = 1) out vec4 out_faceID;\n  layout(location = 2) out vec4 out_position;\n  layout(location = 3) out vec4 out_normal;\n\n  void main() {\n    out_objectID = vec4(\n      float(objectID >> 8) / 255.0,\n      float(objectID & 0xFF) / 255.0,\n      float(geometryID >> 8) / 255.0,\n      float(geometryID & 0xFF) / 255.0\n    );\n    //out_faceID = vec4(\n    //  (gl_PrimitiveID >> 24) / 255.0,\n    //  ((gl_PrimitiveID >> 16) & 0xFF) / 255.0,\n    //  ((gl_PrimitiveID >> 8) & 0xFF) / 255.0,\n    //  (gl_PrimitiveID & 0xFF) / 255.0\n    //);\n    out_faceID = vec4(0, 0, 0, 0); // TODO: implement\n    vec3 n = normalize(v_normal);\n    out_normal = vec4((n.x + 1.0) * 0.5, (n.y + 1.0) * 0.5, (n.z + 1.0) * 0.5, 0);\n    //out_position = vec4((v_position.x + 1.0) * 0.5, (v_position.y + 1.0) * 0.5, (v_position.z + 1.0) * 0.5, 0);\n    float r = (v_position.z + 1.0) * 0.5;\n    float g = fract(r * 255.0);\n    float b = fract(g * 255.0);\n    float a = fract(b * 255.0);\n    float coef = 1.0 / 255.0;\n\n    r -= g * coef;\n    g -= b * coef;\n    b -= a * coef;\n    out_position = vec4(r, g, b, a);\n  }\n"),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(i);throw new Error("hitTest fragment shader compile error: ".concat(a))}if(e.attachShader(n,r),e.attachShader(n,i),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var u=e.getProgramInfoLog(n);throw new Error("program link error: ".concat(u))}return this._useProgram(t),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.enable(e.CULL_FACE),e.cullFace(e.BACK),this.__defaultHitTestProgram}}])&&fu(n.prototype,r),o&&fu(n,o),t}();function _u(e){return(_u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gu(e,t){return!t||"object"!==_u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vu(e){return(vu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Su(e,t){return(Su=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wu=function(e){var t,n,r;function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=gu(this,vu(o).call(this))).animation=e,t.inputMode=null,t.inputBias=0,t.inputScale=0,t.inputOrigin=null,t.inputProperty=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Su(e,t)}(o,J["a"]),t=o,r=[{key:"_propTypes",get:function(){return{animation:["NSMutableDictionary",function(e,t){e.animation=po._loadAnimationData(t,null)}],inputMode:"integer",inputBias:"float",inputScale:"float",inputOrigin:"SCNNode"}}}],(n=null)&&bu(t.prototype,n),r&&bu(t,r),o}(),Tu=function e(t,n,r,o){return new e(t,n,r,o)};var ku=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.technique=null};function Ou(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Cu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"writeBytesCount",value:function(e,t){}}])&&Ou(t.prototype,n),r&&Ou(t,r),e}();function xu(e){return(xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eu(e,t){return!t||"object"!==xu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pu(e){return(Pu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Au(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nu(e,t){return(Nu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ru=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=Eu(this,Pu(o).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nu(e,t)}(o,Te),t=o,r=[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}],(n=null)&&Au(t.prototype,n),r&&Au(t,r),o}();function Fu(e){return(Fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Du(e,t){return!t||"object"!==Fu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Iu(e,t,n){return(Iu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mu(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Mu(e){return(Mu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ju(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bu(e,t,n){return t&&ju(e.prototype,t),n&&ju(e,n),e}function Lu(e,t){return(Lu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Uu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Du(this,Mu(t).call(this)))._rotX=0,e._rotY=0,e._rotZ=0,e._lastRotX=0,e._lastRotY=0,e._lastRotZ=0,e._axisRot=new se.a,e._isRelative=!1,e._isReversed=!1,e._isUnitArc=!1,e._isAxisAngle=!1,e._isRunning=!1,e._finished=!1,e._duration=0,e._pausedTime=0,e._timingMode=le.linear,e._beginTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lu(e,t)}(t,Te),Bu(t,null,[{key:"_propTypes",get:function(){return{_rotX:"float",_rotY:"float",_rotZ:"float",_lastRotX:"float",_lastRotY:"float",_lastRotZ:"float",_axisRot:"SCNVector4",_isRelative:"boolean",_isReversed:"boolean",_isUnitArc:"boolean",_isAxisAngle:"boolean",_isRunning:"boolean",_finished:"boolean",_duration:"float",_pausedTime:"float",_timingMode:"integer",_beginTime:"float",name:["string",null]}}}]),Bu(t,[{key:"copy",value:function(){var e=Iu(Mu(t.prototype),"copy",this).call(this);return e._rotX=this._rotX,e._rotY=this._rotY,e._rotZ=this._rotZ,e._lastRotX=this._lastRotX,e._lastRotY=this._lastRotY,e._lastRotZ=this._lastRotZ,e._axisRot=this._axisRot,e._isRelative=this._isRelative,e._isReveresed=this._isReversed,e._isUnitArc=this._isUnitArc,e._isAxisAngle=this._isAxisAngle,e._isRunning=this._isRunning,e._finished=this._finished,e._duration=this._duration,e._pausedTime=this._pausedTime,e._timingMode=this._timingMode,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!Object(w.a)(e,po))throw new Error("unsupported class for SCNActionRotate: ".concat(e.constructor.name));var r=this._getTime(t,n);if(this._isAxisAngle){var o=e.rotation,i=this._axisRot;if(this._isRelative){var a=o.rotationToQuat,u=this._axisRot.rotationToQuat;i=a.cross(u).quatToRotation}if(this._isUnitArc){var s=this._slerp(o.rotationToQuat(),i.rotationToQuat(),r);e.presentation.orientation=s}else{var l=this._lerp(o,i,r);e.presentation.rotation=l}this._finished&&(e.rotation=i)}else{var c=new ue.a(this._rotX,this._rotY,this._rotZ),f=null;if(this._isRelative)f=e.orientation.cross(c.mul(r).eulerAnglesToQuat()),e.presentation.orientation=f;else if(this._isUnitArc){var h=e.orientation;f=this._slerp(h,c.eulerAnglesToQuat(),r),e.presentation.orientation=f}else{var y=e.eulerAngles;f=this._lerp(y,c,r),e.presentation.eulerAngles=f}this._finished&&(this._isRelative?(c=e.orientation.cross(c.eulerAnglesToQuat()),e.orientation=c):e.eulerAngles=c)}}}],[{key:"rotateByXYZ",value:function(e,n,r,o){var i=new t;return i._rotX=-e,i._rotY=-n,i._rotZ=r,i._duration=o,i._isRelative=!0,i}},{key:"rotateToXYZ",value:function(e,n,r,o){var i=new t;return i._rotX=e,i._rotY=n,i._rotZ=r,i._duration=o,i}},{key:"rotateToXYZUsesShortestUnitArc",value:function(e,n,r,o,i){var a=new t;return a._rotX=e,a._rotY=n,a._rotZ=r,a._duration=o,a._isUnitArc=i,a}},{key:"rotateByAround",value:function(e,n,r){var o=new t;return o._axisRot.w=e,o._axisRot.x=n.x,o._axisRot.y=n.y,o._axisRot.z=n.z,o._duration=r,o._isRelative=!0,o._isAxisAngle=!0,o}},{key:"rotateToAxisAngle",value:function(e,n){var r=new t;return r._axisRot=e,r._duration=n,r._isAxisAngle=!0,r}}]),t}();function Vu(e){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zu(e,t){return!t||"object"!==Vu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gu(e){return(Gu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xu(e,t,n){return t&&Yu(e.prototype,t),n&&Yu(e,n),e}function Hu(e,t){return(Hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Te.rotateByXYZ=Uu.rotateByXYZ,Te.rotateToXYZ=Uu.rotateToXYZ,Te.rotateToXYZUsesShortestUnitArc=Uu.rotateToXYZUsesShortestUnitArc,Te.rotateByAround=Uu.rotateByAround,Te.rotateToAxisAngle=Uu.rotateToAxisAngle;var Wu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=zu(this,Gu(t).call(this,[],[]))).width=n,e.height=r,e.widthSegmentCount=1,e.heightSegmentCount=1,e.cornerRadius=0,e.cornerSegmentCount=10,e._createGeometry(),e.materials.push(new Gn),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hu(e,t)}(t,Qn),Xu(t,null,[{key:"_propTypes",get:function(){return{width:"float",height:"float",widthSegmentCount:"integer",heightSegmentCount:"integer",cornerRadius:"float",cornerSegmentCount:"integer",materials:"NSArray",tessellator:"SCNGeometryTessellator",wantsAdaptiveSubdivision:"boolean",name:"string",primitiveType:["integer",null],subdivisionLevel:"integer",subdivisionSettings:["bytes",null]}}}]),Xu(t,[{key:"_createGeometry",value:function(){for(var e=[],t=[],n=(this.widthSegmentCount,0);n<=this.heightSegmentCount;n++)for(var r=n/this.heightSegmentCount,o=(-.5+r)*this.height,i=0;i<=this.widthSegmentCount;i++){var a=i/this.widthSegmentCount,u=(-.5+a)*this.width;e.push(u,o,0),e.push(0,0,1),e.push(a,1-r)}for(var s=this.widthSegmentCount*this.heightSegmentCount,l=0;l<s;l++){var c=4*l;t.push(c,c+1,c+3),t.push(c,c+3,c+2)}var f=(this.widthSegmentCount+1)*(this.heightSegmentCount+1),h=new tt.a(e,tt.a.Semantic.vertex,f,!0,3,4,0,32),y=new tt.a(e,tt.a.Semantic.normal,f,!0,3,4,12,32),p=new tt.a(e,tt.a.Semantic.texcoord,f,!0,2,4,24,32),m=new $n.a(t,er.a.triangles);this._geometryElements=[m],this._geometrySources=[h,y,p],this.boundingBox={min:new ue.a(-.5*this.width,-.5*this.height,0),max:new ue.a(.5*this.width,.5*this.height,0)}}}]),t}(),Ku=function(e){return new ue.a(e)};function Zu(e){return(Zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ju(e,t){return!t||"object"!==Zu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qu(e){return(Qu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $u(e,t){return($u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var es=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ju(this,Qu(t).call(this))).maximumDistance=0,e.minimumDistance=0,e.target=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$u(e,t)}(t,vt),n=t,o=[{key:"constraintWithTarget",value:function(e){return new t}}],(r=null)&&qu(n.prototype,r),o&&qu(n,o),t}(),ts=function(e,t,n,r){},ns=new ue.a(0,0,0);function rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var os=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"programHandleError",value:function(e,t){}},{key:"programIsOpaque",value:function(e){return!1}},{key:"programBindValueForSymbolAtLocation",value:function(e,t,n,r,o){return!1}},{key:"programUnbindValueForSymbolAtLocation",value:function(e,t,n,r,o){}}])&&rs(t.prototype,n),r&&rs(t,r),e}(),is={both:0,front:1,back:2},as=function(e){return[e.x,e.y,e.z,e.w]};function us(e){return(us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ss(e,t){return!t||"object"!==us(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ls(e,t,n){return(ls="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cs(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function cs(e){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hs(e,t,n){return t&&fs(e.prototype,t),n&&fs(e,n),e}function ys(e,t){return(ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ps=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ss(this,cs(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e._source=null,e._wait=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ys(e,t)}(t,Te),hs(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float",name:["string",null]}}}]),hs(t,[{key:"copy",value:function(){var e=ls(cs(t.prototype),"copy",this).call(this);return e._source=this._source,e._wait=this._wait,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._isRunning||(this._source._play(),this._isRunning=!0),(this._duration<=0||this._source._duration>0)&&(this._duration=this._source._duration);var r=this._getTime(t,n);this._wait?!this._source.loops&&r>=1?this._finished=!0:this._finished=!1:this._finished=!0}}],[{key:"playAudioWaitForCompletion",value:function(e,n){var r=new t;return r._source=e,r._wait=n,r}}]),t}();Te.playAudioWaitForCompletion=ps.playAudioWaitForCompletion;var ms=function(e,t,n,r){};function ds(e){return(ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _s(e,t){return!t||"object"!==ds(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gs(e,t,n){return(gs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vs(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vs(e){return(vs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ss(e,t,n){return t&&bs(e.prototype,t),n&&bs(e,n),e}function ws(e,t){return(ws=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ts=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_s(this,vs(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e._toValue=null,e._byValue=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ws(e,t)}(t,Te),Ss(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float",name:["string",null]}}}]),Ss(t,[{key:"copy",value:function(){var e=gs(vs(t.prototype),"copy",this).call(this);return e._toValue=this._toValue,e._byValue=this._byValue,e._duration=this._duration,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._getTime(t,n);if(!Object(w.a)(e,po))throw new Error("unsupported class for SCNActionFade: ".concat(e.constructor.name));var o=e._opacity,i=0;if(null!==this._toValue)i=this._toValue;else{if(null===this._byValue)throw new Error("both toValue and byValue are null");i=o+this._byValue}var a=this._lerp(o,i,r);e.presentation._opacity=a,this._finished&&(e._opacity=i)}}],[{key:"fadeInDuration",value:function(e){var n=new t;return n._toValue=1,n._duration=e,n}},{key:"fadeOutDuration",value:function(e){var n=new t;return n._toValue=0,n._duration=e,n}},{key:"fadeOpacityByDuration",value:function(e,n){var r=new t;return r._byValue=e,r._duration=n,r}},{key:"fadeOpacityToDuration",value:function(e,n){var r=new t;return r._toValue=e,r._duration=n,r}}]),t}();Te.fadeInDuration=Ts.fadeInDuration,Te.fadeOutDuration=Ts.fadeOutDuration,Te.fadeOpacityByDuration=Ts.fadeOpacityByDuration,Te.fadeOpacityToDuration=Ts.fadeOpacityToDuration;var ks={overLife:0,overDistance:1,overOtherProperty:2};function Os(e){return(Os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xs(e,t){return!t||"object"!==Os(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Es(e){return(Es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ps(e,t){return(Ps=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var As=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=xs(this,Es(t).call(this)))._numberOfInputs=0,e._numberOfOutputs=0,e._engine=null,e._lastRenderTime=null,e._auAudioUnit=null,e._latency=0,e._outputPresentationLatency=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ps(e,t)}(t,J["a"]),n=t,(r=[{key:"inputFormatForBus",value:function(e){return null}},{key:"nameForInputBus",value:function(e){return null}},{key:"outputFormatForBus",value:function(e){return null}},{key:"nameForOutputBus",value:function(e){return null}},{key:"installTapOnBusBlock",value:function(e,t,n,r){}},{key:"removeTapOnBus",value:function(e){}},{key:"reset",value:function(){}},{key:"numberOfInputs",get:function(){return this._numberOfInputs}},{key:"numberOfOutputs",get:function(){return this._numberOfOutputs}},{key:"engine",get:function(){return this._engine}},{key:"lastRenderTime",get:function(){return this._lastRenderTime}},{key:"auAudioUnit",get:function(){return this._auAudioUnit}},{key:"latency",get:function(){return this._latency}},{key:"outputPresentationLatency",get:function(){return this._outputPresentationLatency}}])&&Cs(n.prototype,r),o&&Cs(n,o),t}();function Ns(e){return(Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fs(e,t){return!t||"object"!==Ns(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ds(e){return(Ds=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Is(e,t){return(Is=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ms=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Fs(this,Ds(t).call(this)))._gainNode=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Is(e,t)}(t,As),n=t,(r=[{key:"volume",get:function(){return this._gainNode.gain.value},set:function(e){this._gainNode.gain.value=e}}])&&Rs(n.prototype,r),o&&Rs(n,o),t}();function js(e){return(js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ls(e,t){return!t||"object"!==js(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Us(e){return(Us=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vs(e,t){return(Vs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zs=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ls(this,Us(t).call(this)))._audioSource=e,n._audioNode=new Ms,n._audioNode._gainNode=e._gainNode,n.willStartPlayback=null,n.didFinishPlayback=null,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vs(e,t)}(t,J["a"]),n=t,(r=[{key:"initAvAudioNode",value:function(e){this._audioSource=null,this._audioNode=null,this.willStartPlayback=null,this.didFinishPlayback=null}},{key:"_play",value:function(){this._audioSource._play()}},{key:"_stop",value:function(){this._audioSource._stop()}},{key:"_getLoadedPromise",value:function(){return this._audioSource?this._audioSource._getLoadedPromise():Promise.resolve()}},{key:"audioSource",get:function(){return this._audioSource}},{key:"audioNode",get:function(){return this._audioNode}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}])&&Bs(n.prototype,r),o&&Bs(n,o),t}(),Gs=function(e,t,n){return new It.a(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1)},Ys=function(e,t,n,r,o){return e.rotation(n,r,o,t)},Xs={fragment:"SCNShaderModifierEntryPointFragment",geometry:"SCNShaderModifierEntryPointGeometry",lightingModel:"SCNShaderModifierEntryPointLightingModel",surface:"SCNShaderModifierEntryPointSurface"};function Hs(e){return(Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ks(e,t){return!t||"object"!==Hs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zs(e){return(Zs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qs(e,t){return(qs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Js=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ks(this,Zs(t).call(this))).halfExtent=null,e.scope=null,e.usesEllipsoidalExtent=!1,e.offset=null,e.direction=null,e.strength=0,e.falloffExponent=0,e.minimumDistance=0,e.isActive=!1,e.isExclusive=!1,e.categoryBitMask=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qs(e,t)}(t,J["a"]),n=t,o=[{key:"drag",value:function(){return null}},{key:"vortex",value:function(){return null}},{key:"radialGravity",value:function(){return null}},{key:"linearGravity",value:function(){return null}},{key:"noiseFieldAnimationSpeed",value:function(e,t){return null}},{key:"turbulenceFieldAnimationSpeed",value:function(e,t){return null}},{key:"spring",value:function(){return null}},{key:"electric",value:function(){return null}},{key:"magnetic",value:function(){return null}},{key:"customFieldEvaluationBlock",value:function(e){return null}}],(r=null)&&Ws(n.prototype,r),o&&Ws(n,o),t}();function Qs(e){return(Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $s(e,t){return!t||"object"!==Qs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function el(e){return(el=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tl(e,t){return(tl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nl=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$s(this,el(t).call(this)))._smoothness=0,e._animationSpeed=1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tl(e,t)}(t,Js),t}(),rl=function(e){return null},ol=function(e){return null},il=function(e){return null},al=function(e){return null},ul={none:0,multisampling2X:1,multisampling4X:2,multisampling8X:3,multisampling16X:4};function sl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ll=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.boundingBox=null,this._boundingSphere=null}var t,n,r;return t=e,(n=[{key:"boundingSphere",get:function(){return this._boundingSphere}}])&&sl(t.prototype,n),r&&sl(t,r),e}(),cl=function(e,t){return!!Object(w.a)(e,It.a)&&e.equalTo(t)},fl={none:0,phong:1,pnTriangles:2},hl=function(e){return e.invert()},yl={constant:0,surfaceNormal:1,random:2},pl=function(e,t,n){return new ue.a(e,t,n)};function ml(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var dl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this._default=null,this._static=null,this._all=null}},{key:"default",get:function(){return this._default}},{key:"static",get:function(){return this._static}},{key:"all",get:function(){return this._all}}])&&ml(t.prototype,n),r&&ml(t,r),e}(),_l={birth:0,death:1,collision:2};function gl(e){return(gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vl(e,t){return!t||"object"!==gl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bl(e){return(bl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wl(e,t){return(wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Tl=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=vl(this,bl(o).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wl(e,t)}(o,Te),t=o,r=[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}],(n=null)&&Sl(t.prototype,n),r&&Sl(t,r),o}();function kl(e){return(kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ol(e,t){return!t||"object"!==kl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cl(e,t,n){return(Cl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xl(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xl(e){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function El(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pl(e,t,n){return t&&El(e.prototype,t),n&&El(e,n),e}function Al(e,t){return(Al=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nl=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ol(this,xl(t).call(this)))._actions=[],e._finished=!1,e._animIndex=0,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Al(e,t)}(t,Te),Pl(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean","_mycaction->_animIndex":["integer","_animIndex"],_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float",name:["string",null]}}}]),Pl(t,[{key:"copy",value:function(){var e=Cl(xl(t.prototype),"copy",this).call(this);return e._actions=this._actions.slice(0),e._animIndex=this._animIndex,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.duration,o=0;o=r<=0||r===1/0?this._activetimeFromTime(t):this._getTime(t,n)*r;for(var i=0;i<this._animIndex;i++)o-=this._actions[i].duration/this._actions[i].speed;for(;this._animIndex<this._actions.length;this._animIndex++){var a=this._actions[this._animIndex];if(a._applyAction(e,o,!0),(o-=a.duration/a.speed)<0)break}this._animIndex>=this._actions.length&&(this._finished=!0)}},{key:"_resetFinished",value:function(){this._actions.forEach(function(e){e._resetFinished()}),this._finished=!1,this._animIndex=0}},{key:"duration",get:function(){var e=0;return this._actions.forEach(function(t){t.speed>0&&(e+=t.duration/t.speed)}),e}}],[{key:"sequence",value:function(e){var n=new t;return n._actions=e,n._duration=0,n}}]),t}();function Rl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Te.sequence=Nl.sequence;var Fl=function(){var e,t,n;function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._X=null,this._Y=null,this._Z=null,this._all=null}return e=r,(t=[{key:"X",get:function(){return this._X}},{key:"Y",get:function(){return this._Y}},{key:"Z",get:function(){return this._Z}},{key:"all",get:function(){return this._all}}])&&Rl(e.prototype,t),n&&Rl(e,n),r}();function Dl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Il=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(){this.program=null,this.shaderModifiers=null}},{key:"handleBindingOfSymbolHandler",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"handleUnbindingOfSymbolHandler",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}])&&Dl(t.prototype,n),r&&Dl(t,r),e}(),Ml=function(e){return null};function jl(e){return(jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bl(e,t){return!t||"object"!==jl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ll(e,t,n){return(Ll="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ul(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ul(e){return(Ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zl(e,t,n){return t&&Vl(e.prototype,t),n&&Vl(e,n),e}function Gl(e,t){return(Gl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yl=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Bl(this,Ul(t).call(this,[],[]))).radius=n,e.height=r,e.radialSegmentCount=48,e.heightSegmentCount=1,e._createGeometry(),e.materials.push(new Gn),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gl(e,t)}(t,Qn),zl(t,null,[{key:"_propTypes",get:function(){return{$constructor:function(e,n){var r=new t(n.cylinderradius,n.cylinderheight);return r.radialSegmentCount=n.cylinderradialSegmentCount,r.heightSegmentCount=n.cylinderheightSegmentCount,r.materials=n.materials,r.tessellator=n.tessellator,r.subdivisionLevel=n.subdivisionLevel,r},name:["string",null],cylinderradius:["float",null],cylinderheight:["float",null],cylinderradialSegmentCount:["integer",null],cylinderheightSegmentCount:["integer",null],cylinderradialSpan:["float",null],cylinderprimitiveType:["integer",null],materials:["NSArray",null],tessellator:["SCNGeometryTessellator",null],subdivisionLevel:["integer",null],subdivisionSettings:["bytes",null],wantsAdaptiveSubdivision:["boolean",null]}}}]),zl(t,[{key:"_createGeometry",value:function(){for(var e=[],t=.5*this.height,n=.5*-this.height,r=[],o=[],i=[],a=2*Math.PI/this.radialSegmentCount,u=1/this.radialSegmentCount,s=0;s<=this.radialSegmentCount;s++){var l=-Math.sin(a*s),c=-Math.cos(a*s),f=l*this.radius,h=c*this.radius;r.push(f,n,h),o.push(f,t,h),i.push(-f,n,h),r.push(l,0,c),o.push(0,1,0),i.push(0,-1,0);var y=u*s;r.push(y,1);var p=.5*(1+Math.cos(s*a)),m=.5*(1+Math.sin(s*a));o.push(p,m),i.push(p,m),r.push(f,t,h),o.push(0,t,0),i.push(0,n,0),r.push(l,0,c),o.push(0,1,0),i.push(0,-1,0),r.push(y,0),o.push(.5,.5),i.push(.5,.5)}e.push.apply(e,r.concat(o,i));for(var d=6*(this.radialSegmentCount+1),_=new tt.a(e,tt.a.Semantic.vertex,d,!0,3,4,0,32),g=new tt.a(e,tt.a.Semantic.normal,d,!0,3,4,12,32),v=new tt.a(e,tt.a.Semantic.texcoord,d,!0,2,4,24,32),b=[],S=[],w=[],T=[],k=2*(this.radialSegmentCount+1),O=4*(this.radialSegmentCount+1),C=0;C<this.radialSegmentCount;C++){var x=2*C;S.push(x,x+3,x+1),S.push(x,x+2,x+3);var E=k+x;w.push(E,E+2,E+3);var P=O+x;T.push(P,P+2,P+3)}b.push(new $n.a(S,er.a.triangles)),b.push(new $n.a(w,er.a.triangles)),b.push(new $n.a(T,er.a.triangles)),this._geometryElements=b,this._geometrySources=[_,g,v],this.boundingBox={min:new ue.a(-this.radius,n,-this.radius),max:new ue.a(this.radius,t,this.radius)}}},{key:"_updateBoundingBoxForSkinner",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this.boundingBox:Ll(Ul(t.prototype),"_updateBoundingBoxForSkinner",this).call(this,e)}}]),t}();function Xl(e){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wl(e,t){return!t||"object"!==Xl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kl(e){return(Kl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zl(e,t){return(Zl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ql=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Wl(this,Kl(t).call(this))).isGimbalLockEnabled=!1,e.target=null,e.localFront=null,e.targetOffset=null,e.worldUp=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zl(e,t)}(t,vt),n=t,o=[{key:"constraintWithTarget",value:function(e){return new t}}],(r=null)&&Hl(n.prototype,r),o&&Hl(n,o),t}();function Jl(e){return(Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ql(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $l(e,t){return!t||"object"!==Jl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ec(e){return(ec=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tc(e,t){return(tc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nc=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$l(this,ec(t).call(this,[],[]))).ringRadius=n,e.pipeRadius=r,e.ringSegmentCount=48,e.pipeSegmentCount=24,e._createGeometry(),e.materials.push(new Gn),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tc(e,t)}(t,Qn),n=t,(r=[{key:"_createGeometry",value:function(){for(var e=[],t=[],n=(this.ringSegmentCount+1)*(this.pipeSegmentCount+1),r=0;r<=this.ringSegmentCount;r++)for(var o=2*r*Math.PI/this.ringSegmentCount,i=Math.sin(o),a=Math.cos(o),u=-i*this.ringRadius,s=-a*this.ringRadius,l=r/this.ringSegmentCount,c=0;c<=this.pipeSegmentCount;c++){var f=2*c*Math.PI/this.pipeSegmentCount,h=Math.sin(f),y=Math.cos(f),p=u+this.pipeRadius*i*y,m=-this.pipeRadius*h,d=s+this.pipeRadius*a*y;e.push(p,m,d),e.push(i*y,-h,a*y);var _=1-c/this.pipeSegmentCount;e.push(l,_)}for(var g=new tt.a(e,tt.a.Semantic.vertex,n,!0,3,4,0,32),v=new tt.a(e,tt.a.Semantic.normal,n,!0,3,4,12,32),b=new tt.a(e,tt.a.Semantic.texcoord,n,!0,2,4,24,32),S=this.ringSegmentCount*this.pipeSegmentCount,w=0,T=0;T<S;T++){var k=w+this.pipeSegmentCount+1;t.push(w,k+1,w+1),t.push(w,k,k+1),w+=1,(T+1)%this.pipeSegmentCount==0&&(w+=1)}var O=new $n.a(t,er.a.triangles);this._geometryElements=[O],this._geometrySources=[g,v,b],this.boundingBox={min:new ue.a(-this.radius,-this.radius,-this.radius),max:new ue.a(this.radius,this.radius,this.radius)}}}])&&Ql(n.prototype,r),o&&Ql(n,o),t}();function rc(e){return(rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oc(e,t){return!t||"object"!==rc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ic(e){return(ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uc(e,t){return(uc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sc=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=oc(this,ic(o).call(this)))._owner=null,e._shaderModifiers=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uc(e,t)}(o,J["a"]),t=o,r=[{key:"_propTypes",get:function(){return{owner:["SCNGeometry","_owner"],shaderModifiers:["NSDictionary","_shaderModifiers"]}}}],(n=null)&&ac(t.prototype,n),r&&ac(t,r),o}();function lc(e){return(lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cc(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fc(e,t){return!t||"object"!==lc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hc(e){return(hc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pc(e,t,n){return t&&yc(e.prototype,t),n&&yc(e,n),e}function mc(e,t){return(mc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dc=function(e){function t(e,n,r,o,i){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=fc(this,hc(t).call(this));var u=n.length;if(r.length!==u)throw new Error("SCNSkinner: bones.length (".concat(u,") !== boneInverseBindTransforms.length (").concat(r.length,")"));if(o.componentsPerVector!==i.componentsPerVector)throw new Error("SCNSkinner: boneWeights.componentsPerVector (".concat(o.componentsPerVector,") !== boneIndices.componentsPerVector (").concat(o.componentsPerVector,")"));return a.baseGeometry=e,a.baseGeometryBindTransform=Object(Z.a)(0,0,0),a.skeleton=null,a._bones=n,a._boneInverseBindTransforms=r,a._boneWeights=o,a._boneIndices=i,a._useGPU=!0,a._checkUseGPU(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mc(e,t)}(t,J["a"]),pc(t,null,[{key:"_propTypes",get:function(){return{$constructor:function(e,n){for(var r=[],o=n.bones.length,i=0;i<o;i++){var a=n["baseGeometryBindTransform-".concat(i)];if(void 0===a)throw new Error("boneInverseBindTransforms ".concat(i," does not exist"));r.push(a)}var u=new t(n.baseGeometry,n.bones,r,n.boneWeights,n.boneIndices);return u.skeleton=n.skeleton,u.baseGeometryBindTransform=n.baseGeometryBindTransform,u},$unknownKey:function(e){var t=new RegExp(/^baseGeometryBindTransform-(\d+)$/);return null!==e.match(t)?["SCNMatrix4",null]:null},baseGeometry:["SCNGeometry",null],baseGeometryBindTransform:["SCNMatrix4",null],skeleton:["SCNNode",null],bones:["NSArray",null],boneWeights:["SCNGeometrySource",null],boneIndices:["SCNGeometrySource",null]}}}]),pc(t,[{key:"_checkUseGPU",value:function(){this._useGPU=!0,this._boneWeights&&this._boneWeights.componentsPerVector>4&&(this._useGPU=!1),this._boneIndices&&this._boneIndices.componentsPerVector>4&&(this._useGPU=!1)}},{key:"float32Array",value:function(){for(var e=[],t=this._bones.length,n=0;n<t;n++){var r=this._bones[n],o=this.baseGeometryBindTransform.mult(this._boneInverseBindTransforms[n]).mult(r.presentation._worldTransform);e.push.apply(e,cc(o.floatArray3x4f()))}return new Float32Array(e)}},{key:"_update",value:function(e){if(!this._useGPU){var t=e.presentation;if(null!==e.geometry&&null!==t&&null!==t.geometry){this.baseGeometryBindTransform,this._boneInverseBindTransforms;for(var n=this._bones.length,r=[],o=0;o<n;o++){var i=this._bones[o];r.push(this.baseGeometryBindTransform.mult(this._boneInverseBindTransforms[o]).mult(i.presentation._worldTransform))}var a=this.baseGeometry,u=a.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],s=a.getGeometrySourcesForSemantic(tt.a.Semantic.normal)[0],l=t.geometry,c=l.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],f=l.getGeometrySourcesForSemantic(tt.a.Semantic.normal)[0],h=this._boneWeights,y=this._boneIndices,p=h.vectorCount,m=h.componentsPerVector;if(s)for(var d=0;d<p;d++){for(var _=u._scnVectorAt(d),g=s._scnVectorAt(d),v=h._vectorAt(d),b=y._vectorAt(d),S=new ue.a(0,0,0),w=new ue.a(0,0,0),T=0;T<m;T++)if(!(b[T]<0)&&0!==v[T]){var k=r[b[T]];S=S.add(_.transform(k).mul(v[T])),w=w.add(g.rotate(k).mul(v[T]))}c._setVectorAt(S,d),f._setVectorAt(w,d)}}}}},{key:"bones",get:function(){return this._bones.slice(0)}},{key:"boneInverseBindTransforms",get:function(){return this._boneInverseBindTransforms.slice(0)}},{key:"boneWeights",get:function(){return this._boneWeights}},{key:"boneIndices",get:function(){return this._boneIndices}},{key:"numSkinningJoints",get:function(){return this._boneWeights.componentsPerVector}}]),t}();function _c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var gc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(){this._animationKeys=null}},{key:"addAnimationForKey",value:function(e,t){}},{key:"animationForKey",value:function(e){return null}},{key:"removeAllAnimations",value:function(){}},{key:"removeAnimationForKey",value:function(e){}},{key:"removeAnimationForKeyFadeOutDuration",value:function(e,t){}},{key:"pauseAnimationForKey",value:function(e){}},{key:"resumeAnimationForKey",value:function(e){}},{key:"isAnimationPausedForKey",value:function(e){return!1}},{key:"setAnimationSpeedForKey",value:function(e,t){}},{key:"animationKeys",get:function(){return this._animationKeys}}])&&_c(t.prototype,n),r&&_c(t,r),e}();function vc(e){return(vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bc(e,t){return!t||"object"!==vc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sc(e){return(Sc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wc(e,t){return(wc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Tc=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=bc(this,Sc(t).call(this))).edgeTessellationFactor=0,e.insideTessellationFactor=0,e.isAdaptive=!1,e.isScreenSpace=!1,e.maximumEdgeLength=0,e.smoothingMode=fl.none,e.tessellationFactorScale=0,e.tessellationPartitionMode=I.none,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wc(e,t)}(t,J["a"]),t}();function kc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Oc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"physicsWorldDidBegin",value:function(e,t){}},{key:"physicsWorldDidUpdate",value:function(e,t){}},{key:"physicsWorldDidEnd",value:function(e,t){}}])&&kc(t.prototype,n),r&&kc(t,r),e}(),Cc={insideExtent:0,outsideExtent:1};function xc(e){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ec(e,t){return!t||"object"!==xc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pc(e){return(Pc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ac(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nc(e,t){return(Nc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rc=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=Ec(this,Pc(o).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nc(e,t)}(o,Te),t=o,r=[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}],(n=null)&&Ac(t.prototype,n),r&&Ac(t,r),o}();function Fc(e){return(Fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dc(e,t){return!t||"object"!==Fc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ic(e){return(Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jc(e,t){return(jc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bc=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=Dc(this,Ic(o).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jc(e,t)}(o,Te),t=o,r=[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}],(n=null)&&Mc(t.prototype,n),r&&Mc(t,r),o}();function Lc(e){return(Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vc(e,t){return!t||"object"!==Lc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zc(e){return(zc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gc(e,t){return(Gc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yc=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Vc(this,zc(t).call(this)))._time=e,r._eventBlock=n,r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gc(e,t)}(t,J["a"]),n=t,o=[{key:"eventWithTimeEventBlock",value:function(e,n){return new t(e,n)}}],(r=null)&&Uc(n.prototype,r),o&&Uc(n,o),t}();function Xc(e){return(Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wc(e,t){return!t||"object"!==Xc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kc(e){return(Kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zc(e,t){return(Zc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qc=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wc(this,Kc(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zc(e,t)}(t,vt),n=t,o=[{key:"inverseKinematicsConstraint",value:function(e){return null}}],(r=[{key:"init",value:function(e){this._chainRootNode=null,this.targetPosition=null}},{key:"maxAllowedRotationAngleForJoint",value:function(e){return 0}},{key:"setMaxAllowedRotationAngleForJoint",value:function(e,t){}},{key:"chainRootNode",get:function(){return this._chainRootNode}}])&&Hc(n.prototype,r),o&&Hc(n,o),t}(),Jc={none:0,projectedDepth:1,distance:2,oldestFirst:3,youngestFirst:4},Qc=function(e,t,n,r){return e.mult(Gs(t,n,r))};function $c(e){return($c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ef(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tf(e,t){return!t||"object"!==$c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nf(e){return(nf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rf(e,t){return(rf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var of=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=tf(this,nf(t).call(this)))._dictionaryRepresentation=e,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rf(e,t)}(t,J["a"]),n=t,(r=[{key:"initBySequencingTechniques",value:function(e){this._dictionaryRepresentation=null}},{key:"handleBindingOfSymbolUsing",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"setObjectForKeyedSubscript",value:function(e,t){}},{key:"dictionaryRepresentation",get:function(){return this._dictionaryRepresentation}}])&&ef(n.prototype,r),o&&ef(n,o),t}(),af={billboardScreenAligned:0,billboardViewAligned:1,free:2,billboardYAligned:3},uf=function(e,t,n){};function sf(e){return(sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cf(e,t){return!t||"object"!==sf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ff(e){return(ff=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hf(e,t){return(hf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yf=function(e){function t(e,n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=cf(this,ff(t).call(this))).anchorA=null,i.anchorB=null,i._bodyA=null,i._bodyB=null,i}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hf(e,t)}(t,ze),n=t,(r=[{key:"bodyA",get:function(){return this._bodyA}},{key:"bodyB",get:function(){return this._bodyB}}])&&lf(n.prototype,r),o&&lf(n,o),t}();function pf(e){return(pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mf(e,t){return!t||"object"!==pf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function df(e){return(df=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gf(e,t,n){return t&&_f(e.prototype,t),n&&_f(e,n),e}function vf(e,t){return(vf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bf=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tr.static,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=mf(this,df(t).call(this))).physicsShape=r,e.type=n,e.velocityFactor=new ue.a(0,0,0),e.angularVelocityFactor=new ue.a(0,0,0),e.isAffectedByGravity=!0,e.mass=0,e.charge=0,e.friction=0,e.rollingFriction=0,e.restitution=0,e.damping=0,e.angularDamping=0,e.momentOfInertia=new ue.a(0,0,0),e.usesDefaultMomentOfInertia=!0,e.categoryBitMask=0,e.contactTestBitMask=0,e.collisionBitMask=0,e.velocity=new ue.a(0,0,0),e.angularVelocity=new se.a(0,0,0,0),e.allowsResting=!1,e._isResting=!1,e._node=null,e._btRigidBody=null,e._updateRigidBody(),e._position=null,e._radius=null,e._transform=null,e._invTransform=null,e._shape=null,e._prevPosition=null,e._positionDiff=new ue.a,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vf(e,t)}(t,J["a"]),gf(t,null,[{key:"_propTypes",get:function(){return{physicsShape:"SCNPhysicsShape",type:"integer",velocityFactor:"SCNVector3",angularVelocityFactor:"SCNVector3",ignoreGravity:["boolean",function(e,t){e.isAffectedByGravity=!t}],mass:"float",charge:"float",friction:"float",rollingFriction:"float",restitution:"float",damping:"float",angularDamping:"float",momentOfInertia:"SCNVector3",explicitMomentOfInertia:["boolean",function(e,t){e.usesDefaultMomentOfInertia=!t}],categoryBitMask:"integer",contactTestBitMask:"integer",collisionBitMask:"integer",velocity:"SCNVector3",angularVelocity:"SCNVector4",allowsResting:"boolean",isDefaultShape:["boolean",null]}}}]),gf(t,[{key:"applyForceAsImpulse",value:function(e,t){}},{key:"applyForceAtAsImpulse",value:function(e,t,n){}},{key:"applyTorqueAsImpulse",value:function(e,t){}},{key:"clearAllForces",value:function(){}},{key:"resetTransform",value:function(){this._resetTransform(!0)}},{key:"_resetTransform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!==this._node&&(e&&this._node._updateWorldTransform(),this._node._presentation?this._transform=this._node._presentation._worldTransform:this._transform=this._node._worldTransform),this._radius=0,!this.physicsShape&&this._node&&this._node.geometry&&(this.physicsShape=new Hr(this._node.geometry)),this.physicsShape){this.physicsShape._sourceObject||this.physicsShape._setSourceObject(this._node),this.physicsShape._sourceGeometry||this.physicsShape._setSourceObject(this._sourceObject),this.physicsShape._shape||this.physicsShape._createShape();var t=this.physicsShape._center;this._transform=this._transform.translation(t.x,t.y,t.z),this.physicsShape._shape&&(this._radius=this.physicsShape._shape.getBoundingSphere().radius)}this._position=this._transform.getTranslation(),this._invTransform=this._transform.invert()}},{key:"_updateRigidBody",value:function(){this._btRigidBody}},{key:"_createRigidBody",value:function(){}},{key:"_execDestroy",value:function(){}},{key:"_getPosition",value:function(){var e=new ue.a(0,0,0);if(null!==this._node&&(e=this._node._worldTranslation),null!==this.physicsShape&&null!==this.physicsShape._sourceGeometry){var t=this.physicsShape._sourceGeometry.getBoundingSphere().center;e=e.add(t)}return e}},{key:"_getRadius",value:function(){return null===this.physicsShape||null===this.physicsShape._sourceGeometry?0:this.physicsShape._sourceGeometry.getBoundingSphere().radius}},{key:"isResting",get:function(){return this._isResting}}],[{key:"static",value:function(){return new t(Tr.static)}},{key:"dynamic",value:function(){return new t(Tr.dynamic)}},{key:"kinematic",value:function(){return new t(Tr.kinematic)}}]),t}();function Sf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wf=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"init",value:function(e){this._showPhysicsShapes=null,this._showBoundingBoxes=null,this._showLightInfluences=null,this._showLightExtents=null,this._showPhysicsFields=null,this._showWireframe=null}},{key:"showPhysicsShapes",get:function(){return this._showPhysicsShapes}},{key:"showBoundingBoxes",get:function(){return this._showBoundingBoxes}},{key:"showLightInfluences",get:function(){return this._showLightInfluences}},{key:"showLightExtents",get:function(){return this._showLightExtents}},{key:"showPhysicsFields",get:function(){return this._showPhysicsFields}},{key:"showWireframe",get:function(){return this._showWireframe}}])&&Sf(t.prototype,n),r&&Sf(t,r),e}();function Tf(e){return(Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kf(e,t){return!t||"object"!==Tf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Of(e){return(Of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xf(e,t,n){return t&&Cf(e.prototype,t),n&&Cf(e,n),e}function Ef(e,t){return(Ef=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pf=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=kf(this,Of(t).call(this)))._geometry=null,e._screenSpaceRadius=0,e._worldSpaceDistance=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ef(e,t)}(t,J["a"]),xf(t,null,[{key:"_propTypes",get:function(){return{mode:["integer",null],threshold:["float",null]}}}]),xf(t,[{key:"initScreenSpaceRadius",value:function(e,t){}},{key:"initWorldSpaceDistance",value:function(e,t){}},{key:"geometry",get:function(){return this._geometry}},{key:"screenSpaceRadius",get:function(){return this._screenSpaceRadius}},{key:"worldSpaceDistance",get:function(){return this._worldSpaceDistance}}]),t}(),Af={repeat:0,clamp:1,autoReverse:2},Nf=function(e){return null},Rf={forward:0,deferred:1,modulated:2},Ff=function(e){return new se.a(e)};function Df(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var If=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"renderNode",value:function(e,t,n){}}])&&Df(t.prototype,n),r&&Df(t,r),e}();function Mf(e){return(Mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bf(e,t){return!t||"object"!==Mf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lf(e){return(Lf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uf(e,t){return(Uf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vf=function(e){function t(e,n,r,o,i,a){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(u=Bf(this,Lf(t).call(this))).axisA=null,u.anchorA=null,u.axisB=null,u.anchorB=null,u._bodyA=null,u._bodyB=null,u.minimumLinearLimit=0,u.maximumLinearLimit=0,u.minimumAngularLimit=0,u.maximumAngularLimit=0,u.motorTargetLinearVelocity=0,u.motorMaximumForce=0,u.motorTargetAngularVelocity=0,u.motorMaximumTorque=0,u}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uf(e,t)}(t,ze),n=t,(r=[{key:"bodyA",get:function(){return this._bodyA}},{key:"bodyB",get:function(){return this._bodyB}}])&&jf(n.prototype,r),o&&jf(n,o),t}();function zf(e){return(zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gf(e,t){return!t||"object"!==zf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yf(e){return(Yf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hf(e,t){return(Hf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wf=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=Gf(this,Yf(o).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hf(e,t)}(o,Te),t=o,r=[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}],(n=null)&&Xf(t.prototype,n),r&&Xf(t,r),o}(),Kf=function(e,t,n,r){};function Zf(e){return(Zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qf(e,t){return!t||"object"!==Zf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jf(e,t,n){return(Jf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qf(e){return(Qf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eh(e,t,n){return t&&$f(e.prototype,t),n&&$f(e,n),e}function th(e,t){return(th=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nh=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=qf(this,Qf(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&th(e,t)}(t,Te),eh(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}]),eh(t,[{key:"copy",value:function(){return Jf(Qf(t.prototype),"copy",this).call(this)}},{key:"_applyAction",value:function(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!Object(w.a)(e,po))throw new Error("unsupported class for SCNActionRemove: ".concat(e.constructor.name));e.removeFromParentNode(),this._finished=!0}}],[{key:"removeFromParentNode",value:function(){return new t}}]),t}();function rh(e){return(rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oh(e,t){return!t||"object"!==rh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ih(e){return(ih=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ah(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uh(e,t){return(uh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Te.removeFromParentNode=nh.removeFromParentNode;var sh=function(e){var t,n,r;function o(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),oh(this,ih(o).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uh(e,t)}(o,J["a"]),t=o,(n=[{key:"initCaMediaTimingFunction",value:function(e){}}])&&ah(t.prototype,n),r&&ah(t,r),o}();function lh(e){return(lh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ch(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fh(e,t){return!t||"object"!==lh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hh(e){return(hh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yh(e,t){return(yh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ph=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=fh(this,hh(t).call(this,[],[]))).topRadius=n,e.bottomRadius=r,e.height=o,e.radialSegmentCount=48,e.heightSegmentCount=1,e._createGeometry(),e.materials.push(new Gn),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yh(e,t)}(t,Qn),n=t,(r=[{key:"_createGeometry",value:function(){for(var e=[],t=.5*this.height,n=.5*-this.height,r=[],o=[],i=2*Math.PI/this.radialSegmentCount,a=1/this.radialSegmentCount,u=0;u<=this.radialSegmentCount;u++){var s=-Math.sin(i*u),l=-Math.cos(i*u),c=s*this.topRadius,f=l*this.topRadius,h=s*this.bottomRadius,y=l*this.bottomRadius;r.push(h,n,y),o.push(-h,n,y),r.push(s,0,l),o.push(0,-1,0);var p=a*u;r.push(p,1);var m=.5*(1+Math.cos(u*i)),d=.5*(1+Math.sin(u*i));o.push(m,d),r.push(c,t,f),o.push(0,n,0),r.push(s,0,l),o.push(0,-1,0),r.push(p,0),o.push(.5,.5)}e.push.apply(e,r.concat(o));for(var _=4*(this.radialSegmentCount+1),g=new tt.a(e,tt.a.Semantic.vertex,_,!0,3,4,0,32),v=new tt.a(e,tt.a.Semantic.normal,_,!0,3,4,12,32),b=new tt.a(e,tt.a.Semantic.texcoord,_,!0,2,4,24,32),S=[],w=[],T=[],k=2*(this.radialSegmentCount+1),O=0;O<this.radialSegmentCount;O++){var C=2*O;w.push(C,C+2,C+3);var x=k+C;T.push(x,x+2,x+3)}S.push(new $n.a(w,er.a.triangles)),S.push(new $n.a(T,er.a.triangles)),this._geometryElements=S,this._geometrySources=[g,v,b],this.boundingBox={min:new ue.a(-this.radius,n,-this.radius),max:new ue.a(this.radius,t,this.radius)}}}])&&ch(n.prototype,r),o&&ch(n,o),t}();function mh(e){return(mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _h(e,t){return!t||"object"!==mh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gh(e){return(gh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vh(e,t){return(vh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bh=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_h(this,gh(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vh(e,t)}(t,nl),n=t,o=[{key:"_propTypes",get:function(){return{halfExtent:"SCNVector3",scope:"integer",usesEllipsoidalExtent:"boolean",offset:"SCNVector3",strength:"float",falloffExponent:"float",minimumDistance:"float",active:["boolean","isActive"],exclusive:["boolean","isExclusive"],smoothness:["float","_smoothness"],animationSpeed:["float","_animationSpeed"]}}}],(r=null)&&dh(n.prototype,r),o&&dh(n,o),t}();function Sh(e){return(Sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Th(e,t){return!t||"object"!==Sh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kh(e){return(kh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oh(e,t){return(Oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ch=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Th(this,kh(t).call(this,[],[]))).reflectivity=.25,e.reflectionFalloffEnd=0,e.reflectionFalloffStart=0,e.reflectionResolutionScaleFactor=1,e.length=2,e.reflectionCategoryBitMask=-1,e.width=2,e._createGeometry(),e.materials.push(new Gn),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oh(e,t)}(t,Qn),n=t,(r=[{key:"_createGeometry",value:function(){for(var e=[],t=[],n=this.width/10,r=-this.length/10,o=.5*this.length,i=1,a=0;a<=10;a++){for(var u=.5*-this.width,s=0,l=0;l<=10;l++)e.push(u,o,0),e.push(0,0,1),e.push(s,i),u+=n,s+=.1;o+=r,i+=-.1}for(var c=0;c<10;c++)for(var f=11*c,h=0;h<10;h++){var y=f+h,p=y+11;t.push(y,y+1,p+1),t.push(y,p+1,p)}var m=new tt.a(e,tt.a.Semantic.vertex,121,!0,3,4,0,32),d=new tt.a(e,tt.a.Semantic.normal,121,!0,3,4,12,32),_=new tt.a(e,tt.a.Semantic.texcoord,121,!0,2,4,24,32),g=new $n.a(t,er.a.triangles);this._geometryElements=[g],this._geometrySources=[m,d,_],this.boundingBox={min:new ue.a(.5*-this.width,.5*-this.length,0),max:new ue.a(.5*this.width,.5*this.length,0)}}}])&&wh(n.prototype,r),o&&wh(n,o),t}();function xh(e){return(xh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ph(e,t){return!t||"object"!==xh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ah(e){return(Ah=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nh(e,t){return(Nh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rh=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Ph(this,Ah(t).call(this))).string=null,r.font=null,r.containerFrame=null,r.isWrapped=!1,r.alignmentMode="",r.truncationMode="",r._textSize=null,r.flatness=0,r.extrusionDepth=0,r.chamferRadius=0,r.chamferProfile=null,r}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nh(e,t)}(t,Qn),n=t,(r=[{key:"textSize",get:function(){return this._textSize}}])&&Eh(n.prototype,r),o&&Eh(n,o),t}();function Fh(e){return(Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dh(e,t){return!t||"object"!==Fh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ih(e){return(Ih=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jh(e,t,n){return t&&Mh(e.prototype,t),n&&Mh(e,n),e}function Bh(e,t){return(Bh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lh=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Dh(this,Ih(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bh(e,t)}(t,Te),jh(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float",name:["string",null]}}}]),jh(t,null,[{key:"waitDuration",value:function(e){var n=new t;return n._duration=e,n}},{key:"waitDurationWithRange",value:function(e,n){var r=Math.max(0,e+(Math.random()-.5)*n),o=new t;return o._duration=r,o}}]),t}();Te.waitDuration=Lh.waitDuration,Te.waitDurationWithRange=Lh.waitDurationWithRange;var Uh={additive:0,subtract:1,multiply:2,screen:3,alpha:4,replace:5},Vh=function(e){},zh={normalized:0,additive:1},Gh=function(e){return[e.x,e.y,e.z]},Yh=function(e,t,n,r){},Xh=function(e,t){return Math.abs(e.x-t.x)<1e-5&&Math.abs(e.y-t.y)<1e-5&&Math.abs(e.z-t.z)<1e-5&&Math.abs(e.w-t.w)<1e-5};function Hh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=null,this.pointOfView=null,this.autoenablesDefaultLighting=!1,this.isJitteringEnabled=!1,this.showsStatistics=!1,this.debugOptions=null,this._renderingAPI=null,this.sceneTime=0,this.isPlaying=!1,this.loops=!1,this.delegate=null,this._currentRenderCommandEncoder=null,this._device=null,this._commandQueue=null,this._colorPixelFormat=null,this._depthPixelFormat=null,this._stencilPixelFormat=null,this._context=null,this.overlaySKScene=null,this.audioListener=null,this._audioEnvironmentNode=null,this._audioEngine=null,this.currentTime=0}var t,n,r;return t=e,(n=[{key:"presentWithIncomingPointOfView",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"prepareShouldAbortBlock",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!1}},{key:"prepare",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"hitTest",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return null}},{key:"isNodeInsideFrustumOf",value:function(e,t){return!1}},{key:"nodesInsideFrustumOf",value:function(e){return null}},{key:"projectPoint",value:function(e){return null}},{key:"unprojectPoint",value:function(e){return null}},{key:"renderingAPI",get:function(){return this._renderingAPI}},{key:"currentRenderCommandEncoder",get:function(){return this._currentRenderCommandEncoder}},{key:"device",get:function(){return this._device}},{key:"commandQueue",get:function(){return this._commandQueue}},{key:"colorPixelFormat",get:function(){return this._colorPixelFormat}},{key:"depthPixelFormat",get:function(){return this._depthPixelFormat}},{key:"stencilPixelFormat",get:function(){return this._stencilPixelFormat}},{key:"context",get:function(){return this._context}},{key:"audioEnvironmentNode",get:function(){return this._audioEnvironmentNode}},{key:"audioEngine",get:function(){return this._audioEngine}}])&&Hh(t.prototype,n),r&&Hh(t,r),e}(),Kh=function(e,t,n){};function Zh(e){return(Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jh(e,t){return!t||"object"!==Zh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qh(e){return(Qh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $h(e,t){return($h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ey=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Jh(this,Qh(t).call(this)))._isAnalog=!1,e._collection=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$h(e,t)}(t,J["a"]),n=t,(r=[{key:"isAnalog",get:function(){return this._isAnalog}},{key:"collection",get:function(){return this._collection}}])&&qh(n.prototype,r),o&&qh(n,o),t}();function ty(e){return(ty="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ny(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ry(e,t){return!t||"object"!==ty(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oy(e){return(oy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iy(e,t){return(iy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ay=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ry(this,oy(t).call(this)))._isPressed=!1,e._value=0,e.pressedChangedHandler=null,e.valueChangedHandler=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iy(e,t)}(t,ey),n=t,(r=[{key:"isPressed",get:function(){return this._isPressed}},{key:"value",get:function(){return this._value}}])&&ny(n.prototype,r),o&&ny(n,o),t}();function uy(e){return(uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ly(e,t){return!t||"object"!==uy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cy(e){return(cy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fy(e,t){return(fy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hy=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ly(this,cy(t).call(this)))._value=0,e.valueChangedHandler=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fy(e,t)}(t,ey),n=t,(r=[{key:"value",get:function(){return this._value}}])&&sy(n.prototype,r),o&&sy(n,o),t}();function yy(e){return(yy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function py(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function my(e,t){return!t||"object"!==yy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dy(e){return(dy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _y(e,t){return(_y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gy=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=my(this,dy(t).call(this)))._xAxis=new hy,e._yAxis=new hy,e._up=new ay,e._down=new ay,e._left=new ay,e._right=new ay,e.valueChangedHandler=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_y(e,t)}(t,ey),n=t,(r=[{key:"xAxis",get:function(){return this._xAxis}},{key:"yAxis",get:function(){return this._yAxis}},{key:"up",get:function(){return this._up}},{key:"down",get:function(){return this._down}},{key:"left",get:function(){return this._left}},{key:"right",get:function(){return this._right}}])&&py(n.prototype,r),o&&py(n,o),t}();function vy(e){return(vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function by(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sy(e,t){return!t||"object"!==vy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wy(e){return(wy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ty(e,t){return(Ty=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ky={A:0,B:1,X:2,Y:3,L1:4,R1:5,UP:12,DOWN:13,LEFT:14,RIGHT:15};"undefined"!=typeof navigator&&-1!==navigator.userAgent.indexOf("Firefox")&&(ky.A=1,ky.B=2,ky.X=0,ky.Y=3,ky.UP=14,ky.DOWN=15,ky.LEFT=16,ky.RIGHT=17);var Oy=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Sy(this,wy(t).call(this)))._controller=null,e.valueChangedHandler=null,e._leftShoulder=new ay,e._rightShoulder=new ay,e._dpad=new gy,e._buttonA=new ay,e._buttonB=new ay,e._buttonX=new ay,e._buttonY=new ay,e._buttonMapping=new Map([[e._leftShoulder,ky.L1],[e._rightShoulder,ky.R1],[e._buttonA,ky.A],[e._buttonB,ky.B],[e._buttonX,ky.X],[e._buttonY,ky.Y]]),e._dpadMapping=new Map([[e._dpad._up,ky.UP],[e._dpad._down,ky.DOWN],[e._dpad._left,ky.LEFT],[e._dpad._right,ky.RIGHT]]),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ty(e,t)}(t,J["a"]),n=t,(r=[{key:"_update",value:function(){var e=this;this._buttonMapping.forEach(function(t,n){n._value=e._controller._state.buttons[t],n._isPressed=e._controller._state.pressed[t]}),this._dpadMapping.forEach(function(t,n){n._value=e._controller._state.buttons[t],n._isPressed=e._controller._state.pressed[t]}),this._dpad._xAxis._value=this._dpad._right._value-this._dpad._left._value,this._dpad._yAxis._value=this._dpad._down._value-this._dpad._up._value,this._buttonMapping.forEach(function(t,n){n.pressedChangedHandler&&e._controller._updated.pressed[t]&&n.pressedChangedHandler(n,n._value,n._isPressed),e._controller._updated.buttons[t]&&(n.valueChangedHandler&&n.valueChangedHandler(n,n._value,n._isPressed),e.valueChangedHandler&&e.valueChangedHandler(e,n))});var t=!1;this._dpadMapping.forEach(function(n,r){e._controller._updated.pressed[n]&&(t=!0,r.pressedChangedHandler&&r.pressedChangedHandler(r,r._value,r._isPressed)),e._controller._updated.buttons[n]&&(t=!0,r.valueChangedHandler&&r.valueChangedHandler(r,r._value,r._isPressed),e.valueChangedHandler&&e.valueChangedHandler(e,r))}),t&&(this._dpad.valueChangedHandler&&this._dpad.valueChangedHandler(this._dpad,this._dpad._xAxis.value,this._dpad._yAxis.value),this.valueChangedHandler&&this.valueChangedHandler(this,this._dpad))}},{key:"_getValue",value:function(e){var t=this._buttonMapping.get(e);return void 0===t&&(t=this._dpadMapping.get(e)),void 0===t?null:this._controller._state.buttons[t]}},{key:"saveSnapshot",value:function(){return null}},{key:"controller",get:function(){return this._controller}},{key:"leftShoulder",get:function(){return this._leftShoulder}},{key:"rightShoulder",get:function(){return this._rightShoulder}},{key:"dpad",get:function(){return this._dpad}},{key:"buttonA",get:function(){return this._buttonA}},{key:"buttonB",get:function(){return this._buttonB}},{key:"buttonX",get:function(){return this._buttonX}},{key:"buttonY",get:function(){return this._buttonY}}])&&by(n.prototype,r),o&&by(n,o),t}();function Cy(e){return(Cy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ey(e,t){return!t||"object"!==Cy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Py(e){return(Py=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ay(e,t){return(Ay=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ny=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ey(this,Py(t).call(this)))._controller=null,e.valueChangedHandler=null,e._leftShoulder=new ay,e._rightShoulder=new ay,e._dpad=new gy,e._buttonA=new ay,e._buttonB=new ay,e._buttonX=new ay,e._buttonY=new ay,e._leftThumbstick=new gy,e._rightThumbstick=new gy,e._leftTrigger=new ay,e._rightTrigger=new ay,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ay(e,t)}(t,J["a"]),n=t,(r=[{key:"_update",value:function(){}},{key:"saveSnapshot",value:function(){return null}},{key:"controller",get:function(){return this._controller}},{key:"leftShoulder",get:function(){return this._leftShoulder}},{key:"rightShoulder",get:function(){return this._rightShoulder}},{key:"dpad",get:function(){return this._dpad}},{key:"buttonA",get:function(){return this._buttonA}},{key:"buttonB",get:function(){return this._buttonB}},{key:"buttonX",get:function(){return this._buttonX}},{key:"buttonY",get:function(){return this._buttonY}},{key:"leftThumbstick",get:function(){return this._leftThumbstick}},{key:"rightThumbstick",get:function(){return this._rightThumbstick}},{key:"leftTrigger",get:function(){return this._leftTrigger}},{key:"rightTrigger",get:function(){return this._rightTrigger}}])&&xy(n.prototype,r),o&&xy(n,o),t}();function Ry(e){return(Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dy(e,t){return!t||"object"!==Ry(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Iy(e){return(Iy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function My(e,t){return(My=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jy=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Dy(this,Iy(t).call(this)))._controller=null,e.valueChangedHandler=null,e.reportsAbsoluteDpadValues=!1,e.allowsRotation=!1,e._dpad=null,e._buttonA=null,e._buttonX=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&My(e,t)}(t,J["a"]),n=t,(r=[{key:"saveSnapshot",value:function(){return null}},{key:"controller",get:function(){return this._controller}},{key:"dpad",get:function(){return this._dpad}},{key:"buttonA",get:function(){return this._buttonA}},{key:"buttonX",get:function(){return this._buttonX}}])&&Fy(n.prototype,r),o&&Fy(n,o),t}();function By(e){return(By="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ly(e,t){return!t||"object"!==By(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uy(e){return(Uy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zy(e,t,n){return t&&Vy(e.prototype,t),n&&Vy(e,n),e}function Gy(e,t){return(Gy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yy={getGamepads:function(){return[]}};"undefined"!=typeof window&&void 0!==window.navigator&&(Yy=window.navigator);var Xy=new Map,Hy=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ly(this,Uy(t).call(this)))._gamepad=null,e._extendedGamepad=null,e._microGamepad=null,e._motion=null,e.controllerPausedHandler=null,e._isAttachedToDevice=!1,e._vendorName=null,e.playerIndex=null,e.handlerQueue=null,e._gamepadIndex=-1,e._gamepadId=-1,e._state={buttons:[],pressed:[],axes:[]},e._updated={buttons:[],pressed:[],axes:[]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gy(e,t)}(t,J["a"]),zy(t,null,[{key:"getController",value:function(e){var n=e;if(""===e.id&&null===(n=t._gamepadObjByIndex(e.index)))return null;var r=Xy.get(n.id);return r||(r=new t,n?(Xy.set(n.id,r),r._gamepadIndex=n.index,r._gamepadId=n.id,r._gamepad=new Oy,r._gamepad._controller=r,"standard"===e.mapping&&(r._extendedGamepad=new Ny,r._extendedGamepad._controller=r),r):r)}}]),zy(t,[{key:"gamepad",get:function(){return this._gamepad}},{key:"extendedGamepad",get:function(){return this._extendedGamepad}},{key:"microGamepad",get:function(){return this._microGamepad}},{key:"motion",get:function(){return this._motion}},{key:"isAttachedToDevice",get:function(){return this._isAttachedToDevice}},{key:"vendorName",get:function(){return this._vendorName}},{key:"gamepadObj",get:function(){return t._gamepadObjById(this._gamepadId)}}],[{key:"_update",value:function(){Xy.forEach(function(e,n){var r=t._gamepadObjById(n);if(r){for(var o=r.buttons.length,i=0;i<o;i++){var a=r.buttons[i];e._updated.buttons[i]=!1,e._state.buttons[i]!==a.value&&(e._state.buttons[i]=a.value,e._updated.buttons[i]=!0),e._updated.pressed[i]=!1,e._state.pressed[i]!==a.pressed&&(e._state.pressed[i]=a.pressed,e._updated.pressed[i]=!0)}for(var u=r.axes.length,s=0;s<u;s++){var l=r.axes[s];e._updated.axes[s]=!1,e._state.axes[s]!==l&&(e._state.axes[s]=l,e._updated.axes[s]=!0)}}else Xy.delete(n)}),Xy.forEach(function(e,t){e._gamepad&&e._gamepad._update(),e._extendedGamepad&&e._extendedGamepad._update(),e._microGamepad&&e._microGamepad._update()})}},{key:"startWirelessControllerDiscovery",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"stopWirelessControllerDiscovery",value:function(){}},{key:"controllers",value:function(){return Array.from(Xy.values())}},{key:"_gamepadObjByIndexId",value:function(e,n){var r=t._gamepadObjByIndex(e);return r&&r.id===n?r:null}},{key:"_gamepadObjByIndex",value:function(e){return Yy.getGamepads()[e]}},{key:"_gamepadObjById",value:function(e){var t=Yy.getGamepads(),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;if(u&&u.id===e)return u}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return null}}]),t}();function Wy(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ky(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zy={preferLowPowerDevice:"SCNPreferLowPowerDeviceKey",preferredDevice:"SCNPreferredDeviceKey",preferredRenderingAPI:"SCNPreferredRenderingAPIKey"},qy=new Map([["KeyA",0],["KeyS",1],["KeyD",2],["KeyF",3],["KeyH",4],["KeyG",5],["KeyZ",6],["KeyX",7],["KeyC",8],["KeyV",9],["IntlBackslash",10],["KeyB",11],["KeyQ",12],["KeyW",13],["KeyE",14],["KeyR",15],["KeyY",16],["KeyT",17],["Digit1",18],["Digit2",19],["Digit3",20],["Digit4",21],["Digit6",22],["Digit5",23],["Equal",24],["Digit9",25],["Digit7",26],["Minus",27],["Digit8",28],["Digit0",29],["BracketRight",30],["KeyO",31],["KeyU",32],["BracietLeft",33],["KeyI",34],["KeyP",35],["Enter",36],["KeyL",37],["KeyJ",38],["Quote",39],["KeyK",40],["Semicolon",41],["Backslash",42],["Comma",43],["Slash",44],["KeyN",45],["KeyM",46],["Period",47],["Tab",48],["Space",49],["Backquote",50],["Delete",51],["NumpadEnter",52],["Escape",53],["OSRight",54],["MetaRight",54],["OSLeft",55],["MetaLeft",55],["ShiftLeft",56],["CapsLock",57],["AltLeft",58],["ControlLeft",59],["ShiftRight",60],["AltRight",61],["ControlRight",62],["Fn",63],["F17",64],["NumpadDecimal",65],["NumpadMultiply",67],["NumpadAdd",69],["NumLock",71],["AudioVolumeUp",72],["AudioVolumeDown",73],["AudioVolumeMute",74],["NumpadDivide",75],["NumpadEnter",76],["NumpadSubtract",78],["F18",79],["F19",80],["NumpadEqual",81],["Numpad0",82],["Numpad1",83],["Numpad2",84],["Numpad3",85],["Numpad4",86],["Numpad5",87],["Numpad6",88],["Numpad7",89],["F20",90],["Numpad8",91],["Numpad9",92],["IntlYen",93],["IntlRo",94],["NumpadComma",95],["F5",96],["F6",97],["F7",98],["F3",99],["F8",100],["F9",101],["Lang2",102],["F11",103],["Lang1",104],["F13",105],["F16",106],["F14",107],["F10",109],["F12",111],["F15",113],["Help",114],["Insert",114],["Home",115],["PageUp",116],["Delete",117],["F4",118],["End",119],["F2",120],["PageDown",121],["F1",122],["ArrowLeft",123],["ArrowRight",124],["ArrowDown",125],["ArrowUp",126]]),Jy=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._scene=null,this._backgroundColor=de.white,this.allowsCameraControl=!1,this.antialiasingMode=ul.multisampling4X,this.preferredFramesPerSecond=0,this._context=null,this.pixelFormat=null,this._renderingAPI=Mo.webGL,this._delegate=null,this._device=null,this.technique=null,this._frame=t,this._canvas=document.createElement("canvas"),this._canvas.tabIndex=1,void 0===t&&(t=i.a.rectWithXYWidthHeight(0,0,300,300)),this._canvas.style.width=t.width,this._canvas.style.height=t.height,this._canvasWidth=0,this._canvasHeight=0,this._currentSystemTime=0,this._elapsedTime=0,this._previousSystemTimeMs=0,this._sumElapsedTimeMs=0,this._sumFrames=0,this._lastFpsCalculationTimeMs=0,this._fpsCalculationSpanMs=2e3,this._fps=0,this._renderer=new du,this._requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};for(var o=r?r[e.Option.preferLowPowerDevice]:null,a=(r&&r[e.Option.preferredDevice],r&&r[e.Option.preferredRenderingAPI],{alpha:!0,depth:!0,stencil:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,preferLowPowerToHighPerformance:Boolean(o),failIfMajorPerformanceCaveat:!1}),u=["webgl2"],s=0;s<u.length;s++){var l=u[s];try{this._context=this._canvas.getContext(l,a)}catch(e){}if(this._context)break}if(!this._context)throw new Error("can't create WebGL context");this._context.viewport(t.minX,t.minY,t.width,t.height),this._renderer._setContext(this._context),this._renderer._backgroundColor=this._backgroundColor,this._renderer._viewRect=t,this._mouseIsDown=!1,this._mouseDownX=0,this._mouseDownY=0,this._canvas.addEventListener("mousedown",function(e){var t=n._createEvent(e);n._mouseIsDown=!0,n._mouseDownX=e.clientX,n._mouseDownY=e.clientY,n.allowsCameraControl&&(n._baseCameraPosition=n._renderer._getCameraPosition(),n._baseCameraOrientation=n._renderer._getCameraOrientation(),n._baseCameraDistance=n._renderer._getCameraDistance()),n.mouseDownWith(t)}),this._canvas.addEventListener("mousemove",function(e){var t=n._createEvent(e);if(n.mouseMovedWith(t),n._mouseIsDown){if(n.allowsCameraControl){var r=e.clientX,o=e.clientY,i=r-n._mouseDownX,a=o-n._mouseDownY,u=Math.sqrt(i*i+a*a);if(u>0){var s=.5*-u*.01,l=Math.sin(s)/u,c=new se.a(a*l,i*l,0,Math.cos(s)),f=n._baseCameraOrientation.cross(c);n._renderer._setDefaultCameraOrientation(f)}n._renderer._switchToDefaultCamera()}n.mouseDraggedWith(t)}}),document.addEventListener("mouseup",function(e){if(n._mouseIsDown){n._mouseIsDown=!1;var t=n._createEvent(e);n.mouseUpWith(t),n._preventDefault(t)}}),this._canvas.addEventListener("mouseover",function(e){var t=n._createEvent(e);n._preventDefault(t)}),this._canvas.addEventListener("mouseout",function(e){var t=n._createEvent(e);n.mouseExitedWith(t),n._preventDefault(t)}),this._canvas.addEventListener("mousewheel",function(e){var t=n._createEvent(e);n.scrollWheelWith(t),n._preventDefault(t)}),this._canvas.addEventListener("DOMMouseScroll",function(e){var t=n._createEvent(e);n.scrollWheelWith(t),n._preventDefault(t)}),this._canvas.addEventListener("keydown",function(e){var t=n._createEvent(e);n.keyDownWith(t),n._preventDefault(t)}),this._canvas.addEventListener("keyup",function(e){var t=n._createEvent(e);n.keyUpWith(t),n._preventDefault(t)})}var t,n,r;return t=e,r=[{key:"Option",get:function(){return Zy}}],(n=[{key:"connectedCallback",value:function(){}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(){}},{key:"_resizeCanvas",value:function(){var e=this._canvas.clientWidth,t=this._canvas.clientHeight;this._frame&&this._frame.width===e&&this._frame.height===t||(this._frame=i.a.rectWithXYWidthHeight(0,0,e,t),this._canvas.width=e,this._canvas.height=t,this._context.viewport(0,0,e,t),this._renderer._viewRect=this._frame,this.setFrameSize(this._frame.size))}},{key:"appendTo",value:function(e){var t=this;e.appendChild(this._canvas),void 0===this._frame&&(this._canvas.style.width="100%",this._canvas.style.height="100%",this._canvas.clientHeight<=0&&(this._canvas.style.height=300)),this._resizeCanvas(),"undefined"!=typeof window&&window.addEventListener("resize",function(){t._resizeCanvas()})}},{key:"pause",value:function(e){this._isPlaying&&(this._isPlaying=!1)}},{key:"play",value:function(e){this._isPlaying||(this._isPlaying=!0,this.__requestAnimationFrame())}},{key:"stop",value:function(e){this._isPlaying=!1}},{key:"snapshot",value:function(){return null}},{key:"presentWithIncomingPointOfView",value:function(e,t,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},{key:"prepareShouldAbortBlock",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!1}},{key:"prepare",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"hitTest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=(e.x-this._frame.minX)/this._frame.width*2-1,r=(e.y-this._frame.minY)/this._frame.height*2-1;return this._renderer.hitTest(new c.a(n,-r),t)}},{key:"isNodeInsideFrustumOf",value:function(e,t){return!1}},{key:"nodesInsideFrustumOf",value:function(e){return null}},{key:"projectPoint",value:function(e){return null}},{key:"unprojectPoint",value:function(e){return null}},{key:"viewDidMoveToWindow",value:function(){}},{key:"setFrameSize",value:function(e){}},{key:"_drawAtTimeWithContext",value:function(e,t){this._renderer._time=e,this._createPresentationNodes(),this._createSKPresentationNodes(),this._updateTransform(),this._delegate&&this._delegate.rendererUpdateAtTime&&this._delegate.rendererUpdateAtTime(this._renderer,e),this._copyTransformToPresentationNodes(),this._copyTransformToPresentationSKNodes(),this._updateTransform(),this._runActions(),this._runAnimations(),this._runSKActions(),this._updateTransform(),this._delegate&&this._delegate.rendererDidApplyAnimationsAtTime&&this._delegate.rendererDidApplyAnimationsAtTime(this._renderer,e),this._updateTransform(),this._scene&&null!==this._scene._physicsWorld&&this._scene._physicsWorld._simulate(e),this._delegate&&this._delegate.rendererDidSimulatePhysicsAtTime&&this._delegate.rendererDidSimulatePhysicsAtTime(this._renderer,e),this._delegate&&this._delegate.rendererWillRenderSceneAtTime&&this._delegate.rendererWillRenderSceneAtTime(this._renderer,this._scene,e),this._updateSkinner(),this._updateMorph(),this._updateParticles(),this._updateSKTransform(),this._renderer.render(),this._delegate&&this._delegate.rendererDidRenderSceneAtTime&&this._delegate.rendererDidRenderSceneAtTime(this._renderer,e)}},{key:"_createPresentationNodes",value:function(){if(null!==this._scene)for(var e=[this._scene.rootNode];e.length>0;){var t=e.shift();t._presentation||t._createPresentation(),e.push.apply(e,Wy(t.childNodes))}}},{key:"_copyTransformToPresentationNodes",value:function(){if(null!==this._scene)for(var e=[this._scene.rootNode,this._scene._skyBox,this._renderer._defaultCameraPosNode,this._renderer._defaultLightNode];e.length>0;){var t=e.shift();t._copyTransformToPresentation(),t._copyMaterialPropertiesToPresentation(),t._copyMorpherToPresentation(),e.push.apply(e,Wy(t.childNodes))}}},{key:"_createSKPresentationNodes",value:function(){if(null!==this.overlaySKScene)for(var e=[this.overlaySKScene];e.length>0;){var t=e.shift(),n=t.__presentation;null===n&&((n=t.copy())._isPresentationInstance=!0,t.__presentation=n),e.push.apply(e,Wy(t.children))}}},{key:"_copyTransformToPresentationSKNodes",value:function(){if(null!==this.overlaySKScene)for(var e=[this.overlaySKScene];e.length>0;){var t=e.shift();t._copyTransformToPresentation(),e.push.apply(e,Wy(t.children))}}},{key:"__requestAnimationFrame",value:function(){var e=this;this._requestAnimationFrame.call(window,function(){var t=Date.now(),n=0;e._previousSystemTimeMs&&(n=t-e._previousSystemTimeMs),n&&(e._lastFpsCalculationTimeMs||(e._lastFpsCalculationTime=t),e._sumElapsedTimeMs+=n,e._sumFrames+=1,t-e._lastFpsCalculationTimeMs>e._fpsCalculationSpanMs&&(e._fps=e._sumFrames/(.001*e._sumElapsedTimeMs),e._sumFrames=0,e._sumElapsedTimeMs=0,e._lastFpsCalculationTimeMs=t,console.error("fps: "+e._fps))),e._currentSystemTime=.001*t,e._elapsedTime=.001*n,e.currentTime=e._currentSystemTime,Hy._update(),e._drawAtTimeWithContext(e.currentTime,e._context),e._isPlaying&&e.__requestAnimationFrame(),e._previousSystemTimeMs=t})}},{key:"_updateTransform",value:function(e,t){null!==this._scene&&(this._scene.rootNode._updateWorldTransform(),this._scene.rootNode._updateBoundingBox())}},{key:"_updateSkinner",value:function(e){var t=this;void 0!==e?(null===e.skinner||e.skinner._useGPU||e.skinner._update(e),e.childNodes.forEach(function(e){t._updateSkinner(e)})):this._scene&&this._updateSkinner(this._scene.rootNode)}},{key:"_updateMorph",value:function(e){var t=this;void 0!==e?(null!==e.morpher&&e.morpher._morph(e),e.childNodes.forEach(function(e){t._updateMorph(e)})):this._scene&&this._updateMorph(this._scene.rootNode)}},{key:"_updateSKTransform",value:function(){null!==this.overlaySKScene&&this.overlaySKScene._updateWorldTransform()}},{key:"_runActions",value:function(){null!==this._scene&&this._runActionForNode(this._scene.rootNode)}},{key:"_runActionForNode",value:function(e){var t=this;this._runActionForObject(e),e.childNodes.forEach(function(e){return t._runActionForNode(e)})}},{key:"_runActionForObject",value:function(e){var t=this,n=[];e._actions.forEach(function(r,o){r._applyAction(e,t.currentTime),r._finished&&(r._completionHandler&&r._completionHandler(),n.push(o))}),n.forEach(function(t){e._actions.delete(t)})}},{key:"_runSKActions",value:function(){null!==this.overlaySKScene&&this._runSKActionForNode(this.overlaySKScene)}},{key:"_runSKActionForNode",value:function(e){var t=this;this._runSKActionForObject(e),e.children.forEach(function(e){return t._runSKActionForNode(e)})}},{key:"_runSKActionForObject",value:function(e){var t=this,n=[];e._actions.forEach(function(r,o){r._applyAction(e,t.currentTime),r._finished&&(r._completionHandler&&r._completionHandler(),n.push(o))}),n.forEach(function(t){e._actions.delete(t)})}},{key:"_runAnimations",value:function(){null!==this._scene&&this._runAnimationForNode(this._scene.rootNode)}},{key:"_runAnimationForNode",value:function(e){var t=this;if(e.childNodes.forEach(function(e){return t._runAnimationForNode(e)}),this._runAnimationForObject(e),e.geometry&&(this._runAnimationForObject(e.geometry),e.geometry.materials.forEach(function(e){t._runAnimationForObject(e),[e._diffuse,e._ambient,e._specular,e._normal,e._reflective,e._emission,e._transparent,e._multiply,e._ambientOcclusion,e._selfIllumination,e._metalness,e._roughness].forEach(function(e){t._runAnimationForObject(e)})})),e._particleSystems){var n=!0,r=!1,o=void 0;try{for(var i,a=e._particleSystems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var u=i.value;this._runAnimationForObject(u)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}},{key:"_runAnimationForObject",value:function(e){var t=this,n=[];e._animations.forEach(function(r,o){r._applyAnimation(e,t.currentTime),r._isFinished&&r.isRemovedOnCompletion&&n.push(o)}),n.forEach(function(t){e._animations.delete(t)})}},{key:"_updateParticles",value:function(){null!==this._scene&&(this._updateParticlesForScene(),this._updateParticlesForNode(this._scene.rootNode))}},{key:"_updateParticlesForScene",value:function(){if(null!==this._scene._particleSystems){for(var e=this._scene.physicsWorld?this._scene.physicsWorld.gravity:null,t=this._scene._particleSystems.length,n=0;n<t;n++){var r=this._scene._particleSystems[n],o=this._scene._particleSystemsTransform[n];r._updateParticles(o,e,this.currentTime)}var i=!0,a=!1,u=void 0;try{for(var s,l=this._scene._particleSystems[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;c._finished&&this._scene.removeParticleSystem(c)}}catch(e){a=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw u}}}}},{key:"_updateParticlesForNode",value:function(e){var t=this;this._updateParticlesForObject(e),e.childNodes.forEach(function(e){return t._updateParticlesForNode(e)})}},{key:"_updateParticlesForObject",value:function(e){if(null!==e.particleSystems){var t=this._scene.physicsWorld?this._scene.physicsWorld.gravity:null,n=!0,r=!1,o=void 0;try{for(var i,a=e.particleSystems[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value._updateParticles(e.presentation.worldTransform,t,this.currentTime)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var u=!0,s=!1,l=void 0;try{for(var c,f=e.particleSystems[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var h=c.value;h._finished&&e.removeParticleSystem(h)}}catch(e){s=!0,l=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}}},{key:"_createEvent",value:function(e){var t={};return t.locationInWindow=new c.a(e.clientX,e.clientY),t.modifierFlags=0,t.timestamp=e.timeStamp,"undefined"!=typeof window&&(t.window=window),t.windowNumber=0,t.eventRef=e,t.cgEvent=null,t.characters=null,t.charactersIgnoringModifiers=null,t.isARepeat=!1,void 0!==e.repeat&&(t.isARepeat=e.repeat),e.code&&qy.has(e.code)?t.keyCode=qy.get(e.code):t.keyCode=0,t.buttonNumber=0,t.clickCount=0,t.associatedEventsMask=null,t.eventNumber=0,t.trackingNumber=0,t.trackingArea=0,t.userData=null,t.data1=0,t.data2=0,t.sutype=null,void 0!==e.deltaX?(t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ):(t.deltaX=0,t.deltaY=0,t.deltaZ=0,void 0!==e.detail&&(t.deltaY=10*-e.detail)),t._doDefaultAction=!1,t}},{key:"_preventDefault",value:function(e){e._doDefaultAction||e.eventRef.preventDefault()}},{key:"mouseDownWith",value:function(e){e._doDefaultAction=!0}},{key:"mouseDraggedWith",value:function(e){e._doDefaultAction=!0}},{key:"mouseUpWith",value:function(e){e._doDefaultAction=!0}},{key:"mouseMovedWith",value:function(e){e._doDefaultAction=!0}},{key:"mouseEnteredWith",value:function(e){e._doDefaultAction=!0}},{key:"mouseExitedWith",value:function(e){e._doDefaultAction=!0}},{key:"rightMouseDraggedWith",value:function(e){e._doDefaultAction=!0}},{key:"rightMouseUpWith",value:function(e){e._doDefaultAction=!0}},{key:"otherMouseDownWith",value:function(e){e._doDefaultAction=!0}},{key:"otherMouseDraggedWith",value:function(e){e._doDefaultAction=!0}},{key:"otherMouseUpWith",value:function(e){e._doDefaultAction=!0}},{key:"scrollWheelWith",value:function(e){e._doDefaultAction=!0}},{key:"keyDownWith",value:function(e){e._doDefaultAction=!0}},{key:"keyUpWith",value:function(e){e._doDefaultAction=!0}},{key:"flagsChangedWith",value:function(e){}},{key:"tablePointWith",value:function(e){}},{key:"tableProximityWith",value:function(e){}},{key:"convertFrom",value:function(e,t){var n=0,r=0;t&&(n=t._frame.origin.x,r=t._frame.origin.y);var o=this._canvas.getBoundingClientRect(),i=o.left,a=o.top;return new c.a(e.x+n-i,e.y+r-a)}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._renderer._backgroundColor=e}},{key:"isPlaying",get:function(){return this._renderer.isPlaying},set:function(e){e?this.play():this.pause()}},{key:"scene",get:function(){return this._scene},set:function(e){this._scene=e,this._renderer.scene=this._scene,null!==this._scene&&(this._scene._physicsWorld._renderer=this._renderer,this._updateTransform(),this._scene.rootNode._resetPhysicsTransformRecursively())}},{key:"pointOfView",get:function(){return this._renderer.pointOfView},set:function(e){this._renderer.pointOfView=e}},{key:"autoenablesDefaultLighting",get:function(){return this._renderer.autoenablesDefaultLighting},set:function(e){this._renderer.autoenablesDefaultLighting=e}},{key:"isJitteringEnabled",get:function(){return this._renderer.isJitteringEnabled},set:function(e){this._renderer.isJitteringEnabled=e}},{key:"showsStatistics",get:function(){return this._renderer.showsStatistics},set:function(e){this._renderer.showsStatistics=e}},{key:"debugOptions",get:function(){return this._renderer.debugOptions},set:function(e){this._renderer.debugOptions=e}},{key:"sceneTime",get:function(){return this._renderer.sceneTime},set:function(e){this._renderer.sceneTime=e}},{key:"loops",get:function(){return this._renderer.loops},set:function(e){this._renderer.loops=e}},{key:"renderingAPI",get:function(){return this._renderingAPI}},{key:"delegate",get:function(){return this._delegate},set:function(e){this._delegate=e}},{key:"currentRenderCommandEncoder",get:function(){return this._renderer.currentRenderCommandEncoder}},{key:"device",get:function(){return this._device}},{key:"commandQueue",get:function(){return this._renderer.commandQueue}},{key:"colorPixelFormat",get:function(){return this._renderer.colorPixelFormat}},{key:"depthPixelFormat",get:function(){return this._renderer.depthPixelFormat}},{key:"stencilPixelFormat",get:function(){return this._renderer._stencilPixelFormat}},{key:"context",get:function(){return this._renderer.context}},{key:"overlaySKScene",get:function(){return this._renderer.overlaySKScene},set:function(e){this._renderer.overlaySKScene=e}},{key:"audioListener",get:function(){return this._renderer.audioListener},set:function(e){this._renderer.audioListener=e}},{key:"audioEnvironmentNode",get:function(){return this._renderer.audioEnvironmentNode}},{key:"audioEngine",get:function(){return this._renderer.audioEngine}},{key:"currentTime",get:function(){return this._renderer.currentTime},set:function(e){this._renderer.currentTime=e}},{key:"bounds",get:function(){var e=this._canvas.getBoundingClientRect();return new i.a(new c.a(e.left,e.top),new a.a(e.width,e.height))}}])&&Ky(t.prototype,n),r&&Ky(t,r),e}(),Qy=function(e){return null},$y=(new It.a,function(e){return e.isIdentity()});function ep(e){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tp(e,t){return!t||"object"!==ep(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function np(e,t,n){return(np="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rp(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rp(e){return(rp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function op(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ip(e,t,n){return t&&op(e.prototype,t),n&&op(e,n),e}function ap(e,t){return(ap=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var up=new RegExp(/^weights\[(\d+)\]$/),sp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=tp(this,rp(t).call(this))).targets=[],e._weights=[],e.calculationMode=zh.normalized,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ap(e,t)}(t,J["a"]),ip(t,null,[{key:"_propTypes",get:function(){return{calculationMode:"integer",shouldMorphNormals:["boolean",null],targets:"NSArray",useSparseTargets:["boolean",null],weights:["NSArray","_weights"]}}}]),ip(t,[{key:"weightForTargetAt",value:function(e){return this._weights[e]}},{key:"setWeightForTargetAt",value:function(e,t){this._weights[t]=e}},{key:"setValueForKey",value:function(e,n){var r=n.match(up);if(null===r)np(rp(t.prototype),"setValueForKey",this).call(this,e,n);else if(r.length>1){var o=r[1];this._weights[o]=e}}},{key:"_morph",value:function(e){var t=e.presentation;if(null!==e.geometry&&null!==t&&null!==t.geometry){var n=t.geometry,r=t.morpher,o=new Map;e.geometry.geometrySources.forEach(function(e){n.getGeometrySourcesForSemantic(e.semantic)[0].fill(0),o.set(e.semantic,0)});for(var i=r.targets.length,a=function(e){var t=r.targets[e],i=r._weights[e];if(0===i||void 0===i)return"continue";t.geometrySources.forEach(function(e){var t=n.getGeometrySourcesForSemantic(e.semantic)[0];if(void 0!==t){o.set(e.semantic,o.get(e.semantic)+i);var r=e._dataOffset/e._bytesPerComponent,a=e._dataStride/e._bytesPerComponent,u=t._dataOffset/t._bytesPerComponent,s=t._dataStride/t._bytesPerComponent,l=e._componentsPerVector,c=e._vectorCount;if(void 0===e._firstIndex){for(var f=r,h=0;h<c;h++){if(void 0!==e._data[f]&&0!==e._data[f]){e._firstIndex=h;break}f+=a}f=r+a*(c-1);for(var y=c-1;y>=0;y--){if(void 0!==e._data[f]&&0!==e._data[f]){e._lastIndex=y;break}f-=a}}r+=a*e._firstIndex,u+=s*e._firstIndex;for(var p=e._firstIndex;p<=e._lastIndex;p++){for(var m=0;m<l;m++){var d=e._data[r+m];d&&(t._data[u+m]+=d*i)}r+=a,u+=s}}})},u=0;u<i;u++)a(u);e.geometry.geometrySources.forEach(function(e){var r=n.getGeometrySourcesForSemantic(e.semantic)[0],i=e._dataOffset/e._bytesPerComponent,a=e._dataStride/e._bytesPerComponent,u=r._dataOffset/r._bytesPerComponent,s=r._dataStride/r._bytesPerComponent,l=e._componentsPerVector,c=e._vectorCount;if(t.calculationMode===zh.normalized)for(var f=1-o.get(e.semantic),h=0;h<c;h++){for(var y=0;y<l;y++)r._data[u+y]+=e._data[i+y]*f;i+=a,u+=s}else for(var p=0;p<c;p++){for(var m=0;m<l;m++)r._data[u+m]+=e._data[i+m];i+=a,u+=s}})}}},{key:"_copy",value:function(){var e=new t;return e.targets=this.targets.slice(0),e._weights=this._weights.slice(0),e.calculationMode=this.calculationMode,e}}]),t}();function lp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cp=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"rendererUpdateAtTime",value:function(e,t){}},{key:"rendererDidApplyAnimationsAtTime",value:function(e,t){}},{key:"rendererDidSimulatePhysicsAtTime",value:function(e,t){}},{key:"rendererWillRenderSceneAtTime",value:function(e,t,n){}},{key:"rendererDidRenderSceneAtTime",value:function(e,t,n){}}])&&lp(t.prototype,n),r&&lp(t,r),e}();function fp(e){return(fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hp(e,t){return!t||"object"!==fp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yp(e){return(yp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mp(e,t){return(mp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dp=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=hp(this,yp(o).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=le.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mp(e,t)}(o,Te),t=o,r=[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float"}}}],(n=null)&&pp(t.prototype,n),r&&pp(t,r),o}();function _p(e){return(_p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gp(e,t){return!t||"object"!==_p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vp(e){return(vp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bp(e,t){return(bp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=gp(this,vp(t).call(this))).damping=0,e.decelerationDistance=0,e.maximumLinearAcceleration=0,e.maximumLinearVelocity=0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bp(e,t)}(t,vt),t}();function wp(e){return(wp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tp(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function kp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Op(e,t){return!t||"object"!==wp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cp(e){return(Cp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xp(e,t){return(xp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ep=function(e){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Op(this,Cp(t).call(this,[],[]))).width=1,e.height=n,e.length=r,e.widthSegmentCount=1,e.heightSegmentCount=1,e.lengthSegmentCount=1,e._createGeometry(),e.materials.push(new Gn),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xp(e,t)}(t,Qn),n=t,(r=[{key:"_createGeometry",value:function(){var e=[],t=.5*this.width,n=-t,r=.5*this.length,o=-r,i=this.height;e.push.apply(e,Tp(this._createSideFace(n,r,t,r))),e.push.apply(e,Tp(this._createSideFace(t,r,t,o))),e.push.apply(e,Tp(this._createSideFace(t,o,n,o))),e.push.apply(e,Tp(this._createSideFace(n,o,n,r))),e.push(n,0,o),e.push(0,-1,0),e.push(0,1),e.push(t,0,o),e.push(0,-1,0),e.push(1,1),e.push(n,0,r),e.push(0,-1,0),e.push(0,0),e.push(t,0,r),e.push(0,-1,0),e.push(1,0);for(var a=new tt.a(e,tt.a.Semantic.vertex,20,!0,3,4,0,32),u=new tt.a(e,tt.a.Semantic.normal,20,!0,3,4,12,32),s=new tt.a(e,tt.a.Semantic.texcoord,20,!0,2,4,24,32),l=[],c=[[0,2,3],[4,6,7],[8,10,11],[12,14,15],[16,17,19,16,19,18]],f=0;f<5;f++)l.push(new $n.a(c[f],er.a.triangles));this._geometryElements=l,this._geometrySources=[a,u,s],this.boundingBox={min:new ue.a(n,0,o),max:new ue.a(t,i,r)}}},{key:"_createSideFace",value:function(e,t,n,r){var o=this.height,i=[],a=new ue.a;if(e===n)a.x=o,a.y=e,e<0&&(a.x=-a.x,a.y=-a.y);else{if(t!==r)throw new Error("position inconsistent");a.z=o,a.y=t,t<0&&(a.z=-a.z,a.y=-a.y)}return a=a.normalize(),i.push(e,0,t),i.push(a.x,a.y,a.z),i.push(0,1),i.push(0,this.height,0),i.push(a.x,a.y,a.z),i.push(0,0),i.push(n,0,r),i.push(a.x,a.y,a.z),i.push(1,1),i.push(0,this.height,0),i.push(a.x,a.y,a.z),i.push(1,0),i}}])&&kp(n.prototype,r),o&&kp(n,o),t}();function Pp(e){return(Pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ap(e,t){return!t||"object"!==Pp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Np(e,t,n){return(Np="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rp(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Rp(e){return(Rp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dp(e,t,n){return t&&Fp(e.prototype,t),n&&Fp(e,n),e}function Ip(e,t){return(Ip=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ap(this,Rp(t).call(this)))._actions=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ip(e,t)}(t,Te),Dp(t,null,[{key:"_propTypes",get:function(){return{_actions:"NSArray",_finished:"boolean",_duration:"float",_timingMode:"integer",_beginTime:"float",_isRunning:"boolean",_pausedTime:"float",name:["string",null]}}}]),Dp(t,[{key:"copy",value:function(){var e=Np(Rp(t.prototype),"copy",this).call(this);return e._actions=[],this._actions.forEach(function(t){e._actions.push(t.copy())}),e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._activetimeFromTime(t),o=!0;this._actions.forEach(function(t){t._finished||(t._applyAction(e,r,n),t._finished||(o=!1))}),this._finished=o}},{key:"_resetFinished",value:function(){this._actions.forEach(function(e){e._resetFinished()}),this._finished=!1}},{key:"duration",get:function(){var e=0;return this._actions.forEach(function(t){e<t.duration&&(e=t.duration)}),e}}],[{key:"group",value:function(e){var n=new t;return n._actions=e,n}}]),t}();function jp(e){return(jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bp(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Lp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Up(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vp(e,t,n){return t&&Up(e.prototype,t),n&&Up(e,n),e}function zp(e,t){return!t||"object"!==jp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gp(e,t,n){return(Gp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yp(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Yp(e){return(Yp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xp(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hp(e,t)}function Hp(e,t){return(Hp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Te.group=Mp.group;var Wp={angle:"Angle",angularVelocity:"AngularVelocity",bounce:"Bounce",charge:"Charge",color:"Color",contactNormal:"ContactNormal",contactPoint:"ContactPoint",frame:"Frame",frameRate:"FrameRate",friction:"Friction",life:"Life",opacity:"Opacity",position:"Position",rotationAxis:"RotationAxis",size:"Size",velocity:"Velocity"},Kp=function(e){function t(){var e;return Lp(this,t),(e=zp(this,Yp(t).call(this))).position=null,e.axis=null,e.angle=0,e.size=1,e.baseSize=1,e.color=null,e.velocity=null,e.angularVelocity=0,e.acceleration=null,e.birthTime=0,e.lifeSpan=0,e.imageFrameRate=0,e.initialImageFrame=0,e.texLeft=0,e.texRight=0,e.texTop=0,e.texBottom=0,e._maxParticleIndex=0,e}return Xp(t,J["a"]),Vp(t,[{key:"floatArray",value:function(){var e=[].concat(Bp(this.position.floatArray()),Bp(this.velocity.floatArray()),Bp(this.axis.floatArray()),[this.angle],Bp(this.color.floatArray()),[this.size]);return[].concat(Bp(e),[-1,-1,this.texLeft,this.texTop],Bp(e),[1,-1,this.texRight,this.texTop],Bp(e),[-1,1,this.texLeft,this.texBottom],Bp(e),[1,1,this.texRight,this.texBottom])}},{key:"valueForKeyPath",value:function(e){return"size"===e?this.baseSize:Gp(Yp(t.prototype),"valueForKeyPath",this).call(this,e)}},{key:"float32Array",value:function(){return new Float32Array(this.floatArray())}}]),t}(),Zp=function(e){function t(){var e;arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Lp(this,t),(e=zp(this,Yp(t).call(this))).emissionDuration=1,e.emissionDurationVariation=0,e.idleDuration=0,e.idleDurationVariation=0,e.loops=!0,e.warmupDuration=0,e._birthRate=0,e.birthRateVariation=0,e.emitterShape=null,e.birthLocation=Co.surface,e.birthDirection=yl.constant,e.emittingDirection=new ue.a(0,1,0),e.spreadingAngle=0,e.particleAngle=0,e.particleAngleVariation=0,e.particleVelocity=0,e.particleVelocityVariation=0,e.particleAngularVelocity=0,e.particleAngularVelocityVariation=0,e.particleLifeSpan=1,e.particleLifeSpanVariation=0,e.particleSize=1,e.particleSizeVariation=0,e.particleColor=de.white,e.particleColorVariation=new se.a(0,0,0,0),e.particleImage=null,e.fresnelExponent=0,e.stretchFactor=0,e.imageSequenceRowCount=1,e.imageSequenceColumnCount=1,e.imageSequenceInitialFrame=0,e.imageSequenceInitialFrameVariation=0,e.imageSequenceFrameRate=0,e.imageSequenceFrameRateVariation=0,e.imageSequenceAnimationMode=Af.repeat,e.isAffectedByGravity=!1,e.isAffectedByPhysicsFields=!1,e.colliderNodes=null,e.particleDiesOnCollision=!1,e.acceleration=new ue.a(0,0,0),e.dampingFactor=0,e.particleMass=1,e.particleMassVariation=0,e.particleCharge=0,e.particleChargeVariation=0,e.particleBounce=.7,e.particleBounceVariation=0,e.particleFriction=1,e.particleFrictionVariation=0,e.systemSpawnedOnCollision=null,e.systemSpawnedOnDying=null,e.systemSpawnedOnLiving=null,e.blendMode=Uh.additive,e.orientationMode=af.billboardScreenAligned,e.sortingMode=Jc.none,e.isLightingEnabled=!1,e.isBlackPassEnabled=!1,e.isLocal=!1,e.speedFactor=1,e.propertyControllers=null,e._program=null,e._vertexArray=null,e._vertexBuffer=null,e._indexBuffer=null,e._particles=[],e._glIndexSize=null,e._particleTexture=null,e._finished=!1,e._startTime=null,e._prevTime=0,e._nextBirthTime=0,e._emissionEndTime=0,e._idleEndTime=0,e._numImages=null,e._imageWidth=null,e._imageHeight=null,e.__presentation=null,e._animations=new sn,e._loadedPromise=null,e}return Xp(t,J["a"]),Vp(t,null,[{key:"_propTypes",get:function(){return{emissionDuration:"float",emissionDurationVariation:"float",idleDuration:"float",idleDurationVariation:"float",loops:"boolean",warmupDuration:"float",birthRate:["float","_birthRate"],birthRateVariation:"float",emitterShape:"SCNGeometry",birthLocation:"integer",birthDirection:"integer",emittingDirection:"SCNVector3",spreadingAngle:"float",particleAngle:"float",particleAngleVariation:"float",particleVelocity:"float",particleVelocityVariation:"float",particleAngularVelocity:"float",particleAngularVelocityVariation:"float",particleLifeSpan:"float",particleLifeSpanVariation:"float",particleSize:"float",particleSizeVariation:"float",particleColor:"plist",particleColorVariation:"SCNVector4",particleImage:["NSMutableDictionary",function(e,t,n,r){var o="";void 0!==t.path?o=t.path:void 0!==t.URL&&(o=t.URL),e._loadParticleImage(o,r._directoryPath)}],fresnelExponent:"float",stretchFactor:"float",imageSequenceRowCount:"integer",imageSequenceColumnCount:"integer",imageSequenceInitialFrame:"float",imageSequenceInitialFrameVariation:"float",imageSequenceFrameRate:"float",imageSequenceFrameRateVariation:"float",imageSequenceAnimationMode:"integer",affectedByGravity:["boolean","isAffectedByGravity"],affectedByPhysicsFields:["boolean","isAffectedByPhysicsFields"],colliderNodes:"NSArray",particleDiesOnCollision:"boolean",acceleration:"SCNVector3",dampingFactor:"float",particleMass:"float",particleMassVariation:"float",particleCharge:"float",particleChargeVariation:"float",particleBounce:"float",particleBounceVariation:"float",particleFriction:"float",particleFrictionVariation:"float",systemSpawnedOnCollision:"SCNParticleSystem",systemSpawnedOnDying:"SCNParticleSystem",systemSpawnedOnLiving:"SCNParticleSystem",blendMode:"integer",orientationMode:"integer",sortingMode:"integer",lightingEnabled:["boolean","isLightingEnabled"],blackPassEnabled:["boolean","isBlackPassEnabled"],isLocal:"boolean",speedFactor:"float",propertyControllers:["NSMutableDictionary",function(e,t){Object.keys(Wp).forEach(function(e){var n=t[Wp[e]];void 0!==n&&(n.animation.keyPath=e,"size"===e&&(n.animation._isMultiplicative=!0))}),e.propertyControllers=t}],seed:["integer",null],softParticlesEnabled:["boolean",null],fixedTimeStep:["float",null],renderingMode:["integer",null],physicsCollisionsEnabled:["boolean",null],orientationDirection:["SCNVector3",null],particleIntensity:["float",null],particleIntensityVariation:["float",null]}}}]),Vp(t,[{key:"reset",value:function(){this._finished=!1,this._startTime=null,this._prevTime=0,this._nextBirthTime=0,this._emissionEndTime=0,this._idleEndTime=0,this._particles=[]}},{key:"handleForPropertiesHandler",value:function(e,t,n){}},{key:"addModifierForPropertiesAtModifier",value:function(e,t,n){}},{key:"removeModifiersAt",value:function(e){}},{key:"removeAllModifiers",value:function(){}},{key:"_loadParticleImage",value:function(e,t){var n=this,r=new Image;r.crossOrigin="anonymous";var o=e;return 0===o.indexOf("file:///")&&(o=o.slice(8)),o=o.replace(/\.exr$/,".png"),this._loadedPromise=new Promise(function(e,i){var a=o.split("/"),u=1,s=t+a.slice(-u).join("/");r.onload=function(){n.particleImage=r,e()},r.onerror=function(){(u+=1)>a.length?(r.onerror=function(){i()},r.src=o):(s=t+a.slice(-u).join("/"),r.src=s)},r.src=s}),r}},{key:"_initializeVAO",value:function(e,t){if(null===this._vertexArray){this._vertexArray=e.createVertexArray(),e.bindVertexArray(this._vertexArray),this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer);var n=e.getAttribLocation(t,"position"),r=e.getAttribLocation(t,"velocity"),o=e.getAttribLocation(t,"rotation"),i=e.getAttribLocation(t,"color"),a=e.getAttribLocation(t,"size"),u=e.getAttribLocation(t,"corner"),s=e.getAttribLocation(t,"texcoord");e.enableVertexAttribArray(n),e.vertexAttribPointer(n,3,e.FLOAT,!1,76,0),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,3,e.FLOAT,!1,76,12),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,4,e.FLOAT,!1,76,24),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,4,e.FLOAT,!1,76,40),e.enableVertexAttribArray(a),e.vertexAttribPointer(a,1,e.FLOAT,!1,76,56),e.enableVertexAttribArray(u),e.vertexAttribPointer(u,2,e.FLOAT,!1,76,60),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,76,68);var l=this._maxParticles+5;this._updateIndexBuffer(e,l),this._numImages=this.imageSequenceRowCount*this.imageSequenceColumnCount,this._imageWidth=1/this.imageSequenceColumnCount,this._imageHeight=1/this.imageSequenceRowCount}}},{key:"_updateIndexBuffer",value:function(e,t){for(var n=e,r=[],o=0,i=0;i<t;i++)r.push(o+0),r.push(o+3),r.push(o+2),r.push(o+0),r.push(o+1),r.push(o+3),o+=4;var a=null;o<256?(a=new Uint8Array(r),this._glIndexSize=n.UNSIGNED_BYTE):o<65536?(a=new Uint16Array(r),this._glIndexSize=n.UNSIGNED_SHORT):(a=new Uint32Array(r),this._glIndexSize=n.UNSIGNED_INT),null===this._indexBuffer&&(this._indexBuffer=n.createBuffer()),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indexBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,a,n.STATIC_DRAW),this._maxParticleIndex=t}},{key:"_createParticle",value:function(e,t){var n=new Kp,r=t.getTranslation(),o=this.particleVelocity+this.particleVelocityVariation*(Math.random()-.5),i=this.spreadingAngle/180*Math.PI*Math.random(),a=2*Math.PI*Math.random(),u=It.a.matrixWithRotation(this._normal.x,this._normal.y,this._normal.z,i),s=It.a.matrixWithRotation(this._direction.x,this._direction.y,this._direction.z,a);if(null===this.emitterShape)n.position=r,n.velocity=new ue.a(0,0,o);else if(this.birthLocation===Co.surface){var l=null,c=null;switch(this.emitterShape.className){case"SCNBox":var f=Math.random(),h=Math.random()-.5,y=Math.random()-.5,p=this.emitterShape.width,m=this.emitterShape.height,d=this.emitterShape.length,_=m*d,g=d*p,v=p*m,b=1/(_+g+v),S=_*b,w=g*b,T=v*b;f<.5*S?(l=new ue.a(.5*p,m*h,d*y),c=new ue.a(1,0,0)):f<S?(l=new ue.a(.5*-p,m*h,d*y),c=new ue.a(-1,0,0)):f<S+.5*w?(l=new ue.a(p*h,.5*m,d*y),c=new ue.a(0,1,0)):f<S+w?(l=new ue.a(p*h,.5*-m,d*y),c=new ue.a(0,-1,0)):f<S+w+.5*T?(l=new ue.a(p*h,m*y,.5*d),c=new ue.a(0,0,1)):(l=new ue.a(p*h,m*y,.5*-d),c=new ue.a(0,0,-1));break;case"SCNSphere":var k=new ue.a(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize();l=k.mul(this.emitterShape.radius),c=k;break;case"SCNPlane":l=new ue.a((Math.random()-.5)*this.emitterShape.width,(Math.random()-.5)*this.emitterShape.height,0),c=new ue.a(0,0,1);break;case"SCNCylinder":var O=(Math.random()-.5)*this.emitterShape.height,C=Math.random()*Math.PI*2,x=Math.sin(C),E=Math.cos(C);l=new ue.a(x*this.emitterShape.radius,O,E*this.emitterShape.radius),c=new ue.a(x,0,E);break;case"SCNGeometry":var P=this.emitterShape.geometryElementAtIndex(0),A=this.emitterShape.getGeometrySourcesForSemantic(tt.a.Semantic.vertex)[0],N=this.emitterShape.getGeometrySourcesForSemantic(tt.a.Semantic.normal)[0],R=Math.floor(Math.random()*P.primitiveCount),F=P._indexAt(R),D=F.map(function(e){return A._scnVectorAt(e)}),I=F.map(function(e){return N._scnVectorAt(e)});l=D[0].add(D[1]).add(D[2]).mul(1/3),c=I[0].add(I[1]).add(I[2]).normalize();break;default:throw new Error("surface emitter for ".concat(this.emitterShape.className," is not implemented"))}l=l.rotate(t),n.position=r.add(l),this.birthDirection===yl.surfaceNormal&&(n.velocity=c.rotate(t).normalize().mul(o))}else{if(this.birthLocation!==Co.volume)throw new Error("birthLocation ".concat(this.birthLocation," is not implemented."));var M=null;switch(this.emitterShape.className){case"SCNBox":var j=(Math.random()-.5)*this.emitterShape.width,B=(Math.random()-.5)*this.emitterShape.height,L=(Math.random()-.5)*this.emitterShape.length;M=new ue.a(j,B,L);break;case"SCNSphere":var U=Math.random()*this.emitterShape.radius,V=Math.random()*Math.PI,z=Math.random()*Math.PI*2,G=U*Math.sin(V),Y=G*Math.cos(z),X=G*Math.sin(z),H=U*Math.cos(V);M=new ue.a(Y,X,H);break;default:throw new Error("volume emitter for ".concat(this.emitterShape.className," is not implemented"))}if(M=M.rotate(t),n.position=r.add(M),this.birthDirection===yl.surfaceNormal)throw new Error("combination of birthLocation=volume and birthDirection=surfaceNormal is not implemented.")}switch(this.orientationMode===af.billboardScreenAligned?n.axis=new ue.a(0,0,1):n.axis=new ue.a(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize(),n.angle=(this.particleAngle+this.particleAngleVariation*(Math.random()-.5))/180*Math.PI,n.size=this.particleSize+this.particleSizeVariation*(Math.random()-.5),n.baseSize=n.size,n.color=this._createColor(),this.birthDirection){case yl.constant:n.velocity=this._direction.rotate(u).rotate(s).rotate(t).mul(o);break;case yl.surfaceNormal:break;case yl.random:var W=2*Math.PI*Math.random(),K=It.a.matrixWithRotation(this._normal.x,this._normal.y,this._normal.z,W);n.velocity=this._direction.rotate(K).rotate(s).rotate(t).mul(o);break;default:throw new Error("unknown birth direction: ".concat(this.birthDirection))}n.angularVelocity=(this.particleAngularVelocity+this.particleAngularVelocityVariation*(Math.random()-.5))/180*Math.PI,n.acceleration=this.acceleration._copy(),n.birthTime=e,n.lifeSpan=this.particleLifeSpan+this.particleLifeSpanVariation*(2*Math.random()-1),n.imageFrameRate=this.imageSequenceFrameRate+this.imageSequenceFrameRateVariation*(Math.random()-.5),n.imageFrameRate<0&&(n.imageFrameRate=0);var Z=this.imageSequenceRowCount*this.imageSequenceColumnCount;return n.initialImageFrame=(this.imageSequenceInitialFrame+this.imageSequenceInitialFrameVariation*(Math.random()-.5))%Z,n.initialImageFrame<0&&(n.initialImageFrame+=Z),n}},{key:"_updateParticles",value:function(e,t,n){var r=this;if(this._prevTime<=0){this._prevTime=n,this._nextBirthTime=n,this._startTime=n,this._direction=this.emittingDirection.normalize();var o=new ue.a(this._direction.z,this._direction.x,this._direction.y);this._normal=this._direction.cross(o),this._updateEndTime()}if(this._presentation._birthRate+this.birthRateVariation>0)for(;this._nextBirthTime<=n;){var i=this._createParticle(this._nextBirthTime,e);this._particles.push(i);var a=this._presentation._birthRate+this.birthRateVariation*(Math.random()-.5);a<1e-7&&(a=1e-7),this._nextBirthTime+=1/a,this._nextBirthTime>this._emissionEndTime&&(this._nextBirthTime=this._idleEndTime,this.loops||(this._finished=!0),this._updateEndTime())}var u=(n-this._prevTime)*this.speedFactor,s=1;this.dampingFactor>0&&(s=Math.pow(.01*(100-this.dampingFactor),60*u)),this._particles.forEach(function(e){var o=u,i=(n-e.birthTime)*r.speedFactor;e.birthTime>r._prevTime&&(o=i);var a=i/e.lifeSpan;if(e.life=a,!(a>1)){var l=e.acceleration;null!==t&&r.isAffectedByGravity&&(l=l.add(t)),e.angle+=e.angularVelocity*o,e.velocity.x=(e.velocity.x+l.x*o)*s,e.velocity.y=(e.velocity.y+l.y*o)*s,e.velocity.z=(e.velocity.z+l.z*o)*s,e.position.x+=e.velocity.x*o,e.position.y+=e.velocity.y*o,e.position.z+=e.velocity.z*o,null!==r.propertyControllers&&Object.keys(r.propertyControllers).forEach(function(t){r.propertyControllers[t].animation._applyAnimation(e,a,!1)});var c=e.initialImageFrame+e.imageFrameRate*i,f=0;switch(r.imageSequenceAnimationMode){case Af.repeat:f=Math.floor(c%r._numImages);break;case Af.clamp:var h=Math.floor(c%r._numImages);f=h>=r._numImages-1?r._numImages-1:h;break;case Af.autoReverse:var y=Math.floor(c%(2*r._numImages-2));y>=r._numImages&&(y=2*r._numImages-2-y),f=y;break;default:throw new Error("unknown SCNParticleImageSequenceAnimationMode: "+r.imageSequenceAnimationMode)}var p=Math.floor(f/r.imageSequenceRowCount),m=f%r.imageSequenceColumnCount;e.texLeft=m*r._imageWidth,e.texTop=(p+1)*r._imageHeight,e.texRight=(m+1)*r._imageWidth,e.texBottom=p*r._imageHeight}}),this._particles=this._particles.filter(function(e){return e.life<=1}),this._prevTime=n}},{key:"_updateEndTime",value:function(){var e=0===this._idleEndTime?this._startTime:this._idleEndTime,t=this.emissionDuration+(Math.random()-.5)*this.emissionDurationVariation;t<0&&(t=0),this._emissionEndTime=e+t;var n=this.idleDuration+(Math.random()-.5)*this.idleDurationVariation;n<0&&(n=0),this._idleEndTime=this._emissionEndTime+n}},{key:"_bufferMaterialData",value:function(e,t){null===this._particleTexture&&null!==this.particleImage&&(this._particleTexture=this._createTexture(e,this.particleImage)),null!==this._particleTexture&&(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._particleTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.uniform1i(e.getUniformLocation(t,"orientationMode"),this.orientationMode),e.uniform1f(e.getUniformLocation(t,"stretchFactor"),this.stretchFactor),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this._particleData,e.DYNAMIC_DRAW),this._particles.length>this._maxParticleIndex&&this._updateIndexBuffer(e,this._particles.length+10);var n=[e.ONE,e.ZERO,e.ZERO,e.SRC_ALPHA,e.SRC_ALPHA,e.ONE],r=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ZERO];e.blendFunc(n[this.blendMode],r[this.blendMode])}},{key:"_createTexture",value:function(e,t){var n=e.createTexture(),r=document.createElement("canvas");return r.width=t.naturalWidth,r.height=t.naturalHeight,r.getContext("2d").drawImage(t,0,0),e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t.width,t.height,0,e.RGBA,e.UNSIGNED_BYTE,r),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),n}},{key:"_createColor",value:function(){var e=this._rgb2hsb(this.particleColor);return e.x=(e.x+this.particleColorVariation.x*(2*Math.random()-1))%360,e.x<0&&(e.x+=360),e.y=Math.max(0,Math.min(1,e.y+this.particleColorVariation.y*(Math.random()-.5))),e.z=Math.max(0,Math.min(1,e.z+this.particleColorVariation.z*(Math.random()-.5))),e.w=Math.max(0,Math.min(1,e.w+this.particleColorVariation.w*(Math.random()-.5))),this._hsb2rgb(e)}},{key:"_rgb2hsb",value:function(e){var t=new se.a,n=Math.min(e.red,Math.min(e.green,e.blue)),r=Math.max(e.red,Math.max(e.green,e.blue)),o=r-n;return t.w=e.alpha,t.z=r,0===t.z?(t.x=0,t.y=0,t):(t.y=o/r,0===t.y?(t.x=0,t):(r===e.red?t.x=(60*(e.green-e.blue)/o+360)%360:r===e.green?t.x=60*(e.blue-e.red)/o+120:t.x=60*(e.red-e.green)/o+240,t))}},{key:"_hsb2rgb",value:function(e){if(0===e.y)return new de(e.z,e.z,e.z,e.w);var t=Math.floor(e.x/60),n=e.z,r=e.x/60-t,o=n*(1-e.y),i=n*(1-e.y*r),a=n*(1-e.y*(1-r));switch(t){case 0:return new de(n,a,o,e.w);case 1:return new de(i,n,o,e.w);case 2:return new de(o,n,a,e.w);case 3:return new de(o,i,n,e.w);case 4:return new de(a,o,n,e.w);default:return new de(n,o,i,e.w)}}},{key:"_copy",value:function(){for(var e=new t,n=["_birthRate"],r=0;r<n.length;r++){var o=n[r];e[o]=this[o]}return e}},{key:"_createPresentation",value:function(){if(this.__presentation)return this.__presentation;var e=this._copy();return this.__presentation=e,e}},{key:"addAnimationForKey",value:function(e,t){null==t&&(t=Symbol());var n=e.copy();n._animationStartTime=.001*Date.now(),this._animations.set(t,n)}},{key:"animationForKey",value:function(e){return this._animations.get(e)}},{key:"removeAllAnimations",value:function(){this._animations.clear()}},{key:"removeAnimationForKey",value:function(e){this._animations.delete(e),this._copyTransformToPresentationRecursive()}},{key:"removeAnimationForKeyFadeOutDuration",value:function(e,t){this.removeAnimationForKey(e)}},{key:"pauseAnimationForKey",value:function(e){}},{key:"resumeAnimationForKey",value:function(e){}},{key:"isAnimationPausedForKey",value:function(e){return!1}},{key:"setAnimationSpeedForKey",value:function(e,t){}},{key:"valueForKeyPath",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=n&&this._presentation?this._presentation:this,o=e.split("."),i=o[0];o[1];return"_birthRate"===i?r[i]:Gp(Yp(t.prototype),"valueForKeyPath",this).call(this,e,n)}},{key:"setValueForKeyPath",value:function(e,n){var r=this._presentation?this._presentation:this,o=n.split("."),i=o.shift();o.join(".");"_birthRate"!==i?Gp(Yp(t.prototype),"setValueForKeyPath",this).call(this,e,n):r[i]=e}},{key:"_getLoadedPromise",value:function(){return this._loadedPromise?this._loadedPromise:Promise.resolve()}},{key:"_particleData",get:function(){var e=[];return this._particles.forEach(function(t){e.push.apply(e,Bp(t.floatArray()))}),new Float32Array(e)}},{key:"_maxParticles",get:function(){var e=this._birthRate+.5*this.birthRateVariation,t=this.particleLifeSpan+.5*this.particleLifeSpanVariation;return Math.ceil(e*t)}},{key:"birthRate",get:function(){return this._birthRate},set:function(e){var t=this._birthRate;this._birthRate=e,kn._addChange(this,"_birthRate",t,e)}},{key:"animationKeys",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var o,i=this._animations.keys()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"_presentation",get:function(){return this.__presentation?this.__presentation:this}},{key:"didLoad",get:function(){return this._getLoadedPromise()}}],[{key:"systemNamedInDirectory",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==e){var r=e;return null!==n&&(r="".concat(n,"/").concat(e)),F.get(r).then(function(e){var n=Ei.a.unarchiveObjectWithData(e,r);if(!Object(w.a)(n,t))throw new Error("file ".concat(r," is not an instance of SCNParticleSystem"));return n._loadedPromise=Promise.resolve(n),n})}return null}},{key:"ParticleProperty",get:function(){return Wp}}]),t}(),qp=function(e,t){return Math.abs(e.x-t.x)<1e-5&&Math.abs(e.y-t.y)<1e-5&&Math.abs(e.z-t.z)<1e-5};function Jp(e){return(Jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qp(e,t){return!t||"object"!==Jp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $p(e){return($p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function em(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tm(e,t){return(tm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nm=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=Qp(this,$p(o).call(this)))._icc=null,e._spaceID=null,e._id=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tm(e,t)}(o,J["a"]),t=o,r=[{key:"_propTypes",get:function(){return{NSICC:["NSMutableData","_icc"],NSSpaceID:["integer","_spaceID"],NSID:["integer","_id"]}}}],(n=null)&&em(t.prototype,n),r&&em(t,r),o}(),rm=n(18),om=n(20);function im(e){return(im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function am(e,t){return!t||"object"!==im(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function um(e){return(um=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sm(e,t){return(sm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),am(this,um(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sm(e,t)}(t,om["a"]),t}();function cm(e){return(cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hm(e,t){return!t||"object"!==cm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ym(e){return(ym=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pm(e,t){return(pm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),hm(this,ym(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pm(e,t)}(t,J["a"]),n=t,o=[{key:"initWithCoder",value:function(e){var t={};if(void 0!==e._refObj["NS.objects"]){var n=e._refObj["NS.keys"],r=e._refObj["NS.objects"];if(!Array.isArray(n))throw new Error("NS.keys must be Array");if(!Array.isArray(r))throw new Error("NS.objects must be Array");if(n.length!==r.length)throw new Error("NS.keys.length !== NS.objects.length");var o=e.copy();o._refObj=n;var i=e.copy();i._refObj=r;for(var a=0;a<n.length;a++){var u=o.decodeObjectForKey(a),s=i.decodeObjectForKey(a);t[u]=s}}else for(var l=0;;l++){var c="NS.object.".concat(l),f="NS.key.".concat(l);if(void 0===e._refObj[c])break;var h=e.decodeObjectForKey(f),y=e.decodeObjectForKey(c);t[h]=y}return t}}],(r=null)&&fm(n.prototype,r),o&&fm(n,o),t}();function dm(e){return(dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _m(e,t){return!t||"object"!==dm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gm(e){return(gm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vm(e,t){return(vm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_m(this,gm(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vm(e,t)}(t,mm),t}();function Sm(e){return(Sm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tm(e,t){return!t||"object"!==Sm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function km(e){return(km=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Om(e,t){return(Om=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Cm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tm(this,km(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Om(e,t)}(t,J["a"]),n=t,o=[{key:"initWithCoder",value:function(e){e._refObj["NS.base"].obj;var t=e._refObj["NS.relative"].obj;return t.indexOf(":")<0&&(t=e._directoryPath+t),t}}],(r=null)&&wm(n.prototype,r),o&&wm(n,o),t}();function xm(e){return(xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Em(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pm(e,t){return!t||"object"!==xm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Am(e){return(Am=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nm(e,t){return(Nm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rm=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Pm(this,Am(t).call(this))).outputFormat=null,e.requiresSecureCoding=!1,e.delegate=null,e._encodedData=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nm(e,t)}(t,rm["a"]),n=t,o=[{key:"archiverForWritingWithData",value:function(e){return new t}},{key:"archivedDataWithRootObject",value:function(e){return null}},{key:"archiveRootObjectToFile",value:function(e,t){return!1}},{key:"setClassNameFor",value:function(e,t){}},{key:"classNameFor",value:function(e){return null}}],(r=[{key:"finishEncoding",value:function(){}},{key:"encodeForKey",value:function(e,t){}},{key:"encodeBytesLengthForKey",value:function(e,t,n){}},{key:"encodeConditionalObjectForKey",value:function(e,t){}},{key:"encodedData",get:function(){return this._encodedData}}])&&Em(n.prototype,r),o&&Em(n,o),t}();function Fm(e){return(Fm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dm(e,t){return!t||"object"!==Fm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Im(e){return(Im=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jm(e,t,n){return t&&Mm(e.prototype,t),n&&Mm(e,n),e}function Bm(e,t){return(Bm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lm=new RegExp(/^\{\{([-.0-9]+),\s*([-.0-9]+)\},\s*\{([-.0-9]+),\s*([-.0-9]+)\}\}$/),Um=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Dm(this,Im(t).call(this)))._objCType=null,n._pointerValue=null,n._nonretainedObjectValue=null,n._rangeValue=null,n._pointValue=null,n._sizeValue=null,n._rectValue=null,n._cgPointValue=null,n._cgVectorValue=null,n._cgSizeValue=null,n._cgRectValue=null,n._cgAffineTransformValue=null,n._uiEdgeInsetsValue=null,n._uiOffsetValue=null,n._caTransform3DValue=null,n._timeValue=null,n._timeRangeValue=null,n._timeMappingValue=null,n._mkCoordinateValue=null,n._mkCoordinateSpanValue=null,n._scnVector3Value=null,n._scnVector4Value=null,n._scnMatrix4Value=null,n._edgeInsetsValue=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bm(e,t)}(t,J["a"]),jm(t,[{key:"initBytesObjCType",value:function(e,t){}},{key:"initWithObjCType",value:function(e,t){}},{key:"getValue",value:function(e){}},{key:"objCType",get:function(){return this._objCType}}],[{key:"initWithCoder",value:function(e){e._refObj["NS.special"];var t=e._refObj["NS.sizeval"];if(t){var n=t.obj;if("{"!==n.charAt(0)||"}"!==n.charAt(t.length-1))throw new Error("unknown NSValue size format: ".concat(n));var r=n.slice(1,-1).split(",").map(parseFloat);return new a.a(r[0],r[1])}var o=e._refObj["NS.rectval"];if(o){var u=o.obj,s=u.match(Lm);if(!s)throw new Error("unknown NSValue rect format: ".concat(u));var l=s.slice(1,5).map(parseFloat),f=new c.a(l[0],l[1]),h=new a.a(l[2],l[3]);return new i.a(f,h)}throw new Error("unknown NSValue type")}}]),jm(t,[{key:"initNonretainedObject",value:function(e){}},{key:"initCgPoint",value:function(e){}},{key:"initCgVector",value:function(e){}},{key:"initCgSize",value:function(e){}},{key:"initCgRect",value:function(e){}},{key:"initCgAffineTransform",value:function(e){}},{key:"initUiEdgeInsets",value:function(e){}},{key:"initUiOffset",value:function(e){}},{key:"initCaTransform3D",value:function(e){}},{key:"initMkCoordinate",value:function(e){}},{key:"initMkCoordinateSpan",value:function(e){}},{key:"initScnVector3",value:function(e){}},{key:"initScnVector4",value:function(e){}},{key:"initScnMatrix4",value:function(e){}},{key:"isEqualTo",value:function(e){return!1}},{key:"initCoder",value:function(e){}},{key:"initEdgeInsets",value:function(e){}},{key:"pointerValue",get:function(){return this._pointerValue}},{key:"nonretainedObjectValue",get:function(){return this._nonretainedObjectValue}},{key:"rangeValue",get:function(){return this._rangeValue}},{key:"pointValue",get:function(){return this._pointValue}},{key:"sizeValue",get:function(){return this._sizeValue}},{key:"rectValue",get:function(){return this._rectValue}},{key:"cgPointValue",get:function(){return this._cgPointValue}},{key:"cgVectorValue",get:function(){return this._cgVectorValue}},{key:"cgSizeValue",get:function(){return this._cgSizeValue}},{key:"cgRectValue",get:function(){return this._cgRectValue}},{key:"cgAffineTransformValue",get:function(){return this._cgAffineTransformValue}},{key:"uiEdgeInsetsValue",get:function(){return this._uiEdgeInsetsValue}},{key:"uiOffsetValue",get:function(){return this._uiOffsetValue}},{key:"caTransform3DValue",get:function(){return this._caTransform3DValue}},{key:"timeValue",get:function(){return this._timeValue}},{key:"timeRangeValue",get:function(){return this._timeRangeValue}},{key:"timeMappingValue",get:function(){return this._timeMappingValue}},{key:"mkCoordinateValue",get:function(){return this._mkCoordinateValue}},{key:"mkCoordinateSpanValue",get:function(){return this._mkCoordinateSpanValue}},{key:"scnVector3Value",get:function(){return this._scnVector3Value}},{key:"scnVector4Value",get:function(){return this._scnVector4Value}},{key:"scnMatrix4Value",get:function(){return this._scnMatrix4Value}},{key:"edgeInsetsValue",get:function(){return this._edgeInsetsValue}}]),t}();function Vm(e){return(Vm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gm(e,t){return!t||"object"!==Vm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ym(e){return(Ym=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xm(e,t){return(Xm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Gm(this,Ym(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xm(e,t)}(t,J["a"]),n=t,o=[{key:"initWithCoder",value:function(e){var t=[];if(void 0!==e._refObj["NS.objects"]){var n=e._refObj["NS.objects"];if(!Array.isArray(n))throw new Error("NS.objects must be Array");var r=e.copy();r._refObj=n;for(var o=0;o<n.length;o++){var i=r.decodeObjectForKey(o);t.push(i)}}else for(var a=0;;a++){var u="NS.object.".concat(a);if(void 0===e._refObj[u])break;var s=e.decodeObjectForKey(u);t.push(s)}return t}}],(r=null)&&zm(n.prototype,r),o&&zm(n,o),t}();function Wm(e){return(Wm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Km(e,t){return!t||"object"!==Wm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zm(e){return(Zm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jm(e,t,n){return t&&qm(e.prototype,t),n&&qm(e,n),e}function Qm(e,t){return(Qm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $m={AVAudioEngineConfigurationChange:Symbol(),AVAudioSessionInterruption:Symbol(),AVAudioSessionMediaServicesWereLost:Symbol(),AVAudioSessionMediaServicesWereReset:Symbol(),AVAudioSessionRouteChange:Symbol(),AVAudioSessionSilenceSecondaryAudioHint:Symbol(),AVAudioUnitComponentTagsDidChange:Symbol(),CKAccountChanged:Symbol(),CLKComplicationServerActiveComplicationsDidChange:Symbol(),CNContactStoreDidChange:Symbol(),EKEventStoreChanged:Symbol(),HKUserPreferencesDidChange:Symbol(),HMCharacteristicPropertySupportsEvent:Symbol(),NSBundleResourceRequestLowDiskSpace:Symbol(),NSCalendarDayChanged:Symbol(),NSDidBecomeSingleThreaded:Symbol(),NSExtensionHostDidBecomeActive:Symbol(),NSExtensionHostDidEnterBackground:Symbol(),NSExtensionHostWillEnterForeground:Symbol(),NSExtensionHostWillResignActive:Symbol(),NSFileHandleConnectionAccepted:Symbol(),NSFileHandleDataAvailable:Symbol(),NSFileHandleReadToEndOfFileCompletion:Symbol(),NSHTTPCookieManagerAcceptPolicyChanged:Symbol(),NSHTTPCookieManagerCookiesChanged:Symbol(),NSManagedObjectContextDidSave:Symbol(),NSManagedObjectContextObjectsDidChange:Symbol(),NSManagedObjectContextWillSave:Symbol(),NSMetadataQueryDidFinishGathering:Symbol(),NSMetadataQueryDidStartGathering:Symbol(),NSMetadataQueryDidUpdate:Symbol(),NSMetadataQueryGatheringProgress:Symbol(),NSPersistentStoreCoordinatorStoresDidChange:Symbol(),NSPersistentStoreCoordinatorStoresWillChange:Symbol(),NSPersistentStoreCoordinatorWillRemoveStore:Symbol(),NSProcessInfoPowerStateDidChange:Symbol(),NSSystemClockDidChange:Symbol(),NSSystemTimeZoneDidChange:Symbol(),NSThreadWillExit:Symbol(),NSURLCredentialStorageChanged:Symbol(),NSUbiquityIdentityDidChange:Symbol(),NSUndoManagerCheckpoint:Symbol(),NSUndoManagerDidCloseUndoGroup:Symbol(),NSUndoManagerDidOpenUndoGroup:Symbol(),NSUndoManagerDidRedoChange:Symbol(),NSUndoManagerDidUndoChange:Symbol(),NSUndoManagerWillCloseUndoGroup:Symbol(),NSUndoManagerWillRedoChange:Symbol(),NSUndoManagerWillUndoChange:Symbol(),NSWillBecomeMultiThreaded:Symbol(),PKPassLibraryDidChange:Symbol(),PKPassLibraryRemotePaymentPassesDidChange:Symbol(),UIAccessibilityAnnouncementDidFinish:Symbol(),UIAccessibilityElementFocused:Symbol(),WKAudioFilePlayerItemDidPlayToEndTime:Symbol(),WKAudioFilePlayerItemFailedToPlayToEndTime:Symbol(),WKAudioFilePlayerItemTimeJumped:Symbol(),ABPeoplePickerDisplayedPropertyDidChange:Symbol(),ABPeoplePickerGroupSelectionDidChange:Symbol(),ABPeoplePickerNameSelectionDidChange:Symbol(),ABPeoplePickerValueSelectionDidChange:Symbol(),ACAccountStoreDidChange:Symbol(),AVAssetChapterMetadataGroupsDidChange:Symbol(),AVAssetContainsFragmentsDidChange:Symbol(),AVAssetDurationDidChange:Symbol(),AVAssetMediaSelectionGroupsDidChange:Symbol(),AVAssetTrackSegmentsDidChange:Symbol(),AVAssetTrackTimeRangeDidChange:Symbol(),AVAssetTrackTrackAssociationsDidChange:Symbol(),AVAssetWasDefragmented:Symbol(),AVCaptureDeviceWasConnected:Symbol(),AVCaptureDeviceWasDisconnected:Symbol(),AVCaptureInputPortFormatDescriptionDidChange:Symbol(),AVCaptureSessionDidStartRunning:Symbol(),AVCaptureSessionDidStopRunning:Symbol(),AVCaptureSessionRuntimeError:Symbol(),AVFragmentedMovieContainsMovieFragmentsDidChange:Symbol(),AVFragmentedMovieDurationDidChange:Symbol(),AVFragmentedMovieTrackSegmentsDidChange:Symbol(),AVFragmentedMovieTrackTimeRangeDidChange:Symbol(),AVFragmentedMovieTrackTotalSampleDataLengthDidChange:Symbol(),AVFragmentedMovieWasDefragmented:Symbol(),AVPlayerItemDidPlayToEndTime:Symbol(),AVPlayerItemFailedToPlayToEndTime:Symbol(),AVPlayerItemNewAccessLogEntry:Symbol(),AVPlayerItemNewErrorLogEntry:Symbol(),AVPlayerItemPlaybackStalled:Symbol(),AVPlayerItemTimeJumped:Symbol(),AVSampleBufferDisplayLayerFailedToDecode:Symbol(),CWBSSIDDidChange:Symbol(),CWCountryCodeDidChange:Symbol(),CWLinkDidChange:Symbol(),CWLinkQualityDidChange:Symbol(),CWModeDidChange:Symbol(),CWPowerDidChange:Symbol(),CWSSIDDidChange:Symbol(),CWScanCacheDidUpdate:Symbol(),GCControllerDidConnect:Symbol(),GCControllerDidDisconnect:Symbol(),IKFilterBrowserFilterDoubleClick:Symbol(),IKFilterBrowserFilterSelected:Symbol(),IKFilterBrowserWillPreviewFilter:Symbol(),IOBluetoothHostControllerPoweredOff:Symbol(),IOBluetoothHostControllerPoweredOn:Symbol(),IOBluetoothL2CAPChannelPublished:Symbol(),IOBluetoothL2CAPChannelTerminated:Symbol(),MKAnnotationCalloutInfoDidChange:Symbol(),NEFilterConfigurationDidChange:Symbol(),NEVPNConfigurationChange:Symbol(),NEVPNStatusDidChange:Symbol(),announcementRequested:Symbol(),applicationActivated:Symbol(),applicationDeactivated:Symbol(),applicationHidden:Symbol(),applicationShown:Symbol(),created:Symbol(),drawerCreated:Symbol(),focusedUIElementChanged:Symbol(),focusedWindowChanged:Symbol(),helpTagCreated:Symbol(),layoutChanged:Symbol(),mainWindowChanged:Symbol(),moved:Symbol(),resized:Symbol(),rowCollapsed:Symbol(),rowCountChanged:Symbol(),rowExpanded:Symbol(),selectedCellsChanged:Symbol(),selectedChildrenChanged:Symbol(),selectedChildrenMoved:Symbol(),selectedColumnsChanged:Symbol(),selectedRowsChanged:Symbol(),selectedTextChanged:Symbol(),sheetCreated:Symbol(),titleChanged:Symbol(),uiElementDestroyed:Symbol(),unitsChanged:Symbol(),valueChanged:Symbol(),windowCreated:Symbol(),windowDeminiaturized:Symbol(),windowMiniaturized:Symbol(),windowMoved:Symbol(),windowResized:Symbol(),progressMarkNotification:Symbol(),antialiasThresholdChangedNotification:Symbol(),NSAppleEventManagerWillProcessFirstEvent:Symbol(),didBecomeActiveNotification:Symbol(),didChangeOcclusionStateNotification:Symbol(),didChangeScreenParametersNotification:Symbol(),didFinishLaunchingNotification:Symbol(),didFinishRestoringWindowsNotification:Symbol(),didHideNotification:Symbol(),didResignActiveNotification:Symbol(),didUnhideNotification:Symbol(),didUpdateNotification:Symbol(),willBecomeActiveNotification:Symbol(),willFinishLaunchingNotification:Symbol(),willHideNotification:Symbol(),willResignActiveNotification:Symbol(),willTerminateNotification:Symbol(),willUnhideNotification:Symbol(),willUpdateNotification:Symbol(),columnConfigurationDidChangeNotification:Symbol(),NSClassDescriptionNeededForClass:Symbol(),didChangeNotification:Symbol(),colorDidChangeNotification:Symbol(),selectionDidChangeNotification:Symbol(),selectionIsChangingNotification:Symbol(),willDismissNotification:Symbol(),willPopUpNotification:Symbol(),contextHelpModeDidActivateNotification:Symbol(),contextHelpModeDidDeactivateNotification:Symbol(),textDidBeginEditingNotification:Symbol(),textDidChangeNotification:Symbol(),textDidEndEditingNotification:Symbol(),currentControlTintDidChangeNotification:Symbol(),didCloseNotification:Symbol(),didOpenNotification:Symbol(),willCloseNotification:Symbol(),willOpenNotification:Symbol(),fontSetChangedNotification:Symbol(),registryDidChangeNotification:Symbol(),didAddItemNotification:Symbol(),didBeginTrackingNotification:Symbol(),didChangeItemNotification:Symbol(),didEndTrackingNotification:Symbol(),didRemoveItemNotification:Symbol(),didSendActionNotification:Symbol(),willSendActionNotification:Symbol(),columnDidMoveNotification:Symbol(),columnDidResizeNotification:Symbol(),itemDidCollapseNotification:Symbol(),itemDidExpandNotification:Symbol(),itemWillCollapseNotification:Symbol(),itemWillExpandNotification:Symbol(),NSPersistentStoreDidImportUbiquitousContentChanges:Symbol(),didShowNotification:Symbol(),willShowNotification:Symbol(),preferredScrollerStyleDidChangeNotification:Symbol(),rowsDidChangeNotification:Symbol(),colorSpaceDidChangeNotification:Symbol(),didEndLiveMagnifyNotification:Symbol(),didEndLiveScrollNotification:Symbol(),didLiveScrollNotification:Symbol(),willStartLiveMagnifyNotification:Symbol(),willStartLiveScrollNotification:Symbol(),didChangeAutomaticCapitalizationNotification:Symbol(),didChangeAutomaticDashSubstitutionNotification:Symbol(),didChangeAutomaticPeriodSubstitutionNotification:Symbol(),didChangeAutomaticQuoteSubstitutionNotification:Symbol(),didChangeAutomaticSpellingCorrectionNotification:Symbol(),didChangeAutomaticTextReplacementNotification:Symbol(),didResizeSubviewsNotification:Symbol(),willResizeSubviewsNotification:Symbol(),systemColorsDidChangeNotification:Symbol(),selectedAlternativeStringNotification:Symbol(),didBeginEditingNotification:Symbol(),didEndEditingNotification:Symbol(),keyboardSelectionDidChangeNotification:Symbol(),NSTextStorageDidProcessEditing:Symbol(),NSTextStorageWillProcessEditing:Symbol(),didChangeSelectionNotification:Symbol(),didChangeTypingAttributesNotification:Symbol(),willChangeNotifyingTextViewNotification:Symbol(),willAddItemNotification:Symbol(),boundsDidChangeNotification:Symbol(),didUpdateTrackingAreasNotification:Symbol(),frameDidChangeNotification:Symbol(),globalFrameDidChangeNotification:Symbol(),didBecomeKeyNotification:Symbol(),didBecomeMainNotification:Symbol(),didChangeBackingPropertiesNotification:Symbol(),didChangeScreenNotification:Symbol(),didChangeScreenProfileNotification:Symbol(),didDeminiaturizeNotification:Symbol(),didEndLiveResizeNotification:Symbol(),didEndSheetNotification:Symbol(),didEnterFullScreenNotification:Symbol(),didEnterVersionBrowserNotification:Symbol(),didExitFullScreenNotification:Symbol(),didExitVersionBrowserNotification:Symbol(),didExposeNotification:Symbol(),didMiniaturizeNotification:Symbol(),didMoveNotification:Symbol(),didResignKeyNotification:Symbol(),didResignMainNotification:Symbol(),didResizeNotification:Symbol(),willBeginSheetNotification:Symbol(),willEnterFullScreenNotification:Symbol(),willEnterVersionBrowserNotification:Symbol(),willExitFullScreenNotification:Symbol(),willExitVersionBrowserNotification:Symbol(),willMiniaturizeNotification:Symbol(),willMoveNotification:Symbol(),willStartLiveResizeNotification:Symbol(),accessibilityDisplayOptionsDidChangeNotification:Symbol(),activeSpaceDidChangeNotification:Symbol(),didActivateApplicationNotification:Symbol(),didChangeFileLabelsNotification:Symbol(),didDeactivateApplicationNotification:Symbol(),didHideApplicationNotification:Symbol(),didLaunchApplicationNotification:Symbol(),didMountNotification:Symbol(),didPerformFileOperationNotification:Symbol(),didRenameVolumeNotification:Symbol(),didTerminateApplicationNotification:Symbol(),didUnhideApplicationNotification:Symbol(),didUnmountNotification:Symbol(),didWakeNotification:Symbol(),screensDidSleepNotification:Symbol(),screensDidWakeNotification:Symbol(),sessionDidBecomeActiveNotification:Symbol(),sessionDidResignActiveNotification:Symbol(),willLaunchApplicationNotification:Symbol(),willPowerOffNotification:Symbol(),willSleepNotification:Symbol(),willUnmountNotification:Symbol(),PDFDocumentDidBeginFind:Symbol(),PDFDocumentDidBeginPageFind:Symbol(),PDFDocumentDidBeginPageWrite:Symbol(),PDFDocumentDidBeginWrite:Symbol(),PDFDocumentDidEndFind:Symbol(),PDFDocumentDidEndPageFind:Symbol(),PDFDocumentDidEndPageWrite:Symbol(),PDFDocumentDidEndWrite:Symbol(),PDFDocumentDidFindMatch:Symbol(),PDFDocumentDidUnlock:Symbol(),PDFThumbnailViewDocumentEdited:Symbol(),PDFViewAnnotationHit:Symbol(),PDFViewAnnotationWillHit:Symbol(),PDFViewChangedHistory:Symbol(),PDFViewCopyPermission:Symbol(),PDFViewDisplayBoxChanged:Symbol(),PDFViewDisplayModeChanged:Symbol(),PDFViewDocumentChanged:Symbol(),PDFViewPageChanged:Symbol(),PDFViewPrintPermission:Symbol(),PDFViewScaleChanged:Symbol(),PDFViewSelectionChanged:Symbol(),PDFViewVisiblePagesChanged:Symbol(),QCCompositionPickerPanelDidSelectComposition:Symbol(),QCCompositionPickerViewDidSelectComposition:Symbol(),QCCompositionRepositoryDidUpdate:Symbol(),QCViewDidStartRendering:Symbol(),QCViewDidStopRendering:Symbol(),WebHistoryAllItemsRemoved:Symbol(),WebHistoryItemChanged:Symbol(),WebHistoryItemsAdded:Symbol(),WebHistoryItemsRemoved:Symbol(),WebHistoryLoaded:Symbol(),WebHistorySaved:Symbol(),WebPreferencesChanged:Symbol(),WebViewDidBeginEditing:Symbol(),WebViewDidChange:Symbol(),WebViewDidChangeSelection:Symbol(),WebViewDidChangeTypingStyle:Symbol(),WebViewDidEndEditing:Symbol(),WebViewProgressEstimateChanged:Symbol(),WebViewProgressFinished:Symbol(),WebViewProgressStarted:Symbol(),abDatabaseChanged:Symbol(),abDatabaseChangedExternally:Symbol(),quartzFilterManagerDidAddFilter:Symbol(),quartzFilterManagerDidModifyFilter:Symbol(),quartzFilterManagerDidRemoveFilter:Symbol(),quartzFilterManagerDidSelectFilter:Symbol(),EAAccessoryDidConnect:Symbol(),EAAccessoryDidDisconnect:Symbol(),MPMovieDurationAvailable:Symbol(),MPMovieMediaTypesAvailable:Symbol(),MPMovieNaturalSizeAvailable:Symbol(),MPMoviePlayerDidEnterFullscreen:Symbol(),MPMoviePlayerDidExitFullscreen:Symbol(),MPMoviePlayerIsAirPlayVideoActiveDidChange:Symbol(),MPMoviePlayerLoadStateDidChange:Symbol(),MPMoviePlayerNowPlayingMovieDidChange:Symbol(),MPMoviePlayerPlaybackDidFinish:Symbol(),MPMoviePlayerPlaybackStateDidChange:Symbol(),MPMoviePlayerReadyForDisplayDidChange:Symbol(),MPMoviePlayerScalingModeDidChange:Symbol(),MPMoviePlayerThumbnailImageRequestDidFinish:Symbol(),MPMoviePlayerTimedMetadataUpdated:Symbol(),MPMoviePlayerWillEnterFullscreen:Symbol(),MPMoviePlayerWillExitFullscreen:Symbol(),MPMovieSourceTypeAvailable:Symbol(),SKCloudServiceCapabilitiesDidChange:Symbol(),SKStorefrontIdentifierDidChange:Symbol(),TVTopShelfItemsDidChange:Symbol(),UIAccessibilityAssistiveTouchStatusDidChange:Symbol(),UIAccessibilityBoldTextStatusDidChange:Symbol(),UIAccessibilityClosedCaptioningStatusDidChange:Symbol(),UIAccessibilityDarkerSystemColorsStatusDidChange:Symbol(),UIAccessibilityGrayscaleStatusDidChange:Symbol(),UIAccessibilityGuidedAccessStatusDidChange:Symbol(),UIAccessibilityHearingDevicePairedEarDidChange:Symbol(),UIAccessibilityInvertColorsStatusDidChange:Symbol(),UIAccessibilityMonoAudioStatusDidChange:Symbol(),UIAccessibilityReduceMotionStatusDidChange:Symbol(),UIAccessibilityReduceTransparencyStatusDidChange:Symbol(),UIAccessibilityShakeToUndoDidChange:Symbol(),UIAccessibilitySpeakScreenStatusDidChange:Symbol(),UIAccessibilitySpeakSelectionStatusDidChange:Symbol(),UIAccessibilitySwitchControlStatusDidChange:Symbol(),UIApplicationDidBecomeActive:Symbol(),UIApplicationDidEnterBackground:Symbol(),UIApplicationDidFinishLaunching:Symbol(),UIApplicationDidReceiveMemoryWarning:Symbol(),UIApplicationSignificantTimeChange:Symbol(),UIApplicationUserDidTakeScreenshot:Symbol(),UIApplicationWillEnterForeground:Symbol(),UIApplicationWillResignActive:Symbol(),UIApplicationWillTerminate:Symbol(),UIContentSizeCategoryDidChange:Symbol(),UIDeviceProximityStateDidChange:Symbol(),UIScreenBrightnessDidChange:Symbol(),UIScreenDidConnect:Symbol(),UIScreenDidDisconnect:Symbol(),UIScreenModeDidChange:Symbol(),UITableViewSelectionDidChange:Symbol(),UITextFieldTextDidBeginEditing:Symbol(),UITextFieldTextDidChange:Symbol(),UITextFieldTextDidEndEditing:Symbol(),UITextInputCurrentInputModeDidChange:Symbol(),UITextViewTextDidBeginEditing:Symbol(),UITextViewTextDidChange:Symbol(),UITextViewTextDidEndEditing:Symbol(),UIViewControllerShowDetailTargetDidChange:Symbol(),UIWindowDidBecomeHidden:Symbol(),UIWindowDidBecomeKey:Symbol(),UIWindowDidBecomeVisible:Symbol(),UIWindowDidResignKey:Symbol(),ALAssetsLibraryChanged:Symbol(),AVCaptureDeviceSubjectAreaDidChange:Symbol(),AVCaptureSessionInterruptionEnded:Symbol(),AVCaptureSessionWasInterrupted:Symbol(),CTRadioAccessTechnologyDidChange:Symbol(),MFMessageComposeViewControllerTextMessageAvailabilityDidChange:Symbol(),MPMediaLibraryDidChange:Symbol(),MPMediaPlaybackIsPreparedToPlayDidChange:Symbol(),MPMusicPlayerControllerNowPlayingItemDidChange:Symbol(),MPMusicPlayerControllerPlaybackStateDidChange:Symbol(),MPMusicPlayerControllerVolumeDidChange:Symbol(),MPVolumeViewWirelessRouteActiveDidChange:Symbol(),MPVolumeViewWirelessRoutesAvailableDidChange:Symbol(),NKIssueDownloadCompleted:Symbol(),UIApplicationBackgroundRefreshStatusDidChange:Symbol(),UIApplicationDidChangeStatusBarFrame:Symbol(),UIApplicationDidChangeStatusBarOrientation:Symbol(),UIApplicationWillChangeStatusBarFrame:Symbol(),UIApplicationWillChangeStatusBarOrientation:Symbol(),UIDeviceBatteryLevelDidChange:Symbol(),UIDeviceBatteryStateDidChange:Symbol(),UIDeviceOrientationDidChange:Symbol(),UIDocumentStateChanged:Symbol(),UIKeyboardDidChangeFrame:Symbol(),UIKeyboardDidHide:Symbol(),UIKeyboardDidShow:Symbol(),UIKeyboardWillChangeFrame:Symbol(),UIKeyboardWillHide:Symbol(),UIKeyboardWillShow:Symbol(),UIMenuControllerDidHideMenu:Symbol(),UIMenuControllerDidShowMenu:Symbol(),UIMenuControllerMenuFrameDidChange:Symbol(),UIMenuControllerWillHideMenu:Symbol(),UIMenuControllerWillShowMenu:Symbol(),UIPasteboardChanged:Symbol(),UIPasteboardRemoved:Symbol(),UIApplicationProtectedDataDidBecomeAvailable:Symbol(),UIApplicationProtectedDataWillBecomeUnavailable:Symbol(),didChangeAutomaticTextCompletionNotification:Symbol(),MPMusicPlayerControllerQueueDidChange:Symbol(),GKPlayerAuthenticationDidChangeNotificationName:Symbol(),GKPlayerDidChangeNotificationName:Symbol(),NEDNSProxyConfigurationDidChange:Symbol(),SKStorefrontCountryCodeDidChange:Symbol(),UIAccessibilityVoiceOverStatusDidChange:Symbol(),UIFocusDidUpdate:Symbol(),UIFocusMovementDidFail:Symbol()},ed=function(e){function t(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Km(this,Zm(t).call(this)))._name=e,r._object=n,r._userInfo=o,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qm(e,t)}(t,J["a"]),Jm(t,[{key:"initCoder",value:function(e){}},{key:"initNameObject",value:function(e,t){}}]),Jm(t,[{key:"name",get:function(){return this._name}},{key:"object",get:function(){return this._object}},{key:"userInfo",get:function(){return this._userInfo}}],[{key:"Name",get:function(){return $m}}]),t}();function td(e){return(td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rd(e,t){return!t||"object"!==td(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function od(e){return(od=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function id(e,t){return(id=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ad=null,ud=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rd(this,od(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&id(e,t)}(t,J["a"]),n=t,o=[{key:"default",get:function(){return null===ad&&(ad=new t),ad}}],(r=[{key:"addObserverForNameObjectUsing",value:function(e,t,n,r){return null}},{key:"addObserverSelectorNameObject",value:function(e,t,n,r){var o=t.bind(e);n===ed.Name.GCControllerDidConnect&&(window.addEventListener("gamepadconnected",function(e){var t=Hy.getController(e.gamepad);t&&o(new ed(n,t,r))}),window.addEventListener("gamepaddisconnected",function(e){var t=Hy.getController(e.gamepad);t&&o(new ed(n,t,r))}))}},{key:"removeObserver",value:function(e){}},{key:"removeObserverNameObject",value:function(e,t,n){}},{key:"post",value:function(e){}},{key:"postNameObject",value:function(e,t){}},{key:"postNameObjectUserInfo",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]}}])&&nd(n.prototype,r),o&&nd(n,o),t}();function sd(e){return(sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ld(e,t){return!t||"object"!==sd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cd(e){return(cd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fd(e,t){return(fd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hd=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ld(this,cd(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fd(e,t)}(t,Hm),t}();function yd(e){return(yd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function md(e,t){return!t||"object"!==yd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dd(e){return(dd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _d(e,t){return(_d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gd=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=md(this,dd(t).call(this)))._components=[],e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_d(e,t)}(t,J["a"]),n=t,(r=[{key:"addComponent",value:function(e){this._components.indexOf(e)<0&&(this._components.push(e),e._entity=this,e.didAddToEntity())}},{key:"updateDeltaTime",value:function(e){}},{key:"componentOfType",value:function(e){return this._components.find(function(t){return Object(w.a)(t,e)})}},{key:"removeComponentOfType",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._components[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(Object(w.a)(a,e)){a.willRemoveFromEntity();var u=this._components.indexOf(a);u>=0&&(this._components.splice(u),a._entity=null)}}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"components",get:function(){return this._components.slice()}}])&&pd(n.prototype,r),o&&pd(n,o),t}();function vd(e){return(vd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sd(e,t){return!t||"object"!==vd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wd(e){return(wd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Td(e,t){return(Td=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kd=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Sd(this,wd(t).call(this)))._entity=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Td(e,t)}(t,J["a"]),n=t,(r=[{key:"updateDeltaTime",value:function(e){}},{key:"didAddToEntity",value:function(){}},{key:"willRemoveFromEntity",value:function(){}},{key:"entity",get:function(){return this._entity}}])&&bd(n.prototype,r),o&&bd(n,o),t}();function Od(e){return(Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cd(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function xd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ed(e,t){return!t||"object"!==Od(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pd(e){return(Pd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ad(e,t){return(Ad=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nd=1,Rd=2,Fd=3,Dd=4,Id=5,Md=6,jd=7,Bd=8,Ld=9,Ud=10,Vd=11,zd=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ed(this,Pd(t).call(this)))._type=0,e._path=null,e._obstacles=[],e._agents=[],e._time=0,e._angle=0,e._distance=0,e._speed=0,e._forward=!0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ad(e,t)}(t,J["a"]),n=t,o=[{key:"goalToSeekAgent",value:function(e){var n=new t;return n._type=Nd,n._agents.push(e),n}},{key:"goalToFleeAgent",value:function(e){var n=new t;return n._type=Rd,n._agents.push(e),n}},{key:"goalToReachTargetSpeed",value:function(e){var n=new t;return n._type=Fd,n._speed=e,n}},{key:"goalToWander",value:function(e){var n=new t;return n._type=Dd,n._speed=e,n}},{key:"goalToAvoid",value:function(e,n){var r,o=new t;return o._type=Id,(r=o._obstacles).push.apply(r,Cd(e)),o._time=n,o}},{key:"goalToInterceptAgent",value:function(e,n){var r,o=new t;return o._type=Md,(r=o._agents).push.apply(r,Cd(e)),o._time=n,o}},{key:"goalToSeparateFrom",value:function(e,n,r){var o,i=new t;return i._type=jd,(o=i._agents).push.apply(o,Cd(e)),i._distance=n,i._angle=r,i}},{key:"goalToAlignWith",value:function(e,n,r){var o,i=new t;return i._type=Bd,(o=i._agents).push.apply(o,Cd(e)),i._distance=n,i._angle=r,i}},{key:"goalToCohereWith",value:function(e,n,r){var o,i=new t;return i._type=Ld,(o=i._agents).push.apply(o,Cd(e)),i._distance=n,i._angle=r,i}},{key:"goalToStayOn",value:function(e,n){var r=new t;return r._type=Ud,r._path=e,r._time=n,r}},{key:"goalToFollow",value:function(e,n,r){var o=new t;return o._type=Vd,o._path=e,o._time=n,o._foward=r,o}}],(r=null)&&xd(n.prototype,r),o&&xd(n,o),t}();function Gd(e){return(Gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yd(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Xd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hd(e,t){return!t||"object"!==Gd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wd(e){return(Wd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kd(e,t){return(Kd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zd=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Hd(this,Wd(t).call(this)))._goals=[],e._weights=[],e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kd(e,t)}(t,J["a"]),n=t,o=[{key:"behaviorWithGoalWeight",value:function(e,n){var r=new t;return r._goals.push(e),r._weights.push(n),r}},{key:"behaviorWithGoals",value:function(e){var n,r=new t;(n=r._goals).push.apply(n,Yd(e));for(var o=0;o<e.length;o++)r._weights.push(1);return r}},{key:"behaviorWithGoalsAndWeights",value:function(e,n){var r,o,i=new t;return(r=i._goals).push.apply(r,Yd(e)),(o=i._weights).push.apply(o,Yd(n)),i}}],(r=[{key:"setWeightFor",value:function(e,t){var n=this._goals.indexOf(t);n>=0&&(this._weights[n]=e)}},{key:"weightFor",value:function(e){var t=this._goals.indexOf(e);return t>=0?this._weights[t]:0}},{key:"remove",value:function(e){var t=this._goals.indexOf(e);t>=0&&(this._goals.splice(t,1),this._weights.splice(t,1))}},{key:"removeAllGoals",value:function(){this._goals=[],this._weights=[]}},{key:"subscript",value:function(e){return null}},{key:"goalCount",get:function(){return this._goals.length}}])&&Xd(n.prototype,r),o&&Xd(n,o),t}();function qd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Jd=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"agentWillUpdate",value:function(e){}},{key:"agentDidUpdate",value:function(e){}}])&&qd(t.prototype,n),r&&qd(t,r),e}();function Qd(e){return(Qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e_(e,t){return!t||"object"!==Qd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function t_(e){return(t_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n_(e,t){return(n_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e_(this,t_(t).call(this))).behavior=null,e.mass=0,e.maxAcceleration=0,e.maxSpeed=0,e.radius=0,e.delegate=null,e.speed=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n_(e,t)}(t,kd),n=t,(r=[{key:"agentWillUpdate",value:function(e){}},{key:"agentDidUpdate",value:function(e){}}])&&$d(n.prototype,r),o&&$d(n,o),t}();function o_(e){return(o_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a_(e,t){return!t||"object"!==o_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u_(e){return(u_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s_(e,t){return(s_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=a_(this,u_(t).call(this))).position=new c.a(0,0),e.rotation=0,e._velocity=new c.a,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s_(e,t)}(t,r_),n=t,(r=[{key:"updateDeltaTime",value:function(e){}},{key:"velocity",get:function(){return this._velocity}}])&&i_(n.prototype,r),o&&i_(n,o),t}();function c_(e){return(c_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h_(e,t){return!t||"object"!==c_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y_(e){return(y_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p_(e,t){return(p_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m_=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=h_(this,y_(t).call(this)))._node=e,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p_(e,t)}(t,kd),n=t,(r=[{key:"node",get:function(){return this._node}}])&&f_(n.prototype,r),o&&f_(n,o),t}();function d_(e){return(d_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function __(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function g_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v_(e,t){return!t||"object"!==d_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b_(e){return(b_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S_(e,t){return(S_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=v_(this,b_(t).call(this))).radius=0,e.isCyclical=!1,e._points=[],e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S_(e,t)}(t,J["a"]),n=t,o=[{key:"pathWithPointsCountRadiusCyclical",value:function(e,n,r,o){var i,a=new t;return(i=a._points).push.apply(i,__(e.slice(0,n))),a.radius=r,a.isCyclical=o,a}},{key:"pathWithFloat3PointsCountRadiusCyclical",value:function(e,n,r,o){var i,a=new t;return(i=a._points).push.apply(i,__(e.slice(0,n))),a.radius=r,a.isCyclical=o,a}},{key:"pathWithGraphNodesRadius",value:function(e,n){var r=new t;return r.radius=n,r}},{key:"pathWithPointsRadiusCyclical",value:function(e,n,r){var o,i=new t;return(o=i._points).push.apply(o,__(e)),i.radius=n,i.isCyclical=r,i}}],(r=[{key:"float2At",value:function(e){return this.pointAt(e)}},{key:"float3At",value:function(e){var t=this._points[e];return t?new ue.a(t.x,t.y,t.z):null}},{key:"pointAt",value:function(e){var t=this._points[e];return t?new c.a(t.x,t.y):null}},{key:"numPoints",get:function(){return this._points.length()}}])&&g_(n.prototype,r),o&&g_(n,o),t}();function T_(e){return(T_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O_(e,t){return!t||"object"!==T_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C_(e){return(C_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x_(e,t){return(x_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=O_(this,C_(t).call(this))).rootNode=null,e._entities=[],e._graphs={},e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x_(e,t)}(t,J["a"]),n=t,o=[{key:"sceneWithFileNamed",value:function(e){return new t}}],(r=[{key:"addEntity",value:function(e){this._entities.indexOf(e)<0&&this._entities.push(e)}},{key:"removeEntity",value:function(e){var t=this._entities.indexOf(e);this._entities.splice(t,1)}},{key:"removeGraph",value:function(e){this._graphs[e]&&delete this._graphs[e]}},{key:"addGraph",value:function(e,t){this._graphs[t]=e}},{key:"entities",get:function(){return this._entities.slice()}},{key:"graphs",get:function(){return this._graphs}}])&&k_(n.prototype,r),o&&k_(n,o),t}(),P_={linear:0,easeIn:1,easeOut:2,easeInEaseOut:3};function A_(e){return(A_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R_(e,t){return!t||"object"!==A_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function F_(e,t,n){return(F_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=D_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function D_(e){return(D_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I_(e,t){return(I_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M_=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=R_(this,D_(t).call(this)))._speed=1,o._timingMode=P_.linear,o._timingFunction=null,o._duration=0,o._finished=!1,o._beginTime=0,o._isRunning=!1,o._pausedTime=0,o._completionHandler=null,o.__actionStartTime=null,o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I_(e,t)}(t,J["a"]),n=t,o=[{key:"actionWithName",value:function(e){return new t(e,null,.25)}},{key:"actionWithNamedDuration",value:function(e,n){return new t(e,null,n)}},{key:"actionWithNamedFrom",value:function(e,n){return new t(e,n)}},{key:"moveByXYDuration",value:function(e,t,n){return null}},{key:"moveByDuration",value:function(e,t){return null}},{key:"moveToDuration",value:function(e,t){return null}},{key:"followDuration",value:function(e,t){return null}},{key:"follow",value:function(e,t){return null}},{key:"followAsOffsetOrientToPathDuration",value:function(e,t,n,r){return null}},{key:"followAsOffsetOrientToPath",value:function(e,t,n,r){return null}},{key:"rotateByAngleDuration",value:function(e,t){return null}},{key:"rotateToAngleDuration",value:function(e,t){return null}},{key:"speedByDuration",value:function(e,t){return null}},{key:"speedToDuration",value:function(e,t){return null}},{key:"scaleByDuration",value:function(e,t){return null}},{key:"scaleToDuration",value:function(e,t){return null}},{key:"scaleXByYDuration",value:function(e,t,n){return null}},{key:"scaleXToYDuration",value:function(e,t,n){return null}},{key:"scaleXToDuration",value:function(e,t){return null}},{key:"scaleYToDuration",value:function(e,t){return null}},{key:"unhide",value:function(){return null}},{key:"hide",value:function(){return null}},{key:"fadeInWithDuration",value:function(e){return null}},{key:"fadeOutWithDuration",value:function(e){return null}},{key:"fadeAlphaByDuration",value:function(e,t){return null}},{key:"fadeAlphaToDuration",value:function(e,t){return null}},{key:"resizeByWidth",value:function(e,t,n){return null}},{key:"resizeToHeight",value:function(e,t){return null}},{key:"resizeToWidth",value:function(e,t){return null}},{key:"setTexture",value:function(e){return null}},{key:"animateWithTimePerFrame",value:function(e,t){return null}},{key:"setNormalTexture",value:function(e){return null}},{key:"animateWithNormalTexturesTimePerFrame",value:function(e,t){return null}},{key:"colorizeWithDuration",value:function(e,t,n){return null}},{key:"applyForceDuration",value:function(e,t){return null}},{key:"applyTorqueDuration",value:function(e,t){return null}},{key:"applyForceAtDuration",value:function(e,t,n){return null}},{key:"applyImpulseDuration",value:function(e,t){return null}},{key:"applyAngularImpulseDuration",value:function(e,t){return null}},{key:"applyImpulseAtDuration",value:function(e,t,n){return null}},{key:"changeChargeTo",value:function(e,t){return null}},{key:"changeChargeBy",value:function(e,t){return null}},{key:"changeMassTo",value:function(e,t){return null}},{key:"changeMassBy",value:function(e,t){return null}},{key:"strengthToDuration",value:function(e,t){return null}},{key:"strengthByDuration",value:function(e,t){return null}},{key:"falloffToDuration",value:function(e,t){return null}},{key:"falloffByDuration",value:function(e,t){return null}},{key:"animateWithWarps",value:function(e,t){return null}},{key:"warpTo",value:function(e,t){return null}},{key:"playSoundFileNamedWaitForCompletion",value:function(e,t){return null}},{key:"play",value:function(){return null}},{key:"pause",value:function(){return null}},{key:"stop",value:function(){return null}},{key:"changePlaybackRateTo",value:function(e,t){return null}},{key:"changePlaybackRateBy",value:function(e,t){return null}},{key:"changeVolumeTo",value:function(e,t){return null}},{key:"changeVolumeBy",value:function(e,t){return null}},{key:"changeObstructionTo",value:function(e,t){return null}},{key:"changeObstructionBy",value:function(e,t){return null}},{key:"changeOcclusionTo",value:function(e,t){return null}},{key:"changeOcclusionBy",value:function(e,t){return null}},{key:"changeReverbTo",value:function(e,t){return null}},{key:"changeReverbBy",value:function(e,t){return null}},{key:"stereoPanTo",value:function(e,t){return null}},{key:"stereoPanBy",value:function(e,t){return null}},{key:"removeFromParent",value:function(){return null}},{key:"runOnChildWithName",value:function(e,t){return null}},{key:"group",value:function(e){return null}},{key:"sequence",value:function(e){return null}},{key:"repeat",value:function(e,t){return null}},{key:"repeatForever",value:function(e){return null}},{key:"waitForDuration",value:function(e){return null}},{key:"waitForDurationWithRange",value:function(e,t){return null}},{key:"reachToRootNodeDuration",value:function(e,t,n){return null}},{key:"reachToRootNode",value:function(e,t,n){return null}},{key:"customActionWithDurationActionBlock",value:function(e,t){return null}},{key:"performOnTarget",value:function(e,t){return null}},{key:"run",value:function(e){return null}}],(r=[{key:"copy",value:function(){var e=F_(D_(t.prototype),"copy",this).call(this);return e._beginTime=this._beginTime,e._duration=this._duration,e._speed=this.speed,e._timingMode=this.timingMode,e._timingFunction=this.timingFunction,e._finished=this._finished,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._getTime(t,n)}},{key:"_getTime",value:function(e,t){if(!t)return e>=1&&!this._finished&&(this._finished=!0),e;var n=this._basetimeFromTime(e);return null===this.timingFunction?n:this.timingFunction._getValueAtTime(n)}},{key:"_basetimeFromTime",value:function(e){var t=e-this._actionStartTime;return this._basetimeFromActivetime(t)}},{key:"_activetimeFromTime",value:function(e){return e-this._actionStartTime}},{key:"_basetimeFromActivetime",value:function(e){var t=e-this._beginTime;if(0===this.speed)return 0;if(0===this._duration)return t/Math.abs(this.speed);var n=this._duration/Math.abs(this.speed);return 0===n&&(n=.25),t>=n&&(this._finished||(this._finished=!0)),t/n}},{key:"_lerp",value:function(e,t,n){return null===n?t:Object(w.a)(e,a.a)?e._lerp(t,n):Object(w.a)(e,c.a)?e._lerp(t,n):Object(w.a)(e,i.a)?e._lerp(t,n):Object(w.a)(e,de)?e._lerp(t,n):e+(t-e)*n}},{key:"_resetFinished",value:function(){this._finished=!1}},{key:"reversed",value:function(){return null}},{key:"speed",get:function(){return this._speed},set:function(e){this._speed=e}},{key:"timingMode",get:function(){return this._timingMode},set:function(e){this._timingMode=e}},{key:"timingFunction",get:function(){return this._timingFunction},set:function(e){this._timingFunction=e}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"_actionStartTime",get:function(){return this.__actionStartTime},set:function(e){this.__actionStartTime=e}}])&&N_(n.prototype,r),o&&N_(n,o),t}();function j_(e){return(j_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B_(e,t){return!t||"object"!==j_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L_(e){return(L_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U_(e,t){return(U_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=B_(this,L_(t).call(this))).shouldEnableEffects=!0,e.filter=null,e.shouldCenterFilter=!0,e.blendMode=Ia.alpha,e.shader=null,e.attributeValues=new Map,e.shouldRasterize=!1,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U_(e,t)}(t,za),t}(),z_={fill:0,aspectFill:1,aspectFit:2,resizeFill:3};function G_(e){return(G_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X_(e,t){return!t||"object"!==G_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H_(e){return(H_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W_(e,t){return(W_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var K_=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=X_(this,H_(t).call(this))).camera=null,n.anchorPoint=new c.a(0,0),n.size=e||new a.a(1,1),n.scaleMode=z_.fill,n.backgroundColor=new de(.15,.15,.15,1),n._view=null,n.delegate=null,n._physicsWorld=null,n.listener=null,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W_(e,t)}(t,V_),n=t,(r=[{key:"_copyValue",value:function(e){this.camera=e.camera,this.anchorPoint=e.anchorPoint.copy(),this.size=e.size.copy(),this.scaleMode=e.scaleMode,this.backgroundColor=e.backgroundColor._copy(),this._view=e._view,this.delegate=e.delegate,this._physicsWorld=e._physicsWorld,this.listener=e.listener}},{key:"didChangeSize",value:function(e){}},{key:"convertPointFromView",value:function(e){return null}},{key:"convertPointToView",value:function(e){return null}},{key:"sceneDidLoad",value:function(){}},{key:"willMoveFrom",value:function(e){}},{key:"didMoveTo",value:function(e){}},{key:"update",value:function(e){}},{key:"didEvaluateActions",value:function(){}},{key:"didSimulatePhysics",value:function(){}},{key:"didApplyConstraints",value:function(){}},{key:"didFinishUpdate",value:function(){}},{key:"view",get:function(){return this._view}},{key:"physicsWorld",get:function(){return this._physicsWorld}}])&&Y_(n.prototype,r),o&&Y_(n,o),t}();function Z_(e){return(Z_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q_(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J_(e,t){return!t||"object"!==Z_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q_(e,t,n){return(Q_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$_(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $_(e){return($_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eg(e,t){return(eg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=J_(this,$_(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=P_.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e._toValue=null,e._byValue=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eg(e,t)}(t,M_),n=t,o=[{key:"fadeInWithDuration",value:function(e){var n=new t;return n._toValue=1,n._duration=e,n}},{key:"fadeOutWithDuration",value:function(e){var n=new t;return n._toValue=0,n._duration=e,n}},{key:"fadeAlphaByDuration",value:function(e,n){var r=new t;return r._byValue=e,r._duration=n,r}},{key:"fadeAlphaToDuration",value:function(e,n){var r=new t;return r._toValue=e,r._duration=n,r}}],(r=[{key:"copy",value:function(){var e=Q_($_(t.prototype),"copy",this).call(this);return e._toValue=this._toValue,e._byValue=this._byValue,e._duration=this._duration,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._getTime(t,n);if(!(e instanceof za))throw new Error("unsupported class for SKFade: ".concat(e.constructor.name));var o=e.alpha,i=0;if(null!==this._toValue)i=this._toValue;else{if(null===this._byValue)throw new Error("both toValue and byValue are null");i=o+this._byValue}var a=this._lerp(o,i,r);e._presentation.alpha=a,this._finished&&(e.alpha=i)}}])&&q_(n.prototype,r),o&&q_(n,o),t}();M_.fadeInWithDuration=tg.fadeInWithDuration,M_.fadeOutWithDuration=tg.fadeOutWithDuration,M_.fadeAlphaByDuration=tg.fadeAlphaByDuration,M_.fadeAlphaToDuration=tg.fadeAlphaToDuration;var ng={center:0,left:1,right:2};function rg(e){return(rg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function og(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ig(e,t){return!t||"object"!==rg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ag(e,t,n){return(ag="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ug(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ug(e){return(ug=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sg(e,t){return(sg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ig(this,ug(t).call(this)))._actions=[],e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sg(e,t)}(t,M_),n=t,o=[{key:"group",value:function(e){var n=new t;return n._actions=e,n}}],(r=[{key:"copy",value:function(){var e=ag(ug(t.prototype),"copy",this).call(this);return e._actions=[],this._actions.forEach(function(t){e._actions.push(t.copy())}),e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._activetimeFromTime(t),o=!0;this._actions.forEach(function(t){t._finished||(t._applyAction(e,r,n),t._finished||(o=!1))}),this._finished=o}},{key:"_resetFinished",value:function(){this._actions.forEach(function(e){e._resetFinished()}),this._finished=!1}},{key:"duration",get:function(){var e=0;return this._actions.forEach(function(t){e<t.duration&&(e=t.duration)}),e}}])&&og(n.prototype,r),o&&og(n,o),t}();function cg(e){return(cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hg(e,t){return!t||"object"!==cg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yg(e){return(yg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pg(e,t){return(pg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}M_.group=lg.group;var mg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=hg(this,yg(t).call(this))).path=null,e.fillColor=new de(0,0,0,0),e.fillTexture=null,e.fillShader=null,e.lineWidth=1,e.glowWidth=0,e.isAntialiased=!0,e.strokeColor=new de(1,1,1,1),e.strokeTexture=null,e.strokeShader=null,e.lineCap=r.butt,e.lineJoin=o.bevel,e.miterLimit=.5,e.blendMode=Ia.alpha,e.attributeValues=new Map,e._customPlaygroundQuickLook=null,e}var n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pg(e,t)}(t,za),n=t,a=[{key:"node",value:function(e){}},{key:"nodeWithRectOf",value:function(e){}},{key:"nodeWithCircleOfRadius",value:function(e){return new t}},{key:"nodeWithEllipseOf",value:function(e){}},{key:"nodeWithEllipseIn",value:function(e){}},{key:"nodeWithPointsCount",value:function(e,t){}},{key:"nodeWithSplinePointsCount",value:function(e,t){}}],(i=[{key:"setValueForAttribute",value:function(e,t){}},{key:"valueForAttributeNamed",value:function(e){return null}},{key:"_render",value:function(e){}},{key:"lineLength",get:function(){return 0}},{key:"customPlaygroundQuickLook",get:function(){return this._customPlaygroundQuickLook}}])&&fg(n.prototype,i),a&&fg(n,a),t}();function dg(e){return(dg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gg(e,t){return!t||"object"!==dg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vg(e,t,n){return(vg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function bg(e){return(bg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sg(e,t){return(Sg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=gg(this,bg(t).call(this)))._actions=[],e._animIndex=0,e._finished=!1,e._duration=0,e._timingMode=P_.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sg(e,t)}(t,M_),n=t,o=[{key:"sequence",value:function(e){var n=new t;return n._actions=e,n._duration=0,n}}],(r=[{key:"copy",value:function(){var e=vg(bg(t.prototype),"copy",this).call(this);return e._actions=this._actions.slice(0),e._animIndex=this._animIndex,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.duration,o=0;o=r<=0||r===1/0?this._activetimeFromTime(t):this._getTime(t,n)*r;for(var i=0;i<this._animIndex;i++)o-=this._actions[i].duration/this._actions[i].speed;for(;this._animIndex<this._actions.length;this._animIndex++){var a=this._actions[this._animIndex];if(a._applyAction(e,o,!0),(o-=a.duration/a.speed)<=0||!a._finished)break}this._animIndex>=this._actions.length&&(this._finished=!0)}},{key:"_resetFinished",value:function(){this._actions.forEach(function(e){e._resetFinished()}),this._finished=!1,this._animIndex=0}},{key:"duration",get:function(){var e=0;return this._actions.forEach(function(t){t.speed>0&&(e+=t.duration/t.speed)}),e}}])&&_g(n.prototype,r),o&&_g(n,o),t}();function Tg(e){return(Tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Og(e,t){return!t||"object"!==Tg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cg(e,t,n){return(Cg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xg(e){return(xg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eg(e,t){return(Eg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}M_.sequence=wg.sequence;var Pg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Og(this,xg(t).call(this)))._timesToRepeat=0,e._repeatedAtion=null,e._forever=!1,e._timesRepeated=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eg(e,t)}(t,M_),n=t,o=[{key:"repeat",value:function(e,n){var r=new t;return r._repeatedAction=e,r._duration=e.duration,r._timesToRepeat=n,r._forever=n===1/0,r}},{key:"repeatForever",value:function(e){return this.repeat(e,1/0)}}],(r=[{key:"copy",value:function(){var e=Cg(xg(t.prototype),"copy",this).call(this);return e._timesToRepeat=this._timesToRepeat,e._repeatedAction=this._repeatedAction,e._forever=this._forever,e._timesRepeated=this._timesRepeated,e}},{key:"_getTime",value:function(e,t){if(!t)return e;var n=this._basetimeFromTime(e);if(null===this.timingFunction)return n;var r=Math.floor(n);return r+this.timingFunction._getValueAtTime(n-r)}},{key:"_applyAction",value:function(e,t){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._getTime(t,n),o=Math.floor(r);o>this._timesRepeated;){if(this._timesRepeated+=1,this._repeatedAction._applyAction(e,1,!1),!this._forever&&this._timesRepeated>=this._timesToRepeat)return void(this._finished=!0);this._repeatedAction._resetFinished()}var i=r-this._timesRepeated;this._repeatedAction._applyAction(e,i,!1),this._finished=!1}},{key:"_resetFinished",value:function(){this._repeatedAction._resetFinished(),this._timesRepeated=0,this._finished=!1}},{key:"duration",get:function(){return this._forever?1/0:this._repeatedAction.duration*this._timesToRepeat}}])&&kg(n.prototype,r),o&&kg(n,o),t}();function Ag(e){return(Ag="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ng(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rg(e,t){return!t||"object"!==Ag(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fg(e,t,n){return(Fg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Dg(e){return(Dg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ig(e,t){return(Ig=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}M_.repeat=Pg.repeat,M_.repeatForever=Pg.repeatForever;var Mg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Rg(this,Dg(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=P_.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e._scaleXTo=null,e._scaleXBy=null,e._scaleWidthTo=null,e._scaleYTo=null,e._scaleYBy=null,e._scaleHeightTo=null,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ig(e,t)}(t,M_),n=t,o=[{key:"scaleByDuration",value:function(e,n){var r=new t;return r._scaleXBy=e,r._scaleYBy=e,r._duration=n,r}},{key:"scaleToDuration",value:function(e,n){var r=new t;if(e instanceof a.a)r._scaleWidthTo=e.width,r._scaleHeightTo=e.height;else{if("number"!=typeof e)throw new Error("unsupported format");r._scaleXTo=e,r._scaleYTo=e}return r._duration=n,r}},{key:"scaleXByYDuration",value:function(e,n,r){var o=new t;return o._scaleXBy=e,o._scaleYBy=n,o._duration=r,o}},{key:"scaleXToYDuration",value:function(e,n,r){var o=new t;return o._scaleXTo=e,o._scaleYTo=n,o._duration=r,o}},{key:"scaleXToDuration",value:function(e,n){var r=new t;return r._scaleXTo=e,r._duration=n,r}},{key:"scaleYToDuration",value:function(e,n){var r=new t;return r._scaleYTo=e,r._duration=n,r}}],(r=[{key:"copy",value:function(){var e=Fg(Dg(t.prototype),"copy",this).call(this);return e._scaleXTo=this._scaleXTo,e._scaleXBy=this._scaleXBy,e._scaleWidthTo=this._scaleWidthTo,e._scaleYTo=this._scaleYTo,e._scaleYBy=this._scaleYBy,e._scaleHeightTo=this._scaleHeightTo,e}},{key:"_applyAction",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._getTime(t,n);if(!(e instanceof za))throw new Error("unsupported class for SKSequence: ".concat(e.constructor.name));var o=e.xScale,i=null;null!==this._scaleXTo?i=this._scaleXTo:null!==this._scaleXBy?i=o+this._scaleXBy:null!==this._scaleWidthTo&&(i=this._scaleWidthTo/this._frame.size.width);var a=e.yScale,u=null;if(null!==this._scaleYTo?u=this._scaleYTo:null!==this._scaleYBy?u=a+this._scaleYBy:null!==this._scaleHeightTo&&(u=this._scaleHeightTo/this._frame.size.height),null===i&&null===u)throw new Error("both toXValue and toYValue are null");if(null!==i){var s=this._lerp(o,i,r);e._presentation.xScale=s}if(null!==u){var l=this._lerp(a,u,r);e._presentation.yScale=l}this._finished&&(null!==i&&(e.xScale=i),null!==u&&(e.yScale=u))}}])&&Ng(n.prototype,r),o&&Ng(n,o),t}();M_.scaleByDuration=Mg.scaleByDuration,M_.scaleToDuration=Mg.scaleToDuration,M_.scaleXByYDuration=Mg.scaleXByYDuration,M_.scaleXToYDuration=Mg.scaleXToYDuration,M_.scaleXToDuration=Mg.scaleXToDuration,M_.scaleYToDuration=Mg.scaleYToDuration;var jg={baseline:0,center:1,top:2,bottom:3};function Bg(e){return(Bg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ug(e,t){return!t||"object"!==Bg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vg(e,t,n){return(Vg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zg(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zg(e){return(zg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gg(e,t){return(Gg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yg=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ug(this,zg(t).call(this)))._text=null,n._fontColor=new de(1,1,1,1),n._fontName="HelveticaNeue-UltraLight",n._fontSize=32,n._verticalAlignmentMode=jg.baseline,n._horizontalAlignmentMode=ng.center,n.color=new de(1,1,1,1),n.colorBlendFactor=0,n.blendMode=Ia.alpha,n._canvas=document.createElement("canvas"),n._context=n._canvas.getContext("2d"),n._glContext=null,n._texture=null,n._textureUpToDate=!1,n._program=null,n._vertexArrayObject=null,n._vertexBuffer=null,n._indexBuffer=null,n.text=e,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gg(e,t)}(t,za),n=t,o=[{key:"labelWithFontNamed",value:function(e){var n=new t;return n.fontName=e,n}},{key:"labelWithText",value:function(e){return new t(e)}}],(r=[{key:"_updateCanvas",value:function(){this._context.font="".concat(this._fontSize,"px ").concat(this._fontName);var e=this._context.measureText(this._text);switch(this._canvas.width=e.width,this._canvas.height=3*this._fontSize,this._context.font="".concat(this._fontSize,"px ").concat(this._fontName),this._context.fillStyle=this._fontColor.hexColor,this._verticalAlignmentMode){case jg.baseline:this._context.textBaseline="alphabetic";break;case jg.center:this._context.textBaseline="middle";break;case jg.top:this._context.textBaseline="top";break;case jg.bottom:this._context.textBaseline="bottom";break;default:throw new Error("unknown vertical alignment mode: ".concat(this._verticalAlignmentMode))}this._context.textAlign="left",this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._context.fillText(this._text,0,.5*this._canvas.height),this._textureUpToDate=!1}},{key:"_render",value:function(e,t){var n=this.__presentation;null!==this._texture&&this._glContext===e||(this._glContext=e,this._texture=e.createTexture(),this._textureUpToDate=!1),this._textureUpToDate||(e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this._canvas.width,this._canvas.height,0,e.RGBA,e.UNSIGNED_BYTE,this._canvas),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),this._textureUpToDate=!0),null===this._program&&(this._program=this._createProgram(e));var r=this._program;e.useProgram(r),null===this._vertexArrayObject&&this._createVertexArrayObject(e,r),e.bindVertexArray(this._vertexArrayObject),e.uniform1f(e.getUniformLocation(r,"screenWidth"),t.size.width),e.uniform1f(e.getUniformLocation(r,"screenHeight"),t.size.height),e.uniform1f(e.getUniformLocation(r,"alpha"),n.alpha);var o=this._createVertexData();e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,o,e.DYNAMIC_DRAW),e.uniform1i(e.getUniformLocation(r,"spriteTexture"),0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_BYTE,0)}},{key:"_createProgram",value:function(e){var t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(n,"#version 300 es\n  precision mediump float;\n\n  in vec3 position;\n  in vec2 texcoord;\n\n  uniform float screenWidth;\n  uniform float screenHeight;\n\n  out vec2 v_texcoord;\n\n  void main() {\n    vec3 pos = position;\n    pos.x = (pos.x * 2.0 / screenWidth) - 1.0;\n    pos.y = (pos.y * 2.0 / screenHeight) - 1.0;\n    v_texcoord = texcoord;\n    gl_Position = vec4(pos, 1.0);\n  }\n"),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(n);throw new Error("SKSpriteNode vertex shader compile error: ".concat(r))}var o=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(o,"#version 300 es\n  precision mediump float;\n\n  uniform sampler2D spriteTexture;\n  uniform float alpha;\n  in vec2 v_texcoord;\n\n  out vec4 outColor;\n\n  void main() {\n    outColor = texture(spriteTexture, v_texcoord);\n    outColor.a *= alpha;\n  }\n"),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(o);throw new Error("particle fragment shader compile error: ".concat(i))}if(e.attachShader(t,n),e.attachShader(t,o),e.linkProgram(t),!e.getProgramParameter(t,e.LINK_STATUS)){var a=e.getProgramInfoLog(t);throw new Error("program link error: ".concat(a))}return t}},{key:"_createVertexArrayObject",value:function(e,t){this._vertexArrayObject=e.createVertexArray(),e.bindVertexArray(this._vertexArrayObject),this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer);var n=e.getAttribLocation(t,"position");e.bindAttribLocation(t,n,"position"),e.enableVertexAttribArray(n),e.vertexAttribPointer(n,3,e.FLOAT,!1,20,0);var r=e.getAttribLocation(t,"texcoord");e.bindAttribLocation(t,r,"texcoord"),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,20,12),this._indexBuffer=e.createBuffer();var o=new Uint8Array([0,3,2,0,1,3]);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,o,e.STATIC_DRAW)}},{key:"_createVertexData",value:function(){var e=this.__presentation._worldPosition,t=this._canvas.width*this.__presentation.xScale,n=this._canvas.height*this.__presentation.yScale,r=e.x,o=e.x,i=e.y+.5*n,a=e.y-.5*n;switch(this.__presentation._horizontalAlignmentMode){case ng.center:r-=.5*t,o+=.5*t;break;case ng.left:o+=t;break;case ng.right:r-=t}var u=[r,i,this.__presentation._worldZPosition,0,0,o,i,this.__presentation._worldZPosition,1,0,r,a,this.__presentation._worldZPosition,0,1,o,a,this.__presentation._worldZPosition,1,1];return new Float32Array(u)}},{key:"copy",value:function(){var e=new t;return e._copyValue(this),e}},{key:"_copyValue",value:function(e){Vg(zg(t.prototype),"_copyValue",this).call(this,e),this._text=e._text,this._fontColor=e._fontColor._copy(),this._fontName=e._fontName,this._fontSize=e._fontSize,this._verticalAlignmentMode=e._verticalAlignmentMode,this._horizontalAlignmentMode=e._horizontalAlignmentMode,this.color=e.color._copy(),this.colorBlendFactor=e.colorBlendFactor,this.blendMode=e.blendMode,this._canvas=e._canvas,this._context=e._context}},{key:"text",get:function(){return this._text},set:function(e){this._text=e,this._updateCanvas()}},{key:"fontColor",get:function(){return this._fontColor},set:function(e){this._fontColor=e,this._updateCanvas()}},{key:"fontName",get:function(){return this._fontName},set:function(e){this._fontName=e,this._updateCanvas()}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize=e,this._updateCanvas()}},{key:"verticalAlignmentMode",get:function(){return this._verticalAlignmentMode},set:function(e){this._verticalAlignmentMode=e,this._updateCanvas()}},{key:"horizontalAlignmentMode",get:function(){return this._horizontalAlignmentMode},set:function(e){this._horizontalAlignmentMode=e,this._updateCanvas()}}])&&Lg(n.prototype,r),o&&Lg(n,o),t}();function Xg(e){return(Xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wg(e,t){return!t||"object"!==Xg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kg(e){return(Kg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zg(e,t){return(Zg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Wg(this,Kg(t).call(this)))._actions=[],e._finished=!1,e._duration=0,e._timingMode=P_.linear,e._beginTime=0,e._isRunning=!1,e._pausedTime=0,e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zg(e,t)}(t,M_),n=t,o=[{key:"waitForDuration",value:function(e){var n=new t;return n._duration=e,n}},{key:"waitForDurationWithRange",value:function(e,n){var r=Math.max(0,e+(Math.random()-.5)*n),o=new t;return o._duration=r,o}}],(r=null)&&Hg(n.prototype,r),o&&Hg(n,o),t}();M_.waitForDuration=qg.waitForDuration,M_.waitForDurationWithRange=qg.waitForDurationWithRange;var Jg=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.beginTime=0,this.timeOffset=0,this.repeatCount=0,this.repeatDuration=0,this.duration=0,this.speed=0,this.autoreverses=!1,this.fillMode=""};function Qg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"animationDidStart",value:function(e){}},{key:"animationDidStopFinished",value:function(e,t){}}])&&Qg(t.prototype,n),r&&Qg(t,r),e}();function ev(e){return(ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tv(e,t){return!t||"object"!==ev(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nv(e){return(nv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ov(e,t){return(ov=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iv=function(e){var t,n,r;function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),tv(this,nv(o).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ov(e,t)}(o,J["a"]),t=o,r=[{key:"_propTypes",get:function(){return{}}}],(n=null)&&rv(t.prototype,n),r&&rv(t,r),o}();function av(e){return(av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uv(e,t){return!t||"object"!==av(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sv(e){return(sv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cv(e,t){return(cv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fv=function(e){var t,n,r;function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=uv(this,sv(o).call(this)))._array=[],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cv(e,t)}(o,iv),t=o,r=[{key:"_propTypes",get:function(){return{array:["NSArray","_array"]}}}],(n=null)&&lv(t.prototype,n),r&&lv(t,r),o}();var hv=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._m11=1,this._m12=0,this._m13=0,this._m14=0,this._m21=0,this._m22=1,this._m23=0,this._m24=0,this._m31=0,this._m32=0,this._m33=1,this._m34=0,this._m41=0,this._m42=0,this._m43=0,this._m44=1};function yv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"runForKeyObjectArguments",value:function(e,t,n){}}])&&yv(t.prototype,n),r&&yv(t,r),e}();function mv(e){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dv(e,t){return!t||"object"!==mv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _v(e){return(_v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vv(e,t){return(vv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bv=function(e){var t,n,r;function o(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),dv(this,_v(o).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vv(e,t)}(o,iv),t=o,r=[{key:"initWithCoder",value:function(e){var t=e._refObj,n=t.kind;switch(n){case 0:return new c.a(t.x,t.y);case 1:return new a.a(t.width,t.height);case 2:var r=new c.a(t.x,t.y),o=new a.a(t.width,t.height);return new i.a(r,o);case 3:break;case 4:case 5:return new c.a(t.x,t.y);case 6:return new a.a(t.width,t.height);case 7:var u=new c.a(t.x,t.y),s=new a.a(t.width,t.height);return new i.a(u,s)}throw new Error("LKNSValueCodingProxy unsupported type: "+n)}}],(n=null)&&gv(t.prototype,n),r&&gv(t,r),o}(),Sv=function(){return.001*Date.now()};function wv(e){return(wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kv(e,t){return!t||"object"!==wv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ov(e){return(Ov=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cv(e,t){return(Cv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kv(this,Ov(t).apply(this,arguments))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cv(e,t)}(t,J["a"]),n=t,o=[{key:"initWithCoder",value:function(e){return de.initWithCoder(e)}}],(r=null)&&Tv(n.prototype,r),o&&Tv(n,o),t}(),Ev={gray:0,RGB:1,CMYK:2,LAB:3,deviceN:4,indexed:5,patterned:6,unknown:-1},Pv=Date.UTC(2001,0,1,0,0,0,0);var Av=function(){return.001*(Date.now()-Pv)};k.a.registerClass(r,"CGLineCap"),k.a.registerClass(o,"CGLineJoin"),k.a.registerClass(i.a,"CGRect"),k.a.registerClass(a.a,"CGSize"),k.a.registerClass(u,"CGBlendMode"),k.a.registerClass(l,"CGPath"),k.a.registerClass(c.a,"CGPoint"),k.a.registerClass(f,"CGPathApplierFunction"),k.a.registerClass(h,"CGPathFillRule"),k.a.registerClass(p,"CGMutablePath"),k.a.registerClass(m.a,"CGVector"),k.a.registerClass(I,"MTLTessellationPartitionMode"),k.a.registerClass(M,"DispatchTimeInterval"),k.a.registerClass(B,"DispatchObject"),k.a.registerClass(U,"DispatchTime"),k.a.registerClass(W,"DispatchQueue"),k.a.registerClass(K,"SCNBufferFrequency"),k.a.registerClass(q,"SCNMatrix4Translate"),k.a.registerClass(Ne,"SCNActionRepeat"),k.a.registerClass(je,"SCNPhysicsVehicleWheel"),k.a.registerClass(Ke,"SCNPhysicsVehicle"),k.a.registerClass(et,"SCNPhysicsHingeJoint"),k.a.registerClass(tt.a,"SCNGeometrySource"),k.a.registerClass(pt,"SCNAnimationPlayer"),k.a.registerClass(wo,"SCNTransformConstraint"),k.a.registerClass(ko,"SCNActionable"),k.a.registerClass(Oo,"SCNLayer"),k.a.registerClass(wr,"SCNHitTestResult"),k.a.registerClass(Co,"SCNParticleBirthLocation"),k.a.registerClass(Io,"SCNAudioSource"),k.a.registerClass(Mo,"SCNRenderingAPI"),k.a.registerClass(jo,"SCNParticleModifierStage"),k.a.registerClass(Bo,"SCNMatrix4ToMat4"),k.a.registerClass(Go,"SCNShape"),k.a.registerClass(Xo,"SCNSceneExportDelegate"),k.a.registerClass(Ho,"SCNParticleModifierBlock"),k.a.registerClass(Wo,"SCNMatrix4Mult"),k.a.registerClass(yn,"SCNFilterMode"),k.a.registerClass(ti,"SCNCamera"),k.a.registerClass(ni,"SCNFieldForceEvaluator"),k.a.registerClass(ri,"_SCNDefaultVertexShader"),k.a.registerClass(ci,"SCNTube"),k.a.registerClass(gi,"SCNActionRunBlock"),k.a.registerClass(vi,"_SCNDefaultParticleFragmentShader"),k.a.registerClass(bi,"SCNSceneSourceStatus"),k.a.registerClass(hn,"SCNFillMode"),k.a.registerClass(Qi,"SCNReferenceNode"),k.a.registerClass($i,"_SCNDefaultShadowFragmentShader"),k.a.registerClass(ea,"SCNMatrix4MakeRotation"),k.a.registerClass(ia,"SCNBillboardConstraint"),k.a.registerClass(sn,"SCNOrderedDictionary"),k.a.registerClass(fa,"SCNActionHide"),k.a.registerClass(xi,"_SCNObjLoader"),k.a.registerClass(va,"SCNActionMove"),k.a.registerClass(du,"SCNRenderer"),k.a.registerClass(vt,"SCNConstraint"),k.a.registerClass(wu,"SCNParticlePropertyController"),k.a.registerClass(fn,"SCNCullMode"),k.a.registerClass(Tu,"SCNVector4Make"),k.a.registerClass(ku,"SCNTechniqueSupport"),k.a.registerClass(Cu,"SCNBufferStream"),k.a.registerClass(Ru,"SCNActionPerformSelector"),k.a.registerClass(Uu,"SCNActionRotate"),k.a.registerClass(Wu,"SCNPlane"),k.a.registerClass(Ku,"SCNVector3FromFloat3"),k.a.registerClass(Hr,"SCNPhysicsShape"),k.a.registerClass(es,"SCNDistanceConstraint"),k.a.registerClass(ts,"SCNBufferBindingBlock"),k.a.registerClass(ns,"SCNVector3Zero"),k.a.registerClass(os,"SCNProgramDelegate"),k.a.registerClass(is,"SCNChamferMode"),k.a.registerClass(se.a,"SCNVector4"),k.a.registerClass(as,"SCNVector4ToFloat4"),k.a.registerClass(ps,"SCNActionPlaySound"),k.a.registerClass(jr,"SCNSphere"),k.a.registerClass(ms,"SCNBindingBlock"),k.a.registerClass(Ts,"SCNActionFade"),k.a.registerClass(ks,"SCNParticleInputMode"),k.a.registerClass(zs,"SCNAudioPlayer"),k.a.registerClass(Gs,"SCNMatrix4MakeScale"),k.a.registerClass(Gn,"SCNMaterial"),k.a.registerClass(Ys,"SCNMatrix4Rotate"),k.a.registerClass(mo,"SCNQuaternion"),k.a.registerClass(uu,"_SCNDefaultHitTestVertexShader"),k.a.registerClass(su,"_SCNDefaultHitTestFragmentShader"),k.a.registerClass(Xs,"SCNShaderModifierEntryPoint"),k.a.registerClass(nl,"SCNPhysicsNoiseField"),k.a.registerClass(rl,"SCNVector3FromGLKVector3"),k.a.registerClass(ol,"SCNVector4FromGLKVector4"),k.a.registerClass(il,"SCNMatrix4ToGLKMatrix4"),k.a.registerClass(al,"SCNVector4ToGLKVector4"),k.a.registerClass(It.a,"SCNMatrix4"),k.a.registerClass(Oa,"SCNProgram"),k.a.registerClass(ul,"SCNAntialiasingMode"),k.a.registerClass(ll,"SCNBoundingVolume"),k.a.registerClass(Dn,"SCNTransparencyMode"),k.a.registerClass(cl,"SCNMatrix4EqualToMatrix4"),k.a.registerClass(fl,"SCNTessellationSmoothingMode"),k.a.registerClass(ze,"SCNPhysicsBehavior"),k.a.registerClass(hl,"SCNMatrix4Invert"),k.a.registerClass(yl,"SCNParticleBirthDirection"),k.a.registerClass(pl,"SCNVector3Make"),k.a.registerClass(dl,"SCNPhysicsCollisionCategory"),k.a.registerClass(cn,"SCNColorMask"),k.a.registerClass(_l,"SCNParticleEvent"),k.a.registerClass(ru,"_SCNDefaultFragmentShader"),k.a.registerClass(Tl,"SCNActionReference"),k.a.registerClass(Si,"SCNReferenceLoadingPolicy"),k.a.registerClass(Nl,"SCNActionSequence"),k.a.registerClass(le,"SCNActionTimingMode"),k.a.registerClass(Fl,"SCNBillboardAxis"),k.a.registerClass($n.a,"SCNGeometryElement"),k.a.registerClass(Il,"SCNShadable"),k.a.registerClass(Ml,"SCNVector3ToGLKVector3"),k.a.registerClass(Yl,"SCNCylinder"),k.a.registerClass(ql,"SCNLookAtConstraint"),k.a.registerClass(Tr,"SCNPhysicsBodyType"),k.a.registerClass(nc,"SCNTorus"),k.a.registerClass(sc,"SCNShadableHelper"),k.a.registerClass(Fa,"SCNLight"),k.a.registerClass(Ko,"SCNCameraProjectionDirection"),k.a.registerClass(dc,"SCNSkinner"),k.a.registerClass(gc,"SCNAnimatable"),k.a.registerClass(Tc,"SCNGeometryTessellator"),k.a.registerClass(Pr,"SCNPhysicsContact"),k.a.registerClass(ut,"SCNAnimation"),k.a.registerClass(Oc,"SCNPhysicsContactDelegate"),k.a.registerClass(on,"SCNMovabilityHint"),k.a.registerClass(Cc,"SCNPhysicsFieldScope"),k.a.registerClass(Rc,"SCNActionScale"),k.a.registerClass(ue.a,"SCNVector3"),k.a.registerClass(Da,"SCNHitTestOption"),k.a.registerClass(Bc,"SCNActionCustom"),k.a.registerClass(Yc,"SCNAnimationEvent"),k.a.registerClass(qc,"SCNIKConstraint"),k.a.registerClass(Jc,"SCNParticleSortingMode"),k.a.registerClass(Qc,"SCNMatrix4Scale"),k.a.registerClass(of,"SCNTechnique"),k.a.registerClass(af,"SCNParticleOrientationMode"),k.a.registerClass(Mi,"SCNSceneSource"),k.a.registerClass(po,"SCNNode"),k.a.registerClass(uf,"SCNSceneExportProgressHandler"),k.a.registerClass(yf,"SCNPhysicsBallSocketJoint"),k.a.registerClass(bf,"SCNPhysicsBody"),k.a.registerClass(wf,"SCNDebugOptions"),k.a.registerClass(Pf,"SCNLevelOfDetail"),k.a.registerClass(Af,"SCNParticleImageSequenceAnimationMode"),k.a.registerClass(Nf,"SCNMatrix4FromMat4"),k.a.registerClass(Rf,"SCNShadowMode"),k.a.registerClass(Ff,"SCNVector4FromFloat4"),k.a.registerClass(Fn,"SCNMaterialProperty"),k.a.registerClass(If,"SCNNodeRendererDelegate"),k.a.registerClass(Vf,"SCNPhysicsSliderJoint"),k.a.registerClass(Wf,"SCNActionRunAction"),k.a.registerClass(sr,"SCNBox"),k.a.registerClass(Kf,"SCNParticleEventBlock"),k.a.registerClass(kn,"SCNTransaction"),k.a.registerClass(nh,"SCNActionRemove"),k.a.registerClass(ln,"SCNBlendMode"),k.a.registerClass(sh,"SCNTimingFunction"),k.a.registerClass(ph,"SCNCone"),k.a.registerClass(Yi,"SCNScene"),k.a.registerClass(bh,"SCNPhysicsTurbulenceField"),k.a.registerClass(Te,"SCNAction"),k.a.registerClass(Ch,"SCNFloor"),k.a.registerClass(On,"SCNWrapMode"),k.a.registerClass(Rh,"SCNText"),k.a.registerClass(ou,"_SCNDefaultPBRFragmentShader"),k.a.registerClass(Lh,"SCNActionWait"),k.a.registerClass(Qn,"SCNGeometry"),k.a.registerClass(Uh,"SCNParticleBlendMode"),k.a.registerClass(Vh,"SCNActionTimingFunction"),k.a.registerClass(Oi,"_SCNMtlLoader"),k.a.registerClass(zh,"SCNMorpherCalculationMode"),k.a.registerClass(Gh,"SCNVector3ToFloat3"),k.a.registerClass(er.a,"SCNGeometryPrimitiveType"),k.a.registerClass(Yh,"SCNSceneSourceStatusHandler"),k.a.registerClass(no,"SCNPhysicsWorld"),k.a.registerClass(Xh,"SCNVector4EqualToVector4"),k.a.registerClass(dr,"SCNCapsule"),k.a.registerClass(Wh,"SCNSceneRenderer"),k.a.registerClass(Z.a,"SCNMatrix4MakeTranslation"),k.a.registerClass(Kh,"SCNAnimationEventBlock"),k.a.registerClass(Jy,"SCNView"),k.a.registerClass(Qy,"SCNMatrix4FromGLKMatrix4"),k.a.registerClass($y,"SCNMatrix4IsIdentity"),k.a.registerClass(sp,"SCNMorpher"),k.a.registerClass(cp,"SCNSceneRendererDelegate"),k.a.registerClass(dp,"SCNActionJavaScript"),k.a.registerClass(au,"_SCNDefaultParticleVertexShader"),k.a.registerClass(Sp,"SCNAccelerationConstraint"),k.a.registerClass(Ep,"SCNPyramid"),k.a.registerClass(iu,"_SCNDefaultShadowVertexShader"),k.a.registerClass(Mp,"SCNActionGroup"),k.a.registerClass(Zp,"SCNParticleSystem"),k.a.registerClass(qp,"SCNVector3EqualToVector3"),k.a.registerClass(Js,"SCNPhysicsField"),k.a.registerClass(nm,"NSColorSpace"),k.a.registerClass(rm.a,"NSCoder"),k.a.registerClass(lm,"NSMutableData"),k.a.registerClass(bm,"NSMutableDictionary"),k.a.registerClass(om.a,"NSData"),k.a.registerClass(Cm,"NSURL"),k.a.registerClass(Rm,"NSKeyedArchiver"),k.a.registerClass(Um,"NSValue"),k.a.registerClass(Hm,"NSArray"),k.a.registerClass(ed,"NSNotification"),k.a.registerClass(Ei.a,"NSKeyedUnarchiver"),k.a.registerClass(mm,"NSDictionary"),k.a.registerClass(ud,"NotificationCenter"),k.a.registerClass(hd,"NSMutableArray"),k.a.registerClass(As,"AVAudioNode"),k.a.registerClass(Ms,"AVAudioMixerNode"),k.a.registerClass(l_,"GKAgent2D"),k.a.registerClass(m_,"GKSCNNodeComponent"),k.a.registerClass(zd,"GKGoal"),k.a.registerClass(w_,"GKPath"),k.a.registerClass(Zd,"GKBehavior"),k.a.registerClass(E_,"GKScene"),k.a.registerClass(kd,"GKComponent"),k.a.registerClass(Jd,"GKAgentDelegate"),k.a.registerClass(gd,"GKEntity"),k.a.registerClass(r_,"GKAgent"),k.a.registerClass(nu,"SKSpriteNode"),k.a.registerClass(de,"SKColor"),k.a.registerClass(M_,"SKAction"),k.a.registerClass(P_,"SKActionTimingMode"),k.a.registerClass(Ia,"SKBlendMode"),k.a.registerClass(K_,"SKScene"),k.a.registerClass(tg,"SKFade"),k.a.registerClass(ng,"SKLabelHorizontalAlignmentMode"),k.a.registerClass(z_,"SKSceneScaleMode"),k.a.registerClass(za,"SKNode"),k.a.registerClass(lg,"SKGroup"),k.a.registerClass(V_,"SKEffectNode"),k.a.registerClass(Za,"SKTexture"),k.a.registerClass(Ga,"SKTextureFilteringMode"),k.a.registerClass(mg,"SKShapeNode"),k.a.registerClass(wg,"SKSequence"),k.a.registerClass(Pg,"SKRepeat"),k.a.registerClass(Mg,"SKScale"),k.a.registerClass(Yg,"SKLabelNode"),k.a.registerClass(jg,"SKLabelVerticalAlignmentMode"),k.a.registerClass(qg,"SKWait"),k.a.registerClass(Ny,"GCExtendedGamepad"),k.a.registerClass(Oy,"GCGamepad"),k.a.registerClass(gy,"GCControllerDirectionPad"),k.a.registerClass(ey,"GCControllerElement"),k.a.registerClass(jy,"GCMicroGamepad"),k.a.registerClass(hy,"GCControllerAxisInput"),k.a.registerClass(ay,"GCControllerButtonInput"),k.a.registerClass(Hy,"GCController"),k.a.registerClass(Jg,"CAMediaTiming"),k.a.registerClass(Dt,"CAAnimationGroup"),k.a.registerClass(ae,"CAMediaTimingFunction"),k.a.registerClass(zt,"CAPropertyAnimation"),k.a.registerClass(rn,"CAKeyframeAnimation"),k.a.registerClass($g,"CAAnimationDelegate"),k.a.registerClass(Ct,"CAAnimation"),k.a.registerClass(iv,"CACodingProxy"),k.a.registerClass(Zt,"CABasicAnimation"),k.a.registerClass(fv,"LKNSArrayCodingProxy"),k.a.registerClass(hv,"CATransform3D"),k.a.registerClass(pv,"CAAction"),k.a.registerClass(bv,"LKNSValueCodingProxy"),k.a.registerClass(Sv,"CACurrentMediaTime"),k.a.registerClass(xv,"NSColor"),k.a.registerClass(Ev,"NSColorSpaceModel"),k.a.registerClass(Av,"CFAbsoluteTimeGetCurrent"),k.a.registerClass(J.a,"NSObject"),exports.CGLineCap=r,exports.CGLineJoin=o,exports.CGRect=i.a,exports.CGSize=a.a,exports.CGBlendMode=u,exports.CGPath=l,exports.CGPoint=c.a,exports.CGPathApplierFunction=f,exports.CGPathFillRule=h,exports.CGMutablePath=p,exports.CGVector=m.a,exports._Buffer=d.a,exports._HTMLCanvasElement=v,exports._BinaryReader=b.a,exports._File=S.a,exports._InstanceOf=w.a,exports._TextReader=T.a,exports._ClassList=k.a,exports._AjaxRequest=x,exports.CanUseWebGL2=E,exports._BinaryRequest=F,exports._FileReader=D.a,exports.MTLTessellationPartitionMode=I,exports.DispatchTimeInterval=M,exports.DispatchObject=B,exports.DispatchTime=U,exports.DispatchQueue=W,exports.SCNBufferFrequency=K,exports.SCNMatrix4Translate=q,exports.SCNActionRepeat=Ne,exports.SCNPhysicsVehicleWheel=je,exports.SCNPhysicsVehicle=Ke,exports.SCNPhysicsHingeJoint=et,exports.SCNGeometrySource=tt.a,exports.SCNAnimationPlayer=pt,exports.SCNTransformConstraint=wo,exports.SCNActionable=ko,exports.SCNLayer=Oo,exports.SCNHitTestResult=wr,exports.SCNParticleBirthLocation=Co,exports.SCNAudioSource=Io,exports.SCNRenderingAPI=Mo,exports.SCNParticleModifierStage=jo,exports.SCNMatrix4ToMat4=Bo,exports.SCNShape=Go,exports.SCNSceneExportDelegate=Xo,exports.SCNParticleModifierBlock=Ho,exports.SCNMatrix4Mult=Wo,exports.SCNFilterMode=yn,exports.SCNCamera=ti,exports.SCNFieldForceEvaluator=ni,exports._SCNDefaultVertexShader=ri,exports.SCNTube=ci,exports.SCNActionRunBlock=gi,exports._SCNDefaultParticleFragmentShader=vi,exports.SCNSceneSourceStatus=bi,exports.SCNFillMode=hn,exports.SCNReferenceNode=Qi,exports._SCNDefaultShadowFragmentShader=$i,exports.SCNMatrix4MakeRotation=ea,exports.SCNBillboardConstraint=ia,exports.SCNOrderedDictionary=sn,exports.SCNActionHide=fa,exports._SCNObjLoader=xi,exports.SCNActionMove=va,exports.SCNRenderer=du,exports.SCNConstraint=vt,exports.SCNParticlePropertyController=wu,exports.SCNCullMode=fn,exports.SCNVector4Make=Tu,exports.SCNTechniqueSupport=ku,exports.SCNBufferStream=Cu,exports.SCNActionPerformSelector=Ru,exports.SCNActionRotate=Uu,exports.SCNPlane=Wu,exports.SCNVector3FromFloat3=Ku,exports.SCNPhysicsShape=Hr,exports.SCNDistanceConstraint=es,exports.SCNBufferBindingBlock=ts,exports.SCNVector3Zero=ns,exports.SCNProgramDelegate=os,exports.SCNChamferMode=is,exports.SCNVector4=se.a,exports.SCNVector4ToFloat4=as,exports.SCNActionPlaySound=ps,exports.SCNSphere=jr,exports.SCNBindingBlock=ms,exports.SCNActionFade=Ts,exports.SCNParticleInputMode=ks,exports.SCNAudioPlayer=zs,exports.SCNMatrix4MakeScale=Gs,exports.SCNMaterial=Gn,exports.SCNMatrix4Rotate=Ys,exports.SCNQuaternion=mo,exports._SCNDefaultHitTestVertexShader=uu,exports._SCNDefaultHitTestFragmentShader=su,exports.SCNShaderModifierEntryPoint=Xs,exports.SCNPhysicsNoiseField=nl,exports.SCNVector3FromGLKVector3=rl,exports.SCNVector4FromGLKVector4=ol,exports.SCNMatrix4ToGLKMatrix4=il,exports.SCNVector4ToGLKVector4=al,exports.SCNMatrix4=It.a,exports.SCNProgram=Oa,exports.SCNAntialiasingMode=ul,exports.SCNBoundingVolume=ll,exports.SCNTransparencyMode=Dn,exports.SCNMatrix4EqualToMatrix4=cl,exports.SCNTessellationSmoothingMode=fl,exports.SCNPhysicsBehavior=ze,exports.SCNMatrix4Invert=hl,exports.SCNParticleBirthDirection=yl,exports.SCNVector3Make=pl,exports.SCNPhysicsCollisionCategory=dl,exports.SCNColorMask=cn,exports.SCNParticleEvent=_l,exports._SCNDefaultFragmentShader=ru,exports.SCNActionReference=Tl,exports.SCNReferenceLoadingPolicy=Si,exports.SCNActionSequence=Nl,exports.SCNActionTimingMode=le,exports.SCNBillboardAxis=Fl,exports.SCNGeometryElement=$n.a,exports.SCNShadable=Il,exports.SCNVector3ToGLKVector3=Ml,exports.SCNCylinder=Yl,exports.SCNLookAtConstraint=ql,exports.SCNPhysicsBodyType=Tr,exports.SCNTorus=nc,exports.SCNShadableHelper=sc,exports.SCNLight=Fa,exports.SCNCameraProjectionDirection=Ko,exports.SCNSkinner=dc,exports.SCNAnimatable=gc,exports.SCNGeometryTessellator=Tc,exports.SCNPhysicsContact=Pr,exports.SCNAnimation=ut,exports.SCNPhysicsContactDelegate=Oc,exports.SCNMovabilityHint=on,exports.SCNPhysicsFieldScope=Cc,exports.SCNActionScale=Rc,exports.SCNVector3=ue.a,exports.SCNHitTestOption=Da,exports.SCNActionCustom=Bc,exports.SCNAnimationEvent=Yc,exports.SCNIKConstraint=qc,exports.SCNParticleSortingMode=Jc,exports.SCNMatrix4Scale=Qc,exports.SCNTechnique=of,exports.SCNParticleOrientationMode=af,exports.SCNSceneSource=Mi,exports.SCNNode=po,exports.SCNSceneExportProgressHandler=uf,exports.SCNPhysicsBallSocketJoint=yf,exports.SCNPhysicsBody=bf,exports.SCNDebugOptions=wf,exports.SCNLevelOfDetail=Pf,exports.SCNParticleImageSequenceAnimationMode=Af,exports.SCNMatrix4FromMat4=Nf,exports.SCNShadowMode=Rf,exports.SCNVector4FromFloat4=Ff,exports.SCNMaterialProperty=Fn,exports.SCNNodeRendererDelegate=If,exports.SCNPhysicsSliderJoint=Vf,exports.SCNActionRunAction=Wf,exports.SCNBox=sr,exports.SCNParticleEventBlock=Kf,exports.SCNTransaction=kn,exports.SCNActionRemove=nh,exports.SCNBlendMode=ln,exports.SCNTimingFunction=sh,exports.SCNCone=ph,exports.SCNScene=Yi,exports.SCNPhysicsTurbulenceField=bh,exports.SCNAction=Te,exports.SCNFloor=Ch,exports.SCNWrapMode=On,exports.SCNText=Rh,exports._SCNDefaultPBRFragmentShader=ou,exports.SCNActionWait=Lh,exports.SCNGeometry=Qn,exports.SCNParticleBlendMode=Uh,exports.SCNActionTimingFunction=Vh,exports._SCNMtlLoader=Oi,exports.SCNMorpherCalculationMode=zh,exports.SCNVector3ToFloat3=Gh,exports.SCNGeometryPrimitiveType=er.a,exports.SCNSceneSourceStatusHandler=Yh,exports.SCNPhysicsWorld=no,exports.SCNVector4EqualToVector4=Xh,exports.SCNCapsule=dr,exports.SCNSceneRenderer=Wh,exports.SCNMatrix4MakeTranslation=Z.a,exports.SCNAnimationEventBlock=Kh,exports.SCNView=Jy,exports.SCNMatrix4FromGLKMatrix4=Qy,exports.SCNMatrix4IsIdentity=$y,exports.SCNMorpher=sp,exports.SCNSceneRendererDelegate=cp,exports.SCNActionJavaScript=dp,exports._SCNDefaultParticleVertexShader=au,exports.SCNAccelerationConstraint=Sp,exports.SCNPyramid=Ep,exports._SCNDefaultShadowVertexShader=iu,exports.SCNActionGroup=Mp,exports.SCNParticleSystem=Zp,exports.SCNVector3EqualToVector3=qp,exports.SCNPhysicsField=Js,exports.NSColorSpace=nm,exports.NSCoder=rm.a,exports.NSMutableData=lm,exports.NSMutableDictionary=bm,exports.NSData=om.a,exports.NSURL=Cm,exports.NSKeyedArchiver=Rm,exports.NSValue=Um,exports.NSArray=Hm,exports.NSNotification=ed,exports.NSKeyedUnarchiver=Ei.a,exports.NSDictionary=mm,exports.NotificationCenter=ud,exports.NSMutableArray=hd,exports.AVAudioNode=As,exports.AVAudioMixerNode=Ms,exports.GKAgent2D=l_,exports.GKSCNNodeComponent=m_,exports.GKGoal=zd,exports.GKPath=w_,exports.GKBehavior=Zd,exports.GKScene=E_,exports.GKComponent=kd,exports.GKAgentDelegate=Jd,exports.GKEntity=gd,exports.GKAgent=r_,exports.SKSpriteNode=nu,exports.SKColor=de,exports.SKAction=M_,exports.SKActionTimingMode=P_,exports.SKBlendMode=Ia,exports.SKScene=K_,exports.SKFade=tg,exports.SKLabelHorizontalAlignmentMode=ng,exports.SKSceneScaleMode=z_,exports.SKNode=za,exports.SKGroup=lg,exports.SKEffectNode=V_,exports.SKTexture=Za,exports.SKTextureFilteringMode=Ga,exports.SKShapeNode=mg,exports.SKSequence=wg,exports.SKRepeat=Pg,exports.SKScale=Mg,exports.SKLabelNode=Yg,exports.SKLabelVerticalAlignmentMode=jg,exports.SKWait=qg,exports.GCExtendedGamepad=Ny,exports.GCGamepad=Oy,exports.GCControllerDirectionPad=gy,exports.GCControllerElement=ey,exports.GCMicroGamepad=jy,exports.GCControllerAxisInput=hy,exports.GCControllerButtonInput=ay,exports.GCController=Hy,exports.CAMediaTiming=Jg,exports.CAAnimationGroup=Dt,exports.CAMediaTimingFunction=ae,exports.CAPropertyAnimation=zt,exports.CAKeyframeAnimation=rn,exports.CAAnimationDelegate=$g,exports.CAAnimation=Ct,exports.CACodingProxy=iv,exports.CABasicAnimation=Zt,exports.LKNSArrayCodingProxy=fv,exports.CATransform3D=hv,exports.CAAction=pv,exports.LKNSValueCodingProxy=bv,exports.CACurrentMediaTime=Sv,exports.NSColor=xv,exports.NSColorSpaceModel=Ev,exports.CFAbsoluteTimeGetCurrent=Av,exports.NSObject=J.a,exports.kCAFillModeRemoved=Q,exports.kCAFillModeForwards="forwards",exports.kCAFillModeBackwards="backwards",exports.kCAFillModeBoth="both",exports.kCAMediaTimingFunctionLinear="linear",exports.kCAMediaTimingFunctionEaseIn="easeIn",exports.kCAMediaTimingFunctionEaseOut="easeOut",exports.kCAMediaTimingFunctionEaseInEaseOut="easeInEaseOut",exports.kCAMediaTimingFunctionDefault="default",exports.kCAAnimationLinear=$,exports.kCAAnimationDiscrete="discrete",exports.kCAAnimationPaced="paced",exports.kCAAnimationCubic="cubic",exports.kCAAnimationCubicPaced="cubicPaced",exports.kCAAnimationRotateAuto="auto",exports.kCAAnimationRotateAutoReverse="autoReverse"}]);
